var tD=Object.defineProperty;var nD=(t,e,n)=>e in t?tD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var He=(t,e,n)=>nD(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var bi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vb={exports:{}},Bh={},Gb={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var El=Symbol.for("react.element"),iD=Symbol.for("react.portal"),rD=Symbol.for("react.fragment"),sD=Symbol.for("react.strict_mode"),oD=Symbol.for("react.profiler"),aD=Symbol.for("react.provider"),lD=Symbol.for("react.context"),uD=Symbol.for("react.forward_ref"),cD=Symbol.for("react.suspense"),hD=Symbol.for("react.memo"),dD=Symbol.for("react.lazy"),Av=Symbol.iterator;function fD(t){return t===null||typeof t!="object"?null:(t=Av&&t[Av]||t["@@iterator"],typeof t=="function"?t:null)}var Ub={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qb=Object.assign,Kb={};function Bo(t,e,n){this.props=t,this.context=e,this.refs=Kb,this.updater=n||Ub}Bo.prototype.isReactComponent={};Bo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Bo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jb(){}Jb.prototype=Bo.prototype;function r0(t,e,n){this.props=t,this.context=e,this.refs=Kb,this.updater=n||Ub}var s0=r0.prototype=new Jb;s0.constructor=r0;qb(s0,Bo.prototype);s0.isPureReactComponent=!0;var Tv=Array.isArray,Zb=Object.prototype.hasOwnProperty,o0={current:null},Yb={key:!0,ref:!0,__self:!0,__source:!0};function Xb(t,e,n){var i,r={},s=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Zb.call(e,i)&&!Yb.hasOwnProperty(i)&&(r[i]=e[i]);var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(i in o=t.defaultProps,o)r[i]===void 0&&(r[i]=o[i]);return{$$typeof:El,type:t,key:s,ref:a,props:r,_owner:o0.current}}function pD(t,e){return{$$typeof:El,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function a0(t){return typeof t=="object"&&t!==null&&t.$$typeof===El}function mD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Mv=/\/+/g;function Id(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mD(""+t.key):e.toString(36)}function zu(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case El:case iD:a=!0}}if(a)return a=t,r=r(a),t=i===""?"."+Id(a,0):i,Tv(r)?(n="",t!=null&&(n=t.replace(Mv,"$&/")+"/"),zu(r,e,n,"",function(u){return u})):r!=null&&(a0(r)&&(r=pD(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(Mv,"$&/")+"/")+t)),e.push(r)),1;if(a=0,i=i===""?".":i+":",Tv(t))for(var o=0;o<t.length;o++){s=t[o];var l=i+Id(s,o);a+=zu(s,e,n,l,r)}else if(l=fD(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=i+Id(s,o++),a+=zu(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Wl(t,e,n){if(t==null)return t;var i=[],r=0;return zu(t,i,"","",function(s){return e.call(n,s,r++)}),i}function gD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rn={current:null},Fu={transition:null},vD={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:Fu,ReactCurrentOwner:o0};function Qb(){throw Error("act(...) is not supported in production builds of React.")}Oe.Children={map:Wl,forEach:function(t,e,n){Wl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Wl(t,function(){e++}),e},toArray:function(t){return Wl(t,function(e){return e})||[]},only:function(t){if(!a0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Oe.Component=Bo;Oe.Fragment=rD;Oe.Profiler=oD;Oe.PureComponent=r0;Oe.StrictMode=sD;Oe.Suspense=cD;Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vD;Oe.act=Qb;Oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=qb({},t.props),r=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=o0.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Zb.call(e,l)&&!Yb.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];i.children=o}return{$$typeof:El,type:t.type,key:r,ref:s,props:i,_owner:a}};Oe.createContext=function(t){return t={$$typeof:lD,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:aD,_context:t},t.Consumer=t};Oe.createElement=Xb;Oe.createFactory=function(t){var e=Xb.bind(null,t);return e.type=t,e};Oe.createRef=function(){return{current:null}};Oe.forwardRef=function(t){return{$$typeof:uD,render:t}};Oe.isValidElement=a0;Oe.lazy=function(t){return{$$typeof:dD,_payload:{_status:-1,_result:t},_init:gD}};Oe.memo=function(t,e){return{$$typeof:hD,type:t,compare:e===void 0?null:e}};Oe.startTransition=function(t){var e=Fu.transition;Fu.transition={};try{t()}finally{Fu.transition=e}};Oe.unstable_act=Qb;Oe.useCallback=function(t,e){return rn.current.useCallback(t,e)};Oe.useContext=function(t){return rn.current.useContext(t)};Oe.useDebugValue=function(){};Oe.useDeferredValue=function(t){return rn.current.useDeferredValue(t)};Oe.useEffect=function(t,e){return rn.current.useEffect(t,e)};Oe.useId=function(){return rn.current.useId()};Oe.useImperativeHandle=function(t,e,n){return rn.current.useImperativeHandle(t,e,n)};Oe.useInsertionEffect=function(t,e){return rn.current.useInsertionEffect(t,e)};Oe.useLayoutEffect=function(t,e){return rn.current.useLayoutEffect(t,e)};Oe.useMemo=function(t,e){return rn.current.useMemo(t,e)};Oe.useReducer=function(t,e,n){return rn.current.useReducer(t,e,n)};Oe.useRef=function(t){return rn.current.useRef(t)};Oe.useState=function(t){return rn.current.useState(t)};Oe.useSyncExternalStore=function(t,e,n){return rn.current.useSyncExternalStore(t,e,n)};Oe.useTransition=function(){return rn.current.useTransition()};Oe.version="18.3.1";Gb.exports=Oe;var I=Gb.exports;const ue=Wb(I);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _D=I,yD=Symbol.for("react.element"),bD=Symbol.for("react.fragment"),wD=Object.prototype.hasOwnProperty,SD=_D.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xD={key:!0,ref:!0,__self:!0,__source:!0};function ew(t,e,n){var i,r={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)wD.call(e,i)&&!xD.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:yD,type:t,key:s,ref:a,props:r,_owner:SD.current}}Bh.Fragment=bD;Bh.jsx=ew;Bh.jsxs=ew;Vb.exports=Bh;var C=Vb.exports,tw={exports:{}},kn={},nw={exports:{}},iw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,O){var N=D.length;D.push(O);e:for(;0<N;){var z=N-1>>>1,q=D[z];if(0<r(q,O))D[z]=O,D[N]=q,N=z;else break e}}function n(D){return D.length===0?null:D[0]}function i(D){if(D.length===0)return null;var O=D[0],N=D.pop();if(N!==O){D[0]=N;e:for(var z=0,q=D.length,te=q>>>1;z<te;){var ee=2*(z+1)-1,K=D[ee],ce=ee+1,T=D[ce];if(0>r(K,N))ce<q&&0>r(T,K)?(D[z]=T,D[ce]=N,z=ce):(D[z]=K,D[ee]=N,z=ee);else if(ce<q&&0>r(T,N))D[z]=T,D[ce]=N,z=ce;else break e}}return O}function r(D,O){var N=D.sortIndex-O.sortIndex;return N!==0?N:D.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,d=3,p=!1,m=!1,_=!1,f=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(D){for(var O=n(u);O!==null;){if(O.callback===null)i(u);else if(O.startTime<=D)i(u),O.sortIndex=O.expirationTime,e(l,O);else break;O=n(u)}}function b(D){if(_=!1,y(D),!m)if(n(l)!==null)m=!0,L(w);else{var O=n(u);O!==null&&j(b,O.startTime-D)}}function w(D,O){m=!1,_&&(_=!1,v(S),S=-1),p=!0;var N=d;try{for(y(O),h=n(l);h!==null&&(!(h.expirationTime>O)||D&&!M());){var z=h.callback;if(typeof z=="function"){h.callback=null,d=h.priorityLevel;var q=z(h.expirationTime<=O);O=t.unstable_now(),typeof q=="function"?h.callback=q:h===n(l)&&i(l),y(O)}else i(l);h=n(l)}if(h!==null)var te=!0;else{var ee=n(u);ee!==null&&j(b,ee.startTime-O),te=!1}return te}finally{h=null,d=N,p=!1}}var x=!1,k=null,S=-1,E=5,A=-1;function M(){return!(t.unstable_now()-A<E)}function R(){if(k!==null){var D=t.unstable_now();A=D;var O=!0;try{O=k(!0,D)}finally{O?P():(x=!1,k=null)}}else x=!1}var P;if(typeof g=="function")P=function(){g(R)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,B=H.port2;H.port1.onmessage=R,P=function(){B.postMessage(null)}}else P=function(){f(R,0)};function L(D){k=D,x||(x=!0,P())}function j(D,O){S=f(function(){D(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,L(w))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(D){switch(d){case 1:case 2:case 3:var O=3;break;default:O=d}var N=d;d=O;try{return D()}finally{d=N}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,O){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var N=d;d=D;try{return O()}finally{d=N}},t.unstable_scheduleCallback=function(D,O,N){var z=t.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?z+N:z):N=z,D){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=N+q,D={id:c++,callback:O,priorityLevel:D,startTime:N,expirationTime:q,sortIndex:-1},N>z?(D.sortIndex=N,e(u,D),n(l)===null&&D===n(u)&&(_?(v(S),S=-1):_=!0,j(b,N-z))):(D.sortIndex=q,e(l,D),m||p||(m=!0,L(w))),D},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(D){var O=d;return function(){var N=d;d=O;try{return D.apply(this,arguments)}finally{d=N}}}})(iw);nw.exports=iw;var kD=nw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CD=I,Sn=kD;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rw=new Set,ja={};function As(t,e){yo(t,e),yo(t+"Capture",e)}function yo(t,e){for(ja[t]=e,t=0;t<e.length;t++)rw.add(e[t])}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),np=Object.prototype.hasOwnProperty,ED=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rv={},Ov={};function DD(t){return np.call(Ov,t)?!0:np.call(Rv,t)?!1:ED.test(t)?Ov[t]=!0:(Rv[t]=!0,!1)}function AD(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function TD(t,e,n,i){if(e===null||typeof e>"u"||AD(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sn(t,e,n,i,r,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ft[t]=new sn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ft[e]=new sn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ft[t]=new sn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ft[t]=new sn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ft[t]=new sn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ft[t]=new sn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ft[t]=new sn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ft[t]=new sn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ft[t]=new sn(t,5,!1,t.toLowerCase(),null,!1,!1)});var l0=/[\-:]([a-z])/g;function u0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(l0,u0);Ft[e]=new sn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(l0,u0);Ft[e]=new sn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(l0,u0);Ft[e]=new sn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ft[t]=new sn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ft[t]=new sn(t,1,!1,t.toLowerCase(),null,!0,!0)});function c0(t,e,n,i){var r=Ft.hasOwnProperty(e)?Ft[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(TD(e,n,r,i)&&(n=null),i||r===null?DD(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Zi=CD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vl=Symbol.for("react.element"),Zs=Symbol.for("react.portal"),Ys=Symbol.for("react.fragment"),h0=Symbol.for("react.strict_mode"),ip=Symbol.for("react.profiler"),sw=Symbol.for("react.provider"),ow=Symbol.for("react.context"),d0=Symbol.for("react.forward_ref"),rp=Symbol.for("react.suspense"),sp=Symbol.for("react.suspense_list"),f0=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),aw=Symbol.for("react.offscreen"),Pv=Symbol.iterator;function Wo(t){return t===null||typeof t!="object"?null:(t=Pv&&t[Pv]||t["@@iterator"],typeof t=="function"?t:null)}var rt=Object.assign,Ld;function ca(t){if(Ld===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ld=e&&e[1]||""}return`
`+Ld+t}var Bd=!1;function zd(t,e){if(!t||Bd)return"";Bd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){i=u}t.call(e.prototype)}else{try{throw Error()}catch(u){i=u}t()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==s[o]){var l=`
`+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Bd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ca(t):""}function MD(t){switch(t.tag){case 5:return ca(t.type);case 16:return ca("Lazy");case 13:return ca("Suspense");case 19:return ca("SuspenseList");case 0:case 2:case 15:return t=zd(t.type,!1),t;case 11:return t=zd(t.type.render,!1),t;case 1:return t=zd(t.type,!0),t;default:return""}}function op(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ys:return"Fragment";case Zs:return"Portal";case ip:return"Profiler";case h0:return"StrictMode";case rp:return"Suspense";case sp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ow:return(t.displayName||"Context")+".Consumer";case sw:return(t._context.displayName||"Context")+".Provider";case d0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case f0:return e=t.displayName||null,e!==null?e:op(t.type)||"Memo";case rr:e=t._payload,t=t._init;try{return op(t(e))}catch{}}return null}function RD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return op(e);case 8:return e===h0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Lr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function lw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OD(t){var e=lw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Gl(t){t._valueTracker||(t._valueTracker=OD(t))}function uw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=lw(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function ac(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ap(t,e){var n=e.checked;return rt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Nv(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Lr(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cw(t,e){e=e.checked,e!=null&&c0(t,"checked",e,!1)}function lp(t,e){cw(t,e);var n=Lr(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?up(t,e.type,n):e.hasOwnProperty("defaultValue")&&up(t,e.type,Lr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Iv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function up(t,e,n){(e!=="number"||ac(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ha=Array.isArray;function uo(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Lr(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function cp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return rt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Lv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(ha(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Lr(n)}}function hw(t,e){var n=Lr(e.value),i=Lr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function Bv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function dw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?dw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ul,fw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ul=Ul||document.createElement("div"),Ul.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ul.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ha(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ya={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PD=["Webkit","ms","Moz","O"];Object.keys(ya).forEach(function(t){PD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ya[e]=ya[t]})});function pw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ya.hasOwnProperty(t)&&ya[t]?(""+e).trim():e+"px"}function mw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=pw(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var ND=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dp(t,e){if(e){if(ND[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function fp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pp=null;function p0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mp=null,co=null,ho=null;function zv(t){if(t=Tl(t)){if(typeof mp!="function")throw Error(se(280));var e=t.stateNode;e&&(e=$h(e),mp(t.stateNode,t.type,e))}}function gw(t){co?ho?ho.push(t):ho=[t]:co=t}function vw(){if(co){var t=co,e=ho;if(ho=co=null,zv(t),e)for(t=0;t<e.length;t++)zv(e[t])}}function _w(t,e){return t(e)}function yw(){}var Fd=!1;function bw(t,e,n){if(Fd)return t(e,n);Fd=!0;try{return _w(t,e,n)}finally{Fd=!1,(co!==null||ho!==null)&&(yw(),vw())}}function $a(t,e){var n=t.stateNode;if(n===null)return null;var i=$h(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var gp=!1;if(Gi)try{var Vo={};Object.defineProperty(Vo,"passive",{get:function(){gp=!0}}),window.addEventListener("test",Vo,Vo),window.removeEventListener("test",Vo,Vo)}catch{gp=!1}function ID(t,e,n,i,r,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var ba=!1,lc=null,uc=!1,vp=null,LD={onError:function(t){ba=!0,lc=t}};function BD(t,e,n,i,r,s,a,o,l){ba=!1,lc=null,ID.apply(LD,arguments)}function zD(t,e,n,i,r,s,a,o,l){if(BD.apply(this,arguments),ba){if(ba){var u=lc;ba=!1,lc=null}else throw Error(se(198));uc||(uc=!0,vp=u)}}function Ts(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ww(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Fv(t){if(Ts(t)!==t)throw Error(se(188))}function FD(t){var e=t.alternate;if(!e){if(e=Ts(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return Fv(r),t;if(s===i)return Fv(r),e;s=s.sibling}throw Error(se(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,o=r.child;o;){if(o===n){a=!0,n=r,i=s;break}if(o===i){a=!0,i=r,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,i=r;break}if(o===i){a=!0,i=s,n=r;break}o=o.sibling}if(!a)throw Error(se(189))}}if(n.alternate!==i)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function Sw(t){return t=FD(t),t!==null?xw(t):null}function xw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=xw(t);if(e!==null)return e;t=t.sibling}return null}var kw=Sn.unstable_scheduleCallback,jv=Sn.unstable_cancelCallback,jD=Sn.unstable_shouldYield,HD=Sn.unstable_requestPaint,ut=Sn.unstable_now,$D=Sn.unstable_getCurrentPriorityLevel,m0=Sn.unstable_ImmediatePriority,Cw=Sn.unstable_UserBlockingPriority,cc=Sn.unstable_NormalPriority,WD=Sn.unstable_LowPriority,Ew=Sn.unstable_IdlePriority,zh=null,vi=null;function VD(t){if(vi&&typeof vi.onCommitFiberRoot=="function")try{vi.onCommitFiberRoot(zh,t,void 0,(t.current.flags&128)===128)}catch{}}var ei=Math.clz32?Math.clz32:qD,GD=Math.log,UD=Math.LN2;function qD(t){return t>>>=0,t===0?32:31-(GD(t)/UD|0)|0}var ql=64,Kl=4194304;function da(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function hc(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~r;o!==0?i=da(o):(s&=a,s!==0&&(i=da(s)))}else a=n&~r,a!==0?i=da(a):s!==0&&(i=da(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-ei(e),r=1<<n,i|=t[n],e&=~r;return i}function KD(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JD(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ei(s),o=1<<a,l=r[a];l===-1?(!(o&n)||o&i)&&(r[a]=KD(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function _p(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dw(){var t=ql;return ql<<=1,!(ql&4194240)&&(ql=64),t}function jd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Dl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ei(e),t[e]=n}function ZD(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-ei(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function g0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-ei(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var ze=0;function Aw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Tw,v0,Mw,Rw,Ow,yp=!1,Jl=[],wr=null,Sr=null,xr=null,Wa=new Map,Va=new Map,cr=[],YD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hv(t,e){switch(t){case"focusin":case"focusout":wr=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":xr=null;break;case"pointerover":case"pointerout":Wa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Va.delete(e.pointerId)}}function Go(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Tl(e),e!==null&&v0(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function XD(t,e,n,i,r){switch(e){case"focusin":return wr=Go(wr,t,e,n,i,r),!0;case"dragenter":return Sr=Go(Sr,t,e,n,i,r),!0;case"mouseover":return xr=Go(xr,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Wa.set(s,Go(Wa.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Va.set(s,Go(Va.get(s)||null,t,e,n,i,r)),!0}return!1}function Pw(t){var e=es(t.target);if(e!==null){var n=Ts(e);if(n!==null){if(e=n.tag,e===13){if(e=ww(n),e!==null){t.blockedOn=e,Ow(t.priority,function(){Mw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ju(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=bp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);pp=i,n.target.dispatchEvent(i),pp=null}else return e=Tl(n),e!==null&&v0(e),t.blockedOn=n,!1;e.shift()}return!0}function $v(t,e,n){ju(t)&&n.delete(e)}function QD(){yp=!1,wr!==null&&ju(wr)&&(wr=null),Sr!==null&&ju(Sr)&&(Sr=null),xr!==null&&ju(xr)&&(xr=null),Wa.forEach($v),Va.forEach($v)}function Uo(t,e){t.blockedOn===e&&(t.blockedOn=null,yp||(yp=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,QD)))}function Ga(t){function e(r){return Uo(r,t)}if(0<Jl.length){Uo(Jl[0],t);for(var n=1;n<Jl.length;n++){var i=Jl[n];i.blockedOn===t&&(i.blockedOn=null)}}for(wr!==null&&Uo(wr,t),Sr!==null&&Uo(Sr,t),xr!==null&&Uo(xr,t),Wa.forEach(e),Va.forEach(e),n=0;n<cr.length;n++)i=cr[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<cr.length&&(n=cr[0],n.blockedOn===null);)Pw(n),n.blockedOn===null&&cr.shift()}var fo=Zi.ReactCurrentBatchConfig,dc=!0;function e3(t,e,n,i){var r=ze,s=fo.transition;fo.transition=null;try{ze=1,_0(t,e,n,i)}finally{ze=r,fo.transition=s}}function t3(t,e,n,i){var r=ze,s=fo.transition;fo.transition=null;try{ze=4,_0(t,e,n,i)}finally{ze=r,fo.transition=s}}function _0(t,e,n,i){if(dc){var r=bp(t,e,n,i);if(r===null)Zd(t,e,i,fc,n),Hv(t,i);else if(XD(r,t,e,n,i))i.stopPropagation();else if(Hv(t,i),e&4&&-1<YD.indexOf(t)){for(;r!==null;){var s=Tl(r);if(s!==null&&Tw(s),s=bp(t,e,n,i),s===null&&Zd(t,e,i,fc,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Zd(t,e,i,null,n)}}var fc=null;function bp(t,e,n,i){if(fc=null,t=p0(i),t=es(t),t!==null)if(e=Ts(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ww(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fc=t,null}function Nw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($D()){case m0:return 1;case Cw:return 4;case cc:case WD:return 16;case Ew:return 536870912;default:return 16}default:return 16}}var mr=null,y0=null,Hu=null;function Iw(){if(Hu)return Hu;var t,e=y0,n=e.length,i,r="value"in mr?mr.value:mr.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[s-i];i++);return Hu=r.slice(t,1<i?1-i:void 0)}function $u(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Zl(){return!0}function Wv(){return!1}function Cn(t){function e(n,i,r,s,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Zl:Wv,this.isPropagationStopped=Wv,this}return rt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zl)},persist:function(){},isPersistent:Zl}),e}var zo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},b0=Cn(zo),Al=rt({},zo,{view:0,detail:0}),n3=Cn(Al),Hd,$d,qo,Fh=rt({},Al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:w0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==qo&&(qo&&t.type==="mousemove"?(Hd=t.screenX-qo.screenX,$d=t.screenY-qo.screenY):$d=Hd=0,qo=t),Hd)},movementY:function(t){return"movementY"in t?t.movementY:$d}}),Vv=Cn(Fh),i3=rt({},Fh,{dataTransfer:0}),r3=Cn(i3),s3=rt({},Al,{relatedTarget:0}),Wd=Cn(s3),o3=rt({},zo,{animationName:0,elapsedTime:0,pseudoElement:0}),a3=Cn(o3),l3=rt({},zo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),u3=Cn(l3),c3=rt({},zo,{data:0}),Gv=Cn(c3),h3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},d3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},f3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=f3[t])?!!e[t]:!1}function w0(){return p3}var m3=rt({},Al,{key:function(t){if(t.key){var e=h3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$u(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?d3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:w0,charCode:function(t){return t.type==="keypress"?$u(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$u(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),g3=Cn(m3),v3=rt({},Fh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uv=Cn(v3),_3=rt({},Al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:w0}),y3=Cn(_3),b3=rt({},zo,{propertyName:0,elapsedTime:0,pseudoElement:0}),w3=Cn(b3),S3=rt({},Fh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),x3=Cn(S3),k3=[9,13,27,32],S0=Gi&&"CompositionEvent"in window,wa=null;Gi&&"documentMode"in document&&(wa=document.documentMode);var C3=Gi&&"TextEvent"in window&&!wa,Lw=Gi&&(!S0||wa&&8<wa&&11>=wa),qv=" ",Kv=!1;function Bw(t,e){switch(t){case"keyup":return k3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xs=!1;function E3(t,e){switch(t){case"compositionend":return zw(e);case"keypress":return e.which!==32?null:(Kv=!0,qv);case"textInput":return t=e.data,t===qv&&Kv?null:t;default:return null}}function D3(t,e){if(Xs)return t==="compositionend"||!S0&&Bw(t,e)?(t=Iw(),Hu=y0=mr=null,Xs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Lw&&e.locale!=="ko"?null:e.data;default:return null}}var A3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!A3[t.type]:e==="textarea"}function Fw(t,e,n,i){gw(i),e=pc(e,"onChange"),0<e.length&&(n=new b0("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Sa=null,Ua=null;function T3(t){Zw(t,0)}function jh(t){var e=to(t);if(uw(e))return t}function M3(t,e){if(t==="change")return e}var jw=!1;if(Gi){var Vd;if(Gi){var Gd="oninput"in document;if(!Gd){var Zv=document.createElement("div");Zv.setAttribute("oninput","return;"),Gd=typeof Zv.oninput=="function"}Vd=Gd}else Vd=!1;jw=Vd&&(!document.documentMode||9<document.documentMode)}function Yv(){Sa&&(Sa.detachEvent("onpropertychange",Hw),Ua=Sa=null)}function Hw(t){if(t.propertyName==="value"&&jh(Ua)){var e=[];Fw(e,Ua,t,p0(t)),bw(T3,e)}}function R3(t,e,n){t==="focusin"?(Yv(),Sa=e,Ua=n,Sa.attachEvent("onpropertychange",Hw)):t==="focusout"&&Yv()}function O3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jh(Ua)}function P3(t,e){if(t==="click")return jh(e)}function N3(t,e){if(t==="input"||t==="change")return jh(e)}function I3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ni=typeof Object.is=="function"?Object.is:I3;function qa(t,e){if(ni(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!np.call(e,r)||!ni(t[r],e[r]))return!1}return!0}function Xv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qv(t,e){var n=Xv(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Xv(n)}}function $w(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$w(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ww(){for(var t=window,e=ac();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ac(t.document)}return e}function x0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function L3(t){var e=Ww(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$w(n.ownerDocument.documentElement,n)){if(i!==null&&x0(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=Qv(n,s);var a=Qv(n,i);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var B3=Gi&&"documentMode"in document&&11>=document.documentMode,Qs=null,wp=null,xa=null,Sp=!1;function e_(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Sp||Qs==null||Qs!==ac(i)||(i=Qs,"selectionStart"in i&&x0(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),xa&&qa(xa,i)||(xa=i,i=pc(wp,"onSelect"),0<i.length&&(e=new b0("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Qs)))}function Yl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var eo={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionend:Yl("Transition","TransitionEnd")},Ud={},Vw={};Gi&&(Vw=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function Hh(t){if(Ud[t])return Ud[t];if(!eo[t])return t;var e=eo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Vw)return Ud[t]=e[n];return t}var Gw=Hh("animationend"),Uw=Hh("animationiteration"),qw=Hh("animationstart"),Kw=Hh("transitionend"),Jw=new Map,t_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(t,e){Jw.set(t,e),As(e,[t])}for(var qd=0;qd<t_.length;qd++){var Kd=t_[qd],z3=Kd.toLowerCase(),F3=Kd[0].toUpperCase()+Kd.slice(1);$r(z3,"on"+F3)}$r(Gw,"onAnimationEnd");$r(Uw,"onAnimationIteration");$r(qw,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(Kw,"onTransitionEnd");yo("onMouseEnter",["mouseout","mouseover"]);yo("onMouseLeave",["mouseout","mouseover"]);yo("onPointerEnter",["pointerout","pointerover"]);yo("onPointerLeave",["pointerout","pointerover"]);As("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));As("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));As("onBeforeInput",["compositionend","keypress","textInput","paste"]);As("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));As("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));As("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),j3=new Set("cancel close invalid load scroll toggle".split(" ").concat(fa));function n_(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,zD(i,e,void 0,t),t.currentTarget=null}function Zw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;n_(r,o,u),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;n_(r,o,u),s=l}}}if(uc)throw t=vp,uc=!1,vp=null,t}function Ue(t,e){var n=e[Dp];n===void 0&&(n=e[Dp]=new Set);var i=t+"__bubble";n.has(i)||(Yw(e,t,2,!1),n.add(i))}function Jd(t,e,n){var i=0;e&&(i|=4),Yw(n,t,i,e)}var Xl="_reactListening"+Math.random().toString(36).slice(2);function Ka(t){if(!t[Xl]){t[Xl]=!0,rw.forEach(function(n){n!=="selectionchange"&&(j3.has(n)||Jd(n,!1,t),Jd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xl]||(e[Xl]=!0,Jd("selectionchange",!1,e))}}function Yw(t,e,n,i){switch(Nw(e)){case 1:var r=e3;break;case 4:r=t3;break;default:r=_0}n=r.bind(null,e,n,t),r=void 0,!gp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Zd(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=es(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}bw(function(){var u=s,c=p0(n),h=[];e:{var d=Jw.get(t);if(d!==void 0){var p=b0,m=t;switch(t){case"keypress":if($u(n)===0)break e;case"keydown":case"keyup":p=g3;break;case"focusin":m="focus",p=Wd;break;case"focusout":m="blur",p=Wd;break;case"beforeblur":case"afterblur":p=Wd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Vv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=r3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=y3;break;case Gw:case Uw:case qw:p=a3;break;case Kw:p=w3;break;case"scroll":p=n3;break;case"wheel":p=x3;break;case"copy":case"cut":case"paste":p=u3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Uv}var _=(e&4)!==0,f=!_&&t==="scroll",v=_?d!==null?d+"Capture":null:d;_=[];for(var g=u,y;g!==null;){y=g;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,v!==null&&(b=$a(g,v),b!=null&&_.push(Ja(g,b,y)))),f)break;g=g.return}0<_.length&&(d=new p(d,m,null,n,c),h.push({event:d,listeners:_}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&n!==pp&&(m=n.relatedTarget||n.fromElement)&&(es(m)||m[Ui]))break e;if((p||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=u,m=m?es(m):null,m!==null&&(f=Ts(m),m!==f||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(_=Vv,b="onMouseLeave",v="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(_=Uv,b="onPointerLeave",v="onPointerEnter",g="pointer"),f=p==null?d:to(p),y=m==null?d:to(m),d=new _(b,g+"leave",p,n,c),d.target=f,d.relatedTarget=y,b=null,es(c)===u&&(_=new _(v,g+"enter",m,n,c),_.target=y,_.relatedTarget=f,b=_),f=b,p&&m)t:{for(_=p,v=m,g=0,y=_;y;y=Ls(y))g++;for(y=0,b=v;b;b=Ls(b))y++;for(;0<g-y;)_=Ls(_),g--;for(;0<y-g;)v=Ls(v),y--;for(;g--;){if(_===v||v!==null&&_===v.alternate)break t;_=Ls(_),v=Ls(v)}_=null}else _=null;p!==null&&i_(h,d,p,_,!1),m!==null&&f!==null&&i_(h,f,m,_,!0)}}e:{if(d=u?to(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var w=M3;else if(Jv(d))if(jw)w=N3;else{w=O3;var x=R3}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=P3);if(w&&(w=w(t,u))){Fw(h,w,n,c);break e}x&&x(t,d,u),t==="focusout"&&(x=d._wrapperState)&&x.controlled&&d.type==="number"&&up(d,"number",d.value)}switch(x=u?to(u):window,t){case"focusin":(Jv(x)||x.contentEditable==="true")&&(Qs=x,wp=u,xa=null);break;case"focusout":xa=wp=Qs=null;break;case"mousedown":Sp=!0;break;case"contextmenu":case"mouseup":case"dragend":Sp=!1,e_(h,n,c);break;case"selectionchange":if(B3)break;case"keydown":case"keyup":e_(h,n,c)}var k;if(S0)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Xs?Bw(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(Lw&&n.locale!=="ko"&&(Xs||S!=="onCompositionStart"?S==="onCompositionEnd"&&Xs&&(k=Iw()):(mr=c,y0="value"in mr?mr.value:mr.textContent,Xs=!0)),x=pc(u,S),0<x.length&&(S=new Gv(S,t,null,n,c),h.push({event:S,listeners:x}),k?S.data=k:(k=zw(n),k!==null&&(S.data=k)))),(k=C3?E3(t,n):D3(t,n))&&(u=pc(u,"onBeforeInput"),0<u.length&&(c=new Gv("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=k))}Zw(h,e)})}function Ja(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pc(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=$a(t,n),s!=null&&i.unshift(Ja(t,s,r)),s=$a(t,e),s!=null&&i.push(Ja(t,s,r))),t=t.return}return i}function Ls(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function i_(t,e,n,i,r){for(var s=e._reactName,a=[];n!==null&&n!==i;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&u!==null&&(o=u,r?(l=$a(n,s),l!=null&&a.unshift(Ja(n,l,o))):r||(l=$a(n,s),l!=null&&a.push(Ja(n,l,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var H3=/\r\n?/g,$3=/\u0000|\uFFFD/g;function r_(t){return(typeof t=="string"?t:""+t).replace(H3,`
`).replace($3,"")}function Ql(t,e,n){if(e=r_(e),r_(t)!==e&&n)throw Error(se(425))}function mc(){}var xp=null,kp=null;function Cp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ep=typeof setTimeout=="function"?setTimeout:void 0,W3=typeof clearTimeout=="function"?clearTimeout:void 0,s_=typeof Promise=="function"?Promise:void 0,V3=typeof queueMicrotask=="function"?queueMicrotask:typeof s_<"u"?function(t){return s_.resolve(null).then(t).catch(G3)}:Ep;function G3(t){setTimeout(function(){throw t})}function Yd(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),Ga(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Ga(e)}function kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function o_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Fo=Math.random().toString(36).slice(2),fi="__reactFiber$"+Fo,Za="__reactProps$"+Fo,Ui="__reactContainer$"+Fo,Dp="__reactEvents$"+Fo,U3="__reactListeners$"+Fo,q3="__reactHandles$"+Fo;function es(t){var e=t[fi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ui]||n[fi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=o_(t);t!==null;){if(n=t[fi])return n;t=o_(t)}return e}t=n,n=t.parentNode}return null}function Tl(t){return t=t[fi]||t[Ui],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function to(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function $h(t){return t[Za]||null}var Ap=[],no=-1;function Wr(t){return{current:t}}function Ze(t){0>no||(t.current=Ap[no],Ap[no]=null,no--)}function Ve(t,e){no++,Ap[no]=t.current,t.current=e}var Br={},Ut=Wr(Br),cn=Wr(!1),vs=Br;function bo(t,e){var n=t.type.contextTypes;if(!n)return Br;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function hn(t){return t=t.childContextTypes,t!=null}function gc(){Ze(cn),Ze(Ut)}function a_(t,e,n){if(Ut.current!==Br)throw Error(se(168));Ve(Ut,e),Ve(cn,n)}function Xw(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(se(108,RD(t)||"Unknown",r));return rt({},n,i)}function vc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Br,vs=Ut.current,Ve(Ut,t),Ve(cn,cn.current),!0}function l_(t,e,n){var i=t.stateNode;if(!i)throw Error(se(169));n?(t=Xw(t,e,vs),i.__reactInternalMemoizedMergedChildContext=t,Ze(cn),Ze(Ut),Ve(Ut,t)):Ze(cn),Ve(cn,n)}var Ni=null,Wh=!1,Xd=!1;function Qw(t){Ni===null?Ni=[t]:Ni.push(t)}function K3(t){Wh=!0,Qw(t)}function Vr(){if(!Xd&&Ni!==null){Xd=!0;var t=0,e=ze;try{var n=Ni;for(ze=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ni=null,Wh=!1}catch(r){throw Ni!==null&&(Ni=Ni.slice(t+1)),kw(m0,Vr),r}finally{ze=e,Xd=!1}}return null}var io=[],ro=0,_c=null,yc=0,Pn=[],Nn=0,_s=null,Ii=1,Li="";function Zr(t,e){io[ro++]=yc,io[ro++]=_c,_c=t,yc=e}function eS(t,e,n){Pn[Nn++]=Ii,Pn[Nn++]=Li,Pn[Nn++]=_s,_s=t;var i=Ii;t=Li;var r=32-ei(i)-1;i&=~(1<<r),n+=1;var s=32-ei(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Ii=1<<32-ei(e)+r|n<<r|i,Li=s+t}else Ii=1<<s|n<<r|i,Li=t}function k0(t){t.return!==null&&(Zr(t,1),eS(t,1,0))}function C0(t){for(;t===_c;)_c=io[--ro],io[ro]=null,yc=io[--ro],io[ro]=null;for(;t===_s;)_s=Pn[--Nn],Pn[Nn]=null,Li=Pn[--Nn],Pn[Nn]=null,Ii=Pn[--Nn],Pn[Nn]=null}var bn=null,_n=null,Qe=!1,Zn=null;function tS(t,e){var n=Ln(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function u_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,bn=t,_n=kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,bn=t,_n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_s!==null?{id:Ii,overflow:Li}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ln(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,bn=t,_n=null,!0):!1;default:return!1}}function Tp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Mp(t){if(Qe){var e=_n;if(e){var n=e;if(!u_(t,e)){if(Tp(t))throw Error(se(418));e=kr(n.nextSibling);var i=bn;e&&u_(t,e)?tS(i,n):(t.flags=t.flags&-4097|2,Qe=!1,bn=t)}}else{if(Tp(t))throw Error(se(418));t.flags=t.flags&-4097|2,Qe=!1,bn=t}}}function c_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;bn=t}function eu(t){if(t!==bn)return!1;if(!Qe)return c_(t),Qe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Cp(t.type,t.memoizedProps)),e&&(e=_n)){if(Tp(t))throw nS(),Error(se(418));for(;e;)tS(t,e),e=kr(e.nextSibling)}if(c_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){_n=kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}_n=null}}else _n=bn?kr(t.stateNode.nextSibling):null;return!0}function nS(){for(var t=_n;t;)t=kr(t.nextSibling)}function wo(){_n=bn=null,Qe=!1}function E0(t){Zn===null?Zn=[t]:Zn.push(t)}var J3=Zi.ReactCurrentBatchConfig;function Ko(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var i=n.stateNode}if(!i)throw Error(se(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=r.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function tu(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function h_(t){var e=t._init;return e(t._payload)}function iS(t){function e(v,g){if(t){var y=v.deletions;y===null?(v.deletions=[g],v.flags|=16):y.push(g)}}function n(v,g){if(!t)return null;for(;g!==null;)e(v,g),g=g.sibling;return null}function i(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function r(v,g){return v=Ar(v,g),v.index=0,v.sibling=null,v}function s(v,g,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<g?(v.flags|=2,g):y):(v.flags|=2,g)):(v.flags|=1048576,g)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function o(v,g,y,b){return g===null||g.tag!==6?(g=of(y,v.mode,b),g.return=v,g):(g=r(g,y),g.return=v,g)}function l(v,g,y,b){var w=y.type;return w===Ys?c(v,g,y.props.children,b,y.key):g!==null&&(g.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===rr&&h_(w)===g.type)?(b=r(g,y.props),b.ref=Ko(v,g,y),b.return=v,b):(b=Ju(y.type,y.key,y.props,null,v.mode,b),b.ref=Ko(v,g,y),b.return=v,b)}function u(v,g,y,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=af(y,v.mode,b),g.return=v,g):(g=r(g,y.children||[]),g.return=v,g)}function c(v,g,y,b,w){return g===null||g.tag!==7?(g=cs(y,v.mode,b,w),g.return=v,g):(g=r(g,y),g.return=v,g)}function h(v,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=of(""+g,v.mode,y),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Vl:return y=Ju(g.type,g.key,g.props,null,v.mode,y),y.ref=Ko(v,null,g),y.return=v,y;case Zs:return g=af(g,v.mode,y),g.return=v,g;case rr:var b=g._init;return h(v,b(g._payload),y)}if(ha(g)||Wo(g))return g=cs(g,v.mode,y,null),g.return=v,g;tu(v,g)}return null}function d(v,g,y,b){var w=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return w!==null?null:o(v,g,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Vl:return y.key===w?l(v,g,y,b):null;case Zs:return y.key===w?u(v,g,y,b):null;case rr:return w=y._init,d(v,g,w(y._payload),b)}if(ha(y)||Wo(y))return w!==null?null:c(v,g,y,b,null);tu(v,y)}return null}function p(v,g,y,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(y)||null,o(g,v,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Vl:return v=v.get(b.key===null?y:b.key)||null,l(g,v,b,w);case Zs:return v=v.get(b.key===null?y:b.key)||null,u(g,v,b,w);case rr:var x=b._init;return p(v,g,y,x(b._payload),w)}if(ha(b)||Wo(b))return v=v.get(y)||null,c(g,v,b,w,null);tu(g,b)}return null}function m(v,g,y,b){for(var w=null,x=null,k=g,S=g=0,E=null;k!==null&&S<y.length;S++){k.index>S?(E=k,k=null):E=k.sibling;var A=d(v,k,y[S],b);if(A===null){k===null&&(k=E);break}t&&k&&A.alternate===null&&e(v,k),g=s(A,g,S),x===null?w=A:x.sibling=A,x=A,k=E}if(S===y.length)return n(v,k),Qe&&Zr(v,S),w;if(k===null){for(;S<y.length;S++)k=h(v,y[S],b),k!==null&&(g=s(k,g,S),x===null?w=k:x.sibling=k,x=k);return Qe&&Zr(v,S),w}for(k=i(v,k);S<y.length;S++)E=p(k,v,S,y[S],b),E!==null&&(t&&E.alternate!==null&&k.delete(E.key===null?S:E.key),g=s(E,g,S),x===null?w=E:x.sibling=E,x=E);return t&&k.forEach(function(M){return e(v,M)}),Qe&&Zr(v,S),w}function _(v,g,y,b){var w=Wo(y);if(typeof w!="function")throw Error(se(150));if(y=w.call(y),y==null)throw Error(se(151));for(var x=w=null,k=g,S=g=0,E=null,A=y.next();k!==null&&!A.done;S++,A=y.next()){k.index>S?(E=k,k=null):E=k.sibling;var M=d(v,k,A.value,b);if(M===null){k===null&&(k=E);break}t&&k&&M.alternate===null&&e(v,k),g=s(M,g,S),x===null?w=M:x.sibling=M,x=M,k=E}if(A.done)return n(v,k),Qe&&Zr(v,S),w;if(k===null){for(;!A.done;S++,A=y.next())A=h(v,A.value,b),A!==null&&(g=s(A,g,S),x===null?w=A:x.sibling=A,x=A);return Qe&&Zr(v,S),w}for(k=i(v,k);!A.done;S++,A=y.next())A=p(k,v,S,A.value,b),A!==null&&(t&&A.alternate!==null&&k.delete(A.key===null?S:A.key),g=s(A,g,S),x===null?w=A:x.sibling=A,x=A);return t&&k.forEach(function(R){return e(v,R)}),Qe&&Zr(v,S),w}function f(v,g,y,b){if(typeof y=="object"&&y!==null&&y.type===Ys&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Vl:e:{for(var w=y.key,x=g;x!==null;){if(x.key===w){if(w=y.type,w===Ys){if(x.tag===7){n(v,x.sibling),g=r(x,y.props.children),g.return=v,v=g;break e}}else if(x.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===rr&&h_(w)===x.type){n(v,x.sibling),g=r(x,y.props),g.ref=Ko(v,x,y),g.return=v,v=g;break e}n(v,x);break}else e(v,x);x=x.sibling}y.type===Ys?(g=cs(y.props.children,v.mode,b,y.key),g.return=v,v=g):(b=Ju(y.type,y.key,y.props,null,v.mode,b),b.ref=Ko(v,g,y),b.return=v,v=b)}return a(v);case Zs:e:{for(x=y.key;g!==null;){if(g.key===x)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(v,g.sibling),g=r(g,y.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else e(v,g);g=g.sibling}g=af(y,v.mode,b),g.return=v,v=g}return a(v);case rr:return x=y._init,f(v,g,x(y._payload),b)}if(ha(y))return m(v,g,y,b);if(Wo(y))return _(v,g,y,b);tu(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(v,g.sibling),g=r(g,y),g.return=v,v=g):(n(v,g),g=of(y,v.mode,b),g.return=v,v=g),a(v)):n(v,g)}return f}var So=iS(!0),rS=iS(!1),bc=Wr(null),wc=null,so=null,D0=null;function A0(){D0=so=wc=null}function T0(t){var e=bc.current;Ze(bc),t._currentValue=e}function Rp(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function po(t,e){wc=t,D0=so=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(un=!0),t.firstContext=null)}function Hn(t){var e=t._currentValue;if(D0!==t)if(t={context:t,memoizedValue:e,next:null},so===null){if(wc===null)throw Error(se(308));so=t,wc.dependencies={lanes:0,firstContext:t}}else so=so.next=t;return e}var ts=null;function M0(t){ts===null?ts=[t]:ts.push(t)}function sS(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,M0(e)):(n.next=r.next,r.next=n),e.interleaved=n,qi(t,i)}function qi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var sr=!1;function R0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Cr(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Ne&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,qi(t,n)}return r=i.interleaved,r===null?(e.next=e,M0(i)):(e.next=r.next,r.next=e),i.interleaved=e,qi(t,n)}function Wu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,g0(t,n)}}function d_(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Sc(t,e,n,i){var r=t.updateQueue;sr=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;a=0,c=u=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((i&d)===d){c!==null&&(c=c.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=t,_=o;switch(d=e,p=n,_.tag){case 1:if(m=_.payload,typeof m=="function"){h=m.call(p,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=_.payload,d=typeof m=="function"?m.call(p,h,d):m,d==null)break e;h=rt({},h,d);break e;case 2:sr=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=p,l=h):c=c.next=p,a|=d;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;d=o,o=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(c===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);bs|=a,t.lanes=a,t.memoizedState=h}}function f_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(se(191,r));r.call(i)}}}var Ml={},_i=Wr(Ml),Ya=Wr(Ml),Xa=Wr(Ml);function ns(t){if(t===Ml)throw Error(se(174));return t}function O0(t,e){switch(Ve(Xa,e),Ve(Ya,t),Ve(_i,Ml),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hp(e,t)}Ze(_i),Ve(_i,e)}function xo(){Ze(_i),Ze(Ya),Ze(Xa)}function aS(t){ns(Xa.current);var e=ns(_i.current),n=hp(e,t.type);e!==n&&(Ve(Ya,t),Ve(_i,n))}function P0(t){Ya.current===t&&(Ze(_i),Ze(Ya))}var tt=Wr(0);function xc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qd=[];function N0(){for(var t=0;t<Qd.length;t++)Qd[t]._workInProgressVersionPrimary=null;Qd.length=0}var Vu=Zi.ReactCurrentDispatcher,ef=Zi.ReactCurrentBatchConfig,ys=0,it=null,bt=null,Et=null,kc=!1,ka=!1,Qa=0,Z3=0;function Ht(){throw Error(se(321))}function I0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ni(t[n],e[n]))return!1;return!0}function L0(t,e,n,i,r,s){if(ys=s,it=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Vu.current=t===null||t.memoizedState===null?eA:tA,t=n(i,r),ka){s=0;do{if(ka=!1,Qa=0,25<=s)throw Error(se(301));s+=1,Et=bt=null,e.updateQueue=null,Vu.current=nA,t=n(i,r)}while(ka)}if(Vu.current=Cc,e=bt!==null&&bt.next!==null,ys=0,Et=bt=it=null,kc=!1,e)throw Error(se(300));return t}function B0(){var t=Qa!==0;return Qa=0,t}function ai(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?it.memoizedState=Et=t:Et=Et.next=t,Et}function $n(){if(bt===null){var t=it.alternate;t=t!==null?t.memoizedState:null}else t=bt.next;var e=Et===null?it.memoizedState:Et.next;if(e!==null)Et=e,bt=t;else{if(t===null)throw Error(se(310));bt=t,t={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},Et===null?it.memoizedState=Et=t:Et=Et.next=t}return Et}function el(t,e){return typeof e=="function"?e(t):e}function tf(t){var e=$n(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var i=bt,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((ys&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=i):l=l.next=h,it.lanes|=c,bs|=c}u=u.next}while(u!==null&&u!==s);l===null?a=i:l.next=o,ni(i,e.memoizedState)||(un=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,it.lanes|=s,bs|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nf(t){var e=$n(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do s=t(s,a.action),a=a.next;while(a!==r);ni(s,e.memoizedState)||(un=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function lS(){}function uS(t,e){var n=it,i=$n(),r=e(),s=!ni(i.memoizedState,r);if(s&&(i.memoizedState=r,un=!0),i=i.queue,z0(dS.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,tl(9,hS.bind(null,n,i,r,e),void 0,null),Mt===null)throw Error(se(349));ys&30||cS(n,e,r)}return r}function cS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function hS(t,e,n,i){e.value=n,e.getSnapshot=i,fS(e)&&pS(t)}function dS(t,e,n){return n(function(){fS(e)&&pS(t)})}function fS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ni(t,n)}catch{return!0}}function pS(t){var e=qi(t,1);e!==null&&ti(e,t,1,-1)}function p_(t){var e=ai();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:el,lastRenderedState:t},e.queue=t,t=t.dispatch=Q3.bind(null,it,t),[e.memoizedState,t]}function tl(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function mS(){return $n().memoizedState}function Gu(t,e,n,i){var r=ai();it.flags|=t,r.memoizedState=tl(1|e,n,void 0,i===void 0?null:i)}function Vh(t,e,n,i){var r=$n();i=i===void 0?null:i;var s=void 0;if(bt!==null){var a=bt.memoizedState;if(s=a.destroy,i!==null&&I0(i,a.deps)){r.memoizedState=tl(e,n,s,i);return}}it.flags|=t,r.memoizedState=tl(1|e,n,s,i)}function m_(t,e){return Gu(8390656,8,t,e)}function z0(t,e){return Vh(2048,8,t,e)}function gS(t,e){return Vh(4,2,t,e)}function vS(t,e){return Vh(4,4,t,e)}function _S(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yS(t,e,n){return n=n!=null?n.concat([t]):null,Vh(4,4,_S.bind(null,e,t),n)}function F0(){}function bS(t,e){var n=$n();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&I0(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function wS(t,e){var n=$n();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&I0(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function SS(t,e,n){return ys&21?(ni(n,e)||(n=Dw(),it.lanes|=n,bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,un=!0),t.memoizedState=n)}function Y3(t,e){var n=ze;ze=n!==0&&4>n?n:4,t(!0);var i=ef.transition;ef.transition={};try{t(!1),e()}finally{ze=n,ef.transition=i}}function xS(){return $n().memoizedState}function X3(t,e,n){var i=Dr(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},kS(t))CS(e,n);else if(n=sS(t,e,n,i),n!==null){var r=en();ti(n,t,i,r),ES(n,e,i)}}function Q3(t,e,n){var i=Dr(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(kS(t))CS(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,ni(o,a)){var l=e.interleaved;l===null?(r.next=r,M0(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=sS(t,e,r,i),n!==null&&(r=en(),ti(n,t,i,r),ES(n,e,i))}}function kS(t){var e=t.alternate;return t===it||e!==null&&e===it}function CS(t,e){ka=kc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ES(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,g0(t,n)}}var Cc={readContext:Hn,useCallback:Ht,useContext:Ht,useEffect:Ht,useImperativeHandle:Ht,useInsertionEffect:Ht,useLayoutEffect:Ht,useMemo:Ht,useReducer:Ht,useRef:Ht,useState:Ht,useDebugValue:Ht,useDeferredValue:Ht,useTransition:Ht,useMutableSource:Ht,useSyncExternalStore:Ht,useId:Ht,unstable_isNewReconciler:!1},eA={readContext:Hn,useCallback:function(t,e){return ai().memoizedState=[t,e===void 0?null:e],t},useContext:Hn,useEffect:m_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Gu(4194308,4,_S.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Gu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gu(4,2,t,e)},useMemo:function(t,e){var n=ai();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=ai();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=X3.bind(null,it,t),[i.memoizedState,t]},useRef:function(t){var e=ai();return t={current:t},e.memoizedState=t},useState:p_,useDebugValue:F0,useDeferredValue:function(t){return ai().memoizedState=t},useTransition:function(){var t=p_(!1),e=t[0];return t=Y3.bind(null,t[1]),ai().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=it,r=ai();if(Qe){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),Mt===null)throw Error(se(349));ys&30||cS(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,m_(dS.bind(null,i,s,t),[t]),i.flags|=2048,tl(9,hS.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=ai(),e=Mt.identifierPrefix;if(Qe){var n=Li,i=Ii;n=(i&~(1<<32-ei(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Qa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Z3++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tA={readContext:Hn,useCallback:bS,useContext:Hn,useEffect:z0,useImperativeHandle:yS,useInsertionEffect:gS,useLayoutEffect:vS,useMemo:wS,useReducer:tf,useRef:mS,useState:function(){return tf(el)},useDebugValue:F0,useDeferredValue:function(t){var e=$n();return SS(e,bt.memoizedState,t)},useTransition:function(){var t=tf(el)[0],e=$n().memoizedState;return[t,e]},useMutableSource:lS,useSyncExternalStore:uS,useId:xS,unstable_isNewReconciler:!1},nA={readContext:Hn,useCallback:bS,useContext:Hn,useEffect:z0,useImperativeHandle:yS,useInsertionEffect:gS,useLayoutEffect:vS,useMemo:wS,useReducer:nf,useRef:mS,useState:function(){return nf(el)},useDebugValue:F0,useDeferredValue:function(t){var e=$n();return bt===null?e.memoizedState=t:SS(e,bt.memoizedState,t)},useTransition:function(){var t=nf(el)[0],e=$n().memoizedState;return[t,e]},useMutableSource:lS,useSyncExternalStore:uS,useId:xS,unstable_isNewReconciler:!1};function Kn(t,e){if(t&&t.defaultProps){e=rt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Op(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:rt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Gh={isMounted:function(t){return(t=t._reactInternals)?Ts(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=en(),r=Dr(t),s=Hi(i,r);s.payload=e,n!=null&&(s.callback=n),e=Cr(t,s,r),e!==null&&(ti(e,t,r,i),Wu(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=en(),r=Dr(t),s=Hi(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Cr(t,s,r),e!==null&&(ti(e,t,r,i),Wu(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=en(),i=Dr(t),r=Hi(n,i);r.tag=2,e!=null&&(r.callback=e),e=Cr(t,r,i),e!==null&&(ti(e,t,i,n),Wu(e,t,i))}};function g_(t,e,n,i,r,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!qa(n,i)||!qa(r,s):!0}function DS(t,e,n){var i=!1,r=Br,s=e.contextType;return typeof s=="object"&&s!==null?s=Hn(s):(r=hn(e)?vs:Ut.current,i=e.contextTypes,s=(i=i!=null)?bo(t,r):Br),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gh,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function v_(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Gh.enqueueReplaceState(e,e.state,null)}function Pp(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},R0(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Hn(s):(s=hn(e)?vs:Ut.current,r.context=bo(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Op(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Gh.enqueueReplaceState(r,r.state,null),Sc(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function ko(t,e){try{var n="",i=e;do n+=MD(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function rf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Np(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var iA=typeof WeakMap=="function"?WeakMap:Map;function AS(t,e,n){n=Hi(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Dc||(Dc=!0,Vp=i),Np(t,e)},n}function TS(t,e,n){n=Hi(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){Np(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Np(t,e),typeof i!="function"&&(Er===null?Er=new Set([this]):Er.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function __(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new iA;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=vA.bind(null,t,e,n),e.then(t,t))}function y_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function b_(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hi(-1,1),e.tag=2,Cr(n,e,1))),n.lanes|=1),t)}var rA=Zi.ReactCurrentOwner,un=!1;function Xt(t,e,n,i){e.child=t===null?rS(e,null,n,i):So(e,t.child,n,i)}function w_(t,e,n,i,r){n=n.render;var s=e.ref;return po(e,r),i=L0(t,e,n,i,s,r),n=B0(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ki(t,e,r)):(Qe&&n&&k0(e),e.flags|=1,Xt(t,e,i,r),e.child)}function S_(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!q0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,MS(t,e,s,i,r)):(t=Ju(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:qa,n(a,i)&&t.ref===e.ref)return Ki(t,e,r)}return e.flags|=1,t=Ar(s,i),t.ref=e.ref,t.return=e,e.child=t}function MS(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(qa(s,i)&&t.ref===e.ref)if(un=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(un=!0);else return e.lanes=t.lanes,Ki(t,e,r)}return Ip(t,e,n,i,r)}function RS(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(ao,gn),gn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ve(ao,gn),gn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Ve(ao,gn),gn|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Ve(ao,gn),gn|=i;return Xt(t,e,r,n),e.child}function OS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ip(t,e,n,i,r){var s=hn(n)?vs:Ut.current;return s=bo(e,s),po(e,r),n=L0(t,e,n,i,s,r),i=B0(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ki(t,e,r)):(Qe&&i&&k0(e),e.flags|=1,Xt(t,e,n,r),e.child)}function x_(t,e,n,i,r){if(hn(n)){var s=!0;vc(e)}else s=!1;if(po(e,r),e.stateNode===null)Uu(t,e),DS(e,n,i),Pp(e,n,i,r),i=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=Hn(u):(u=hn(n)?vs:Ut.current,u=bo(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==u)&&v_(e,a,i,u),sr=!1;var d=e.memoizedState;a.state=d,Sc(e,i,a,r),l=e.memoizedState,o!==i||d!==l||cn.current||sr?(typeof c=="function"&&(Op(e,n,c,i),l=e.memoizedState),(o=sr||g_(e,n,o,i,d,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=u,i=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,oS(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Kn(e.type,o),a.props=u,h=e.pendingProps,d=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=Hn(l):(l=hn(n)?vs:Ut.current,l=bo(e,l));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&v_(e,a,i,l),sr=!1,d=e.memoizedState,a.state=d,Sc(e,i,a,r);var m=e.memoizedState;o!==h||d!==m||cn.current||sr?(typeof p=="function"&&(Op(e,n,p,i),m=e.memoizedState),(u=sr||g_(e,n,u,i,d,m,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,m,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=m),a.props=i,a.state=m,a.context=l,i=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return Lp(t,e,n,i,s,r)}function Lp(t,e,n,i,r,s){OS(t,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&l_(e,n,!1),Ki(t,e,s);i=e.stateNode,rA.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&a?(e.child=So(e,t.child,null,s),e.child=So(e,null,o,s)):Xt(t,e,o,s),e.memoizedState=i.state,r&&l_(e,n,!0),e.child}function PS(t){var e=t.stateNode;e.pendingContext?a_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&a_(t,e.context,!1),O0(t,e.containerInfo)}function k_(t,e,n,i,r){return wo(),E0(r),e.flags|=256,Xt(t,e,n,i),e.child}var Bp={dehydrated:null,treeContext:null,retryLane:0};function zp(t){return{baseLanes:t,cachePool:null,transitions:null}}function NS(t,e,n){var i=e.pendingProps,r=tt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(r&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Ve(tt,r&1),t===null)return Mp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,t=i.fallback,s?(i=e.mode,s=e.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Kh(a,i,0,null),t=cs(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=zp(n),e.memoizedState=Bp,t):j0(e,a));if(r=t.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return sA(t,e,a,i,o,r,n);if(s){s=i.fallback,a=e.mode,r=t.child,o=r.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Ar(r,l),i.subtreeFlags=r.subtreeFlags&14680064),o!==null?s=Ar(o,s):(s=cs(s,a,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,a=t.child.memoizedState,a=a===null?zp(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=Bp,i}return s=t.child,t=s.sibling,i=Ar(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function j0(t,e){return e=Kh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function nu(t,e,n,i){return i!==null&&E0(i),So(e,t.child,null,n),t=j0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sA(t,e,n,i,r,s,a){if(n)return e.flags&256?(e.flags&=-257,i=rf(Error(se(422))),nu(t,e,a,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Kh({mode:"visible",children:i.children},r,0,null),s=cs(s,r,a,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&So(e,t.child,null,a),e.child.memoizedState=zp(a),e.memoizedState=Bp,s);if(!(e.mode&1))return nu(t,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var o=i.dgst;return i=o,s=Error(se(419)),i=rf(s,i,void 0),nu(t,e,a,i)}if(o=(a&t.childLanes)!==0,un||o){if(i=Mt,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,qi(t,r),ti(i,t,r,-1))}return U0(),i=rf(Error(se(421))),nu(t,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=_A.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,_n=kr(r.nextSibling),bn=e,Qe=!0,Zn=null,t!==null&&(Pn[Nn++]=Ii,Pn[Nn++]=Li,Pn[Nn++]=_s,Ii=t.id,Li=t.overflow,_s=e),e=j0(e,i.children),e.flags|=4096,e)}function C_(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),Rp(t.return,e,n)}function sf(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function IS(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Xt(t,e,i.children,n),i=tt.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&C_(t,n,e);else if(t.tag===19)C_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Ve(tt,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&xc(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),sf(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&xc(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}sf(e,!0,n,null,s);break;case"together":sf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Uu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ki(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=Ar(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ar(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function oA(t,e,n){switch(e.tag){case 3:PS(e),wo();break;case 5:aS(e);break;case 1:hn(e.type)&&vc(e);break;case 4:O0(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Ve(bc,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Ve(tt,tt.current&1),e.flags|=128,null):n&e.child.childLanes?NS(t,e,n):(Ve(tt,tt.current&1),t=Ki(t,e,n),t!==null?t.sibling:null);Ve(tt,tt.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return IS(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ve(tt,tt.current),i)break;return null;case 22:case 23:return e.lanes=0,RS(t,e,n)}return Ki(t,e,n)}var LS,Fp,BS,zS;LS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Fp=function(){};BS=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,ns(_i.current);var s=null;switch(n){case"input":r=ap(t,r),i=ap(t,i),s=[];break;case"select":r=rt({},r,{value:void 0}),i=rt({},i,{value:void 0}),s=[];break;case"textarea":r=cp(t,r),i=cp(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=mc)}dp(n,i);var a;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var o=r[u];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ja.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(o=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ja.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ue("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};zS=function(t,e,n,i){n!==i&&(e.flags|=4)};function Jo(t,e){if(!Qe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function $t(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function aA(t,e,n){var i=e.pendingProps;switch(C0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(e),null;case 1:return hn(e.type)&&gc(),$t(e),null;case 3:return i=e.stateNode,xo(),Ze(cn),Ze(Ut),N0(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(eu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(qp(Zn),Zn=null))),Fp(t,e),$t(e),null;case 5:P0(e);var r=ns(Xa.current);if(n=e.type,t!==null&&e.stateNode!=null)BS(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(se(166));return $t(e),null}if(t=ns(_i.current),eu(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[fi]=e,i[Za]=s,t=(e.mode&1)!==0,n){case"dialog":Ue("cancel",i),Ue("close",i);break;case"iframe":case"object":case"embed":Ue("load",i);break;case"video":case"audio":for(r=0;r<fa.length;r++)Ue(fa[r],i);break;case"source":Ue("error",i);break;case"img":case"image":case"link":Ue("error",i),Ue("load",i);break;case"details":Ue("toggle",i);break;case"input":Nv(i,s),Ue("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ue("invalid",i);break;case"textarea":Lv(i,s),Ue("invalid",i)}dp(n,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ql(i.textContent,o,t),r=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ql(i.textContent,o,t),r=["children",""+o]):ja.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ue("scroll",i)}switch(n){case"input":Gl(i),Iv(i,s,!0);break;case"textarea":Gl(i),Bv(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=mc)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=dw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=a.createElement(n,{is:i.is}):(t=a.createElement(n),n==="select"&&(a=t,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):t=a.createElementNS(t,n),t[fi]=e,t[Za]=i,LS(t,e,!1,!1),e.stateNode=t;e:{switch(a=fp(n,i),n){case"dialog":Ue("cancel",t),Ue("close",t),r=i;break;case"iframe":case"object":case"embed":Ue("load",t),r=i;break;case"video":case"audio":for(r=0;r<fa.length;r++)Ue(fa[r],t);r=i;break;case"source":Ue("error",t),r=i;break;case"img":case"image":case"link":Ue("error",t),Ue("load",t),r=i;break;case"details":Ue("toggle",t),r=i;break;case"input":Nv(t,i),r=ap(t,i),Ue("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=rt({},i,{value:void 0}),Ue("invalid",t);break;case"textarea":Lv(t,i),r=cp(t,i),Ue("invalid",t);break;default:r=i}dp(n,r),o=r;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?mw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&fw(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ha(t,l):typeof l=="number"&&Ha(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ja.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ue("scroll",t):l!=null&&c0(t,s,l,a))}switch(n){case"input":Gl(t),Iv(t,i,!1);break;case"textarea":Gl(t),Bv(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Lr(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?uo(t,!!i.multiple,s,!1):i.defaultValue!=null&&uo(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=mc)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $t(e),null;case 6:if(t&&e.stateNode!=null)zS(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(se(166));if(n=ns(Xa.current),ns(_i.current),eu(e)){if(i=e.stateNode,n=e.memoizedProps,i[fi]=e,(s=i.nodeValue!==n)&&(t=bn,t!==null))switch(t.tag){case 3:Ql(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ql(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[fi]=e,e.stateNode=i}return $t(e),null;case 13:if(Ze(tt),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qe&&_n!==null&&e.mode&1&&!(e.flags&128))nS(),wo(),e.flags|=98560,s=!1;else if(s=eu(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(se(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(se(317));s[fi]=e}else wo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$t(e),s=!1}else Zn!==null&&(qp(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||tt.current&1?wt===0&&(wt=3):U0())),e.updateQueue!==null&&(e.flags|=4),$t(e),null);case 4:return xo(),Fp(t,e),t===null&&Ka(e.stateNode.containerInfo),$t(e),null;case 10:return T0(e.type._context),$t(e),null;case 17:return hn(e.type)&&gc(),$t(e),null;case 19:if(Ze(tt),s=e.memoizedState,s===null)return $t(e),null;if(i=(e.flags&128)!==0,a=s.rendering,a===null)if(i)Jo(s,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=xc(t),a!==null){for(e.flags|=128,Jo(s,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ve(tt,tt.current&1|2),e.child}t=t.sibling}s.tail!==null&&ut()>Co&&(e.flags|=128,i=!0,Jo(s,!1),e.lanes=4194304)}else{if(!i)if(t=xc(a),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Jo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Qe)return $t(e),null}else 2*ut()-s.renderingStartTime>Co&&n!==1073741824&&(e.flags|=128,i=!0,Jo(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ut(),e.sibling=null,n=tt.current,Ve(tt,i?n&1|2:n&1),e):($t(e),null);case 22:case 23:return G0(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?gn&1073741824&&($t(e),e.subtreeFlags&6&&(e.flags|=8192)):$t(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function lA(t,e){switch(C0(e),e.tag){case 1:return hn(e.type)&&gc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xo(),Ze(cn),Ze(Ut),N0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return P0(e),null;case 13:if(Ze(tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));wo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ze(tt),null;case 4:return xo(),null;case 10:return T0(e.type._context),null;case 22:case 23:return G0(),null;case 24:return null;default:return null}}var iu=!1,Vt=!1,uA=typeof WeakSet=="function"?WeakSet:Set,pe=null;function oo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){at(t,e,i)}else n.current=null}function jp(t,e,n){try{n()}catch(i){at(t,e,i)}}var E_=!1;function cA(t,e){if(xp=dc,t=Ww(),x0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var p;h!==n||r!==0&&h.nodeType!==3||(o=a+r),h!==s||i!==0&&h.nodeType!==3||(l=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===n&&++u===r&&(o=a),d===s&&++c===i&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(kp={focusedElem:t,selectionRange:n},dc=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var _=m.memoizedProps,f=m.memoizedState,v=e.stateNode,g=v.getSnapshotBeforeUpdate(e.elementType===e.type?_:Kn(e.type,_),f);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(b){at(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return m=E_,E_=!1,m}function Ca(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&jp(e,n,s)}r=r.next}while(r!==i)}}function Uh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function Hp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function FS(t){var e=t.alternate;e!==null&&(t.alternate=null,FS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fi],delete e[Za],delete e[Dp],delete e[U3],delete e[q3])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function jS(t){return t.tag===5||t.tag===3||t.tag===4}function D_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||jS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $p(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=mc));else if(i!==4&&(t=t.child,t!==null))for($p(t,e,n),t=t.sibling;t!==null;)$p(t,e,n),t=t.sibling}function Wp(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Wp(t,e,n),t=t.sibling;t!==null;)Wp(t,e,n),t=t.sibling}var Nt=null,Jn=!1;function Qi(t,e,n){for(n=n.child;n!==null;)HS(t,e,n),n=n.sibling}function HS(t,e,n){if(vi&&typeof vi.onCommitFiberUnmount=="function")try{vi.onCommitFiberUnmount(zh,n)}catch{}switch(n.tag){case 5:Vt||oo(n,e);case 6:var i=Nt,r=Jn;Nt=null,Qi(t,e,n),Nt=i,Jn=r,Nt!==null&&(Jn?(t=Nt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Nt.removeChild(n.stateNode));break;case 18:Nt!==null&&(Jn?(t=Nt,n=n.stateNode,t.nodeType===8?Yd(t.parentNode,n):t.nodeType===1&&Yd(t,n),Ga(t)):Yd(Nt,n.stateNode));break;case 4:i=Nt,r=Jn,Nt=n.stateNode.containerInfo,Jn=!0,Qi(t,e,n),Nt=i,Jn=r;break;case 0:case 11:case 14:case 15:if(!Vt&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&jp(n,e,a),r=r.next}while(r!==i)}Qi(t,e,n);break;case 1:if(!Vt&&(oo(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){at(n,e,o)}Qi(t,e,n);break;case 21:Qi(t,e,n);break;case 22:n.mode&1?(Vt=(i=Vt)||n.memoizedState!==null,Qi(t,e,n),Vt=i):Qi(t,e,n);break;default:Qi(t,e,n)}}function A_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new uA),e.forEach(function(i){var r=yA.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Gn(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Nt=o.stateNode,Jn=!1;break e;case 3:Nt=o.stateNode.containerInfo,Jn=!0;break e;case 4:Nt=o.stateNode.containerInfo,Jn=!0;break e}o=o.return}if(Nt===null)throw Error(se(160));HS(s,a,r),Nt=null,Jn=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){at(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$S(e,t),e=e.sibling}function $S(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Gn(e,t),si(t),i&4){try{Ca(3,t,t.return),Uh(3,t)}catch(_){at(t,t.return,_)}try{Ca(5,t,t.return)}catch(_){at(t,t.return,_)}}break;case 1:Gn(e,t),si(t),i&512&&n!==null&&oo(n,n.return);break;case 5:if(Gn(e,t),si(t),i&512&&n!==null&&oo(n,n.return),t.flags&32){var r=t.stateNode;try{Ha(r,"")}catch(_){at(t,t.return,_)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&cw(r,s),fp(o,a);var u=fp(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?mw(r,h):c==="dangerouslySetInnerHTML"?fw(r,h):c==="children"?Ha(r,h):c0(r,c,h,u)}switch(o){case"input":lp(r,s);break;case"textarea":hw(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?uo(r,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?uo(r,!!s.multiple,s.defaultValue,!0):uo(r,!!s.multiple,s.multiple?[]:"",!1))}r[Za]=s}catch(_){at(t,t.return,_)}}break;case 6:if(Gn(e,t),si(t),i&4){if(t.stateNode===null)throw Error(se(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(_){at(t,t.return,_)}}break;case 3:if(Gn(e,t),si(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Ga(e.containerInfo)}catch(_){at(t,t.return,_)}break;case 4:Gn(e,t),si(t);break;case 13:Gn(e,t),si(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(W0=ut())),i&4&&A_(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Vt=(u=Vt)||c,Gn(e,t),Vt=u):Gn(e,t),si(t),i&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(pe=t,c=t.child;c!==null;){for(h=pe=c;pe!==null;){switch(d=pe,p=d.child,d.tag){case 0:case 11:case 14:case 15:Ca(4,d,d.return);break;case 1:oo(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){i=d,n=d.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(_){at(i,n,_)}}break;case 5:oo(d,d.return);break;case 22:if(d.memoizedState!==null){M_(h);continue}}p!==null?(p.return=d,pe=p):M_(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{r=h.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=pw("display",a))}catch(_){at(t,t.return,_)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(_){at(t,t.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Gn(e,t),si(t),i&4&&A_(t);break;case 21:break;default:Gn(e,t),si(t)}}function si(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(jS(n)){var i=n;break e}n=n.return}throw Error(se(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Ha(r,""),i.flags&=-33);var s=D_(t);Wp(t,s,r);break;case 3:case 4:var a=i.stateNode.containerInfo,o=D_(t);$p(t,o,a);break;default:throw Error(se(161))}}catch(l){at(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hA(t,e,n){pe=t,WS(t)}function WS(t,e,n){for(var i=(t.mode&1)!==0;pe!==null;){var r=pe,s=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||iu;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||Vt;o=iu;var u=Vt;if(iu=a,(Vt=l)&&!u)for(pe=r;pe!==null;)a=pe,l=a.child,a.tag===22&&a.memoizedState!==null?R_(r):l!==null?(l.return=a,pe=l):R_(r);for(;s!==null;)pe=s,WS(s),s=s.sibling;pe=r,iu=o,Vt=u}T_(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,pe=s):T_(t)}}function T_(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vt||Uh(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Vt)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Kn(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&f_(e,s,i);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}f_(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Ga(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}Vt||e.flags&512&&Hp(e)}catch(d){at(e,e.return,d)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function M_(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function R_(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Uh(4,e)}catch(l){at(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){at(e,r,l)}}var s=e.return;try{Hp(e)}catch(l){at(e,s,l)}break;case 5:var a=e.return;try{Hp(e)}catch(l){at(e,a,l)}}}catch(l){at(e,e.return,l)}if(e===t){pe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,pe=o;break}pe=e.return}}var dA=Math.ceil,Ec=Zi.ReactCurrentDispatcher,H0=Zi.ReactCurrentOwner,zn=Zi.ReactCurrentBatchConfig,Ne=0,Mt=null,ft=null,zt=0,gn=0,ao=Wr(0),wt=0,nl=null,bs=0,qh=0,$0=0,Ea=null,an=null,W0=0,Co=1/0,Oi=null,Dc=!1,Vp=null,Er=null,ru=!1,gr=null,Ac=0,Da=0,Gp=null,qu=-1,Ku=0;function en(){return Ne&6?ut():qu!==-1?qu:qu=ut()}function Dr(t){return t.mode&1?Ne&2&&zt!==0?zt&-zt:J3.transition!==null?(Ku===0&&(Ku=Dw()),Ku):(t=ze,t!==0||(t=window.event,t=t===void 0?16:Nw(t.type)),t):1}function ti(t,e,n,i){if(50<Da)throw Da=0,Gp=null,Error(se(185));Dl(t,n,i),(!(Ne&2)||t!==Mt)&&(t===Mt&&(!(Ne&2)&&(qh|=n),wt===4&&hr(t,zt)),dn(t,i),n===1&&Ne===0&&!(e.mode&1)&&(Co=ut()+500,Wh&&Vr()))}function dn(t,e){var n=t.callbackNode;JD(t,e);var i=hc(t,t===Mt?zt:0);if(i===0)n!==null&&jv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&jv(n),e===1)t.tag===0?K3(O_.bind(null,t)):Qw(O_.bind(null,t)),V3(function(){!(Ne&6)&&Vr()}),n=null;else{switch(Aw(i)){case 1:n=m0;break;case 4:n=Cw;break;case 16:n=cc;break;case 536870912:n=Ew;break;default:n=cc}n=YS(n,VS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function VS(t,e){if(qu=-1,Ku=0,Ne&6)throw Error(se(327));var n=t.callbackNode;if(mo()&&t.callbackNode!==n)return null;var i=hc(t,t===Mt?zt:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Tc(t,i);else{e=i;var r=Ne;Ne|=2;var s=US();(Mt!==t||zt!==e)&&(Oi=null,Co=ut()+500,us(t,e));do try{mA();break}catch(o){GS(t,o)}while(!0);A0(),Ec.current=s,Ne=r,ft!==null?e=0:(Mt=null,zt=0,e=wt)}if(e!==0){if(e===2&&(r=_p(t),r!==0&&(i=r,e=Up(t,r))),e===1)throw n=nl,us(t,0),hr(t,i),dn(t,ut()),n;if(e===6)hr(t,i);else{if(r=t.current.alternate,!(i&30)&&!fA(r)&&(e=Tc(t,i),e===2&&(s=_p(t),s!==0&&(i=s,e=Up(t,s))),e===1))throw n=nl,us(t,0),hr(t,i),dn(t,ut()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(se(345));case 2:Yr(t,an,Oi);break;case 3:if(hr(t,i),(i&130023424)===i&&(e=W0+500-ut(),10<e)){if(hc(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){en(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Ep(Yr.bind(null,t,an,Oi),e);break}Yr(t,an,Oi);break;case 4:if(hr(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-ei(i);s=1<<a,a=e[a],a>r&&(r=a),i&=~s}if(i=r,i=ut()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*dA(i/1960))-i,10<i){t.timeoutHandle=Ep(Yr.bind(null,t,an,Oi),i);break}Yr(t,an,Oi);break;case 5:Yr(t,an,Oi);break;default:throw Error(se(329))}}}return dn(t,ut()),t.callbackNode===n?VS.bind(null,t):null}function Up(t,e){var n=Ea;return t.current.memoizedState.isDehydrated&&(us(t,e).flags|=256),t=Tc(t,e),t!==2&&(e=an,an=n,e!==null&&qp(e)),t}function qp(t){an===null?an=t:an.push.apply(an,t)}function fA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ni(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function hr(t,e){for(e&=~$0,e&=~qh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ei(e),i=1<<n;t[n]=-1,e&=~i}}function O_(t){if(Ne&6)throw Error(se(327));mo();var e=hc(t,0);if(!(e&1))return dn(t,ut()),null;var n=Tc(t,e);if(t.tag!==0&&n===2){var i=_p(t);i!==0&&(e=i,n=Up(t,i))}if(n===1)throw n=nl,us(t,0),hr(t,e),dn(t,ut()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yr(t,an,Oi),dn(t,ut()),null}function V0(t,e){var n=Ne;Ne|=1;try{return t(e)}finally{Ne=n,Ne===0&&(Co=ut()+500,Wh&&Vr())}}function ws(t){gr!==null&&gr.tag===0&&!(Ne&6)&&mo();var e=Ne;Ne|=1;var n=zn.transition,i=ze;try{if(zn.transition=null,ze=1,t)return t()}finally{ze=i,zn.transition=n,Ne=e,!(Ne&6)&&Vr()}}function G0(){gn=ao.current,Ze(ao)}function us(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,W3(n)),ft!==null)for(n=ft.return;n!==null;){var i=n;switch(C0(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&gc();break;case 3:xo(),Ze(cn),Ze(Ut),N0();break;case 5:P0(i);break;case 4:xo();break;case 13:Ze(tt);break;case 19:Ze(tt);break;case 10:T0(i.type._context);break;case 22:case 23:G0()}n=n.return}if(Mt=t,ft=t=Ar(t.current,null),zt=gn=e,wt=0,nl=null,$0=qh=bs=0,an=Ea=null,ts!==null){for(e=0;e<ts.length;e++)if(n=ts[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var a=s.next;s.next=r,i.next=a}n.pending=i}ts=null}return t}function GS(t,e){do{var n=ft;try{if(A0(),Vu.current=Cc,kc){for(var i=it.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}kc=!1}if(ys=0,Et=bt=it=null,ka=!1,Qa=0,H0.current=null,n===null||n.return===null){wt=1,nl=e,ft=null;break}e:{var s=t,a=n.return,o=n,l=e;if(e=zt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=y_(a);if(p!==null){p.flags&=-257,b_(p,a,o,s,e),p.mode&1&&__(s,u,e),e=p,l=u;var m=e.updateQueue;if(m===null){var _=new Set;_.add(l),e.updateQueue=_}else m.add(l);break e}else{if(!(e&1)){__(s,u,e),U0();break e}l=Error(se(426))}}else if(Qe&&o.mode&1){var f=y_(a);if(f!==null){!(f.flags&65536)&&(f.flags|=256),b_(f,a,o,s,e),E0(ko(l,o));break e}}s=l=ko(l,o),wt!==4&&(wt=2),Ea===null?Ea=[s]:Ea.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=AS(s,l,e);d_(s,v);break e;case 1:o=l;var g=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Er===null||!Er.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=TS(s,o,e);d_(s,b);break e}}s=s.return}while(s!==null)}KS(n)}catch(w){e=w,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function US(){var t=Ec.current;return Ec.current=Cc,t===null?Cc:t}function U0(){(wt===0||wt===3||wt===2)&&(wt=4),Mt===null||!(bs&268435455)&&!(qh&268435455)||hr(Mt,zt)}function Tc(t,e){var n=Ne;Ne|=2;var i=US();(Mt!==t||zt!==e)&&(Oi=null,us(t,e));do try{pA();break}catch(r){GS(t,r)}while(!0);if(A0(),Ne=n,Ec.current=i,ft!==null)throw Error(se(261));return Mt=null,zt=0,wt}function pA(){for(;ft!==null;)qS(ft)}function mA(){for(;ft!==null&&!jD();)qS(ft)}function qS(t){var e=ZS(t.alternate,t,gn);t.memoizedProps=t.pendingProps,e===null?KS(t):ft=e,H0.current=null}function KS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=lA(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,ft=null;return}}else if(n=aA(n,e,gn),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);wt===0&&(wt=5)}function Yr(t,e,n){var i=ze,r=zn.transition;try{zn.transition=null,ze=1,gA(t,e,n,i)}finally{zn.transition=r,ze=i}return null}function gA(t,e,n,i){do mo();while(gr!==null);if(Ne&6)throw Error(se(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(ZD(t,s),t===Mt&&(ft=Mt=null,zt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ru||(ru=!0,YS(cc,function(){return mo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=zn.transition,zn.transition=null;var a=ze;ze=1;var o=Ne;Ne|=4,H0.current=null,cA(t,n),$S(n,t),L3(kp),dc=!!xp,kp=xp=null,t.current=n,hA(n),HD(),Ne=o,ze=a,zn.transition=s}else t.current=n;if(ru&&(ru=!1,gr=t,Ac=r),s=t.pendingLanes,s===0&&(Er=null),VD(n.stateNode),dn(t,ut()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Dc)throw Dc=!1,t=Vp,Vp=null,t;return Ac&1&&t.tag!==0&&mo(),s=t.pendingLanes,s&1?t===Gp?Da++:(Da=0,Gp=t):Da=0,Vr(),null}function mo(){if(gr!==null){var t=Aw(Ac),e=zn.transition,n=ze;try{if(zn.transition=null,ze=16>t?16:t,gr===null)var i=!1;else{if(t=gr,gr=null,Ac=0,Ne&6)throw Error(se(331));var r=Ne;for(Ne|=4,pe=t.current;pe!==null;){var s=pe,a=s.child;if(pe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(pe=u;pe!==null;){var c=pe;switch(c.tag){case 0:case 11:case 15:Ca(8,c,s)}var h=c.child;if(h!==null)h.return=c,pe=h;else for(;pe!==null;){c=pe;var d=c.sibling,p=c.return;if(FS(c),c===u){pe=null;break}if(d!==null){d.return=p,pe=d;break}pe=p}}}var m=s.alternate;if(m!==null){var _=m.child;if(_!==null){m.child=null;do{var f=_.sibling;_.sibling=null,_=f}while(_!==null)}}pe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,pe=a;else e:for(;pe!==null;){if(s=pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ca(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,pe=v;break e}pe=s.return}}var g=t.current;for(pe=g;pe!==null;){a=pe;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,pe=y;else e:for(a=g;pe!==null;){if(o=pe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Uh(9,o)}}catch(w){at(o,o.return,w)}if(o===a){pe=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,pe=b;break e}pe=o.return}}if(Ne=r,Vr(),vi&&typeof vi.onPostCommitFiberRoot=="function")try{vi.onPostCommitFiberRoot(zh,t)}catch{}i=!0}return i}finally{ze=n,zn.transition=e}}return!1}function P_(t,e,n){e=ko(n,e),e=AS(t,e,1),t=Cr(t,e,1),e=en(),t!==null&&(Dl(t,1,e),dn(t,e))}function at(t,e,n){if(t.tag===3)P_(t,t,n);else for(;e!==null;){if(e.tag===3){P_(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Er===null||!Er.has(i))){t=ko(n,t),t=TS(e,t,1),e=Cr(e,t,1),t=en(),e!==null&&(Dl(e,1,t),dn(e,t));break}}e=e.return}}function vA(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=en(),t.pingedLanes|=t.suspendedLanes&n,Mt===t&&(zt&n)===n&&(wt===4||wt===3&&(zt&130023424)===zt&&500>ut()-W0?us(t,0):$0|=n),dn(t,e)}function JS(t,e){e===0&&(t.mode&1?(e=Kl,Kl<<=1,!(Kl&130023424)&&(Kl=4194304)):e=1);var n=en();t=qi(t,e),t!==null&&(Dl(t,e,n),dn(t,n))}function _A(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),JS(t,n)}function yA(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(se(314))}i!==null&&i.delete(e),JS(t,n)}var ZS;ZS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||cn.current)un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return un=!1,oA(t,e,n);un=!!(t.flags&131072)}else un=!1,Qe&&e.flags&1048576&&eS(e,yc,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Uu(t,e),t=e.pendingProps;var r=bo(e,Ut.current);po(e,n),r=L0(null,e,i,t,r,n);var s=B0();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hn(i)?(s=!0,vc(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,R0(e),r.updater=Gh,e.stateNode=r,r._reactInternals=e,Pp(e,i,t,n),e=Lp(null,e,i,!0,s,n)):(e.tag=0,Qe&&s&&k0(e),Xt(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Uu(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=wA(i),t=Kn(i,t),r){case 0:e=Ip(null,e,i,t,n);break e;case 1:e=x_(null,e,i,t,n);break e;case 11:e=w_(null,e,i,t,n);break e;case 14:e=S_(null,e,i,Kn(i.type,t),n);break e}throw Error(se(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kn(i,r),Ip(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kn(i,r),x_(t,e,i,r,n);case 3:e:{if(PS(e),t===null)throw Error(se(387));i=e.pendingProps,s=e.memoizedState,r=s.element,oS(t,e),Sc(e,i,null,n);var a=e.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=ko(Error(se(423)),e),e=k_(t,e,i,n,r);break e}else if(i!==r){r=ko(Error(se(424)),e),e=k_(t,e,i,n,r);break e}else for(_n=kr(e.stateNode.containerInfo.firstChild),bn=e,Qe=!0,Zn=null,n=rS(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wo(),i===r){e=Ki(t,e,n);break e}Xt(t,e,i,n)}e=e.child}return e;case 5:return aS(e),t===null&&Mp(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,a=r.children,Cp(i,r)?a=null:s!==null&&Cp(i,s)&&(e.flags|=32),OS(t,e),Xt(t,e,a,n),e.child;case 6:return t===null&&Mp(e),null;case 13:return NS(t,e,n);case 4:return O0(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=So(e,null,i,n):Xt(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kn(i,r),w_(t,e,i,r,n);case 7:return Xt(t,e,e.pendingProps,n),e.child;case 8:return Xt(t,e,e.pendingProps.children,n),e.child;case 12:return Xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,Ve(bc,i._currentValue),i._currentValue=a,s!==null)if(ni(s.value,a)){if(s.children===r.children&&!cn.current){e=Ki(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Hi(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Rp(s.return,n,e),o.lanes|=n;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(se(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),Rp(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Xt(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,po(e,n),r=Hn(r),i=i(r),e.flags|=1,Xt(t,e,i,n),e.child;case 14:return i=e.type,r=Kn(i,e.pendingProps),r=Kn(i.type,r),S_(t,e,i,r,n);case 15:return MS(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kn(i,r),Uu(t,e),e.tag=1,hn(i)?(t=!0,vc(e)):t=!1,po(e,n),DS(e,i,r),Pp(e,i,r,n),Lp(null,e,i,!0,t,n);case 19:return IS(t,e,n);case 22:return RS(t,e,n)}throw Error(se(156,e.tag))};function YS(t,e){return kw(t,e)}function bA(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(t,e,n,i){return new bA(t,e,n,i)}function q0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wA(t){if(typeof t=="function")return q0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===d0)return 11;if(t===f0)return 14}return 2}function Ar(t,e){var n=t.alternate;return n===null?(n=Ln(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ju(t,e,n,i,r,s){var a=2;if(i=t,typeof t=="function")q0(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ys:return cs(n.children,r,s,e);case h0:a=8,r|=8;break;case ip:return t=Ln(12,n,e,r|2),t.elementType=ip,t.lanes=s,t;case rp:return t=Ln(13,n,e,r),t.elementType=rp,t.lanes=s,t;case sp:return t=Ln(19,n,e,r),t.elementType=sp,t.lanes=s,t;case aw:return Kh(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case sw:a=10;break e;case ow:a=9;break e;case d0:a=11;break e;case f0:a=14;break e;case rr:a=16,i=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=Ln(a,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function cs(t,e,n,i){return t=Ln(7,t,i,e),t.lanes=n,t}function Kh(t,e,n,i){return t=Ln(22,t,i,e),t.elementType=aw,t.lanes=n,t.stateNode={isHidden:!1},t}function of(t,e,n){return t=Ln(6,t,null,e),t.lanes=n,t}function af(t,e,n){return e=Ln(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function SA(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jd(0),this.expirationTimes=jd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jd(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function K0(t,e,n,i,r,s,a,o,l){return t=new SA(t,e,n,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ln(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},R0(s),t}function xA(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zs,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function XS(t){if(!t)return Br;t=t._reactInternals;e:{if(Ts(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(hn(n))return Xw(t,n,e)}return e}function QS(t,e,n,i,r,s,a,o,l){return t=K0(n,i,!0,t,r,s,a,o,l),t.context=XS(null),n=t.current,i=en(),r=Dr(n),s=Hi(i,r),s.callback=e??null,Cr(n,s,r),t.current.lanes=r,Dl(t,r,i),dn(t,i),t}function Jh(t,e,n,i){var r=e.current,s=en(),a=Dr(r);return n=XS(n),e.context===null?e.context=n:e.pendingContext=n,e=Hi(s,a),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Cr(r,e,a),t!==null&&(ti(t,r,a,s),Wu(t,r,a)),a}function Mc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function N_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function J0(t,e){N_(t,e),(t=t.alternate)&&N_(t,e)}function kA(){return null}var ex=typeof reportError=="function"?reportError:function(t){console.error(t)};function Z0(t){this._internalRoot=t}Zh.prototype.render=Z0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));Jh(t,e,null,null)};Zh.prototype.unmount=Z0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ws(function(){Jh(null,t,null,null)}),e[Ui]=null}};function Zh(t){this._internalRoot=t}Zh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Rw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<cr.length&&e!==0&&e<cr[n].priority;n++);cr.splice(n,0,t),n===0&&Pw(t)}};function Y0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function I_(){}function CA(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Mc(a);s.call(u)}}var a=QS(e,i,t,0,null,!1,!1,"",I_);return t._reactRootContainer=a,t[Ui]=a.current,Ka(t.nodeType===8?t.parentNode:t),ws(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var o=i;i=function(){var u=Mc(l);o.call(u)}}var l=K0(t,0,!1,null,null,!1,!1,"",I_);return t._reactRootContainer=l,t[Ui]=l.current,Ka(t.nodeType===8?t.parentNode:t),ws(function(){Jh(e,l,n,i)}),l}function Xh(t,e,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var o=r;r=function(){var l=Mc(a);o.call(l)}}Jh(e,a,t,r)}else a=CA(n,e,t,r,i);return Mc(a)}Tw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=da(e.pendingLanes);n!==0&&(g0(e,n|1),dn(e,ut()),!(Ne&6)&&(Co=ut()+500,Vr()))}break;case 13:ws(function(){var i=qi(t,1);if(i!==null){var r=en();ti(i,t,1,r)}}),J0(t,1)}};v0=function(t){if(t.tag===13){var e=qi(t,134217728);if(e!==null){var n=en();ti(e,t,134217728,n)}J0(t,134217728)}};Mw=function(t){if(t.tag===13){var e=Dr(t),n=qi(t,e);if(n!==null){var i=en();ti(n,t,e,i)}J0(t,e)}};Rw=function(){return ze};Ow=function(t,e){var n=ze;try{return ze=t,e()}finally{ze=n}};mp=function(t,e,n){switch(e){case"input":if(lp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=$h(i);if(!r)throw Error(se(90));uw(i),lp(i,r)}}}break;case"textarea":hw(t,n);break;case"select":e=n.value,e!=null&&uo(t,!!n.multiple,e,!1)}};_w=V0;yw=ws;var EA={usingClientEntryPoint:!1,Events:[Tl,to,$h,gw,vw,V0]},Zo={findFiberByHostInstance:es,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DA={bundleType:Zo.bundleType,version:Zo.version,rendererPackageName:Zo.rendererPackageName,rendererConfig:Zo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Sw(t),t===null?null:t.stateNode},findFiberByHostInstance:Zo.findFiberByHostInstance||kA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{zh=su.inject(DA),vi=su}catch{}}kn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EA;kn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y0(e))throw Error(se(200));return xA(t,e,null,n)};kn.createRoot=function(t,e){if(!Y0(t))throw Error(se(299));var n=!1,i="",r=ex;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=K0(t,1,!1,null,null,n,!1,i,r),t[Ui]=e.current,Ka(t.nodeType===8?t.parentNode:t),new Z0(e)};kn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=Sw(e),t=t===null?null:t.stateNode,t};kn.flushSync=function(t){return ws(t)};kn.hydrate=function(t,e,n){if(!Yh(e))throw Error(se(200));return Xh(null,t,e,!0,n)};kn.hydrateRoot=function(t,e,n){if(!Y0(t))throw Error(se(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",a=ex;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=QS(e,null,t,1,n??null,r,!1,s,a),t[Ui]=e.current,Ka(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Zh(e)};kn.render=function(t,e,n){if(!Yh(e))throw Error(se(200));return Xh(null,t,e,!1,n)};kn.unmountComponentAtNode=function(t){if(!Yh(t))throw Error(se(40));return t._reactRootContainer?(ws(function(){Xh(null,null,t,!1,function(){t._reactRootContainer=null,t[Ui]=null})}),!0):!1};kn.unstable_batchedUpdates=V0;kn.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Yh(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return Xh(t,e,n,!1,i)};kn.version="18.3.1-next-f1338f8080-20240426";function tx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tx)}catch(t){console.error(t)}}tx(),tw.exports=kn;var nx=tw.exports;const ix=Wb(nx);var rx,L_=nx;rx=L_.createRoot,L_.hydrateRoot;class sx{}class Tr extends sx{constructor(e,n,i){super(),this.viewId=e,this.groupId=n,this.panelId=i}}class Aa extends sx{constructor(e,n){super(),this.viewId=e,this.paneId=n}}class wi{constructor(){}static getInstance(){return wi.INSTANCE}hasData(e){return e&&e===this.proto}clearData(e){this.hasData(e)&&(this.proto=void 0,this.data=void 0)}getData(e){if(this.hasData(e))return this.data}setData(e,n){n&&(this.data=e,this.proto=n)}}wi.INSTANCE=new wi;function Gt(){const t=wi.getInstance();if(t.hasData(Tr.prototype))return t.getData(Tr.prototype)[0]}function Yo(){const t=wi.getInstance();if(t.hasData(Aa.prototype))return t.getData(Aa.prototype)[0]}var hs;(function(t){t.any=(...e)=>n=>{const i=e.map(r=>r(n));return{dispose:()=>{i.forEach(r=>{r.dispose()})}}}})(hs||(hs={}));class X0{constructor(){this._defaultPrevented=!1}get defaultPrevented(){return this._defaultPrevented}preventDefault(){this._defaultPrevented=!0}}class ox{constructor(){this._isAccepted=!1}get isAccepted(){return this._isAccepted}accept(){this._isAccepted=!0}}class AA{constructor(){this.events=new Map}get size(){return this.events.size}add(e,n){this.events.set(e,n)}delete(e){this.events.delete(e)}clear(){this.events.clear()}}class Rc{static create(){var e;return new Rc((e=new Error().stack)!==null&&e!==void 0?e:"")}constructor(e){this.value=e}print(){console.warn("dockview: stacktrace",this.value)}}class TA{constructor(e,n){this.callback=e,this.stacktrace=n}}class J{static setLeakageMonitorEnabled(e){e!==J.ENABLE_TRACKING&&J.MEMORY_LEAK_WATCHER.clear(),J.ENABLE_TRACKING=e}get value(){return this._last}constructor(e){this.options=e,this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=e=>{var n;!((n=this.options)===null||n===void 0)&&n.replay&&this._last!==void 0&&e(this._last);const i=new TA(e,J.ENABLE_TRACKING?Rc.create():void 0);return this._listeners.push(i),{dispose:()=>{const r=this._listeners.indexOf(i);r>-1&&this._listeners.splice(r,1)}}},J.ENABLE_TRACKING&&J.MEMORY_LEAK_WATCHER.add(this._event,Rc.create())),this._event}fire(e){var n;!((n=this.options)===null||n===void 0)&&n.replay&&(this._last=e);for(const i of this._listeners)i.callback(e)}dispose(){this._disposed||(this._disposed=!0,this._listeners.length>0&&(J.ENABLE_TRACKING&&queueMicrotask(()=>{var e;for(const n of this._listeners)console.warn("dockview: stacktrace",(e=n.stacktrace)===null||e===void 0?void 0:e.print())}),this._listeners=[]),J.ENABLE_TRACKING&&this._event&&J.MEMORY_LEAK_WATCHER.delete(this._event))}}J.ENABLE_TRACKING=!1;J.MEMORY_LEAK_WATCHER=new AA;function Me(t,e,n,i){return t.addEventListener(e,n,i),{dispose:()=>{t.removeEventListener(e,n,i)}}}class B_{constructor(){this._onFired=new J,this._currentFireCount=0,this._queued=!1,this.onEvent=e=>{const n=this._currentFireCount;return this._onFired.event(()=>{this._currentFireCount>n&&e()})}}fire(){this._currentFireCount++,!this._queued&&(this._queued=!0,queueMicrotask(()=>{this._queued=!1,this._onFired.fire()}))}dispose(){this._onFired.dispose()}}var pt;(function(t){t.NONE={dispose:()=>{}};function e(n){return{dispose:()=>{n()}}}t.from=e})(pt||(pt={}));class Se{get isDisposed(){return this._isDisposed}constructor(...e){this._isDisposed=!1,this._disposables=e}addDisposables(...e){e.forEach(n=>this._disposables.push(n))}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposables.forEach(e=>e.dispose()),this._disposables=[])}}class qt{constructor(){this._disposable=pt.NONE}set value(e){this._disposable&&this._disposable.dispose(),this._disposable=e}dispose(){this._disposable&&(this._disposable.dispose(),this._disposable=pt.NONE)}}class MA extends Se{constructor(e){super(),this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._value=null,this.addDisposables(this._onDidChange,Qh(e,n=>{const i=n.target.scrollWidth>n.target.clientWidth,r=n.target.scrollHeight>n.target.clientHeight;this._value={hasScrollX:i,hasScrollY:r},this._onDidChange.fire(this._value)}))}}function Qh(t,e){const n=new ResizeObserver(i=>{requestAnimationFrame(()=>{const r=i[0];e(r)})});return n.observe(t),{dispose:()=>{n.unobserve(t),n.disconnect()}}}const il=(t,...e)=>{for(const n of e)t.classList.contains(n)&&t.classList.remove(n)},ed=(t,...e)=>{for(const n of e)t.classList.contains(n)||t.classList.add(n)},we=(t,e,n)=>{const i=t.classList.contains(e);n&&!i&&t.classList.add(e),!n&&i&&t.classList.remove(e)};function Kp(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function ax(t){return new RA(t)}class RA extends Se{constructor(e){super(),this._onDidFocus=new J,this.onDidFocus=this._onDidFocus.event,this._onDidBlur=new J,this.onDidBlur=this._onDidBlur.event,this.addDisposables(this._onDidFocus,this._onDidBlur);let n=Kp(document.activeElement,e),i=!1;const r=()=>{i=!1,n||(n=!0,this._onDidFocus.fire())},s=()=>{n&&(i=!0,window.setTimeout(()=>{i&&(i=!1,n=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{Kp(document.activeElement,e)!==n&&(n?s():r())},this.addDisposables(Me(e,"focus",r,!0)),this.addDisposables(Me(e,"blur",s,!0))}refreshState(){this._refreshStateHandler()}}const lx="dv-quasiPreventDefault";function OA(t){t[lx]=!0}function z_(t){return t[lx]}function PA(t,e){const n=Array.from(e);for(const i of n){if(i.href){const s=t.createElement("link");s.href=i.href,s.type=i.type,s.rel="stylesheet",t.head.appendChild(s)}let r=[];try{i.cssRules&&(r=Array.from(i.cssRules).map(s=>s.cssText))}catch{}for(const s of r){const a=t.createElement("style");a.appendChild(t.createTextNode(s)),t.head.appendChild(a)}}}function Jp(t){const{left:e,top:n,width:i,height:r}=t.getBoundingClientRect();return{left:e+window.scrollX,top:n+window.scrollY,width:i,height:r}}function NA(t){let e=t;for(;e!=null&&e.parentNode;){if(e.parentNode===document)return!0;e.parentNode instanceof DocumentFragment?e=e.parentNode.host:e=e.parentNode}return!1}function IA(t,e){t.setAttribute("data-testid",e)}function LA(t){const e=[];function n(i){if(i.nodeType===Node.ELEMENT_NODE){t.includes(i.tagName)&&e.push(i),i.shadowRoot&&n(i.shadowRoot);for(const r of i.children)n(r)}}return n(document.documentElement),e}function Oc(t=document){const e=LA(["IFRAME","WEBVIEW"]),n=new WeakMap;for(const i of e)n.set(i,i.style.pointerEvents),i.style.pointerEvents="none";return{release:()=>{var i;for(const r of e)r.style.pointerEvents=(i=n.get(r))!==null&&i!==void 0?i:"auto";e.splice(0,e.length)}}}function BA(t){function e(r){const s=[];for(let a=0;a<r.classList.length;a++)s.push(r.classList.item(a));return s}let n,i=t;for(;i!==null&&(n=e(i).find(r=>r.startsWith("dockview-theme-")),typeof n!="string");)i=i.parentElement;return n}class td{constructor(e){this.element=e,this._classNames=[]}setClassNames(e){for(const n of this._classNames)we(this.element,n,!1);this._classNames=e.split(" ").filter(n=>n.trim().length>0);for(const n of this._classNames)we(this.element,n,!0)}}const ux=100;function zA(t,e){const n=Jp(t),i=Jp(e);return!(n.left<i.left||n.left+n.width>i.left+i.width)}function FA(t){const e=new J;let n=t.screenX,i=t.screenY,r;const s=()=>{if(t.closed)return;const a=t.screenX,o=t.screenY;(a!==n||o!==i)&&(clearTimeout(r),r=setTimeout(()=>{e.fire()},ux),n=a,i=o),requestAnimationFrame(s)};return s(),e}function jA(t,e){let n;return new Se(Me(t,"resize",()=>{clearTimeout(n),n=setTimeout(()=>{e()},ux)}))}function HA(t,e,n={buffer:10}){const i=n.buffer,r=t.getBoundingClientRect(),s=e.getBoundingClientRect();let a=0,o=0;const l=r.left-s.left,u=r.top-s.top,c=r.bottom-s.bottom,h=r.right-s.right;l<i?a=i-l:h>i&&(a=-i-h),u<i?o=i-u:c>i&&(o=-c-i),(a!==0||o!==0)&&(t.style.transform=`translate(${a}px, ${o}px)`)}function $A(t){let e=t;for(;e&&(e.style.zIndex==="auto"||e.style.zIndex==="");)e=e.parentElement;return e}function Bi(t){if(t.length===0)throw new Error("Invalid tail call");return[t.slice(0,t.length-1),t[t.length-1]]}function cx(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function lf(t,e){const n=t.indexOf(e);n>-1&&(t.splice(n,1),t.unshift(e))}function ou(t,e){const n=t.indexOf(e);n>-1&&(t.splice(n,1),t.push(e))}function WA(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(e(i))return n}return-1}function uf(t,e){const n=t.findIndex(i=>i===e);return n>-1?(t.splice(n,1),!0):!1}const Je=(t,e,n)=>e>n?e:Math.min(n,Math.max(t,e)),Q0=()=>{let t=1;return{next:()=>(t++).toString()}},Un=(t,e)=>{const n=[];if(typeof e!="number"&&(e=t,t=0),t<=e)for(let i=t;i<e;i++)n.push(i);else for(let i=t;i>e;i--)n.push(i);return n};class VA{set size(e){this._size=e}get size(){return this._size}get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return typeof this._cachedVisibleSize>"u"}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,n,i,r){this.container=e,this.view=n,this.disposable=r,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}setVisible(e,n){var i;e!==this.visible&&(e?(this.size=Je((i=this._cachedVisibleSize)!==null&&i!==void 0?i:0,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof n=="number"?n:this.size,this.size=0),this.container.classList.toggle("visible",e),this.view.setVisible&&this.view.setVisible(e))}dispose(){return this.disposable.dispose(),this.view}}var ye;(function(t){t.HORIZONTAL="HORIZONTAL",t.VERTICAL="VERTICAL"})(ye||(ye={}));var Mn;(function(t){t[t.MAXIMUM=0]="MAXIMUM",t[t.MINIMUM=1]="MINIMUM",t[t.DISABLED=2]="DISABLED",t[t.ENABLED=3]="ENABLED"})(Mn||(Mn={}));var yt;(function(t){t.Low="low",t.High="high",t.Normal="normal"})(yt||(yt={}));var Bn;(function(t){t.Distribute={type:"distribute"};function e(i){return{type:"split",index:i}}t.Split=e;function n(i){return{type:"invisible",cachedVisibleSize:i}}t.Invisible=n})(Bn||(Bn={}));class rl{get contentSize(){return this._contentSize}get size(){return this._size}set size(e){this._size=e}get orthogonalSize(){return this._orthogonalSize}set orthogonalSize(e){this._orthogonalSize=e}get length(){return this.viewItems.length}get proportions(){return this._proportions?[...this._proportions]:void 0}get orientation(){return this._orientation}set orientation(e){this._orientation=e;const n=this.size;this.size=this.orthogonalSize,this.orthogonalSize=n,il(this.element,"dv-horizontal","dv-vertical"),this.element.classList.add(this.orientation==ye.HORIZONTAL?"dv-horizontal":"dv-vertical")}get minimumSize(){return this.viewItems.reduce((e,n)=>e+n.minimumSize,0)}get maximumSize(){return this.length===0?Number.POSITIVE_INFINITY:this.viewItems.reduce((e,n)=>e+n.maximumSize,0)}get startSnappingEnabled(){return this._startSnappingEnabled}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}get endSnappingEnabled(){return this._endSnappingEnabled}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}get disabled(){return this._disabled}set disabled(e){this._disabled=e,we(this.element,"dv-splitview-disabled",e)}get margin(){return this._margin}set margin(e){this._margin=e,we(this.element,"dv-splitview-has-margin",e!==0)}constructor(e,n){var i,r;this.container=e,this.viewItems=[],this.sashes=[],this._size=0,this._orthogonalSize=0,this._contentSize=0,this._proportions=void 0,this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this._disabled=!1,this._margin=0,this._onDidSashEnd=new J,this.onDidSashEnd=this._onDidSashEnd.event,this._onDidAddView=new J,this.onDidAddView=this._onDidAddView.event,this._onDidRemoveView=new J,this.onDidRemoveView=this._onDidRemoveView.event,this.resize=(s,a,o=this.viewItems.map(m=>m.size),l,u,c=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,d,p)=>{if(s<0||s>this.viewItems.length)return 0;const m=Un(s,-1),_=Un(s+1,this.viewItems.length);if(u)for(const B of u)lf(m,B),lf(_,B);if(l)for(const B of l)ou(m,B),ou(_,B);const f=m.map(B=>this.viewItems[B]),v=m.map(B=>o[B]),g=_.map(B=>this.viewItems[B]),y=_.map(B=>o[B]),b=m.reduce((B,L)=>B+this.viewItems[L].minimumSize-o[L],0),w=m.reduce((B,L)=>B+this.viewItems[L].maximumSize-o[L],0),x=_.length===0?Number.POSITIVE_INFINITY:_.reduce((B,L)=>B+o[L]-this.viewItems[L].minimumSize,0),k=_.length===0?Number.NEGATIVE_INFINITY:_.reduce((B,L)=>B+o[L]-this.viewItems[L].maximumSize,0),S=Math.max(b,k),E=Math.min(x,w);let A=!1;if(d){const B=this.viewItems[d.index],L=a>=d.limitDelta;A=L!==B.visible,B.setVisible(L,d.size)}if(!A&&p){const B=this.viewItems[p.index],L=a<p.limitDelta;A=L!==B.visible,B.setVisible(L,p.size)}if(A)return this.resize(s,a,o,l,u,c,h);const M=Je(a,S,E);let R=0,P=M;for(let B=0;B<f.length;B++){const L=f[B],j=Je(v[B]+P,L.minimumSize,L.maximumSize),D=j-v[B];R+=D,P-=D,L.size=j}let H=R;for(let B=0;B<g.length;B++){const L=g[B],j=Je(y[B]-H,L.minimumSize,L.maximumSize),D=j-y[B];H+=D,L.size=j}return a},this._orientation=(i=n.orientation)!==null&&i!==void 0?i:ye.VERTICAL,this.element=this.createContainer(),this.margin=(r=n.margin)!==null&&r!==void 0?r:0,this.proportionalLayout=n.proportionalLayout===void 0?!0:!!n.proportionalLayout,this.viewContainer=this.createViewContainer(),this.sashContainer=this.createSashContainer(),this.element.appendChild(this.sashContainer),this.element.appendChild(this.viewContainer),this.container.appendChild(this.element),this.style(n.styles),n.descriptor&&(this._size=n.descriptor.size,n.descriptor.views.forEach((s,a)=>{const o=s.visible===void 0||s.visible?s.size:{type:"invisible",cachedVisibleSize:s.size},l=s.view;this.addView(l,o,a,!0)}),this._contentSize=this.viewItems.reduce((s,a)=>s+a.size,0),this.saveProportions())}style(e){(e==null?void 0:e.separatorBorder)==="transparent"?(il(this.element,"dv-separator-border"),this.element.style.removeProperty("--dv-separator-border")):(ed(this.element,"dv-separator-border"),e!=null&&e.separatorBorder&&this.element.style.setProperty("--dv-separator-border",e.separatorBorder))}isViewVisible(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].visible}setViewVisible(e,n){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");const i=this.viewItems[e];i.setVisible(n,i.size),this.distributeEmptySpace(e),this.layoutViews(),this.saveProportions()}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}resizeView(e,n){if(e<0||e>=this.viewItems.length)return;const i=Un(this.viewItems.length).filter(o=>o!==e),r=[...i.filter(o=>this.viewItems[o].priority===yt.Low),e],s=i.filter(o=>this.viewItems[o].priority===yt.High),a=this.viewItems[e];n=Math.round(n),n=Je(n,a.minimumSize,Math.min(a.maximumSize,this._size)),a.size=n,this.relayout(r,s)}getViews(){return this.viewItems.map(e=>e.view)}onDidChange(e,n){const i=this.viewItems.indexOf(e);if(i<0||i>=this.viewItems.length)return;n=typeof n=="number"?n:e.size,n=Je(n,e.minimumSize,e.maximumSize),e.size=n;const r=Un(this.viewItems.length).filter(o=>o!==i),s=[...r.filter(o=>this.viewItems[o].priority===yt.Low),i],a=r.filter(o=>this.viewItems[o].priority===yt.High);this.relayout([...s,i],a)}addView(e,n={type:"distribute"},i=this.viewItems.length,r){const s=document.createElement("div");s.className="dv-view",s.appendChild(e.element);let a;typeof n=="number"?a=n:n.type==="split"?a=this.getViewSize(n.index)/2:n.type==="invisible"?a={cachedVisibleSize:n.cachedVisibleSize}:a=e.minimumSize;const o=e.onDidChange(u=>this.onDidChange(l,u.size)),l=new VA(s,e,a,{dispose:()=>{o.dispose(),this.viewContainer.removeChild(s)}});if(i===this.viewItems.length?this.viewContainer.appendChild(s):this.viewContainer.insertBefore(s,this.viewContainer.children.item(i)),this.viewItems.splice(i,0,l),this.viewItems.length>1){const u=document.createElement("div");u.className="dv-sash";const c=d=>{for(const B of this.viewItems)B.enabled=!1;const p=Oc(),m=this._orientation===ye.HORIZONTAL?d.clientX:d.clientY,_=WA(this.sashes,B=>B.container===u),f=this.viewItems.map(B=>B.size);let v,g;const y=Un(_,-1),b=Un(_+1,this.viewItems.length),w=y.reduce((B,L)=>B+(this.viewItems[L].minimumSize-f[L]),0),x=y.reduce((B,L)=>B+(this.viewItems[L].viewMaximumSize-f[L]),0),k=b.length===0?Number.POSITIVE_INFINITY:b.reduce((B,L)=>B+(f[L]-this.viewItems[L].minimumSize),0),S=b.length===0?Number.NEGATIVE_INFINITY:b.reduce((B,L)=>B+(f[L]-this.viewItems[L].viewMaximumSize),0),E=Math.max(w,S),A=Math.min(k,x),M=this.findFirstSnapIndex(y),R=this.findFirstSnapIndex(b);if(typeof M=="number"){const B=this.viewItems[M],L=Math.floor(B.viewMinimumSize/2);v={index:M,limitDelta:B.visible?E-L:E+L,size:B.size}}if(typeof R=="number"){const B=this.viewItems[R],L=Math.floor(B.viewMinimumSize/2);g={index:R,limitDelta:B.visible?A+L:A-L,size:B.size}}const P=B=>{const j=(this._orientation===ye.HORIZONTAL?B.clientX:B.clientY)-m;this.resize(_,j,f,void 0,void 0,E,A,v,g),this.distributeEmptySpace(),this.layoutViews()},H=()=>{for(const B of this.viewItems)B.enabled=!0;p.release(),this.saveProportions(),document.removeEventListener("pointermove",P),document.removeEventListener("pointerup",H),document.removeEventListener("pointercancel",H),document.removeEventListener("contextmenu",H),this._onDidSashEnd.fire(void 0)};document.addEventListener("pointermove",P),document.addEventListener("pointerup",H),document.addEventListener("pointercancel",H),document.addEventListener("contextmenu",H)};u.addEventListener("pointerdown",c);const h={container:u,disposable:()=>{u.removeEventListener("pointerdown",c),this.sashContainer.removeChild(u)}};this.sashContainer.appendChild(u),this.sashes.push(h)}r||this.relayout([i]),!r&&typeof n!="number"&&n.type==="distribute"&&this.distributeViewSizes(),this._onDidAddView.fire(e)}distributeViewSizes(){const e=[];let n=0;for(const o of this.viewItems)o.maximumSize-o.minimumSize>0&&(e.push(o),n+=o.size);const i=Math.floor(n/e.length);for(const o of e)o.size=Je(i,o.minimumSize,o.maximumSize);const r=Un(this.viewItems.length),s=r.filter(o=>this.viewItems[o].priority===yt.Low),a=r.filter(o=>this.viewItems[o].priority===yt.High);this.relayout(s,a)}removeView(e,n,i=!1){const r=this.viewItems.splice(e,1)[0];if(r.dispose(),this.viewItems.length>=1){const s=Math.max(e-1,0);this.sashes.splice(s,1)[0].disposable()}return i||this.relayout(),n&&n.type==="distribute"&&this.distributeViewSizes(),this._onDidRemoveView.fire(r.view),r.view}getViewCachedVisibleSize(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].cachedVisibleSize}moveView(e,n){const i=this.getViewCachedVisibleSize(e),r=typeof i>"u"?this.getViewSize(e):Bn.Invisible(i),s=this.removeView(e,void 0,!0);this.addView(s,r,n)}layout(e,n){const i=Math.max(this.size,this._contentSize);if(this.size=e,this.orthogonalSize=n,this.proportions){let r=0;for(let s=0;s<this.viewItems.length;s++){const a=this.viewItems[s],o=this.proportions[s];typeof o=="number"?r+=o:e-=a.size}for(let s=0;s<this.viewItems.length;s++){const a=this.viewItems[s],o=this.proportions[s];typeof o=="number"&&r>0&&(a.size=Je(Math.round(o*e/r),a.minimumSize,a.maximumSize))}}else{const r=Un(this.viewItems.length),s=r.filter(o=>this.viewItems[o].priority===yt.Low),a=r.filter(o=>this.viewItems[o].priority===yt.High);this.resize(this.viewItems.length-1,e-i,void 0,s,a)}this.distributeEmptySpace(),this.layoutViews()}relayout(e,n){const i=this.viewItems.reduce((r,s)=>r+s.size,0);this.resize(this.viewItems.length-1,this._size-i,void 0,e,n),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}distributeEmptySpace(e){const n=this.viewItems.reduce((o,l)=>o+l.size,0);let i=this.size-n;const r=Un(this.viewItems.length-1,-1),s=r.filter(o=>this.viewItems[o].priority===yt.Low),a=r.filter(o=>this.viewItems[o].priority===yt.High);for(const o of a)lf(r,o);for(const o of s)ou(r,o);typeof e=="number"&&ou(r,e);for(let o=0;i!==0&&o<r.length;o++){const l=this.viewItems[r[o]],u=Je(l.size+i,l.minimumSize,l.maximumSize),c=u-l.size;i-=c,l.size=u}}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this._proportions=this.viewItems.map(e=>e.visible?e.size/this._contentSize:void 0))}layoutViews(){if(this._contentSize=this.viewItems.reduce((l,u)=>l+u.size,0),this.updateSashEnablement(),this.viewItems.length===0)return;const e=this.viewItems.filter(l=>l.visible),n=Math.max(0,e.length-1),i=this.margin*n/Math.max(1,e.length);let r=0;const s=[],a=4,o=this.viewItems.reduce((l,u,c)=>{const h=u.visible?1:0;return c===0?l.push(h):l.push(l[c-1]+h),l},[]);this.viewItems.forEach((l,u)=>{r+=this.viewItems[u].size,s.push(r);const c=l.visible?l.size-i:0,h=Math.max(0,o[u]-1),d=u===0||h===0?0:s[u-1]+h/n*i;if(u<this.viewItems.length-1){const p=l.visible?d+c-a/2+this.margin/2:d;this._orientation===ye.HORIZONTAL&&(this.sashes[u].container.style.left=`${p}px`,this.sashes[u].container.style.top="0px"),this._orientation===ye.VERTICAL&&(this.sashes[u].container.style.left="0px",this.sashes[u].container.style.top=`${p}px`)}this._orientation===ye.HORIZONTAL&&(l.container.style.width=`${c}px`,l.container.style.left=`${d}px`,l.container.style.top="",l.container.style.height=""),this._orientation===ye.VERTICAL&&(l.container.style.height=`${c}px`,l.container.style.top=`${d}px`,l.container.style.width="",l.container.style.left=""),l.view.layout(l.size-i,this._orthogonalSize)})}findFirstSnapIndex(e){for(const n of e){const i=this.viewItems[n];if(i.visible&&i.snap)return n}for(const n of e){const i=this.viewItems[n];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return n}}updateSashEnablement(){let e=!1;const n=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),r=[...this.viewItems].reverse();e=!1;const s=r.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const a=r.map(l=>e=l.maximumSize-l.size>0||e).reverse();let o=0;for(let l=0;l<this.sashes.length;l++){const u=this.sashes[l],c=this.viewItems[l];o+=c.size;const h=!(n[l]&&a[l+1]),d=!(i[l]&&s[l+1]);if(h&&d){const p=Un(l,-1),m=Un(l+1,this.viewItems.length),_=this.findFirstSnapIndex(p),f=this.findFirstSnapIndex(m),v=typeof _=="number"&&!this.viewItems[_].visible,g=typeof f=="number"&&!this.viewItems[f].visible;v&&s[l]&&(o>0||this.startSnappingEnabled)?this.updateSash(u,Mn.MINIMUM):g&&n[l]&&(o<this._contentSize||this.endSnappingEnabled)?this.updateSash(u,Mn.MAXIMUM):this.updateSash(u,Mn.DISABLED)}else h&&!d?this.updateSash(u,Mn.MINIMUM):!h&&d?this.updateSash(u,Mn.MAXIMUM):this.updateSash(u,Mn.ENABLED)}}updateSash(e,n){we(e.container,"dv-disabled",n===Mn.DISABLED),we(e.container,"dv-enabled",n===Mn.ENABLED),we(e.container,"dv-maximum",n===Mn.MAXIMUM),we(e.container,"dv-minimum",n===Mn.MINIMUM)}createViewContainer(){const e=document.createElement("div");return e.className="dv-view-container",e}createSashContainer(){const e=document.createElement("div");return e.className="dv-sash-container",e}createContainer(){const e=document.createElement("div"),n=this._orientation===ye.HORIZONTAL?"dv-horizontal":"dv-vertical";return e.className=`dv-split-view-container ${n}`,e}dispose(){this._onDidSashEnd.dispose(),this._onDidAddView.dispose(),this._onDidRemoveView.dispose();for(let e=0;e<this.element.children.length;e++)if(this.element.children.item(e)===this.element){this.element.removeChild(this.element);break}for(const e of this.viewItems)e.dispose();this.element.remove()}}const Zp=Object.keys({orientation:void 0,descriptor:void 0,proportionalLayout:void 0,styles:void 0,margin:void 0,disableAutoResizing:void 0,className:void 0});class F_ extends Se{get onDidAddView(){return this.splitview.onDidAddView}get onDidRemoveView(){return this.splitview.onDidRemoveView}get minimumSize(){return this.splitview.minimumSize}get maximumSize(){return this.splitview.maximumSize}get orientation(){return this.splitview.orientation}get size(){return this.splitview.size}get orthogonalSize(){return this.splitview.orthogonalSize}constructor(e,n){var i;super(),this.paneItems=[],this.skipAnimation=!1,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._orientation=(i=n.orientation)!==null&&i!==void 0?i:ye.VERTICAL,this.element=document.createElement("div"),this.element.className="dv-pane-container",e.appendChild(this.element),this.splitview=new rl(this.element,{orientation:this._orientation,proportionalLayout:!1,descriptor:n.descriptor}),this.getPanes().forEach(r=>{const s=new Se(r.onDidChangeExpansionState(()=>{this.setupAnimation(),this._onDidChange.fire(void 0)})),a={pane:r,disposable:{dispose:()=>{s.dispose()}}};this.paneItems.push(a),r.orthogonalSize=this.splitview.orthogonalSize}),this.addDisposables(this._onDidChange,this.splitview.onDidSashEnd(()=>{this._onDidChange.fire(void 0)}),this.splitview.onDidAddView(()=>{this._onDidChange.fire()}),this.splitview.onDidRemoveView(()=>{this._onDidChange.fire()}))}setViewVisible(e,n){this.splitview.setViewVisible(e,n)}addPane(e,n,i=this.splitview.length,r=!1){const s=e.onDidChangeExpansionState(()=>{this.setupAnimation(),this._onDidChange.fire(void 0)}),a={pane:e,disposable:{dispose:()=>{s.dispose()}}};this.paneItems.splice(i,0,a),e.orthogonalSize=this.splitview.orthogonalSize,this.splitview.addView(e,n,i,r)}getViewSize(e){return this.splitview.getViewSize(e)}getPanes(){return this.splitview.getViews()}removePane(e,n={skipDispose:!1}){const i=this.paneItems.splice(e,1)[0];return this.splitview.removeView(e),n.skipDispose||(i.disposable.dispose(),i.pane.dispose()),i}moveView(e,n){if(e===n)return;const i=this.removePane(e,{skipDispose:!0});this.skipAnimation=!0;try{this.addPane(i.pane,i.pane.size,n,!1)}finally{this.skipAnimation=!1}}layout(e,n){this.splitview.layout(e,n)}setupAnimation(){this.skipAnimation||(this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=void 0),ed(this.element,"dv-animated"),this.animationTimer=setTimeout(()=>{this.animationTimer=void 0,il(this.element,"dv-animated")},200))}dispose(){super.dispose(),this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=void 0),this.paneItems.forEach(e=>{e.disposable.dispose(),e.pane.dispose()}),this.paneItems=[],this.splitview.dispose(),this.element.remove()}}class Ct{get minimumWidth(){return this.view.minimumWidth}get maximumWidth(){return this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get priority(){return this.view.priority}get snap(){return this.view.snap}get minimumSize(){return this.orientation===ye.HORIZONTAL?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===ye.HORIZONTAL?this.maximumHeight:this.maximumWidth}get minimumOrthogonalSize(){return this.orientation===ye.HORIZONTAL?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===ye.HORIZONTAL?this.maximumWidth:this.maximumHeight}get orthogonalSize(){return this._orthogonalSize}get size(){return this._size}get element(){return this.view.element}get width(){return this.orientation===ye.HORIZONTAL?this.orthogonalSize:this.size}get height(){return this.orientation===ye.HORIZONTAL?this.size:this.orthogonalSize}constructor(e,n,i,r=0){this.view=e,this.orientation=n,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._orthogonalSize=i,this._size=r,this._disposable=this.view.onDidChange(s=>{s?this._onDidChange.fire({size:this.orientation===ye.VERTICAL?s.width:s.height,orthogonalSize:this.orientation===ye.VERTICAL?s.height:s.width}):this._onDidChange.fire({})})}setVisible(e){this.view.setVisible&&this.view.setVisible(e)}layout(e,n){this._size=e,this._orthogonalSize=n,this.view.layout(this.width,this.height)}dispose(){this._onDidChange.dispose(),this._disposable.dispose()}}class ot extends Se{get width(){return this.orientation===ye.HORIZONTAL?this.size:this.orthogonalSize}get height(){return this.orientation===ye.HORIZONTAL?this.orthogonalSize:this.size}get minimumSize(){return this.children.length===0?0:Math.max(...this.children.map((e,n)=>this.splitview.isViewVisible(n)?e.minimumOrthogonalSize:0))}get maximumSize(){return Math.min(...this.children.map((e,n)=>this.splitview.isViewVisible(n)?e.maximumOrthogonalSize:Number.POSITIVE_INFINITY))}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get orthogonalSize(){return this._orthogonalSize}get size(){return this._size}get minimumWidth(){return this.orientation===ye.HORIZONTAL?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===ye.HORIZONTAL?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===ye.HORIZONTAL?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===ye.HORIZONTAL?this.maximumSize:this.maximumOrthogonalSize}get priority(){if(this.children.length===0)return yt.Normal;const e=this.children.map(n=>typeof n.priority>"u"?yt.Normal:n.priority);return e.some(n=>n===yt.High)?yt.High:e.some(n=>n===yt.Low)?yt.Low:yt.Normal}get disabled(){return this.splitview.disabled}set disabled(e){this.splitview.disabled=e}get margin(){return this.splitview.margin}set margin(e){this.splitview.margin=e,this.children.forEach(n=>{n instanceof ot&&(n.margin=e)})}constructor(e,n,i,r,s,a,o,l){if(super(),this.orientation=e,this.proportionalLayout=n,this.styles=i,this._childrenDisposable=pt.NONE,this.children=[],this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._onDidVisibilityChange=new J,this.onDidVisibilityChange=this._onDidVisibilityChange.event,this._orthogonalSize=s,this._size=r,this.element=document.createElement("div"),this.element.className="dv-branch-node",!l)this.splitview=new rl(this.element,{orientation:this.orientation,proportionalLayout:n,styles:i,margin:o}),this.splitview.layout(this.size,this.orthogonalSize);else{const u={views:l.map(c=>({view:c.node,size:c.node.size,visible:c.node instanceof Ct&&c.visible!==void 0?c.visible:!0})),size:this.orthogonalSize};this.children=l.map(c=>c.node),this.splitview=new rl(this.element,{orientation:this.orientation,descriptor:u,proportionalLayout:n,styles:i,margin:o})}this.disabled=a,this.addDisposables(this._onDidChange,this._onDidVisibilityChange,this.splitview.onDidSashEnd(()=>{this._onDidChange.fire({})})),this.setupChildrenEvents()}setVisible(e){}isChildVisible(e){if(e<0||e>=this.children.length)throw new Error("Invalid index");return this.splitview.isViewVisible(e)}setChildVisible(e,n){if(e<0||e>=this.children.length)throw new Error("Invalid index");if(this.splitview.isViewVisible(e)===n)return;const i=this.splitview.contentSize===0;this.splitview.setViewVisible(e,n);const r=this.splitview.contentSize===0;(n&&i||!n&&r)&&this._onDidVisibilityChange.fire({visible:n})}moveChild(e,n){if(e===n)return;if(e<0||e>=this.children.length)throw new Error("Invalid from index");e<n&&n--,this.splitview.moveView(e,n);const i=this._removeChild(e);this._addChild(i,n)}getChildSize(e){if(e<0||e>=this.children.length)throw new Error("Invalid index");return this.splitview.getViewSize(e)}resizeChild(e,n){if(e<0||e>=this.children.length)throw new Error("Invalid index");this.splitview.resizeView(e,n)}layout(e,n){this._size=n,this._orthogonalSize=e,this.splitview.layout(n,e)}addChild(e,n,i,r){if(i<0||i>this.children.length)throw new Error("Invalid index");this.splitview.addView(e,n,i,r),this._addChild(e,i)}getChildCachedVisibleSize(e){if(e<0||e>=this.children.length)throw new Error("Invalid index");return this.splitview.getViewCachedVisibleSize(e)}removeChild(e,n){if(e<0||e>=this.children.length)throw new Error("Invalid index");return this.splitview.removeView(e,n),this._removeChild(e)}_addChild(e,n){this.children.splice(n,0,e),this.setupChildrenEvents()}_removeChild(e){const[n]=this.children.splice(e,1);return this.setupChildrenEvents(),n}setupChildrenEvents(){this._childrenDisposable.dispose(),this._childrenDisposable=new Se(hs.any(...this.children.map(e=>e.onDidChange))(e=>{this._onDidChange.fire({size:e.orthogonalSize})}),...this.children.map((e,n)=>e instanceof ot?e.onDidVisibilityChange(({visible:i})=>{this.setChildVisible(n,i)}):pt.NONE))}dispose(){this._childrenDisposable.dispose(),this.splitview.dispose(),this.children.forEach(e=>e.dispose()),super.dispose()}}function Yp(t,e){if(t instanceof Ct)return t;if(t instanceof ot)return Yp(t.children[e?t.children.length-1:0],e);throw new Error("invalid node")}function hx(t,e,n){if(t instanceof ot){const i=new ot(t.orientation,t.proportionalLayout,t.styles,e,n,t.disabled,t.margin);for(let r=t.children.length-1;r>=0;r--){const s=t.children[r];i.addChild(hx(s,s.size,s.orthogonalSize),s.size,0,!0)}return i}else return new Ct(t.view,t.orientation,n)}function Xp(t,e,n){if(t instanceof ot){const i=new ot(pi(t.orientation),t.proportionalLayout,t.styles,e,n,t.disabled,t.margin);let r=0;for(let s=t.children.length-1;s>=0;s--){const a=t.children[s],o=a instanceof ot?a.orthogonalSize:a.size;let l=t.size===0?0:Math.round(e*o/t.size);r+=l,s===0&&(l+=e-r),i.addChild(Xp(a,n,l),l,0,!0)}return i}else return new Ct(t.view,pi(t.orientation),n)}function GA(t){const e=t.parentElement;if(!e)throw new Error("Invalid grid element");let n=e.firstElementChild,i=0;for(;n!==t&&n!==e.lastElementChild&&n;)n=n.nextElementSibling,i++;return i}function et(t){const e=t.parentElement;if(!e)throw new Error("Invalid grid element");if(/\bdv-grid-view\b/.test(e.className))return[];const n=GA(e),i=e.parentElement.parentElement.parentElement;return[...et(i),n]}function hi(t,e,n){const i=qA(t,e),r=UA(n);if(i===r){const[s,a]=Bi(e);let o=a;return(n==="right"||n==="bottom")&&(o+=1),[...s,o]}else{const s=n==="right"||n==="bottom"?1:0;return[...e,s]}}function UA(t){return t==="top"||t==="bottom"?ye.VERTICAL:ye.HORIZONTAL}function qA(t,e){return e.length%2===0?pi(t):t}const pi=t=>t===ye.HORIZONTAL?ye.VERTICAL:ye.HORIZONTAL;function KA(t){return!!t.children}const Qp=(t,e)=>{const n=e===ye.VERTICAL?t.box.width:t.box.height;return KA(t)?{type:"branch",data:t.children.map(i=>Qp(i,pi(e))),size:n}:typeof t.cachedVisibleSize=="number"?{type:"leaf",data:t.view.toJSON(),size:t.cachedVisibleSize,visible:!1}:{type:"leaf",data:t.view.toJSON(),size:n}};class JA{get length(){return this._root?this._root.children.length:0}get orientation(){return this.root.orientation}set orientation(e){if(this.root.orientation===e)return;const{size:n,orthogonalSize:i}=this.root;this.root=Xp(this.root,i,n),this.root.layout(n,i)}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get locked(){return this._locked}set locked(e){this._locked=e;const n=[this.root];for(;n.length>0;){const i=n.pop();i instanceof ot&&(i.disabled=e,n.push(...i.children))}}get margin(){return this._margin}set margin(e){this._margin=e,this.root.margin=e}maximizedView(){var e;return(e=this._maximizedNode)===null||e===void 0?void 0:e.leaf.view}hasMaximizedView(){return this._maximizedNode!==void 0}maximizeView(e){var n;const i=et(e.element),[r,s]=this.getNode(i);if(!(s instanceof Ct)||((n=this._maximizedNode)===null||n===void 0?void 0:n.leaf)===s)return;this.hasMaximizedView()&&this.exitMaximizedView(),Qp(this.getView(),this.orientation);const a=[];function o(l,u){for(let c=0;c<l.children.length;c++){const h=l.children[c];h instanceof Ct?h!==u&&(l.isChildVisible(c)?l.setChildVisible(c,!1):a.push(h)):o(h,u)}}o(this.root,s),this._maximizedNode={leaf:s,hiddenOnMaximize:a},this._onDidMaximizedNodeChange.fire({view:s.view,isMaximized:!0})}exitMaximizedView(){if(!this._maximizedNode)return;const e=this._maximizedNode.hiddenOnMaximize;function n(r){for(let s=r.children.length-1;s>=0;s--){const a=r.children[s];a instanceof Ct?e.includes(a)||r.setChildVisible(s,!0):n(a)}}n(this.root);const i=this._maximizedNode.leaf;this._maximizedNode=void 0,this._onDidMaximizedNodeChange.fire({view:i.view,isMaximized:!1})}serialize(){const e=this.maximizedView();let n;e&&(n=et(e.element)),this.hasMaximizedView()&&this.exitMaximizedView();const r={root:Qp(this.getView(),this.orientation),width:this.width,height:this.height,orientation:this.orientation};return n&&(r.maximizedNode={location:n}),e&&this.maximizeView(e),r}dispose(){this.disposable.dispose(),this._onDidChange.dispose(),this._onDidMaximizedNodeChange.dispose(),this._onDidViewVisibilityChange.dispose(),this.root.dispose(),this._maximizedNode=void 0,this.element.remove()}clear(){const e=this.root.orientation;this.root=new ot(e,this.proportionalLayout,this.styles,this.root.size,this.root.orthogonalSize,this.locked,this.margin)}deserialize(e,n){const i=e.orientation,r=i===ye.VERTICAL?e.height:e.width;if(this._deserialize(e.root,i,n,r),this.layout(e.width,e.height),e.maximizedNode){const s=e.maximizedNode.location,[a,o]=this.getNode(s);if(!(o instanceof Ct))return;this.maximizeView(o.view)}}_deserialize(e,n,i,r){this.root=this._deserializeNode(e,n,i,r)}_deserializeNode(e,n,i,r){var s;let a;if(e.type==="branch"){const l=e.data.map(u=>({node:this._deserializeNode(u,pi(n),i,e.size),visible:u.visible}));a=new ot(n,this.proportionalLayout,this.styles,e.size,r,this.locked,this.margin,l)}else{const o=i.fromJSON(e);typeof e.visible=="boolean"&&((s=o.setVisible)===null||s===void 0||s.call(o,e.visible)),a=new Ct(o,n,r,e.size)}return a}get root(){return this._root}set root(e){const n=this._root;n&&(n.dispose(),this._maximizedNode=void 0,this.element.removeChild(n.element)),this._root=e,this.element.appendChild(this._root.element),this.disposable.value=this._root.onDidChange(i=>{this._onDidChange.fire(i)})}normalize(){if(!this._root||this._root.children.length!==1)return;const e=this.root,n=e.children[0];if(n instanceof Ct)return;e.element.remove();const i=e.removeChild(0);e.dispose(),i.dispose(),this._root=hx(n,n.size,n.orthogonalSize),this.element.appendChild(this._root.element),this.disposable.value=this._root.onDidChange(r=>{this._onDidChange.fire(r)})}insertOrthogonalSplitviewAtRoot(){if(!this._root)return;const e=this.root;if(e.element.remove(),this._root=new ot(pi(e.orientation),this.proportionalLayout,this.styles,this.root.orthogonalSize,this.root.size,this.locked,this.margin),e.children.length!==0)if(e.children.length===1){const n=e.children[0];e.removeChild(0).dispose(),e.dispose(),this._root.addChild(Xp(n,n.orthogonalSize,n.size),Bn.Distribute,0)}else this._root.addChild(e,Bn.Distribute,0);this.element.appendChild(this._root.element),this.disposable.value=this._root.onDidChange(n=>{this._onDidChange.fire(n)})}next(e){return this.progmaticSelect(e)}previous(e){return this.progmaticSelect(e,!0)}getView(e){const n=e?this.getNode(e)[1]:this.root;return this._getViews(n,this.orientation)}_getViews(e,n,i){const r={height:e.height,width:e.width};if(e instanceof Ct)return{box:r,view:e.view,cachedVisibleSize:i};const s=[];for(let a=0;a<e.children.length;a++){const o=e.children[a],l=e.getChildCachedVisibleSize(a);s.push(this._getViews(o,pi(n),l))}return{box:r,children:s}}progmaticSelect(e,n=!1){const[i,r]=this.getNode(e);if(!(r instanceof Ct))throw new Error("invalid location");for(let s=i.length-1;s>-1;s--){const a=i[s],o=e[s]||0;if(n?o-1>-1:o+1<a.children.length)return Yp(a.children[n?o-1:o+1],n)}return Yp(this.root,n)}constructor(e,n,i,r,s){this.proportionalLayout=e,this.styles=n,this._locked=!1,this._margin=0,this._maximizedNode=void 0,this.disposable=new qt,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._onDidViewVisibilityChange=new J,this.onDidViewVisibilityChange=this._onDidViewVisibilityChange.event,this._onDidMaximizedNodeChange=new J,this.onDidMaximizedNodeChange=this._onDidMaximizedNodeChange.event,this.element=document.createElement("div"),this.element.className="dv-grid-view",this._locked=r??!1,this._margin=s??0,this.root=new ot(i,e,n,0,0,this.locked,this.margin)}isViewVisible(e){const[n,i]=Bi(e),[,r]=this.getNode(n);if(!(r instanceof ot))throw new Error("Invalid from location");return r.isChildVisible(i)}setViewVisible(e,n){this.hasMaximizedView()&&this.exitMaximizedView();const[i,r]=Bi(e),[,s]=this.getNode(i);if(!(s instanceof ot))throw new Error("Invalid from location");this._onDidViewVisibilityChange.fire(),s.setChildVisible(r,n)}moveView(e,n,i){this.hasMaximizedView()&&this.exitMaximizedView();const[,r]=this.getNode(e);if(!(r instanceof ot))throw new Error("Invalid location");r.moveChild(n,i)}addView(e,n,i){this.hasMaximizedView()&&this.exitMaximizedView();const[r,s]=Bi(i),[a,o]=this.getNode(r);if(o instanceof ot){const l=new Ct(e,pi(o.orientation),o.orthogonalSize);o.addChild(l,n,s)}else{const[l,...u]=[...a].reverse(),[c,...h]=[...r].reverse();let d=0;const p=l.getChildCachedVisibleSize(c);typeof p=="number"&&(d=Bn.Invisible(p)),l.removeChild(c).dispose();const _=new ot(o.orientation,this.proportionalLayout,this.styles,o.size,o.orthogonalSize,this.locked,this.margin);l.addChild(_,o.size,c);const f=new Ct(o.view,l.orientation,o.size);_.addChild(f,d,0),typeof n!="number"&&n.type==="split"&&(n={type:"split",index:0});const v=new Ct(e,l.orientation,o.size);_.addChild(v,n,s)}}remove(e,n){const i=et(e.element);return this.removeView(i,n)}removeView(e,n){this.hasMaximizedView()&&this.exitMaximizedView();const[i,r]=Bi(e),[s,a]=this.getNode(i);if(!(a instanceof ot))throw new Error("Invalid location");const o=a.children[r];if(!(o instanceof Ct))throw new Error("Invalid location");if(a.removeChild(r,n),o.dispose(),a.children.length!==1)return o.view;const l=a.children[0];if(s.length===0)return l instanceof Ct||(a.removeChild(0,n),this.root=l),o.view;const[u,...c]=[...s].reverse(),[h,...d]=[...i].reverse(),p=a.isChildVisible(0);a.removeChild(0,n);const m=u.children.map((_,f)=>u.getChildSize(f));if(u.removeChild(h,n).dispose(),l instanceof ot){m.splice(h,1,...l.children.map(_=>_.size));for(let _=0;_<l.children.length;_++){const f=l.children[_];u.addChild(f,f.size,h+_)}for(;l.children.length>0;)l.removeChild(0)}else{const _=new Ct(l.view,pi(l.orientation),l.size),f=p?l.orthogonalSize:Bn.Invisible(l.orthogonalSize);u.addChild(_,f,h)}l.dispose();for(let _=0;_<m.length;_++)u.resizeChild(_,m[_]);return o.view}layout(e,n){const[i,r]=this.root.orientation===ye.HORIZONTAL?[n,e]:[e,n];this.root.layout(i,r)}getNode(e,n=this.root,i=[]){if(e.length===0)return[i,n];if(!(n instanceof ot))throw new Error("Invalid location");const[r,...s]=e;if(r<0||r>=n.children.length)throw new Error("Invalid location");const a=n.children[r];return i.push(n),this.getNode(s,a,i)}}const em=Object.keys({disableAutoResizing:void 0,proportionalLayout:void 0,orientation:void 0,hideBorders:void 0,className:void 0});class eg extends Se{get element(){return this._element}get disableResizing(){return this._disableResizing}set disableResizing(e){this._disableResizing=e}constructor(e,n=!1){super(),this._disableResizing=n,this._element=e,this.addDisposables(Qh(this._element,i=>{if(this.isDisposed||this.disableResizing||!this._element.offsetParent||!NA(this._element))return;const{width:r,height:s}=i.contentRect;this.layout(r,s)}))}}const ZA=Q0();function Pc(t){switch(t){case"left":return"left";case"right":return"right";case"above":return"top";case"below":return"bottom";case"within":default:return"center"}}class dx extends eg{get id(){return this._id}get size(){return this._groups.size}get groups(){return Array.from(this._groups.values()).map(e=>e.value)}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumHeight(){return this.gridview.minimumHeight}get maximumHeight(){return this.gridview.maximumHeight}get minimumWidth(){return this.gridview.minimumWidth}get maximumWidth(){return this.gridview.maximumWidth}get activeGroup(){return this._activeGroup}get locked(){return this.gridview.locked}set locked(e){this.gridview.locked=e}constructor(e,n){var i;super(document.createElement("div"),n.disableAutoResizing),this._id=ZA.next(),this._groups=new Map,this._onDidRemove=new J,this.onDidRemove=this._onDidRemove.event,this._onDidAdd=new J,this.onDidAdd=this._onDidAdd.event,this._onDidMaximizedChange=new J,this.onDidMaximizedChange=this._onDidMaximizedChange.event,this._onDidActiveChange=new J,this.onDidActiveChange=this._onDidActiveChange.event,this._bufferOnDidLayoutChange=new B_,this.onDidLayoutChange=this._bufferOnDidLayoutChange.onEvent,this._onDidViewVisibilityChangeMicroTaskQueue=new B_,this.onDidViewVisibilityChangeMicroTaskQueue=this._onDidViewVisibilityChangeMicroTaskQueue.onEvent,this.element.style.height="100%",this.element.style.width="100%",this._classNames=new td(this.element),this._classNames.setClassNames((i=n.className)!==null&&i!==void 0?i:""),e.appendChild(this.element),this.gridview=new JA(!!n.proportionalLayout,n.styles,n.orientation,n.locked,n.margin),this.gridview.locked=!!n.locked,this.element.appendChild(this.gridview.element),this.layout(0,0,!0),this.addDisposables(this.gridview.onDidMaximizedNodeChange(r=>{this._onDidMaximizedChange.fire({panel:r.view,isMaximized:r.isMaximized})}),this.gridview.onDidViewVisibilityChange(()=>this._onDidViewVisibilityChangeMicroTaskQueue.fire()),this.onDidViewVisibilityChangeMicroTaskQueue(()=>{this.layout(this.width,this.height,!0)}),pt.from(()=>{var r;(r=this.element.parentElement)===null||r===void 0||r.removeChild(this.element)}),this.gridview.onDidChange(()=>{this._bufferOnDidLayoutChange.fire()}),hs.any(this.onDidAdd,this.onDidRemove,this.onDidActiveChange)(()=>{this._bufferOnDidLayoutChange.fire()}),this._onDidMaximizedChange,this._onDidViewVisibilityChangeMicroTaskQueue,this._bufferOnDidLayoutChange)}setVisible(e,n){this.gridview.setViewVisible(et(e.element),n),this._bufferOnDidLayoutChange.fire()}isVisible(e){return this.gridview.isViewVisible(et(e.element))}updateOptions(e){var n,i,r,s;e.proportionalLayout,e.orientation&&(this.gridview.orientation=e.orientation),"disableResizing"in e&&(this.disableResizing=(n=e.disableAutoResizing)!==null&&n!==void 0?n:!1),"locked"in e&&(this.locked=(i=e.locked)!==null&&i!==void 0?i:!1),"margin"in e&&(this.gridview.margin=(r=e.margin)!==null&&r!==void 0?r:0),"className"in e&&this._classNames.setClassNames((s=e.className)!==null&&s!==void 0?s:"")}maximizeGroup(e){this.gridview.maximizeView(e),this.doSetGroupActive(e)}isMaximizedGroup(e){return this.gridview.maximizedView()===e}exitMaximizedGroup(){this.gridview.exitMaximizedView()}hasMaximizedGroup(){return this.gridview.hasMaximizedView()}doAddGroup(e,n=[0],i){this.gridview.addView(e,i??Bn.Distribute,n),this._onDidAdd.fire(e)}doRemoveGroup(e,n){if(!this._groups.has(e.id))throw new Error("invalid operation");const i=this._groups.get(e.id),r=this.gridview.remove(e,Bn.Distribute);if(i&&!(n!=null&&n.skipDispose)&&(i.disposable.dispose(),i.value.dispose(),this._groups.delete(e.id),this._onDidRemove.fire(e)),!(n!=null&&n.skipActive)&&this._activeGroup===e){const s=Array.from(this._groups.values());this.doSetGroupActive(s.length>0?s[0].value:void 0)}return r}getPanel(e){var n;return(n=this._groups.get(e))===null||n===void 0?void 0:n.value}doSetGroupActive(e){this._activeGroup!==e&&(this._activeGroup&&this._activeGroup.setActive(!1),e&&e.setActive(!0),this._activeGroup=e,this._onDidActiveChange.fire(e))}removeGroup(e){this.doRemoveGroup(e)}moveToNext(e){var n;if(e||(e={}),!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}const i=et(e.group.element),r=(n=this.gridview.next(i))===null||n===void 0?void 0:n.view;this.doSetGroupActive(r)}moveToPrevious(e){var n;if(e||(e={}),!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}const i=et(e.group.element),r=(n=this.gridview.previous(i))===null||n===void 0?void 0:n.view;this.doSetGroupActive(r)}layout(e,n,i){(i||e!==this.width||n!==this.height)&&(this.gridview.element.style.height=`${n}px`,this.gridview.element.style.width=`${e}px`,this.gridview.layout(e,n))}dispose(){this._onDidActiveChange.dispose(),this._onDidAdd.dispose(),this._onDidRemove.dispose();for(const e of this.groups)e.dispose();this.gridview.dispose(),super.dispose()}}class fx{get minimumSize(){return this.component.minimumSize}get maximumSize(){return this.component.maximumSize}get width(){return this.component.width}get height(){return this.component.height}get length(){return this.component.length}get orientation(){return this.component.orientation}get panels(){return this.component.panels}get onDidLayoutFromJSON(){return this.component.onDidLayoutFromJSON}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidAddView(){return this.component.onDidAddView}get onDidRemoveView(){return this.component.onDidRemoveView}constructor(e){this.component=e}removePanel(e,n){this.component.removePanel(e,n)}focus(){this.component.focus()}getPanel(e){return this.component.getPanel(e)}layout(e,n){return this.component.layout(e,n)}addPanel(e){return this.component.addPanel(e)}movePanel(e,n){this.component.movePanel(e,n)}fromJSON(e){this.component.fromJSON(e)}toJSON(){return this.component.toJSON()}clear(){this.component.clear()}updateOptions(e){this.component.updateOptions(e)}dispose(){this.component.dispose()}}class sl{get minimumSize(){return this.component.minimumSize}get maximumSize(){return this.component.maximumSize}get width(){return this.component.width}get height(){return this.component.height}get panels(){return this.component.panels}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidLayoutFromJSON(){return this.component.onDidLayoutFromJSON}get onDidAddView(){return this.component.onDidAddView}get onDidRemoveView(){return this.component.onDidRemoveView}get onDidDrop(){return this.component.onDidDrop}get onUnhandledDragOverEvent(){return this.component.onUnhandledDragOverEvent}constructor(e){this.component=e}removePanel(e){this.component.removePanel(e)}getPanel(e){return this.component.getPanel(e)}movePanel(e,n){this.component.movePanel(e,n)}focus(){this.component.focus()}layout(e,n){this.component.layout(e,n)}addPanel(e){return this.component.addPanel(e)}fromJSON(e){this.component.fromJSON(e)}toJSON(){return this.component.toJSON()}clear(){this.component.clear()}updateOptions(e){this.component.updateOptions(e)}dispose(){this.component.dispose()}}class px{get width(){return this.component.width}get height(){return this.component.height}get minimumHeight(){return this.component.minimumHeight}get maximumHeight(){return this.component.maximumHeight}get minimumWidth(){return this.component.minimumWidth}get maximumWidth(){return this.component.maximumWidth}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidAddPanel(){return this.component.onDidAddGroup}get onDidRemovePanel(){return this.component.onDidRemoveGroup}get onDidActivePanelChange(){return this.component.onDidActiveGroupChange}get onDidLayoutFromJSON(){return this.component.onDidLayoutFromJSON}get panels(){return this.component.groups}get orientation(){return this.component.orientation}set orientation(e){this.component.updateOptions({orientation:e})}constructor(e){this.component=e}focus(){this.component.focus()}layout(e,n,i=!1){this.component.layout(e,n,i)}addPanel(e){return this.component.addPanel(e)}removePanel(e,n){this.component.removePanel(e,n)}movePanel(e,n){this.component.movePanel(e,n)}getPanel(e){return this.component.getPanel(e)}fromJSON(e){return this.component.fromJSON(e)}toJSON(){return this.component.toJSON()}clear(){this.component.clear()}updateOptions(e){this.component.updateOptions(e)}dispose(){this.component.dispose()}}class Nc{get id(){return this.component.id}get width(){return this.component.width}get height(){return this.component.height}get minimumHeight(){return this.component.minimumHeight}get maximumHeight(){return this.component.maximumHeight}get minimumWidth(){return this.component.minimumWidth}get maximumWidth(){return this.component.maximumWidth}get size(){return this.component.size}get totalPanels(){return this.component.totalPanels}get onDidActiveGroupChange(){return this.component.onDidActiveGroupChange}get onDidAddGroup(){return this.component.onDidAddGroup}get onDidRemoveGroup(){return this.component.onDidRemoveGroup}get onDidActivePanelChange(){return this.component.onDidActivePanelChange}get onDidAddPanel(){return this.component.onDidAddPanel}get onDidRemovePanel(){return this.component.onDidRemovePanel}get onDidMovePanel(){return this.component.onDidMovePanel}get onDidLayoutFromJSON(){return this.component.onDidLayoutFromJSON}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidDrop(){return this.component.onDidDrop}get onWillDrop(){return this.component.onWillDrop}get onWillShowOverlay(){return this.component.onWillShowOverlay}get onWillDragGroup(){return this.component.onWillDragGroup}get onWillDragPanel(){return this.component.onWillDragPanel}get onUnhandledDragOverEvent(){return this.component.onUnhandledDragOverEvent}get onDidPopoutGroupSizeChange(){return this.component.onDidPopoutGroupSizeChange}get onDidPopoutGroupPositionChange(){return this.component.onDidPopoutGroupPositionChange}get onDidOpenPopoutWindowFail(){return this.component.onDidOpenPopoutWindowFail}get panels(){return this.component.panels}get groups(){return this.component.groups}get activePanel(){return this.component.activePanel}get activeGroup(){return this.component.activeGroup}constructor(e){this.component=e}focus(){this.component.focus()}getPanel(e){return this.component.getGroupPanel(e)}layout(e,n,i=!1){this.component.layout(e,n,i)}addPanel(e){return this.component.addPanel(e)}removePanel(e){this.component.removePanel(e)}addGroup(e){return this.component.addGroup(e)}closeAllGroups(){return this.component.closeAllGroups()}removeGroup(e){this.component.removeGroup(e)}getGroup(e){return this.component.getPanel(e)}addFloatingGroup(e,n){return this.component.addFloatingGroup(e,n)}fromJSON(e,n){this.component.fromJSON(e,n)}toJSON(){return this.component.toJSON()}clear(){this.component.clear()}moveToNext(e){this.component.moveToNext(e)}moveToPrevious(e){this.component.moveToPrevious(e)}maximizeGroup(e){this.component.maximizeGroup(e.group)}hasMaximizedGroup(){return this.component.hasMaximizedGroup()}exitMaximizedGroup(){this.component.exitMaximizedGroup()}get onDidMaximizedGroupChange(){return this.component.onDidMaximizedGroupChange}addPopoutGroup(e,n){return this.component.addPopoutGroup(e,n)}updateOptions(e){this.component.updateOptions(e)}dispose(){this.component.dispose()}}class tg extends Se{constructor(e,n){super(),this.el=e,this.disabled=n,this.dataDisposable=new qt,this.pointerEventsDisposable=new qt,this._onDragStart=new J,this.onDragStart=this._onDragStart.event,this.addDisposables(this._onDragStart,this.dataDisposable,this.pointerEventsDisposable),this.configure()}setDisabled(e){this.disabled=e}isCancelled(e){return!1}configure(){this.addDisposables(this._onDragStart,Me(this.el,"dragstart",e=>{if(e.defaultPrevented||this.isCancelled(e)||this.disabled){e.preventDefault();return}const n=Oc();this.pointerEventsDisposable.value={dispose:()=>{n.release()}},this.el.classList.add("dv-dragged"),setTimeout(()=>this.el.classList.remove("dv-dragged"),0),this.dataDisposable.value=this.getData(e),this._onDragStart.fire(e),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.items.length>0||e.dataTransfer.setData("text/plain",""))}),Me(this.el,"dragend",()=>{this.pointerEventsDisposable.dispose(),setTimeout(()=>{this.dataDisposable.dispose()},0)}))}}class mx extends Se{constructor(e,n){super(),this.element=e,this.callbacks=n,this.target=null,this.registerListeners()}onDragEnter(e){this.target=e.target,this.callbacks.onDragEnter(e)}onDragOver(e){e.preventDefault(),this.callbacks.onDragOver&&this.callbacks.onDragOver(e)}onDragLeave(e){this.target===e.target&&(this.target=null,this.callbacks.onDragLeave(e))}onDragEnd(e){this.target=null,this.callbacks.onDragEnd(e)}onDrop(e){this.callbacks.onDrop(e)}registerListeners(){this.addDisposables(Me(this.element,"dragenter",e=>{this.onDragEnter(e)},!0)),this.addDisposables(Me(this.element,"dragover",e=>{this.onDragOver(e)},!0)),this.addDisposables(Me(this.element,"dragleave",e=>{this.onDragLeave(e)})),this.addDisposables(Me(this.element,"dragend",e=>{this.onDragEnd(e)})),this.addDisposables(Me(this.element,"drop",e=>{this.onDrop(e)}))}}function YA(t,e){const{top:n,left:i,width:r,height:s}=e,a=`${Math.round(n)}px`,o=`${Math.round(i)}px`,l=`${Math.round(r)}px`,u=`${Math.round(s)}px`;t.style.top=a,t.style.left=o,t.style.width=l,t.style.height=u,t.style.visibility="visible",(!t.style.transform||t.style.transform==="")&&(t.style.transform="translate3d(0, 0, 0)")}function XA(t,e){const{top:n,left:i,width:r,height:s}=e;t.style.top=n,t.style.left=i,t.style.width=r,t.style.height=s,t.style.visibility="visible",(!t.style.transform||t.style.transform==="")&&(t.style.transform="translate3d(0, 0, 0)")}function QA(t,e){const{top:n,left:i,width:r,height:s}=e,a=`${Math.round(n)}px`,o=`${Math.round(i)}px`,l=`${Math.round(r)}px`,u=`${Math.round(s)}px`;return t.style.top!==a||t.style.left!==o||t.style.width!==l||t.style.height!==u}class eT extends X0{get nativeEvent(){return this.options.nativeEvent}get position(){return this.options.position}constructor(e){super(),this.options=e}}function j_(t){switch(t){case"above":return"top";case"below":return"bottom";case"left":return"left";case"right":return"right";case"within":return"center";default:throw new Error(`invalid direction '${t}'`)}}function tT(t){switch(t){case"top":return"above";case"bottom":return"below";case"left":return"left";case"right":return"right";case"center":return"within";default:throw new Error(`invalid position '${t}'`)}}const nT={value:20,type:"percentage"},iT={value:50,type:"percentage"},rT=100,sT=100;class Xn extends Se{get disabled(){return this._disabled}set disabled(e){this._disabled=e}get state(){return this._state}constructor(e,n){super(),this.element=e,this.options=n,this._onDrop=new J,this.onDrop=this._onDrop.event,this._onWillShowOverlay=new J,this.onWillShowOverlay=this._onWillShowOverlay.event,this._disabled=!1,this._acceptedTargetZonesSet=new Set(this.options.acceptedTargetZones),this.dnd=new mx(this.element,{onDragEnter:()=>{var i,r,s;(s=(r=(i=this.options).getOverrideTarget)===null||r===void 0?void 0:r.call(i))===null||s===void 0||s.getElements()},onDragOver:i=>{var r,s,a,o,l,u,c;Xn.ACTUAL_TARGET=this;const h=(s=(r=this.options).getOverrideTarget)===null||s===void 0?void 0:s.call(r);if(this._acceptedTargetZonesSet.size===0){if(h)return;this.removeDropTarget();return}const d=(l=(o=(a=this.options).getOverlayOutline)===null||o===void 0?void 0:o.call(a))!==null&&l!==void 0?l:this.element,p=d.offsetWidth,m=d.offsetHeight;if(p===0||m===0)return;const _=i.currentTarget.getBoundingClientRect(),f=((u=i.clientX)!==null&&u!==void 0?u:0)-_.left,v=((c=i.clientY)!==null&&c!==void 0?c:0)-_.top,g=this.calculateQuadrant(this._acceptedTargetZonesSet,f,v,p,m);if(this.isAlreadyUsed(i)||g===null){this.removeDropTarget();return}if(!this.options.canDisplayOverlay(i,g)){if(h)return;this.removeDropTarget();return}const y=new eT({nativeEvent:i,position:g});if(this._onWillShowOverlay.fire(y),y.defaultPrevented){this.removeDropTarget();return}this.markAsUsed(i),h||this.targetElement||(this.targetElement=document.createElement("div"),this.targetElement.className="dv-drop-target-dropzone",this.overlayElement=document.createElement("div"),this.overlayElement.className="dv-drop-target-selection",this._state="center",this.targetElement.appendChild(this.overlayElement),d.classList.add("dv-drop-target"),d.append(this.targetElement)),this.toggleClasses(g,p,m),this._state=g},onDragLeave:()=>{var i,r;!((r=(i=this.options).getOverrideTarget)===null||r===void 0)&&r.call(i)||this.removeDropTarget()},onDragEnd:i=>{var r,s;const a=(s=(r=this.options).getOverrideTarget)===null||s===void 0?void 0:s.call(r);a&&Xn.ACTUAL_TARGET===this&&this._state&&(i.stopPropagation(),this._onDrop.fire({position:this._state,nativeEvent:i})),this.removeDropTarget(),a==null||a.clear()},onDrop:i=>{var r,s,a;i.preventDefault();const o=this._state;this.removeDropTarget(),(a=(s=(r=this.options).getOverrideTarget)===null||s===void 0?void 0:s.call(r))===null||a===void 0||a.clear(),o&&(i.stopPropagation(),this._onDrop.fire({position:o,nativeEvent:i}))}}),this.addDisposables(this._onDrop,this._onWillShowOverlay,this.dnd)}setTargetZones(e){this._acceptedTargetZonesSet=new Set(e)}setOverlayModel(e){this.options.overlayModel=e}dispose(){this.removeDropTarget(),super.dispose()}markAsUsed(e){e[Xn.USED_EVENT_ID]=!0}isAlreadyUsed(e){const n=e[Xn.USED_EVENT_ID];return typeof n=="boolean"&&n}toggleClasses(e,n,i){var r,s,a,o,l,u,c;const h=(s=(r=this.options).getOverrideTarget)===null||s===void 0?void 0:s.call(r);if(!h&&!this.overlayElement)return;const d=n<rT,p=i<sT,m=e==="left",_=e==="right",f=e==="top",v=e==="bottom",g=!d&&_,y=!d&&m,b=!p&&f,w=!p&&v;let x=1;const k=(o=(a=this.options.overlayModel)===null||a===void 0?void 0:a.size)!==null&&o!==void 0?o:iT;if(k.type==="percentage"?x=Je(k.value,0,100)/100:((g||y)&&(x=Je(0,k.value,n)/n),(b||w)&&(x=Je(0,k.value,i)/i)),h){const E=(c=(u=(l=this.options).getOverlayOutline)===null||u===void 0?void 0:u.call(l))!==null&&c!==void 0?c:this.element,A=E.getBoundingClientRect(),M=h.getElements(void 0,E),R=M.root,P=M.overlay,H=R.getBoundingClientRect(),B=A.top-H.top,L=A.left-H.left,j={top:B,left:L,width:n,height:i};if(g?(j.left=L+n*(1-x),j.width=n*x):y?j.width=n*x:b?j.height=i*x:w&&(j.top=B+i*(1-x),j.height=i*x),d&&m&&(j.width=4),d&&_&&(j.left=L+n-4,j.width=4),!QA(P,j))return;YA(P,j),P.className=`dv-drop-target-anchor${this.options.className?` ${this.options.className}`:""}`,we(P,"dv-drop-target-left",m),we(P,"dv-drop-target-right",_),we(P,"dv-drop-target-top",f),we(P,"dv-drop-target-bottom",v),we(P,"dv-drop-target-center",e==="center"),M.changed&&(we(P,"dv-drop-target-anchor-container-changed",!0),setTimeout(()=>{we(P,"dv-drop-target-anchor-container-changed",!1)},10));return}if(!this.overlayElement)return;const S={top:"0px",left:"0px",width:"100%",height:"100%"};g?(S.left=`${100*(1-x)}%`,S.width=`${100*x}%`):y?S.width=`${100*x}%`:b?S.height=`${100*x}%`:w&&(S.top=`${100*(1-x)}%`,S.height=`${100*x}%`),XA(this.overlayElement,S),we(this.overlayElement,"dv-drop-target-small-vertical",p),we(this.overlayElement,"dv-drop-target-small-horizontal",d),we(this.overlayElement,"dv-drop-target-left",m),we(this.overlayElement,"dv-drop-target-right",_),we(this.overlayElement,"dv-drop-target-top",f),we(this.overlayElement,"dv-drop-target-bottom",v),we(this.overlayElement,"dv-drop-target-center",e==="center")}calculateQuadrant(e,n,i,r,s){var a,o;const l=(o=(a=this.options.overlayModel)===null||a===void 0?void 0:a.activationSize)!==null&&o!==void 0?o:nT;return l.type==="percentage"?oT(e,n,i,r,s,l.value):aT(e,n,i,r,s,l.value)}removeDropTarget(){var e;this.targetElement&&(this._state=void 0,(e=this.targetElement.parentElement)===null||e===void 0||e.classList.remove("dv-drop-target"),this.targetElement.remove(),this.targetElement=void 0,this.overlayElement=void 0)}}Xn.USED_EVENT_ID="__dockview_droptarget_event_is_used__";function oT(t,e,n,i,r,s){const a=100*e/i,o=100*n/r;return t.has("left")&&a<s?"left":t.has("right")&&a>100-s?"right":t.has("top")&&o<s?"top":t.has("bottom")&&o>100-s?"bottom":t.has("center")?"center":null}function aT(t,e,n,i,r,s){return t.has("left")&&e<s?"left":t.has("right")&&e>i-s?"right":t.has("top")&&n<s?"top":t.has("bottom")&&n>r-s?"bottom":t.has("center")?"center":null}const tm=Object.keys({disableAutoResizing:void 0,disableDnd:void 0,className:void 0});class lT extends ox{constructor(e,n,i,r){super(),this.nativeEvent=e,this.position=n,this.getData=i,this.panel=r}}class gx extends X0{constructor(){super()}}class vx extends Se{get isFocused(){return this._isFocused}get isActive(){return this._isActive}get isVisible(){return this._isVisible}get width(){return this._width}get height(){return this._height}constructor(e,n){super(),this.id=e,this.component=n,this._isFocused=!1,this._isActive=!1,this._isVisible=!0,this._width=0,this._height=0,this._parameters={},this.panelUpdatesDisposable=new qt,this._onDidDimensionChange=new J,this.onDidDimensionsChange=this._onDidDimensionChange.event,this._onDidChangeFocus=new J,this.onDidFocusChange=this._onDidChangeFocus.event,this._onWillFocus=new J,this.onWillFocus=this._onWillFocus.event,this._onDidVisibilityChange=new J,this.onDidVisibilityChange=this._onDidVisibilityChange.event,this._onWillVisibilityChange=new J,this.onWillVisibilityChange=this._onWillVisibilityChange.event,this._onDidActiveChange=new J,this.onDidActiveChange=this._onDidActiveChange.event,this._onActiveChange=new J,this.onActiveChange=this._onActiveChange.event,this._onDidParametersChange=new J,this.onDidParametersChange=this._onDidParametersChange.event,this.addDisposables(this.onDidFocusChange(i=>{this._isFocused=i.isFocused}),this.onDidActiveChange(i=>{this._isActive=i.isActive}),this.onDidVisibilityChange(i=>{this._isVisible=i.isVisible}),this.onDidDimensionsChange(i=>{this._width=i.width,this._height=i.height}),this.panelUpdatesDisposable,this._onDidDimensionChange,this._onDidChangeFocus,this._onDidVisibilityChange,this._onDidActiveChange,this._onWillFocus,this._onActiveChange,this._onWillFocus,this._onWillVisibilityChange,this._onDidParametersChange)}getParameters(){return this._parameters}initialize(e){this.panelUpdatesDisposable.value=this._onDidParametersChange.event(n=>{this._parameters=n,e.update({params:n})})}setVisible(e){this._onWillVisibilityChange.fire({isVisible:e})}setActive(){this._onActiveChange.fire()}updateParameters(e){this._onDidParametersChange.fire(e)}}class _x extends vx{constructor(e,n){super(e,n),this._onDidConstraintsChangeInternal=new J,this.onDidConstraintsChangeInternal=this._onDidConstraintsChangeInternal.event,this._onDidConstraintsChange=new J({replay:!0}),this.onDidConstraintsChange=this._onDidConstraintsChange.event,this._onDidSizeChange=new J,this.onDidSizeChange=this._onDidSizeChange.event,this.addDisposables(this._onDidConstraintsChangeInternal,this._onDidConstraintsChange,this._onDidSizeChange)}setConstraints(e){this._onDidConstraintsChangeInternal.fire(e)}setSize(e){this._onDidSizeChange.fire(e)}}class uT extends _x{set pane(e){this._pane=e}constructor(e,n){super(e,n),this._onDidExpansionChange=new J({replay:!0}),this.onDidExpansionChange=this._onDidExpansionChange.event,this._onMouseEnter=new J({}),this.onMouseEnter=this._onMouseEnter.event,this._onMouseLeave=new J({}),this.onMouseLeave=this._onMouseLeave.event,this.addDisposables(this._onDidExpansionChange,this._onMouseEnter,this._onMouseLeave)}setExpanded(e){var n;(n=this._pane)===null||n===void 0||n.setExpanded(e)}get isExpanded(){var e;return!!(!((e=this._pane)===null||e===void 0)&&e.isExpanded())}}class ng extends Se{get element(){return this._element}get width(){return this._width}get height(){return this._height}get params(){var e;return(e=this._params)===null||e===void 0?void 0:e.params}constructor(e,n,i){super(),this.id=e,this.component=n,this.api=i,this._height=0,this._width=0,this._element=document.createElement("div"),this._element.tabIndex=-1,this._element.style.outline="none",this._element.style.height="100%",this._element.style.width="100%",this._element.style.overflow="hidden";const r=ax(this._element);this.addDisposables(this.api,r.onDidFocus(()=>{this.api._onDidChangeFocus.fire({isFocused:!0})}),r.onDidBlur(()=>{this.api._onDidChangeFocus.fire({isFocused:!1})}),r)}focus(){const e=new gx;this.api._onWillFocus.fire(e),!e.defaultPrevented&&this._element.focus()}layout(e,n){this._width=e,this._height=n,this.api._onDidDimensionChange.fire({width:e,height:n}),this.part&&this._params&&this.part.update(this._params.params)}init(e){this._params=e,this.part=this.getComponent()}update(e){var n,i;this._params=Object.assign(Object.assign({},this._params),{params:Object.assign(Object.assign({},(n=this._params)===null||n===void 0?void 0:n.params),e.params)});for(const r of Object.keys(e.params))e.params[r]===void 0&&delete this._params.params[r];(i=this.part)===null||i===void 0||i.update({params:this._params.params})}toJSON(){var e,n;const i=(n=(e=this._params)===null||e===void 0?void 0:e.params)!==null&&n!==void 0?n:{};return{id:this.id,component:this.component,params:Object.keys(i).length>0?i:void 0}}dispose(){var e;this.api.dispose(),(e=this.part)===null||e===void 0||e.dispose(),super.dispose()}}class cT extends ng{set orientation(e){this._orientation=e}get orientation(){return this._orientation}get minimumSize(){const e=this.headerSize,i=this.isExpanded()?this._minimumBodySize:0;return e+i}get maximumSize(){const e=this.headerSize,i=this.isExpanded()?this._maximumBodySize:0;return e+i}get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}set orthogonalSize(e){this._orthogonalSize=e}get minimumBodySize(){return this._minimumBodySize}set minimumBodySize(e){this._minimumBodySize=typeof e=="number"?e:0}get maximumBodySize(){return this._maximumBodySize}set maximumBodySize(e){this._maximumBodySize=typeof e=="number"?e:Number.POSITIVE_INFINITY}get headerVisible(){return this._headerVisible}set headerVisible(e){this._headerVisible=e,this.header.style.display=e?"":"none"}constructor(e){super(e.id,e.component,new uT(e.id,e.component)),this._onDidChangeExpansionState=new J({replay:!0}),this.onDidChangeExpansionState=this._onDidChangeExpansionState.event,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._orthogonalSize=0,this._size=0,this._isExpanded=!1,this.api.pane=this,this.api.initialize(this),this.headerSize=e.headerSize,this.headerComponent=e.headerComponent,this._minimumBodySize=e.minimumBodySize,this._maximumBodySize=e.maximumBodySize,this._isExpanded=e.isExpanded,this._headerVisible=e.isHeaderVisible,this._onDidChangeExpansionState.fire(this.isExpanded()),this._orientation=e.orientation,this.element.classList.add("dv-pane"),this.addDisposables(this.api.onWillVisibilityChange(n=>{const{isVisible:i}=n,{accessor:r}=this._params;r.setVisible(this,i)}),this.api.onDidSizeChange(n=>{this._onDidChange.fire({size:n.size})}),Me(this.element,"mouseenter",n=>{this.api._onMouseEnter.fire(n)}),Me(this.element,"mouseleave",n=>{this.api._onMouseLeave.fire(n)})),this.addDisposables(this._onDidChangeExpansionState,this.onDidChangeExpansionState(n=>{this.api._onDidExpansionChange.fire({isExpanded:n})}),this.api.onDidFocusChange(n=>{this.header&&(n.isFocused?ed(this.header,"focused"):il(this.header,"focused"))})),this.renderOnce()}setVisible(e){this.api._onDidVisibilityChange.fire({isVisible:e})}setActive(e){this.api._onDidActiveChange.fire({isActive:e})}isExpanded(){return this._isExpanded}setExpanded(e){this._isExpanded!==e&&(this._isExpanded=e,e?(this.animationTimer&&clearTimeout(this.animationTimer),this.body&&this.element.appendChild(this.body)):this.animationTimer=setTimeout(()=>{var n;(n=this.body)===null||n===void 0||n.remove()},200),this._onDidChange.fire(e?{size:this.width}:{}),this._onDidChangeExpansionState.fire(e))}layout(e,n){this._size=e,this._orthogonalSize=n;const[i,r]=this.orientation===ye.HORIZONTAL?[e,n]:[n,e];super.layout(i,r)}init(e){var n,i;super.init(e),typeof e.minimumBodySize=="number"&&(this.minimumBodySize=e.minimumBodySize),typeof e.maximumBodySize=="number"&&(this.maximumBodySize=e.maximumBodySize),this.bodyPart=this.getBodyComponent(),this.headerPart=this.getHeaderComponent(),this.bodyPart.init(Object.assign(Object.assign({},e),{api:this.api})),this.headerPart.init(Object.assign(Object.assign({},e),{api:this.api})),(n=this.body)===null||n===void 0||n.append(this.bodyPart.element),(i=this.header)===null||i===void 0||i.append(this.headerPart.element),typeof e.isExpanded=="boolean"&&this.setExpanded(e.isExpanded)}toJSON(){const e=this._params;return Object.assign(Object.assign({},super.toJSON()),{headerComponent:this.headerComponent,title:e.title})}renderOnce(){this.header=document.createElement("div"),this.header.tabIndex=0,this.header.className="dv-pane-header",this.header.style.height=`${this.headerSize}px`,this.header.style.lineHeight=`${this.headerSize}px`,this.header.style.minHeight=`${this.headerSize}px`,this.header.style.maxHeight=`${this.headerSize}px`,this.element.appendChild(this.header),this.body=document.createElement("div"),this.body.className="dv-pane-body",this.element.appendChild(this.body)}getComponent(){return{update:e=>{var n,i;(n=this.bodyPart)===null||n===void 0||n.update({params:e}),(i=this.headerPart)===null||i===void 0||i.update({params:e})},dispose:()=>{var e,n;(e=this.bodyPart)===null||e===void 0||e.dispose(),(n=this.headerPart)===null||n===void 0||n.dispose()}}}}class hT extends cT{constructor(e){super({id:e.id,component:e.component,headerComponent:e.headerComponent,orientation:e.orientation,isExpanded:e.isExpanded,isHeaderVisible:!0,headerSize:e.headerSize,minimumBodySize:e.minimumBodySize,maximumBodySize:e.maximumBodySize}),this._onDidDrop=new J,this.onDidDrop=this._onDidDrop.event,this._onUnhandledDragOverEvent=new J,this.onUnhandledDragOverEvent=this._onUnhandledDragOverEvent.event,this.accessor=e.accessor,this.addDisposables(this._onDidDrop,this._onUnhandledDragOverEvent),e.disableDnd||this.initDragFeatures()}initDragFeatures(){if(!this.header)return;const e=this.id,n=this.accessor.id;this.header.draggable=!0,this.handler=new class extends tg{getData(){return wi.getInstance().setData([new Aa(n,e)],Aa.prototype),{dispose:()=>{wi.getInstance().clearData(Aa.prototype)}}}}(this.header),this.target=new Xn(this.element,{acceptedTargetZones:["top","bottom"],overlayModel:{activationSize:{type:"percentage",value:50}},canDisplayOverlay:(i,r)=>{const s=Yo();if(s&&s.paneId!==this.id&&s.viewId===this.accessor.id)return!0;const a=new lT(i,r,Yo,this);return this._onUnhandledDragOverEvent.fire(a),a.isAccepted}}),this.addDisposables(this._onDidDrop,this.handler,this.target,this.target.onDrop(i=>{this.onDrop(i)}))}onDrop(e){const n=Yo();if(!n||n.viewId!==this.accessor.id){this._onDidDrop.fire(Object.assign(Object.assign({},e),{panel:this,api:new sl(this.accessor),getData:Yo}));return}const i=this._params.containerApi,r=n.paneId,s=i.getPanel(r);if(!s){this._onDidDrop.fire(Object.assign(Object.assign({},e),{panel:this,getData:Yo,api:new sl(this.accessor)}));return}const a=i.panels,o=a.indexOf(s);let l=i.panels.indexOf(this);(e.position==="left"||e.position==="top")&&(l=Math.max(0,l-1)),(e.position==="right"||e.position==="bottom")&&(o>l&&l++,l=Math.min(a.length-1,l)),i.movePanel(o,l)}}class dT extends Se{get element(){return this._element}constructor(e,n){super(),this.accessor=e,this.group=n,this.disposable=new qt,this._onDidFocus=new J,this.onDidFocus=this._onDidFocus.event,this._onDidBlur=new J,this.onDidBlur=this._onDidBlur.event,this._element=document.createElement("div"),this._element.className="dv-content-container",this._element.tabIndex=-1,this.addDisposables(this._onDidFocus,this._onDidBlur);const i=n.dropTargetContainer;this.dropTarget=new Xn(this.element,{getOverlayOutline:()=>{var r;return((r=e.options.theme)===null||r===void 0?void 0:r.dndPanelOverlay)==="group"?this.element.parentElement:null},className:"dv-drop-target-content",acceptedTargetZones:["top","bottom","left","right","center"],canDisplayOverlay:(r,s)=>{if(this.group.locked==="no-drop-target"||this.group.locked&&s==="center")return!1;const a=Gt();return!a&&r.shiftKey&&this.group.location.type!=="floating"?!1:a&&a.viewId===this.accessor.id?!0:this.group.canDisplayOverlay(r,s,"content")},getOverrideTarget:i?()=>i.model:void 0}),this.addDisposables(this.dropTarget)}show(){this.element.style.display=""}hide(){this.element.style.display="none"}renderPanel(e,n={asActive:!0}){const i=n.asActive||this.panel&&this.group.isPanelActive(this.panel);this.panel&&this.panel.view.content.element.parentElement===this._element&&this._element.removeChild(this.panel.view.content.element),this.panel=e;let r;switch(e.api.renderer){case"onlyWhenVisible":this.group.renderContainer.detatch(e),this.panel&&i&&this._element.appendChild(this.panel.view.content.element),r=this._element;break;case"always":e.view.content.element.parentElement===this._element&&this._element.removeChild(e.view.content.element),r=this.group.renderContainer.attach({panel:e,referenceContainer:this});break;default:throw new Error(`dockview: invalid renderer type '${e.api.renderer}'`)}if(i){const s=ax(r);this.focusTracker=s;const a=new Se;a.addDisposables(s,s.onDidFocus(()=>this._onDidFocus.fire()),s.onDidBlur(()=>this._onDidBlur.fire())),this.disposable.value=a}}openPanel(e){this.panel!==e&&this.renderPanel(e)}layout(e,n){}closePanel(){var e;this.panel&&this.panel.api.renderer==="onlyWhenVisible"&&((e=this.panel.view.content.element.parentElement)===null||e===void 0||e.removeChild(this.panel.view.content.element)),this.panel=void 0}dispose(){this.disposable.dispose(),super.dispose()}refreshFocusState(){var e;!((e=this.focusTracker)===null||e===void 0)&&e.refreshState&&this.focusTracker.refreshState()}}function yx(t,e,n){var i,r;ed(e,"dv-dragged"),e.style.top="-9999px",document.body.appendChild(e),t.setDragImage(e,(i=n==null?void 0:n.x)!==null&&i!==void 0?i:0,(r=n==null?void 0:n.y)!==null&&r!==void 0?r:0),setTimeout(()=>{il(e,"dv-dragged"),e.remove()},0)}class fT extends tg{constructor(e,n,i,r,s){super(e,s),this.accessor=n,this.group=i,this.panel=r,this.panelTransfer=wi.getInstance()}getData(e){return this.panelTransfer.setData([new Tr(this.accessor.id,this.group.id,this.panel.id)],Tr.prototype),{dispose:()=>{this.panelTransfer.clearData(Tr.prototype)}}}}class pT extends Se{get element(){return this._element}constructor(e,n,i){super(),this.panel=e,this.accessor=n,this.group=i,this.content=void 0,this._onPointDown=new J,this.onPointerDown=this._onPointDown.event,this._onDropped=new J,this.onDrop=this._onDropped.event,this._onDragStart=new J,this.onDragStart=this._onDragStart.event,this._element=document.createElement("div"),this._element.className="dv-tab",this._element.tabIndex=0,this._element.draggable=!this.accessor.options.disableDnd,we(this.element,"dv-inactive-tab",!0),this.dragHandler=new fT(this._element,this.accessor,this.group,this.panel,!!this.accessor.options.disableDnd),this.dropTarget=new Xn(this._element,{acceptedTargetZones:["left","right"],overlayModel:{activationSize:{value:50,type:"percentage"}},canDisplayOverlay:(r,s)=>{if(this.group.locked)return!1;const a=Gt();return a&&this.accessor.id===a.viewId?!0:this.group.model.canDisplayOverlay(r,s,"tab")},getOverrideTarget:()=>{var r;return(r=i.model.dropTargetContainer)===null||r===void 0?void 0:r.model}}),this.onWillShowOverlay=this.dropTarget.onWillShowOverlay,this.addDisposables(this._onPointDown,this._onDropped,this._onDragStart,this.dragHandler.onDragStart(r=>{if(r.dataTransfer){const s=getComputedStyle(this.element),a=this.element.cloneNode(!0);Array.from(s).forEach(o=>a.style.setProperty(o,s.getPropertyValue(o),s.getPropertyPriority(o))),a.style.position="absolute",yx(r.dataTransfer,a,{y:-10,x:30})}this._onDragStart.fire(r)}),this.dragHandler,Me(this._element,"pointerdown",r=>{this._onPointDown.fire(r)}),this.dropTarget.onDrop(r=>{this._onDropped.fire(r)}),this.dropTarget)}setActive(e){we(this.element,"dv-active-tab",e),we(this.element,"dv-inactive-tab",!e)}setContent(e){this.content&&this._element.removeChild(this.content.element),this.content=e,this._element.appendChild(this.content.element)}updateDragAndDropState(){this._element.draggable=!this.accessor.options.disableDnd,this.dragHandler.setDisabled(!!this.accessor.options.disableDnd)}dispose(){super.dispose()}}class nd{get kind(){return this.options.kind}get nativeEvent(){return this.event.nativeEvent}get position(){return this.event.position}get defaultPrevented(){return this.event.defaultPrevented}get panel(){return this.options.panel}get api(){return this.options.api}get group(){return this.options.group}preventDefault(){this.event.preventDefault()}getData(){return this.options.getData()}constructor(e,n){this.event=e,this.options=n}}class mT extends tg{constructor(e,n,i,r){super(e,r),this.accessor=n,this.group=i,this.panelTransfer=wi.getInstance(),this.addDisposables(Me(e,"pointerdown",s=>{s.shiftKey&&OA(s)},!0))}isCancelled(e){return this.group.api.location.type==="floating"&&!e.shiftKey}getData(e){const n=e.dataTransfer;this.panelTransfer.setData([new Tr(this.accessor.id,this.group.id,null)],Tr.prototype);const i=window.getComputedStyle(this.el),r=i.getPropertyValue("--dv-activegroup-visiblepanel-tab-background-color"),s=i.getPropertyValue("--dv-activegroup-visiblepanel-tab-color");if(n){const a=document.createElement("div");a.style.backgroundColor=r,a.style.color=s,a.style.padding="2px 8px",a.style.height="24px",a.style.fontSize="11px",a.style.lineHeight="20px",a.style.borderRadius="12px",a.style.position="absolute",a.style.pointerEvents="none",a.style.top="-9999px",a.textContent=`Multiple Panels (${this.group.size})`,yx(n,a,{y:-10,x:30})}return{dispose:()=>{this.panelTransfer.clearData(Tr.prototype)}}}}class gT extends Se{get element(){return this._element}constructor(e,n){super(),this.accessor=e,this.group=n,this._onDrop=new J,this.onDrop=this._onDrop.event,this._onDragStart=new J,this.onDragStart=this._onDragStart.event,this._element=document.createElement("div"),this._element.className="dv-void-container",this._element.draggable=!this.accessor.options.disableDnd,we(this._element,"dv-draggable",!this.accessor.options.disableDnd),this.addDisposables(this._onDrop,this._onDragStart,Me(this._element,"pointerdown",()=>{this.accessor.doSetGroupActive(this.group)})),this.handler=new mT(this._element,e,n,!!this.accessor.options.disableDnd),this.dropTarget=new Xn(this._element,{acceptedTargetZones:["center"],canDisplayOverlay:(i,r)=>{const s=Gt();return s&&this.accessor.id===s.viewId?!0:n.model.canDisplayOverlay(i,r,"header_space")},getOverrideTarget:()=>{var i;return(i=n.model.dropTargetContainer)===null||i===void 0?void 0:i.model}}),this.onWillShowOverlay=this.dropTarget.onWillShowOverlay,this.addDisposables(this.handler,this.handler.onDragStart(i=>{this._onDragStart.fire(i)}),this.dropTarget.onDrop(i=>{this._onDrop.fire(i)}),this.dropTarget)}updateDragAndDropState(){this._element.draggable=!this.accessor.options.disableDnd,we(this._element,"dv-draggable",!this.accessor.options.disableDnd),this.handler.setDisabled(!!this.accessor.options.disableDnd)}}class id extends Se{get element(){return this._element}constructor(e){super(),this.scrollableElement=e,this._scrollLeft=0,this._element=document.createElement("div"),this._element.className="dv-scrollable",this._horizontalScrollbar=document.createElement("div"),this._horizontalScrollbar.className="dv-scrollbar-horizontal",this.element.appendChild(e),this.element.appendChild(this._horizontalScrollbar),this.addDisposables(Me(this.element,"wheel",n=>{this._scrollLeft+=n.deltaY*id.MouseWheelSpeed,this.calculateScrollbarStyles()}),Me(this._horizontalScrollbar,"pointerdown",n=>{n.preventDefault(),we(this.element,"dv-scrollable-scrolling",!0);const i=n.clientX,r=this._scrollLeft,s=o=>{const l=o.clientX-i,{clientWidth:u}=this.element,{scrollWidth:c}=this.scrollableElement,h=u/c;this._scrollLeft=r+l/h,this.calculateScrollbarStyles()},a=()=>{we(this.element,"dv-scrollable-scrolling",!1),document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",a),document.removeEventListener("pointercancel",a)};document.addEventListener("pointermove",s),document.addEventListener("pointerup",a),document.addEventListener("pointercancel",a)}),Me(this.element,"scroll",()=>{this.calculateScrollbarStyles()}),Me(this.scrollableElement,"scroll",()=>{this._scrollLeft=this.scrollableElement.scrollLeft,this.calculateScrollbarStyles()}),Qh(this.element,()=>{we(this.element,"dv-scrollable-resizing",!0),this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(()=>{clearTimeout(this._animationTimer),we(this.element,"dv-scrollable-resizing",!1)},500),this.calculateScrollbarStyles()}))}calculateScrollbarStyles(){const{clientWidth:e}=this.element,{scrollWidth:n}=this.scrollableElement;if(n>e){const r=e*(e/n);this._horizontalScrollbar.style.width=`${r}px`,this._scrollLeft=Je(this._scrollLeft,0,this.scrollableElement.scrollWidth-e),this.scrollableElement.scrollLeft=this._scrollLeft;const s=this._scrollLeft/(n-e);this._horizontalScrollbar.style.left=`${(e-r)*s}px`}else this._horizontalScrollbar.style.width="0px",this._horizontalScrollbar.style.left="0px",this._scrollLeft=0}}id.MouseWheelSpeed=1;class vT extends Se{get showTabsOverflowControl(){return this._showTabsOverflowControl}set showTabsOverflowControl(e){if(this._showTabsOverflowControl!=e&&(this._showTabsOverflowControl=e,e)){const n=new MA(this._tabsList);this._observerDisposable.value=new Se(n,n.onDidChange(i=>{const r=i.hasScrollX||i.hasScrollY;this.toggleDropdown({reset:!r})}),Me(this._tabsList,"scroll",()=>{this.toggleDropdown({reset:!1})}))}}get element(){return this._element}get panels(){return this._tabs.map(e=>e.value.panel.id)}get size(){return this._tabs.length}get tabs(){return this._tabs.map(e=>e.value)}constructor(e,n,i){if(super(),this.group=e,this.accessor=n,this._observerDisposable=new qt,this._tabs=[],this.selectedIndex=-1,this._showTabsOverflowControl=!1,this._onTabDragStart=new J,this.onTabDragStart=this._onTabDragStart.event,this._onDrop=new J,this.onDrop=this._onDrop.event,this._onWillShowOverlay=new J,this.onWillShowOverlay=this._onWillShowOverlay.event,this._onOverflowTabsChange=new J,this.onOverflowTabsChange=this._onOverflowTabsChange.event,this._tabsList=document.createElement("div"),this._tabsList.className="dv-tabs-container dv-horizontal",this.showTabsOverflowControl=i.showTabsOverflowControl,n.options.scrollbars==="native")this._element=this._tabsList;else{const r=new id(this._tabsList);this._element=r.element,this.addDisposables(r)}this.addDisposables(this._onOverflowTabsChange,this._observerDisposable,this._onWillShowOverlay,this._onDrop,this._onTabDragStart,Me(this.element,"pointerdown",r=>{if(r.defaultPrevented)return;r.button===0&&this.accessor.doSetGroupActive(this.group)}),pt.from(()=>{for(const{value:r,disposable:s}of this._tabs)s.dispose(),r.dispose();this._tabs=[]}))}indexOf(e){return this._tabs.findIndex(n=>n.value.panel.id===e)}isActive(e){return this.selectedIndex>-1&&this._tabs[this.selectedIndex].value===e}setActivePanel(e){let n=0;for(const i of this._tabs){const r=e.id===i.value.panel.id;if(i.value.setActive(r),r){const s=i.value.element,a=s.parentElement;(n<a.scrollLeft||n+s.clientWidth>a.scrollLeft+a.clientWidth)&&(a.scrollLeft=n)}n+=i.value.element.clientWidth}}openPanel(e,n=this._tabs.length){if(this._tabs.find(a=>a.value.panel.id===e.id))return;const i=new pT(e,this.accessor,this.group);i.setContent(e.view.tab);const r=new Se(i.onDragStart(a=>{this._onTabDragStart.fire({nativeEvent:a,panel:e})}),i.onPointerDown(a=>{if(a.defaultPrevented)return;const o=!this.accessor.options.disableFloatingGroups,l=this.group.api.location.type==="floating"&&this.size===1;if(o&&!l&&a.shiftKey){a.preventDefault();const u=this.accessor.getGroupPanel(i.panel.id),{top:c,left:h}=i.element.getBoundingClientRect(),{top:d,left:p}=this.accessor.element.getBoundingClientRect();this.accessor.addFloatingGroup(u,{x:h-p,y:c-d,inDragMode:!0});return}switch(a.button){case 0:this.group.activePanel!==e&&this.group.model.openPanel(e);break}}),i.onDrop(a=>{this._onDrop.fire({event:a.nativeEvent,index:this._tabs.findIndex(o=>o.value===i)})}),i.onWillShowOverlay(a=>{this._onWillShowOverlay.fire(new nd(a,{kind:"tab",panel:this.group.activePanel,api:this.accessor.api,group:this.group,getData:Gt}))})),s={value:i,disposable:r};this.addTab(s,n)}delete(e){const n=this.indexOf(e),i=this._tabs.splice(n,1)[0],{value:r,disposable:s}=i;s.dispose(),r.dispose(),r.element.remove()}addTab(e,n=this._tabs.length){if(n<0||n>this._tabs.length)throw new Error("invalid location");this._tabsList.insertBefore(e.value.element,this._tabsList.children[n]),this._tabs=[...this._tabs.slice(0,n),e,...this._tabs.slice(n)],this.selectedIndex<0&&(this.selectedIndex=n)}toggleDropdown(e){const n=e.reset?[]:this._tabs.filter(i=>!zA(i.value.element,this._tabsList)).map(i=>i.value.panel.id);this._onOverflowTabsChange.fire({tabs:n,reset:e.reset})}updateDragAndDropState(){for(const e of this._tabs)e.value.updateDragAndDropState()}}const ig=t=>{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"height",t.height),e.setAttributeNS(null,"width",t.width),e.setAttributeNS(null,"viewBox",t.viewbox),e.setAttributeNS(null,"aria-hidden","false"),e.setAttributeNS(null,"focusable","false"),e.classList.add("dv-svg");const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttributeNS(null,"d",t.path),e.appendChild(n),e},_T=()=>ig({width:"11",height:"11",viewbox:"0 0 28 28",path:"M2.1 27.3L0 25.2L11.55 13.65L0 2.1L2.1 0L13.65 11.55L25.2 0L27.3 2.1L15.75 13.65L27.3 25.2L25.2 27.3L13.65 15.75L2.1 27.3Z"}),yT=()=>ig({width:"11",height:"11",viewbox:"0 0 24 15",path:"M12 14.15L0 2.15L2.15 0L12 9.9L21.85 0.0499992L24 2.2L12 14.15Z"}),bx=()=>ig({width:"11",height:"11",viewbox:"0 0 15 25",path:"M2.15 24.1L0 21.95L9.9 12.05L0 2.15L2.15 0L14.2 12.05L2.15 24.1Z"});function bT(){const t=document.createElement("div");t.className="dv-tabs-overflow-dropdown-default";const e=document.createElement("span");e.textContent="";const n=bx();return t.appendChild(n),t.appendChild(e),{element:t,update:i=>{e.textContent=`${i.tabs}`}}}class wT extends Se{get onTabDragStart(){return this.tabs.onTabDragStart}get panels(){return this.tabs.panels}get size(){return this.tabs.size}get hidden(){return this._hidden}set hidden(e){this._hidden=e,this.element.style.display=e?"none":""}get element(){return this._element}constructor(e,n){super(),this.accessor=e,this.group=n,this._hidden=!1,this.dropdownPart=null,this._overflowTabs=[],this._dropdownDisposable=new qt,this._onDrop=new J,this.onDrop=this._onDrop.event,this._onGroupDragStart=new J,this.onGroupDragStart=this._onGroupDragStart.event,this._onWillShowOverlay=new J,this.onWillShowOverlay=this._onWillShowOverlay.event,this._element=document.createElement("div"),this._element.className="dv-tabs-and-actions-container",we(this._element,"dv-full-width-single-tab",this.accessor.options.singleTabMode==="fullwidth"),this.rightActionsContainer=document.createElement("div"),this.rightActionsContainer.className="dv-right-actions-container",this.leftActionsContainer=document.createElement("div"),this.leftActionsContainer.className="dv-left-actions-container",this.preActionsContainer=document.createElement("div"),this.preActionsContainer.className="dv-pre-actions-container",this.tabs=new vT(n,e,{showTabsOverflowControl:!e.options.disableTabsOverflowList}),this.voidContainer=new gT(this.accessor,this.group),this._element.appendChild(this.preActionsContainer),this._element.appendChild(this.tabs.element),this._element.appendChild(this.leftActionsContainer),this._element.appendChild(this.voidContainer.element),this._element.appendChild(this.rightActionsContainer),this.addDisposables(this.tabs.onDrop(i=>this._onDrop.fire(i)),this.tabs.onWillShowOverlay(i=>this._onWillShowOverlay.fire(i)),e.onDidOptionsChange(()=>{this.tabs.showTabsOverflowControl=!e.options.disableTabsOverflowList}),this.tabs.onOverflowTabsChange(i=>{this.toggleDropdown(i)}),this.tabs,this._onWillShowOverlay,this._onDrop,this._onGroupDragStart,this.voidContainer,this.voidContainer.onDragStart(i=>{this._onGroupDragStart.fire({nativeEvent:i,group:this.group})}),this.voidContainer.onDrop(i=>{this._onDrop.fire({event:i.nativeEvent,index:this.tabs.size})}),this.voidContainer.onWillShowOverlay(i=>{this._onWillShowOverlay.fire(new nd(i,{kind:"header_space",panel:this.group.activePanel,api:this.accessor.api,group:this.group,getData:Gt}))}),Me(this.voidContainer.element,"pointerdown",i=>{if(i.defaultPrevented)return;if(!this.accessor.options.disableFloatingGroups&&i.shiftKey&&this.group.api.location.type!=="floating"){i.preventDefault();const{top:s,left:a}=this.element.getBoundingClientRect(),{top:o,left:l}=this.accessor.element.getBoundingClientRect();this.accessor.addFloatingGroup(this.group,{x:a-l+20,y:s-o+20,inDragMode:!0})}}))}show(){this.hidden||(this.element.style.display="")}hide(){this._element.style.display="none"}setRightActionsElement(e){this.rightActions!==e&&(this.rightActions&&(this.rightActions.remove(),this.rightActions=void 0),e&&(this.rightActionsContainer.appendChild(e),this.rightActions=e))}setLeftActionsElement(e){this.leftActions!==e&&(this.leftActions&&(this.leftActions.remove(),this.leftActions=void 0),e&&(this.leftActionsContainer.appendChild(e),this.leftActions=e))}setPrefixActionsElement(e){this.preActions!==e&&(this.preActions&&(this.preActions.remove(),this.preActions=void 0),e&&(this.preActionsContainer.appendChild(e),this.preActions=e))}isActive(e){return this.tabs.isActive(e)}indexOf(e){return this.tabs.indexOf(e)}setActive(e){}delete(e){this.tabs.delete(e),this.updateClassnames()}setActivePanel(e){this.tabs.setActivePanel(e)}openPanel(e,n=this.tabs.size){this.tabs.openPanel(e,n),this.updateClassnames()}closePanel(e){this.delete(e.id)}updateClassnames(){we(this._element,"dv-single-tab",this.size===1)}toggleDropdown(e){const n=e.reset?[]:e.tabs;if(this._overflowTabs=n,this._overflowTabs.length>0&&this.dropdownPart){this.dropdownPart.update({tabs:n.length});return}if(this._overflowTabs.length===0){this._dropdownDisposable.dispose();return}const i=document.createElement("div");i.className="dv-tabs-overflow-dropdown-root";const r=bT();r.update({tabs:n.length}),this.dropdownPart=r,i.appendChild(r.element),this.rightActionsContainer.prepend(i),this._dropdownDisposable.value=new Se(pt.from(()=>{var s,a;i.remove(),(a=(s=this.dropdownPart)===null||s===void 0?void 0:s.dispose)===null||a===void 0||a.call(s),this.dropdownPart=null}),Me(i,"pointerdown",s=>{s.preventDefault()},{capture:!0}),Me(i,"click",s=>{const a=document.createElement("div");a.style.overflow="auto",a.className="dv-tabs-overflow-container";for(const l of this.tabs.tabs.filter(u=>this._overflowTabs.includes(u.panel.id))){const u=this.group.panels.find(p=>p===l.panel),h=u.view.createTabRenderer("headerOverflow").element,d=document.createElement("div");we(d,"dv-tab",!0),we(d,"dv-active-tab",u.api.isActive),we(d,"dv-inactive-tab",!u.api.isActive),d.addEventListener("click",p=>{this.accessor.popupService.close(),!p.defaultPrevented&&(l.element.scrollIntoView(),l.panel.api.setActive())}),d.appendChild(h),a.appendChild(d)}const o=$A(i);this.accessor.popupService.openPopover(a,{x:s.clientX,y:s.clientY,zIndex:o!=null&&o.style.zIndex?`calc(${o.style.zIndex} * 2)`:void 0})}))}updateDragAndDropState(){this.tabs.updateDragAndDropState(),this.voidContainer.updateDragAndDropState()}}class wx extends ox{constructor(e,n,i,r,s){super(),this.nativeEvent=e,this.target=n,this.position=i,this.getData=r,this.group=s}}const nm=Object.keys({disableAutoResizing:void 0,hideBorders:void 0,singleTabMode:void 0,disableFloatingGroups:void 0,floatingGroupBounds:void 0,popoutUrl:void 0,defaultRenderer:void 0,debug:void 0,rootOverlayModel:void 0,locked:void 0,disableDnd:void 0,className:void 0,noPanelsOverlay:void 0,dndEdges:void 0,theme:void 0,disableTabsOverflowList:void 0,scrollbars:void 0});function ST(t){return!!t.referencePanel}function xT(t){return!!t.referenceGroup}function kT(t){return!!t.referencePanel}function CT(t){return!!t.referenceGroup}class rg extends X0{get nativeEvent(){return this.options.nativeEvent}get position(){return this.options.position}get panel(){return this.options.panel}get group(){return this.options.group}get api(){return this.options.api}constructor(e){super(),this.options=e}getData(){return this.options.getData()}}class Sx extends rg{get kind(){return this._kind}constructor(e){super(e),this._kind=e.kind}}class ET extends Se{get element(){throw new Error("dockview: not supported")}get activePanel(){return this._activePanel}get locked(){return this._locked}set locked(e){this._locked=e,we(this.container,"dv-locked-groupview",e==="no-drop-target"||e)}get isActive(){return this._isGroupActive}get panels(){return this._panels}get size(){return this._panels.length}get isEmpty(){return this._panels.length===0}get hasWatermark(){return!!(this.watermark&&this.container.contains(this.watermark.element))}get header(){return this.tabsContainer}get isContentFocused(){return document.activeElement?Kp(document.activeElement,this.contentContainer.element):!1}get location(){return this._location}set location(e){switch(this._location=e,we(this.container,"dv-groupview-floating",!1),we(this.container,"dv-groupview-popout",!1),e.type){case"grid":this.contentContainer.dropTarget.setTargetZones(["top","bottom","left","right","center"]);break;case"floating":this.contentContainer.dropTarget.setTargetZones(["center"]),this.contentContainer.dropTarget.setTargetZones(e?["center"]:["top","bottom","left","right","center"]),we(this.container,"dv-groupview-floating",!0);break;case"popout":this.contentContainer.dropTarget.setTargetZones(["center"]),we(this.container,"dv-groupview-popout",!0);break}this.groupPanel.api._onDidLocationChange.fire({location:this.location})}constructor(e,n,i,r,s){var a;super(),this.container=e,this.accessor=n,this.id=i,this.options=r,this.groupPanel=s,this._isGroupActive=!1,this._locked=!1,this._location={type:"grid"},this.mostRecentlyUsed=[],this._overwriteRenderContainer=null,this._overwriteDropTargetContainer=null,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._width=0,this._height=0,this._panels=[],this._panelDisposables=new Map,this._onMove=new J,this.onMove=this._onMove.event,this._onDidDrop=new J,this.onDidDrop=this._onDidDrop.event,this._onWillDrop=new J,this.onWillDrop=this._onWillDrop.event,this._onWillShowOverlay=new J,this.onWillShowOverlay=this._onWillShowOverlay.event,this._onTabDragStart=new J,this.onTabDragStart=this._onTabDragStart.event,this._onGroupDragStart=new J,this.onGroupDragStart=this._onGroupDragStart.event,this._onDidAddPanel=new J,this.onDidAddPanel=this._onDidAddPanel.event,this._onDidPanelTitleChange=new J,this.onDidPanelTitleChange=this._onDidPanelTitleChange.event,this._onDidPanelParametersChange=new J,this.onDidPanelParametersChange=this._onDidPanelParametersChange.event,this._onDidRemovePanel=new J,this.onDidRemovePanel=this._onDidRemovePanel.event,this._onDidActivePanelChange=new J,this.onDidActivePanelChange=this._onDidActivePanelChange.event,this._onUnhandledDragOverEvent=new J,this.onUnhandledDragOverEvent=this._onUnhandledDragOverEvent.event,we(this.container,"dv-groupview",!0),this._api=new Nc(this.accessor),this.tabsContainer=new wT(this.accessor,this.groupPanel),this.contentContainer=new dT(this.accessor,this),e.append(this.tabsContainer.element,this.contentContainer.element),this.header.hidden=!!r.hideHeader,this.locked=(a=r.locked)!==null&&a!==void 0?a:!1,this.addDisposables(this._onTabDragStart,this._onGroupDragStart,this._onWillShowOverlay,this.tabsContainer.onTabDragStart(o=>{this._onTabDragStart.fire(o)}),this.tabsContainer.onGroupDragStart(o=>{this._onGroupDragStart.fire(o)}),this.tabsContainer.onDrop(o=>{this.handleDropEvent("header",o.event,"center",o.index)}),this.contentContainer.onDidFocus(()=>{this.accessor.doSetGroupActive(this.groupPanel)}),this.contentContainer.onDidBlur(()=>{}),this.contentContainer.dropTarget.onDrop(o=>{this.handleDropEvent("content",o.nativeEvent,o.position)}),this.tabsContainer.onWillShowOverlay(o=>{this._onWillShowOverlay.fire(o)}),this.contentContainer.dropTarget.onWillShowOverlay(o=>{this._onWillShowOverlay.fire(new nd(o,{kind:"content",panel:this.activePanel,api:this._api,group:this.groupPanel,getData:Gt}))}),this._onMove,this._onDidChange,this._onDidDrop,this._onWillDrop,this._onDidAddPanel,this._onDidRemovePanel,this._onDidActivePanelChange,this._onUnhandledDragOverEvent,this._onDidPanelTitleChange,this._onDidPanelParametersChange)}focusContent(){this.contentContainer.element.focus()}set renderContainer(e){this.panels.forEach(n=>{this.renderContainer.detatch(n)}),this._overwriteRenderContainer=e,this.panels.forEach(n=>{this.rerender(n)})}get renderContainer(){var e;return(e=this._overwriteRenderContainer)!==null&&e!==void 0?e:this.accessor.overlayRenderContainer}set dropTargetContainer(e){this._overwriteDropTargetContainer=e}get dropTargetContainer(){var e;return(e=this._overwriteDropTargetContainer)!==null&&e!==void 0?e:this.accessor.rootDropTargetContainer}initialize(){this.options.panels&&this.options.panels.forEach(e=>{this.doAddPanel(e)}),this.options.activePanel&&this.openPanel(this.options.activePanel),this.setActive(this.isActive,!0),this.updateContainer(),this.accessor.options.createRightHeaderActionComponent&&(this._rightHeaderActions=this.accessor.options.createRightHeaderActionComponent(this.groupPanel),this.addDisposables(this._rightHeaderActions),this._rightHeaderActions.init({containerApi:this._api,api:this.groupPanel.api,group:this.groupPanel}),this.tabsContainer.setRightActionsElement(this._rightHeaderActions.element)),this.accessor.options.createLeftHeaderActionComponent&&(this._leftHeaderActions=this.accessor.options.createLeftHeaderActionComponent(this.groupPanel),this.addDisposables(this._leftHeaderActions),this._leftHeaderActions.init({containerApi:this._api,api:this.groupPanel.api,group:this.groupPanel}),this.tabsContainer.setLeftActionsElement(this._leftHeaderActions.element)),this.accessor.options.createPrefixHeaderActionComponent&&(this._prefixHeaderActions=this.accessor.options.createPrefixHeaderActionComponent(this.groupPanel),this.addDisposables(this._prefixHeaderActions),this._prefixHeaderActions.init({containerApi:this._api,api:this.groupPanel.api,group:this.groupPanel}),this.tabsContainer.setPrefixActionsElement(this._prefixHeaderActions.element))}rerender(e){this.contentContainer.renderPanel(e,{asActive:!1})}indexOf(e){return this.tabsContainer.indexOf(e.id)}toJSON(){var e;const n={views:this.tabsContainer.panels,activeView:(e=this._activePanel)===null||e===void 0?void 0:e.id,id:this.id};return this.locked!==!1&&(n.locked=this.locked),this.header.hidden&&(n.hideHeader=!0),n}moveToNext(e){e||(e={}),e.panel||(e.panel=this.activePanel);const n=e.panel?this.panels.indexOf(e.panel):-1;let i;if(n<this.panels.length-1)i=n+1;else if(!e.suppressRoll)i=0;else return;this.openPanel(this.panels[i])}moveToPrevious(e){if(e||(e={}),e.panel||(e.panel=this.activePanel),!e.panel)return;const n=this.panels.indexOf(e.panel);let i;if(n>0)i=n-1;else if(!e.suppressRoll)i=this.panels.length-1;else return;this.openPanel(this.panels[i])}containsPanel(e){return this.panels.includes(e)}init(e){}update(e){}focus(){var e;(e=this._activePanel)===null||e===void 0||e.focus()}openPanel(e,n={}){(typeof n.index!="number"||n.index>this.panels.length)&&(n.index=this.panels.length);const i=!!n.skipSetActive;if(e.updateParentGroup(this.groupPanel,{skipSetActive:n.skipSetActive}),this.doAddPanel(e,n.index,{skipSetActive:i}),this._activePanel===e){this.contentContainer.renderPanel(e,{asActive:!0});return}i||this.doSetActivePanel(e),n.skipSetGroupActive||this.accessor.doSetGroupActive(this.groupPanel),n.skipSetActive||this.updateContainer()}removePanel(e,n={skipSetActive:!1}){const i=typeof e=="string"?e:e.id,r=this._panels.find(s=>s.id===i);if(!r)throw new Error("invalid operation");return this._removePanel(r,n)}closeAllPanels(){if(this.panels.length>0){const e=[...this.panels];for(const n of e)this.doClose(n)}else this.accessor.removeGroup(this.groupPanel)}closePanel(e){this.doClose(e)}doClose(e){const n=this.panels.length===1&&this.accessor.groups.length===1;this.accessor.removePanel(e,n&&this.accessor.options.noPanelsOverlay==="emptyGroup"?{removeEmptyGroup:!1}:void 0)}isPanelActive(e){return this._activePanel===e}updateActions(e){this.tabsContainer.setRightActionsElement(e)}setActive(e,n=!1){!n&&this.isActive===e||(this._isGroupActive=e,we(this.container,"dv-active-group",e),we(this.container,"dv-inactive-group",!e),this.tabsContainer.setActive(this.isActive),!this._activePanel&&this.panels.length>0&&this.doSetActivePanel(this.panels[0]),this.updateContainer())}layout(e,n){var i;this._width=e,this._height=n,this.contentContainer.layout(this._width,this._height),!((i=this._activePanel)===null||i===void 0)&&i.layout&&this._activePanel.layout(this._width,this._height)}_removePanel(e,n){const i=this._activePanel===e;if(this.doRemovePanel(e),i&&this.panels.length>0){const r=this.mostRecentlyUsed[0];this.openPanel(r,{skipSetActive:n.skipSetActive,skipSetGroupActive:n.skipSetActiveGroup})}return this._activePanel&&this.panels.length===0&&this.doSetActivePanel(void 0),n.skipSetActive||this.updateContainer(),e}doRemovePanel(e){const n=this.panels.indexOf(e);if(this._activePanel===e&&this.contentContainer.closePanel(),this.tabsContainer.delete(e.id),this._panels.splice(n,1),this.mostRecentlyUsed.includes(e)){const r=this.mostRecentlyUsed.indexOf(e);this.mostRecentlyUsed.splice(r,1)}const i=this._panelDisposables.get(e.id);i&&(i.dispose(),this._panelDisposables.delete(e.id)),this._onDidRemovePanel.fire({panel:e})}doAddPanel(e,n=this.panels.length,i={skipSetActive:!1}){const s=this._panels.indexOf(e)>-1;this.tabsContainer.show(),this.contentContainer.show(),this.tabsContainer.openPanel(e,n),i.skipSetActive||this.contentContainer.openPanel(e),!s&&(this.updateMru(e),this.panels.splice(n,0,e),this._panelDisposables.set(e.id,new Se(e.api.onDidTitleChange(a=>this._onDidPanelTitleChange.fire(a)),e.api.onDidParametersChange(a=>this._onDidPanelParametersChange.fire(a)))),this._onDidAddPanel.fire({panel:e}))}doSetActivePanel(e){this._activePanel!==e&&(this._activePanel=e,e&&(this.tabsContainer.setActivePanel(e),this.contentContainer.openPanel(e),e.layout(this._width,this._height),this.updateMru(e),this.contentContainer.refreshFocusState(),this._onDidActivePanelChange.fire({panel:e})))}updateMru(e){this.mostRecentlyUsed.includes(e)&&this.mostRecentlyUsed.splice(this.mostRecentlyUsed.indexOf(e),1),this.mostRecentlyUsed=[e,...this.mostRecentlyUsed]}updateContainer(){var e,n;if(this.panels.forEach(i=>i.runEvents()),this.isEmpty&&!this.watermark){const i=this.accessor.createWatermarkComponent();i.init({containerApi:this._api,group:this.groupPanel}),this.watermark=i,Me(this.watermark.element,"pointerdown",()=>{this.isActive||this.accessor.doSetGroupActive(this.groupPanel)}),this.contentContainer.element.appendChild(this.watermark.element)}!this.isEmpty&&this.watermark&&(this.watermark.element.remove(),(n=(e=this.watermark).dispose)===null||n===void 0||n.call(e),this.watermark=void 0)}canDisplayOverlay(e,n,i){const r=new wx(e,i,n,Gt,this.accessor.getPanel(this.id));return this._onUnhandledDragOverEvent.fire(r),r.isAccepted}handleDropEvent(e,n,i,r){if(this.locked==="no-drop-target")return;function s(){switch(e){case"header":return typeof r=="number"?"tab":"header_space";case"content":return"content"}}const a=typeof r=="number"?this.panels[r]:void 0,o=new Sx({nativeEvent:n,position:i,panel:a,getData:()=>Gt(),kind:s(),group:this.groupPanel,api:this._api});if(this._onWillDrop.fire(o),o.defaultPrevented)return;const l=Gt();if(l&&l.viewId===this.accessor.id){if(e==="content"&&l.groupId===this.id&&(i==="center"||l.panelId===null)||e==="header"&&l.groupId===this.id&&l.panelId===null)return;if(l.panelId===null){const{groupId:p}=l;this._onMove.fire({target:i,groupId:p,index:r});return}if(this.tabsContainer.indexOf(l.panelId)!==-1&&this.tabsContainer.size===1)return;const{groupId:c,panelId:h}=l;if(this.id===c&&!i&&this.tabsContainer.indexOf(h)===r)return;this._onMove.fire({target:i,groupId:l.groupId,itemId:l.panelId,index:r})}else this._onDidDrop.fire(new rg({nativeEvent:n,position:i,panel:a,getData:()=>Gt(),group:this.groupPanel,api:this._api}))}updateDragAndDropState(){this.tabsContainer.updateDragAndDropState()}dispose(){var e,n,i;super.dispose(),(e=this.watermark)===null||e===void 0||e.element.remove(),(i=(n=this.watermark)===null||n===void 0?void 0:n.dispose)===null||i===void 0||i.call(n),this.watermark=void 0;for(const r of this.panels)r.dispose();this.tabsContainer.dispose(),this.contentContainer.dispose()}}class sg extends vx{constructor(e,n,i){super(e,n),this._onDidConstraintsChangeInternal=new J,this.onDidConstraintsChangeInternal=this._onDidConstraintsChangeInternal.event,this._onDidConstraintsChange=new J,this.onDidConstraintsChange=this._onDidConstraintsChange.event,this._onDidSizeChange=new J,this.onDidSizeChange=this._onDidSizeChange.event,this.addDisposables(this._onDidConstraintsChangeInternal,this._onDidConstraintsChange,this._onDidSizeChange),i&&this.initialize(i)}setConstraints(e){this._onDidConstraintsChangeInternal.fire(e)}setSize(e){this._onDidSizeChange.fire(e)}}class xx extends ng{get priority(){return this._priority}get snap(){return this._snap}get minimumWidth(){return this.__minimumWidth()}get minimumHeight(){return this.__minimumHeight()}get maximumHeight(){return this.__maximumHeight()}get maximumWidth(){return this.__maximumWidth()}__minimumWidth(){const e=typeof this._minimumWidth=="function"?this._minimumWidth():this._minimumWidth;return e!==this._evaluatedMinimumWidth&&(this._evaluatedMinimumWidth=e,this.updateConstraints()),e}__maximumWidth(){const e=typeof this._maximumWidth=="function"?this._maximumWidth():this._maximumWidth;return e!==this._evaluatedMaximumWidth&&(this._evaluatedMaximumWidth=e,this.updateConstraints()),e}__minimumHeight(){const e=typeof this._minimumHeight=="function"?this._minimumHeight():this._minimumHeight;return e!==this._evaluatedMinimumHeight&&(this._evaluatedMinimumHeight=e,this.updateConstraints()),e}__maximumHeight(){const e=typeof this._maximumHeight=="function"?this._maximumHeight():this._maximumHeight;return e!==this._evaluatedMaximumHeight&&(this._evaluatedMaximumHeight=e,this.updateConstraints()),e}get isActive(){return this.api.isActive}get isVisible(){return this.api.isVisible}constructor(e,n,i,r){super(e,n,r??new sg(e,n)),this._evaluatedMinimumWidth=0,this._evaluatedMaximumWidth=Number.MAX_SAFE_INTEGER,this._evaluatedMinimumHeight=0,this._evaluatedMaximumHeight=Number.MAX_SAFE_INTEGER,this._minimumWidth=0,this._minimumHeight=0,this._maximumWidth=Number.MAX_SAFE_INTEGER,this._maximumHeight=Number.MAX_SAFE_INTEGER,this._snap=!1,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,typeof(i==null?void 0:i.minimumWidth)=="number"&&(this._minimumWidth=i.minimumWidth),typeof(i==null?void 0:i.maximumWidth)=="number"&&(this._maximumWidth=i.maximumWidth),typeof(i==null?void 0:i.minimumHeight)=="number"&&(this._minimumHeight=i.minimumHeight),typeof(i==null?void 0:i.maximumHeight)=="number"&&(this._maximumHeight=i.maximumHeight),this.api.initialize(this),this.addDisposables(this.api.onWillVisibilityChange(s=>{const{isVisible:a}=s,{accessor:o}=this._params;o.setVisible(this,a)}),this.api.onActiveChange(()=>{const{accessor:s}=this._params;s.doSetGroupActive(this)}),this.api.onDidConstraintsChangeInternal(s=>{(typeof s.minimumWidth=="number"||typeof s.minimumWidth=="function")&&(this._minimumWidth=s.minimumWidth),(typeof s.minimumHeight=="number"||typeof s.minimumHeight=="function")&&(this._minimumHeight=s.minimumHeight),(typeof s.maximumWidth=="number"||typeof s.maximumWidth=="function")&&(this._maximumWidth=s.maximumWidth),(typeof s.maximumHeight=="number"||typeof s.maximumHeight=="function")&&(this._maximumHeight=s.maximumHeight)}),this.api.onDidSizeChange(s=>{this._onDidChange.fire({height:s.height,width:s.width})}),this._onDidChange)}setVisible(e){this.api._onDidVisibilityChange.fire({isVisible:e})}setActive(e){this.api._onDidActiveChange.fire({isActive:e})}init(e){e.maximumHeight&&(this._maximumHeight=e.maximumHeight),e.minimumHeight&&(this._minimumHeight=e.minimumHeight),e.maximumWidth&&(this._maximumWidth=e.maximumWidth),e.minimumWidth&&(this._minimumWidth=e.minimumWidth),this._priority=e.priority,this._snap=!!e.snap,super.init(e),typeof e.isVisible=="boolean"&&this.setVisible(e.isVisible)}updateConstraints(){this.api._onDidConstraintsChange.fire({minimumWidth:this._evaluatedMinimumWidth,maximumWidth:this._evaluatedMaximumWidth,minimumHeight:this._evaluatedMinimumHeight,maximumHeight:this._evaluatedMaximumHeight})}toJSON(){const e=super.toJSON(),n=r=>r===Number.MAX_SAFE_INTEGER?void 0:r,i=r=>r<=0?void 0:r;return Object.assign(Object.assign({},e),{minimumHeight:i(this.minimumHeight),maximumHeight:n(this.maximumHeight),minimumWidth:i(this.minimumWidth),maximumWidth:n(this.maximumWidth),snap:this.snap,priority:this.priority})}}const Xo="dockview: DockviewGroupPanelApiImpl not initialized";class DT extends sg{get location(){if(!this._group)throw new Error(Xo);return this._group.model.location}constructor(e,n){super(e,"__dockviewgroup__"),this.accessor=n,this._onDidLocationChange=new J,this.onDidLocationChange=this._onDidLocationChange.event,this._onDidActivePanelChange=new J,this.onDidActivePanelChange=this._onDidActivePanelChange.event,this.addDisposables(this._onDidLocationChange,this._onDidActivePanelChange,this._onDidVisibilityChange.event(i=>{i.isVisible&&this._pendingSize&&(super.setSize(this._pendingSize),this._pendingSize=void 0)}))}setSize(e){this._pendingSize=Object.assign({},e),super.setSize(e)}close(){if(this._group)return this.accessor.removeGroup(this._group)}getWindow(){return this.location.type==="popout"?this.location.getWindow():window}moveTo(e){var n,i,r,s;if(!this._group)throw new Error(Xo);const a=(n=e.group)!==null&&n!==void 0?n:this.accessor.addGroup({direction:tT((i=e.position)!==null&&i!==void 0?i:"right"),skipSetActive:(r=e.skipSetActive)!==null&&r!==void 0?r:!1});this.accessor.moveGroupOrPanel({from:{groupId:this._group.id},to:{group:a,position:e.group&&(s=e.position)!==null&&s!==void 0?s:"center",index:e.index},skipSetActive:e.skipSetActive})}maximize(){if(!this._group)throw new Error(Xo);this.location.type==="grid"&&this.accessor.maximizeGroup(this._group)}isMaximized(){if(!this._group)throw new Error(Xo);return this.accessor.isMaximizedGroup(this._group)}exitMaximized(){if(!this._group)throw new Error(Xo);this.isMaximized()&&this.accessor.exitMaximizedGroup()}initialize(e){this._group=e}}const AT=100,TT=100;class H_ extends xx{get minimumWidth(){var e;if(typeof this._explicitConstraints.minimumWidth=="number")return this._explicitConstraints.minimumWidth;const n=(e=this.activePanel)===null||e===void 0?void 0:e.minimumWidth;return typeof n=="number"?n:super.__minimumWidth()}get minimumHeight(){var e;if(typeof this._explicitConstraints.minimumHeight=="number")return this._explicitConstraints.minimumHeight;const n=(e=this.activePanel)===null||e===void 0?void 0:e.minimumHeight;return typeof n=="number"?n:super.__minimumHeight()}get maximumWidth(){var e;if(typeof this._explicitConstraints.maximumWidth=="number")return this._explicitConstraints.maximumWidth;const n=(e=this.activePanel)===null||e===void 0?void 0:e.maximumWidth;return typeof n=="number"?n:super.__maximumWidth()}get maximumHeight(){var e;if(typeof this._explicitConstraints.maximumHeight=="number")return this._explicitConstraints.maximumHeight;const n=(e=this.activePanel)===null||e===void 0?void 0:e.maximumHeight;return typeof n=="number"?n:super.__maximumHeight()}get panels(){return this._model.panels}get activePanel(){return this._model.activePanel}get size(){return this._model.size}get model(){return this._model}get locked(){return this._model.locked}set locked(e){this._model.locked=e}get header(){return this._model.header}constructor(e,n,i){var r,s,a,o,l,u;super(n,"groupview_default",{minimumHeight:(s=(r=i.constraints)===null||r===void 0?void 0:r.minimumHeight)!==null&&s!==void 0?s:TT,minimumWidth:(o=(a=i.constraints)===null||a===void 0?void 0:a.minimumWidth)!==null&&o!==void 0?o:AT,maximumHeight:(l=i.constraints)===null||l===void 0?void 0:l.maximumHeight,maximumWidth:(u=i.constraints)===null||u===void 0?void 0:u.maximumWidth},new DT(n,e)),this._explicitConstraints={},this.api.initialize(this),this._model=new ET(this.element,e,n,i,this),this.addDisposables(this.model.onDidActivePanelChange(c=>{this.api._onDidActivePanelChange.fire(c)}),this.api.onDidConstraintsChangeInternal(c=>{c.minimumWidth!==void 0&&(this._explicitConstraints.minimumWidth=typeof c.minimumWidth=="function"?c.minimumWidth():c.minimumWidth),c.minimumHeight!==void 0&&(this._explicitConstraints.minimumHeight=typeof c.minimumHeight=="function"?c.minimumHeight():c.minimumHeight),c.maximumWidth!==void 0&&(this._explicitConstraints.maximumWidth=typeof c.maximumWidth=="function"?c.maximumWidth():c.maximumWidth),c.maximumHeight!==void 0&&(this._explicitConstraints.maximumHeight=typeof c.maximumHeight=="function"?c.maximumHeight():c.maximumHeight)}))}focus(){this.api.isActive||this.api.setActive(),super.focus()}initialize(){this._model.initialize()}setActive(e){super.setActive(e),this.model.setActive(e)}layout(e,n){super.layout(e,n),this.model.layout(e,n)}getComponent(){return this._model}toJSON(){return this.model.toJSON()}}const MT={className:"dockview-theme-abyss"};class RT extends sg{get location(){return this.group.api.location}get title(){return this.panel.title}get isGroupActive(){return this.group.isActive}get renderer(){return this.panel.renderer}set group(e){const n=this._group;this._group!==e&&(this._group=e,this._onDidGroupChange.fire({}),this.setupGroupEventListeners(n),this._onDidLocationChange.fire({location:this.group.api.location}))}get group(){return this._group}get tabComponent(){return this._tabComponent}constructor(e,n,i,r,s){super(e.id,r),this.panel=e,this.accessor=i,this._onDidTitleChange=new J,this.onDidTitleChange=this._onDidTitleChange.event,this._onDidActiveGroupChange=new J,this.onDidActiveGroupChange=this._onDidActiveGroupChange.event,this._onDidGroupChange=new J,this.onDidGroupChange=this._onDidGroupChange.event,this._onDidRendererChange=new J,this.onDidRendererChange=this._onDidRendererChange.event,this._onDidLocationChange=new J,this.onDidLocationChange=this._onDidLocationChange.event,this.groupEventsDisposable=new qt,this._tabComponent=s,this.initialize(e),this._group=n,this.setupGroupEventListeners(),this.addDisposables(this.groupEventsDisposable,this._onDidRendererChange,this._onDidTitleChange,this._onDidGroupChange,this._onDidActiveGroupChange,this._onDidLocationChange)}getWindow(){return this.group.api.getWindow()}moveTo(e){var n,i;this.accessor.moveGroupOrPanel({from:{groupId:this._group.id,panelId:this.panel.id},to:{group:(n=e.group)!==null&&n!==void 0?n:this._group,position:e.group&&(i=e.position)!==null&&i!==void 0?i:"center",index:e.index},skipSetActive:e.skipSetActive})}setTitle(e){this.panel.setTitle(e)}setRenderer(e){this.panel.setRenderer(e)}close(){this.group.model.closePanel(this.panel)}maximize(){this.group.api.maximize()}isMaximized(){return this.group.api.isMaximized()}exitMaximized(){this.group.api.exitMaximized()}setupGroupEventListeners(e){var n;let i=(n=e==null?void 0:e.isActive)!==null&&n!==void 0?n:!1;this.groupEventsDisposable.value=new Se(this.group.api.onDidVisibilityChange(r=>{const s=!r.isVisible&&this.isVisible,a=r.isVisible&&!this.isVisible,o=this.group.model.isPanelActive(this.panel);(s||a&&o)&&this._onDidVisibilityChange.fire(r)}),this.group.api.onDidLocationChange(r=>{this.group===this.panel.group&&this._onDidLocationChange.fire(r)}),this.group.api.onDidActiveChange(()=>{this.group===this.panel.group&&i!==this.isGroupActive&&(i=this.isGroupActive,this._onDidActiveGroupChange.fire({isActive:this.isGroupActive}))}))}}class Hs extends Se{get params(){return this._params}get title(){return this._title}get group(){return this._group}get renderer(){var e;return(e=this._renderer)!==null&&e!==void 0?e:this.accessor.renderer}get minimumWidth(){return this._minimumWidth}get minimumHeight(){return this._minimumHeight}get maximumWidth(){return this._maximumWidth}get maximumHeight(){return this._maximumHeight}constructor(e,n,i,r,s,a,o,l){super(),this.id=e,this.accessor=r,this.containerApi=s,this.view=o,this._renderer=l.renderer,this._group=a,this._minimumWidth=l.minimumWidth,this._minimumHeight=l.minimumHeight,this._maximumWidth=l.maximumWidth,this._maximumHeight=l.maximumHeight,this.api=new RT(this,this._group,r,n,i),this.addDisposables(this.api.onActiveChange(()=>{r.setActivePanel(this)}),this.api.onDidSizeChange(u=>{this.group.api.setSize(u)}),this.api.onDidRendererChange(()=>{this.group.model.rerender(this)}))}init(e){this._params=e.params,this.view.init(Object.assign(Object.assign({},e),{api:this.api,containerApi:this.containerApi})),this.setTitle(e.title)}focus(){const e=new gx;this.api._onWillFocus.fire(e),!e.defaultPrevented&&(this.api.isActive||this.api.setActive())}toJSON(){return{id:this.id,contentComponent:this.view.contentComponent,tabComponent:this.view.tabComponent,params:Object.keys(this._params||{}).length>0?this._params:void 0,title:this.title,renderer:this._renderer,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,minimumWidth:this._minimumWidth,maximumWidth:this._maximumWidth}}setTitle(e){e!==this.title&&(this._title=e,this.api._onDidTitleChange.fire({title:e}))}setRenderer(e){e!==this.renderer&&(this._renderer=e,this.api._onDidRendererChange.fire({renderer:e}))}update(e){var n;this._params=Object.assign(Object.assign({},(n=this._params)!==null&&n!==void 0?n:{}),e.params);for(const i of Object.keys(e.params))e.params[i]===void 0&&delete this._params[i];this.view.update({params:this._params})}updateFromStateModel(e){var n,i,r;this._maximumHeight=e.maximumHeight,this._minimumHeight=e.minimumHeight,this._maximumWidth=e.maximumWidth,this._minimumWidth=e.minimumWidth,this.update({params:(n=e.params)!==null&&n!==void 0?n:{}}),this.setTitle((i=e.title)!==null&&i!==void 0?i:this.id),this.setRenderer((r=e.renderer)!==null&&r!==void 0?r:this.accessor.renderer)}updateParentGroup(e,n){this._group=e,this.api.group=this._group;const i=this._group.model.isPanelActive(this),r=this.group.api.isActive&&i;n!=null&&n.skipSetActive||this.api.isActive!==r&&this.api._onDidActiveChange.fire({isActive:this.group.api.isActive&&i}),this.api.isVisible!==i&&this.api._onDidVisibilityChange.fire({isVisible:i})}runEvents(){const e=this._group.model.isPanelActive(this),n=this.group.api.isActive&&e;this.api.isActive!==n&&this.api._onDidActiveChange.fire({isActive:this.group.api.isActive&&e}),this.api.isVisible!==e&&this.api._onDidVisibilityChange.fire({isVisible:e})}layout(e,n){this.api._onDidDimensionChange.fire({width:e,height:n}),this.view.layout(e,n)}dispose(){this.api.dispose(),this.view.dispose()}}class $_ extends Se{get element(){return this._element}constructor(){super(),this._element=document.createElement("div"),this._element.className="dv-default-tab",this._content=document.createElement("div"),this._content.className="dv-default-tab-content",this.action=document.createElement("div"),this.action.className="dv-default-tab-action",this.action.appendChild(_T()),this._element.appendChild(this._content),this._element.appendChild(this.action),this.render()}init(e){this._title=e.title,this.addDisposables(e.api.onDidTitleChange(n=>{this._title=n.title,this.render()}),Me(this.action,"pointerdown",n=>{n.preventDefault()}),Me(this.action,"click",n=>{n.defaultPrevented||(n.preventDefault(),e.api.close())})),this.render()}render(){var e;this._content.textContent!==this._title&&(this._content.textContent=(e=this._title)!==null&&e!==void 0?e:"")}}class kx{get content(){return this._content}get tab(){return this._tab}constructor(e,n,i,r){this.accessor=e,this.id=n,this.contentComponent=i,this.tabComponent=r,this._content=this.createContentComponent(this.id,i),this._tab=this.createTabComponent(this.id,r)}createTabRenderer(e){var n;const i=this.createTabComponent(this.id,this.tabComponent);return this._params&&i.init(Object.assign(Object.assign({},this._params),{tabLocation:e})),this._updateEvent&&((n=i.update)===null||n===void 0||n.call(i,this._updateEvent)),i}init(e){this._params=e,this.content.init(e),this.tab.init(Object.assign(Object.assign({},e),{tabLocation:"header"}))}layout(e,n){var i,r;(r=(i=this.content).layout)===null||r===void 0||r.call(i,e,n)}update(e){var n,i,r,s;this._updateEvent=e,(i=(n=this.content).update)===null||i===void 0||i.call(n,e),(s=(r=this.tab).update)===null||s===void 0||s.call(r,e)}dispose(){var e,n,i,r;(n=(e=this.content).dispose)===null||n===void 0||n.call(e),(r=(i=this.tab).dispose)===null||r===void 0||r.call(i)}createContentComponent(e,n){return this.accessor.options.createComponent({id:e,name:n})}createTabComponent(e,n){const i=n??this.accessor.options.defaultTabComponent;if(i){if(this.accessor.options.createTabComponent){const r=this.accessor.options.createTabComponent({id:e,name:i});return r||new $_}console.warn(`dockview: tabComponent '${n}' was not found. falling back to the default tab.`)}return new $_}}class OT{constructor(e){this.accessor=e}fromJSON(e,n){var i,r;const s=e.id,a=e.params,o=e.title,l=e.view,u=l?l.content.id:(i=e.contentComponent)!==null&&i!==void 0?i:"unknown",c=l?(r=l.tab)===null||r===void 0?void 0:r.id:e.tabComponent,h=new kx(this.accessor,s,u,c),d=new Hs(s,u,c,this.accessor,new Nc(this.accessor),n,h,{renderer:e.renderer,minimumWidth:e.minimumWidth,minimumHeight:e.minimumHeight,maximumWidth:e.maximumWidth,maximumHeight:e.maximumHeight});return d.init({title:o??s,params:a??{}}),d}}class PT extends Se{get element(){return this._element}constructor(){super(),this._element=document.createElement("div"),this._element.className="dv-watermark"}init(e){}}class NT{constructor(){this._orderedList=[]}push(e){this._orderedList=[...this._orderedList.filter(n=>n!==e),e],this.update()}destroy(e){this._orderedList=this._orderedList.filter(n=>n!==e),this.update()}update(){for(let e=0;e<this._orderedList.length;e++)this._orderedList[e].setAttribute("aria-level",`${e}`),this._orderedList[e].style.zIndex=`calc(var(--dv-overlay-z-index, 999) + ${e*2})`}}const au=new NT;class di extends Se{set minimumInViewportWidth(e){this.options.minimumInViewportWidth=e}set minimumInViewportHeight(e){this.options.minimumInViewportHeight=e}get element(){return this._element}get isVisible(){return this._isVisible}constructor(e){super(),this.options=e,this._element=document.createElement("div"),this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._onDidChangeEnd=new J,this.onDidChangeEnd=this._onDidChangeEnd.event,this.addDisposables(this._onDidChange,this._onDidChangeEnd),this._element.className="dv-resize-container",this._isVisible=!0,this.setupResize("top"),this.setupResize("bottom"),this.setupResize("left"),this.setupResize("right"),this.setupResize("topleft"),this.setupResize("topright"),this.setupResize("bottomleft"),this.setupResize("bottomright"),this._element.appendChild(this.options.content),this.options.container.appendChild(this._element),this.setBounds(Object.assign(Object.assign(Object.assign(Object.assign({height:this.options.height,width:this.options.width},"top"in this.options&&{top:this.options.top}),"bottom"in this.options&&{bottom:this.options.bottom}),"left"in this.options&&{left:this.options.left}),"right"in this.options&&{right:this.options.right})),au.push(this._element)}setVisible(e){e!==this.isVisible&&(this._isVisible=e,we(this.element,"dv-hidden",!this.isVisible))}bringToFront(){au.push(this._element)}setBounds(e={}){typeof e.height=="number"&&(this._element.style.height=`${e.height}px`),typeof e.width=="number"&&(this._element.style.width=`${e.width}px`),"top"in e&&typeof e.top=="number"&&(this._element.style.top=`${e.top}px`,this._element.style.bottom="auto",this.verticalAlignment="top"),"bottom"in e&&typeof e.bottom=="number"&&(this._element.style.bottom=`${e.bottom}px`,this._element.style.top="auto",this.verticalAlignment="bottom"),"left"in e&&typeof e.left=="number"&&(this._element.style.left=`${e.left}px`,this._element.style.right="auto",this.horiziontalAlignment="left"),"right"in e&&typeof e.right=="number"&&(this._element.style.right=`${e.right}px`,this._element.style.left="auto",this.horiziontalAlignment="right");const n=this.options.container.getBoundingClientRect(),i=this._element.getBoundingClientRect(),r=Math.max(0,this.getMinimumWidth(i.width)),s=Math.max(0,this.getMinimumHeight(i.height));if(this.verticalAlignment==="top"){const a=Je(i.top-n.top,-s,Math.max(0,n.height-i.height+s));this._element.style.top=`${a}px`,this._element.style.bottom="auto"}if(this.verticalAlignment==="bottom"){const a=Je(n.bottom-i.bottom,-s,Math.max(0,n.height-i.height+s));this._element.style.bottom=`${a}px`,this._element.style.top="auto"}if(this.horiziontalAlignment==="left"){const a=Je(i.left-n.left,-r,Math.max(0,n.width-i.width+r));this._element.style.left=`${a}px`,this._element.style.right="auto"}if(this.horiziontalAlignment==="right"){const a=Je(n.right-i.right,-r,Math.max(0,n.width-i.width+r));this._element.style.right=`${a}px`,this._element.style.left="auto"}this._onDidChange.fire()}toJSON(){const e=this.options.container.getBoundingClientRect(),n=this._element.getBoundingClientRect(),i={};return this.verticalAlignment==="top"?i.top=parseFloat(this._element.style.top):this.verticalAlignment==="bottom"?i.bottom=parseFloat(this._element.style.bottom):i.top=n.top-e.top,this.horiziontalAlignment==="left"?i.left=parseFloat(this._element.style.left):this.horiziontalAlignment==="right"?i.right=parseFloat(this._element.style.right):i.left=n.left-e.left,i.width=n.width,i.height=n.height,i}setupDrag(e,n={inDragMode:!1}){const i=new qt,r=()=>{let s=null;const a=Oc();i.value=new Se({dispose:()=>{a.release()}},Me(window,"pointermove",o=>{const l=this.options.container.getBoundingClientRect(),u=o.clientX-l.left,c=o.clientY-l.top;we(this._element,"dv-resize-container-dragging",!0);const h=this._element.getBoundingClientRect();s===null&&(s={x:o.clientX-h.left,y:o.clientY-h.top});const d=Math.max(0,this.getMinimumWidth(h.width)),p=Math.max(0,this.getMinimumHeight(h.height)),m=Je(c-s.y,-p,Math.max(0,l.height-h.height+p)),_=Je(s.y-c+l.height-h.height,-p,Math.max(0,l.height-h.height+p)),f=Je(u-s.x,-d,Math.max(0,l.width-h.width+d)),v=Je(s.x-u+l.width-h.width,-d,Math.max(0,l.width-h.width+d)),g={};m<=_?g.top=m:g.bottom=_,f<=v?g.left=f:g.right=v,this.setBounds(g)}),Me(window,"pointerup",()=>{we(this._element,"dv-resize-container-dragging",!1),i.dispose(),this._onDidChangeEnd.fire()}))};this.addDisposables(i,Me(e,"pointerdown",s=>{if(s.defaultPrevented){s.preventDefault();return}z_(s)||r()}),Me(this.options.content,"pointerdown",s=>{s.defaultPrevented||z_(s)||s.shiftKey&&r()}),Me(this.options.content,"pointerdown",()=>{au.push(this._element)},!0)),n.inDragMode&&r()}setupResize(e){const n=document.createElement("div");n.className=`dv-resize-handle-${e}`,this._element.appendChild(n);const i=new qt;this.addDisposables(i,Me(n,"pointerdown",r=>{r.preventDefault();let s=null;const a=Oc();i.value=new Se(Me(window,"pointermove",o=>{const l=this.options.container.getBoundingClientRect(),u=this._element.getBoundingClientRect(),c=o.clientY-l.top,h=o.clientX-l.left;s===null&&(s={originalY:c,originalHeight:u.height,originalX:h,originalWidth:u.width});let d,p,m,_,f,v;const g=()=>{const k=s.originalY+s.originalHeight>l.height?Math.max(0,l.height-di.MINIMUM_HEIGHT):Math.max(0,s.originalY+s.originalHeight-di.MINIMUM_HEIGHT);d=Je(c,0,k),m=s.originalY+s.originalHeight-d,p=l.height-d-m},y=()=>{d=s.originalY-s.originalHeight;const k=d<0&&typeof this.options.minimumInViewportHeight=="number"?-d+this.options.minimumInViewportHeight:di.MINIMUM_HEIGHT,S=l.height-Math.max(0,d);m=Je(c-d,k,S),p=l.height-d-m},b=()=>{const k=s.originalX+s.originalWidth>l.width?Math.max(0,l.width-di.MINIMUM_WIDTH):Math.max(0,s.originalX+s.originalWidth-di.MINIMUM_WIDTH);_=Je(h,0,k),v=s.originalX+s.originalWidth-_,f=l.width-_-v},w=()=>{_=s.originalX-s.originalWidth;const k=_<0&&typeof this.options.minimumInViewportWidth=="number"?-_+this.options.minimumInViewportWidth:di.MINIMUM_WIDTH,S=l.width-Math.max(0,_);v=Je(h-_,k,S),f=l.width-_-v};switch(e){case"top":g();break;case"bottom":y();break;case"left":b();break;case"right":w();break;case"topleft":g(),b();break;case"topright":g(),w();break;case"bottomleft":y(),b();break;case"bottomright":y(),w();break}const x={};d<=p?x.top=d:x.bottom=p,_<=f?x.left=_:x.right=f,x.height=m,x.width=v,this.setBounds(x)}),{dispose:()=>{a.release()}},Me(window,"pointerup",()=>{i.dispose(),this._onDidChangeEnd.fire()}))}))}getMinimumWidth(e){return typeof this.options.minimumInViewportWidth=="number"?e-this.options.minimumInViewportWidth:0}getMinimumHeight(e){return typeof this.options.minimumInViewportHeight=="number"?e-this.options.minimumInViewportHeight:0}dispose(){au.destroy(this._element),this._element.remove(),super.dispose()}}di.MINIMUM_HEIGHT=20;di.MINIMUM_WIDTH=20;class IT extends Se{constructor(e,n){super(),this.group=e,this.overlay=n,this.addDisposables(n)}position(e){this.overlay.setBounds(e)}}const lu=100,er={left:100,top:100,width:300,height:300},LT=100;class BT{constructor(){this.cache=new Map,this.currentFrameId=0,this.rafId=null}getPosition(e){const n=this.cache.get(e);if(n&&n.frameId===this.currentFrameId)return n.rect;this.scheduleFrameUpdate();const i=Jp(e);return this.cache.set(e,{rect:i,frameId:this.currentFrameId}),i}invalidate(){this.currentFrameId++}scheduleFrameUpdate(){this.rafId||(this.rafId=requestAnimationFrame(()=>{this.currentFrameId++,this.rafId=null}))}}function zT(){const t=document.createElement("div");return t.tabIndex=-1,t}class W_ extends Se{constructor(e,n){super(),this.element=e,this.accessor=n,this.map={},this._disposed=!1,this.positionCache=new BT,this.pendingUpdates=new Set,this.addDisposables(pt.from(()=>{for(const i of Object.values(this.map))i.disposable.dispose(),i.destroy.dispose();this._disposed=!0}))}updateAllPositions(){if(!this._disposed){this.positionCache.invalidate();for(const e of Object.values(this.map))e.panel.api.isVisible&&e.resize&&e.resize()}}detatch(e){if(this.map[e.api.id]){const{disposable:n,destroy:i}=this.map[e.api.id];return n.dispose(),i.dispose(),delete this.map[e.api.id],!0}return!1}attach(e){const{panel:n,referenceContainer:i}=e;if(!this.map[n.api.id]){const c=zT();c.className="dv-render-overlay",this.map[n.api.id]={panel:n,disposable:pt.NONE,destroy:pt.NONE,element:c}}const r=this.map[n.api.id].element;n.view.content.element.parentElement!==r&&r.appendChild(n.view.content.element),r.parentElement!==this.element&&this.element.appendChild(r);const s=()=>{const c=n.api.id;this.pendingUpdates.has(c)||(this.pendingUpdates.add(c),requestAnimationFrame(()=>{if(this.pendingUpdates.delete(c),this.isDisposed||!this.map[c])return;const h=this.positionCache.getPosition(i.element),d=this.positionCache.getPosition(this.element),p=h.left-d.left,m=h.top-d.top,_=h.width,f=h.height;r.style.left=`${p}px`,r.style.top=`${m}px`,r.style.width=`${_}px`,r.style.height=`${f}px`,we(r,"dv-render-overlay-float",n.group.api.location.type==="floating")}))},a=()=>{n.api.isVisible&&(this.positionCache.invalidate(),s()),r.style.display=n.api.isVisible?"":"none"},o=new qt,l=()=>{n.api.location.type==="floating"?queueMicrotask(()=>{const c=this.accessor.floatingGroups.find(m=>m.group===n.api.group);if(!c)return;const h=c.overlay.element,d=()=>{const m=Number(h.getAttribute("aria-level"));r.style.zIndex=`calc(var(--dv-overlay-z-index, 999) + ${m*2+1})`},p=new MutationObserver(()=>{d()});o.value=pt.from(()=>p.disconnect()),p.observe(h,{attributeFilter:["aria-level"],attributes:!0}),d()}):r.style.zIndex=""},u=new Se(o,new mx(r,{onDragEnd:c=>{i.dropTarget.dnd.onDragEnd(c)},onDragEnter:c=>{i.dropTarget.dnd.onDragEnter(c)},onDragLeave:c=>{i.dropTarget.dnd.onDragLeave(c)},onDrop:c=>{i.dropTarget.dnd.onDrop(c)},onDragOver:c=>{i.dropTarget.dnd.onDragOver(c)}}),n.api.onDidVisibilityChange(()=>{a()}),n.api.onDidDimensionsChange(()=>{n.api.isVisible&&s()}),n.api.onDidLocationChange(()=>{l()}));return this.map[n.api.id].destroy=pt.from(()=>{var c;n.view.content.element.parentElement===r&&r.removeChild(n.view.content.element),(c=r.parentElement)===null||c===void 0||c.removeChild(r)}),l(),queueMicrotask(()=>{this.isDisposed||a()}),this.map[n.api.id].disposable.dispose(),this.map[n.api.id].disposable=u,this.map[n.api.id].resize=s,r}}var FT=function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(i.next(c))}catch(h){a(h)}}function l(c){try{u(i.throw(c))}catch(h){a(h)}}function u(c){c.done?s(c.value):r(c.value).then(o,l)}u((i=i.apply(t,e||[])).next())})};class jT extends Se{get window(){var e,n;return(n=(e=this._window)===null||e===void 0?void 0:e.value)!==null&&n!==void 0?n:null}constructor(e,n,i){super(),this.target=e,this.className=n,this.options=i,this._onWillClose=new J,this.onWillClose=this._onWillClose.event,this._onDidClose=new J,this.onDidClose=this._onDidClose.event,this._window=null,this.addDisposables(this._onWillClose,this._onDidClose,{dispose:()=>{this.close()}})}dimensions(){if(!this._window)return null;const e=this._window.value.screenX,n=this._window.value.screenY,i=this._window.value.innerWidth,r=this._window.value.innerHeight;return{top:n,left:e,width:i,height:r}}close(){var e,n;this._window&&(this._onWillClose.fire(),(n=(e=this.options).onWillClose)===null||n===void 0||n.call(e,{id:this.target,window:this._window.value}),this._window.disposable.dispose(),this._window=null,this._onDidClose.fire())}open(){var e,n;return FT(this,void 0,void 0,function*(){if(this._window)throw new Error("instance of popout window is already open");const i=`${this.options.url}`,r=Object.entries({top:this.options.top,left:this.options.left,width:this.options.width,height:this.options.height}).map(([l,u])=>`${l}=${u}`).join(","),s=window.open(i,this.target,r);if(!s)return null;const a=new Se;this._window={value:s,disposable:a},a.addDisposables(pt.from(()=>{s.close()}),Me(window,"beforeunload",()=>{this.close()}));const o=this.createPopoutWindowContainer();return this.className&&o.classList.add(this.className),(n=(e=this.options).onDidOpen)===null||n===void 0||n.call(e,{id:this.target,window:s}),new Promise((l,u)=>{s.addEventListener("unload",c=>{}),s.addEventListener("load",()=>{try{const c=s.document;c.title=document.title,c.body.appendChild(o),PA(c,window.document.styleSheets),Me(s,"beforeunload",()=>{this.close()}),l(o)}catch(c){u(c)}})})})}createPopoutWindowContainer(){const e=document.createElement("div");return e.classList.add("dv-popout-window"),e.id="dv-popout-window",e.style.position="absolute",e.style.width="100%",e.style.height="100%",e.style.top="0px",e.style.left="0px",e}}class HT extends Se{constructor(e){super(),this.accessor=e,this.init()}init(){const e=new Set,n=new Set;this.addDisposables(this.accessor.onDidAddPanel(i=>{if(e.has(i.api.id))throw new Error(`dockview: Invalid event sequence. [onDidAddPanel] called for panel ${i.api.id} but panel already exists`);e.add(i.api.id)}),this.accessor.onDidRemovePanel(i=>{if(e.has(i.api.id))e.delete(i.api.id);else throw new Error(`dockview: Invalid event sequence. [onDidRemovePanel] called for panel ${i.api.id} but panel does not exists`)}),this.accessor.onDidAddGroup(i=>{if(n.has(i.api.id))throw new Error(`dockview: Invalid event sequence. [onDidAddGroup] called for group ${i.api.id} but group already exists`);n.add(i.api.id)}),this.accessor.onDidRemoveGroup(i=>{if(n.has(i.api.id))n.delete(i.api.id);else throw new Error(`dockview: Invalid event sequence. [onDidRemoveGroup] called for group ${i.api.id} but group does not exists`)}))}}class $T extends Se{constructor(e){super(),this.root=e,this._active=null,this._activeDisposable=new qt,this._element=document.createElement("div"),this._element.className="dv-popover-anchor",this._element.style.position="relative",this.root.prepend(this._element),this.addDisposables(pt.from(()=>{this.close()}),this._activeDisposable)}openPopover(e,n){var i;this.close();const r=document.createElement("div");r.style.position="absolute",r.style.zIndex=(i=n.zIndex)!==null&&i!==void 0?i:"var(--dv-overlay-z-index)",r.appendChild(e);const s=this._element.getBoundingClientRect(),a=s.left,o=s.top;r.style.top=`${n.y-o}px`,r.style.left=`${n.x-a}px`,this._element.appendChild(r),this._active=r,this._activeDisposable.value=new Se(Me(window,"pointerdown",l=>{var u;const c=l.target;if(!(c instanceof HTMLElement))return;let h=c;for(;h&&h!==r;)h=(u=h==null?void 0:h.parentElement)!==null&&u!==void 0?u:null;h||this.close()})),requestAnimationFrame(()=>{HA(r,this.root)})}close(){this._active&&(this._active.remove(),this._activeDisposable.dispose(),this._active=null)}}class V_ extends Se{get disabled(){return this._disabled}set disabled(e){var n;this.disabled!==e&&(this._disabled=e,e&&((n=this.model)===null||n===void 0||n.clear()))}get model(){if(!this.disabled)return{clear:()=>{var e;this._model&&((e=this._model.root.parentElement)===null||e===void 0||e.removeChild(this._model.root)),this._model=void 0},exists:()=>!!this._model,getElements:(e,n)=>{const i=this._outline!==n;if(this._outline=n,this._model)return this._model.changed=i,this._model;const r=this.createContainer(),s=this.createAnchor();if(this._model={root:r,overlay:s,changed:i},r.appendChild(s),this.element.appendChild(r),(e==null?void 0:e.target)instanceof HTMLElement){const a=e.target.getBoundingClientRect(),o=this.element.getBoundingClientRect();s.style.left=`${a.left-o.left}px`,s.style.top=`${a.top-o.top}px`}return this._model}}}constructor(e,n){super(),this.element=e,this._disabled=!1,this._disabled=n.disabled,this.addDisposables(pt.from(()=>{var i;(i=this.model)===null||i===void 0||i.clear()}))}createContainer(){const e=document.createElement("div");return e.className="dv-drop-target-container",e}createAnchor(){const e=document.createElement("div");return e.className="dv-drop-target-anchor",e.style.visibility="hidden",e}}const G_={activationSize:{type:"pixels",value:10},size:{type:"pixels",value:20}};function uu(t){const e=t.from.activePanel;[...t.from.panels].map(i=>{const r=t.from.model.removePanel(i);return t.from.model.renderContainer.detatch(i),r}).forEach(i=>{t.to.model.openPanel(i,{skipSetActive:e!==i,skipSetGroupActive:!0})})}class WT extends dx{get orientation(){return this.gridview.orientation}get totalPanels(){return this.panels.length}get panels(){return this.groups.flatMap(e=>e.panels)}get options(){return this._options}get activePanel(){const e=this.activeGroup;if(e)return e.activePanel}get renderer(){var e;return(e=this.options.defaultRenderer)!==null&&e!==void 0?e:"onlyWhenVisible"}get api(){return this._api}get floatingGroups(){return this._floatingGroups}get popoutRestorationPromise(){return this._popoutRestorationPromise}constructor(e,n){var i,r,s;super(e,{proportionalLayout:!0,orientation:ye.HORIZONTAL,styles:n.hideBorders?{separatorBorder:"transparent"}:void 0,disableAutoResizing:n.disableAutoResizing,locked:n.locked,margin:(r=(i=n.theme)===null||i===void 0?void 0:i.gap)!==null&&r!==void 0?r:0,className:n.className}),this.nextGroupId=Q0(),this._deserializer=new OT(this),this._watermark=null,this._onWillDragPanel=new J,this.onWillDragPanel=this._onWillDragPanel.event,this._onWillDragGroup=new J,this.onWillDragGroup=this._onWillDragGroup.event,this._onDidDrop=new J,this.onDidDrop=this._onDidDrop.event,this._onWillDrop=new J,this.onWillDrop=this._onWillDrop.event,this._onWillShowOverlay=new J,this.onWillShowOverlay=this._onWillShowOverlay.event,this._onUnhandledDragOverEvent=new J,this.onUnhandledDragOverEvent=this._onUnhandledDragOverEvent.event,this._onDidRemovePanel=new J,this.onDidRemovePanel=this._onDidRemovePanel.event,this._onDidAddPanel=new J,this.onDidAddPanel=this._onDidAddPanel.event,this._onDidPopoutGroupSizeChange=new J,this.onDidPopoutGroupSizeChange=this._onDidPopoutGroupSizeChange.event,this._onDidPopoutGroupPositionChange=new J,this.onDidPopoutGroupPositionChange=this._onDidPopoutGroupPositionChange.event,this._onDidOpenPopoutWindowFail=new J,this.onDidOpenPopoutWindowFail=this._onDidOpenPopoutWindowFail.event,this._onDidLayoutFromJSON=new J,this.onDidLayoutFromJSON=this._onDidLayoutFromJSON.event,this._onDidActivePanelChange=new J({replay:!0}),this.onDidActivePanelChange=this._onDidActivePanelChange.event,this._onDidMovePanel=new J,this.onDidMovePanel=this._onDidMovePanel.event,this._onDidMaximizedGroupChange=new J,this.onDidMaximizedGroupChange=this._onDidMaximizedGroupChange.event,this._floatingGroups=[],this._popoutGroups=[],this._popoutRestorationPromise=Promise.resolve(),this._onDidRemoveGroup=new J,this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidAddGroup=new J,this.onDidAddGroup=this._onDidAddGroup.event,this._onDidOptionsChange=new J,this.onDidOptionsChange=this._onDidOptionsChange.event,this._onDidActiveGroupChange=new J,this.onDidActiveGroupChange=this._onDidActiveGroupChange.event,this._moving=!1,this._options=n,this.popupService=new $T(this.element),this._themeClassnames=new td(this.element),this._api=new Nc(this),this.rootDropTargetContainer=new V_(this.element,{disabled:!0}),this.overlayRenderContainer=new W_(this.gridview.element,this),this._rootDropTarget=new Xn(this.element,{className:"dv-drop-target-edge",canDisplayOverlay:(a,o)=>{const l=Gt();if(l)return l.viewId!==this.id?!1:o==="center"?this.gridview.length===0:!0;if(o==="center"&&this.gridview.length!==0)return!1;const u=new wx(a,"edge",o,Gt);return this._onUnhandledDragOverEvent.fire(u),u.isAccepted},acceptedTargetZones:["top","bottom","left","right","center"],overlayModel:(s=n.rootOverlayModel)!==null&&s!==void 0?s:G_,getOverrideTarget:()=>{var a;return(a=this.rootDropTargetContainer)===null||a===void 0?void 0:a.model}}),this.updateDropTargetModel(n),we(this.gridview.element,"dv-dockview",!0),we(this.element,"dv-debug",!!n.debug),this.updateTheme(),this.updateWatermark(),n.debug&&this.addDisposables(new HT(this)),this.addDisposables(this.rootDropTargetContainer,this.overlayRenderContainer,this._onWillDragPanel,this._onWillDragGroup,this._onWillShowOverlay,this._onDidActivePanelChange,this._onDidAddPanel,this._onDidRemovePanel,this._onDidLayoutFromJSON,this._onDidDrop,this._onWillDrop,this._onDidMovePanel,this._onDidMovePanel.event(()=>{this.debouncedUpdateAllPositions()}),this._onDidAddGroup,this._onDidRemoveGroup,this._onDidActiveGroupChange,this._onUnhandledDragOverEvent,this._onDidMaximizedGroupChange,this._onDidOptionsChange,this._onDidPopoutGroupSizeChange,this._onDidPopoutGroupPositionChange,this._onDidOpenPopoutWindowFail,this.onDidViewVisibilityChangeMicroTaskQueue(()=>{this.updateWatermark()}),this.onDidAdd(a=>{this._moving||this._onDidAddGroup.fire(a)}),this.onDidRemove(a=>{this._moving||this._onDidRemoveGroup.fire(a)}),this.onDidActiveChange(a=>{this._moving||this._onDidActiveGroupChange.fire(a)}),this.onDidMaximizedChange(a=>{this._onDidMaximizedGroupChange.fire({group:a.panel,isMaximized:a.isMaximized})}),hs.any(this.onDidAdd,this.onDidRemove)(()=>{this.updateWatermark()}),hs.any(this.onDidAddPanel,this.onDidRemovePanel,this.onDidAddGroup,this.onDidRemove,this.onDidMovePanel,this.onDidActivePanelChange,this.onDidPopoutGroupPositionChange,this.onDidPopoutGroupSizeChange)(()=>{this._bufferOnDidLayoutChange.fire()}),pt.from(()=>{for(const a of[...this._floatingGroups])a.dispose();for(const a of[...this._popoutGroups])a.disposable.dispose()}),this._rootDropTarget,this._rootDropTarget.onWillShowOverlay(a=>{this.gridview.length>0&&a.position==="center"||this._onWillShowOverlay.fire(new nd(a,{kind:"edge",panel:void 0,api:this._api,group:void 0,getData:Gt}))}),this._rootDropTarget.onDrop(a=>{var o;const l=new Sx({nativeEvent:a.nativeEvent,position:a.position,panel:void 0,api:this._api,group:void 0,getData:Gt,kind:"edge"});if(this._onWillDrop.fire(l),l.defaultPrevented)return;const u=Gt();u?this.moveGroupOrPanel({from:{groupId:u.groupId,panelId:(o=u.panelId)!==null&&o!==void 0?o:void 0},to:{group:this.orthogonalize(a.position),position:"center"}}):this._onDidDrop.fire(new rg({nativeEvent:a.nativeEvent,position:a.position,panel:void 0,api:this._api,group:void 0,getData:Gt}))}),this._rootDropTarget)}setVisible(e,n){switch(e.api.location.type){case"grid":super.setVisible(e,n);break;case"floating":{const i=this.floatingGroups.find(r=>r.group===e);i&&(i.overlay.setVisible(n),e.api._onDidVisibilityChange.fire({isVisible:n}));break}case"popout":console.warn("dockview: You cannot hide a group that is in a popout window");break}}addPopoutGroup(e,n){var i,r,s,a,o;if(e instanceof Hs&&e.group.size===1)return this.addPopoutGroup(e.group,n);const l=BA(this.gridview.element),u=this.element;function c(){return n!=null&&n.position?n.position:e instanceof H_?e.element.getBoundingClientRect():e.group?e.group.element.getBoundingClientRect():u.getBoundingClientRect()}const h=c(),d=(r=(i=n==null?void 0:n.overridePopoutGroup)===null||i===void 0?void 0:i.id)!==null&&r!==void 0?r:this.getNextGroupId(),p=new jT(`${this.id}-${d}`,l??"",{url:(o=(s=n==null?void 0:n.popoutUrl)!==null&&s!==void 0?s:(a=this.options)===null||a===void 0?void 0:a.popoutUrl)!==null&&o!==void 0?o:"/popout.html",left:window.screenX+h.left,top:window.screenY+h.top,width:h.width,height:h.height,onDidOpen:n==null?void 0:n.onDidOpen,onWillClose:n==null?void 0:n.onWillClose}),m=new Se(p,p.onDidClose(()=>{m.dispose()}));return p.open().then(_=>{var f;if(p.isDisposed)return!1;const v=n!=null&&n.referenceGroup?n.referenceGroup:e instanceof Hs?e.group:e,g=e.api.location.type,y=v.element.parentElement!==null;let b;if(y?n!=null&&n.overridePopoutGroup?b=n.overridePopoutGroup:(b=this.createGroup({id:d}),_&&this._onDidAddGroup.fire(b)):b=v,_===null)return console.error("dockview: failed to create popout. perhaps you need to allow pop-ups for this website"),m.dispose(),this._onDidOpenPopoutWindowFail.fire(),this.movingLock(()=>uu({from:b,to:v})),v.api.isVisible||v.api.setVisible(!0),!1;const w=document.createElement("div");w.className="dv-overlay-render-container";const x=new W_(w,this);b.model.renderContainer=x,b.layout(p.window.innerWidth,p.window.innerHeight);let k;if(!(n!=null&&n.overridePopoutGroup)&&y)if(e instanceof Hs)this.movingLock(()=>{const H=v.model.removePanel(e);b.model.openPanel(H)});else switch(this.movingLock(()=>uu({from:v,to:b})),g){case"grid":v.api.setVisible(!1);break;case"floating":case"popout":k=(f=this._floatingGroups.find(H=>H.group.api.id===e.api.id))===null||f===void 0?void 0:f.overlay.toJSON(),this.removeGroup(v);break}_.classList.add("dv-dockview"),_.style.overflow="hidden",_.appendChild(w),_.appendChild(b.element);const S=document.createElement("div"),E=new V_(S,{disabled:this.rootDropTargetContainer.disabled});_.appendChild(S),b.model.dropTargetContainer=E,b.model.location={type:"popout",getWindow:()=>p.window,popoutUrl:n==null?void 0:n.popoutUrl},y&&e.api.location.type==="grid"&&e.api.setVisible(!1),this.doSetGroupAndPanelActive(b),m.addDisposables(b.api.onDidActiveChange(H=>{var B;H.isActive&&((B=p.window)===null||B===void 0||B.focus())}),b.api.onWillFocus(()=>{var H;(H=p.window)===null||H===void 0||H.focus()}));let A;const M=y&&v&&this.getPanel(v.id),R={window:p,popoutGroup:b,referenceGroup:M?v.id:void 0,disposable:{dispose:()=>(m.dispose(),A)}},P=FA(p.window);return m.addDisposables(P,jA(p.window,()=>{this._onDidPopoutGroupSizeChange.fire({width:p.window.innerWidth,height:p.window.innerHeight,group:b})}),P.event(()=>{this._onDidPopoutGroupPositionChange.fire({screenX:p.window.screenX,screenY:p.window.screenX,group:b})}),Me(p.window,"resize",()=>{b.layout(p.window.innerWidth,p.window.innerHeight)}),x,pt.from(()=>{if(!this.isDisposed){if(y&&this.getPanel(v.id))this.movingLock(()=>uu({from:b,to:v})),v.api.isVisible||v.api.setVisible(!0),this.getPanel(b.id)&&this.doRemoveGroup(b,{skipPopoutAssociated:!0});else if(this.getPanel(b.id)){if(b.model.renderContainer=this.overlayRenderContainer,b.model.dropTargetContainer=this.rootDropTargetContainer,A=b,!this._popoutGroups.find(B=>B.popoutGroup===b))return;k?this.addFloatingGroup(b,{height:k.height,width:k.width,position:k}):(this.doRemoveGroup(b,{skipDispose:!0,skipActive:!0,skipPopoutReturn:!0}),b.model.location={type:"grid"},this.movingLock(()=>{this.doAddGroup(b,[0])})),this.doSetGroupAndPanelActive(b)}}})),this._popoutGroups.push(R),this.updateWatermark(),!0}).catch(_=>(console.error("dockview: failed to create popout.",_),!1))}addFloatingGroup(e,n){var i,r,s,a,o;let l;if(e instanceof Hs)l=this.createGroup(),this._onDidAddGroup.fire(l),this.movingLock(()=>this.removePanel(e,{removeEmptyGroup:!0,skipDispose:!0,skipSetActiveGroup:!0})),this.movingLock(()=>l.model.openPanel(e,{skipSetGroupActive:!0}));else{l=e;const _=(i=this._popoutGroups.find(g=>g.popoutGroup===l))===null||i===void 0?void 0:i.referenceGroup,f=_?this.getPanel(_):void 0;typeof(n==null?void 0:n.skipRemoveGroup)=="boolean"&&n.skipRemoveGroup||(f?(this.movingLock(()=>uu({from:e,to:f})),this.doRemoveGroup(e,{skipPopoutReturn:!0,skipPopoutAssociated:!0}),this.doRemoveGroup(f,{skipDispose:!0}),l=f):this.doRemoveGroup(e,{skipDispose:!0,skipPopoutReturn:!0,skipPopoutAssociated:!1}))}function u(){if(n!=null&&n.position){const _={};return"left"in n.position?_.left=Math.max(n.position.left,0):"right"in n.position?_.right=Math.max(n.position.right,0):_.left=er.left,"top"in n.position?_.top=Math.max(n.position.top,0):"bottom"in n.position?_.bottom=Math.max(n.position.bottom,0):_.top=er.top,typeof n.width=="number"?_.width=Math.max(n.width,0):_.width=er.width,typeof n.height=="number"?_.height=Math.max(n.height,0):_.height=er.height,_}return{left:typeof(n==null?void 0:n.x)=="number"?Math.max(n.x,0):er.left,top:typeof(n==null?void 0:n.y)=="number"?Math.max(n.y,0):er.top,width:typeof(n==null?void 0:n.width)=="number"?Math.max(n.width,0):er.width,height:typeof(n==null?void 0:n.height)=="number"?Math.max(n.height,0):er.height}}const c=u(),h=new di(Object.assign(Object.assign({container:this.gridview.element,content:l.element},c),{minimumInViewportWidth:this.options.floatingGroupBounds==="boundedWithinViewport"?void 0:(s=(r=this.options.floatingGroupBounds)===null||r===void 0?void 0:r.minimumWidthWithinViewport)!==null&&s!==void 0?s:lu,minimumInViewportHeight:this.options.floatingGroupBounds==="boundedWithinViewport"?void 0:(o=(a=this.options.floatingGroupBounds)===null||a===void 0?void 0:a.minimumHeightWithinViewport)!==null&&o!==void 0?o:lu})),d=l.element.querySelector(".dv-void-container");if(!d)throw new Error("dockview: failed to find drag handle");h.setupDrag(d,{inDragMode:typeof(n==null?void 0:n.inDragMode)=="boolean"?n.inDragMode:!1});const p=new IT(l,h),m=new Se(l.api.onDidActiveChange(_=>{_.isActive&&h.bringToFront()}),Qh(l.element,_=>{const{width:f,height:v}=_.contentRect;l.layout(f,v)}));p.addDisposables(h.onDidChange(()=>{l.layout(l.width,l.height)}),h.onDidChangeEnd(()=>{this._bufferOnDidLayoutChange.fire()}),l.onDidChange(_=>{h.setBounds({height:_==null?void 0:_.height,width:_==null?void 0:_.width})}),{dispose:()=>{m.dispose(),uf(this._floatingGroups,p),l.model.location={type:"grid"},this.updateWatermark()}}),this._floatingGroups.push(p),l.model.location={type:"floating"},n!=null&&n.skipActiveGroup||this.doSetGroupAndPanelActive(l),this.updateWatermark()}orthogonalize(e,n){switch(this.gridview.normalize(),e){case"top":case"bottom":this.gridview.orientation===ye.HORIZONTAL&&this.gridview.insertOrthogonalSplitviewAtRoot();break;case"left":case"right":this.gridview.orientation===ye.VERTICAL&&this.gridview.insertOrthogonalSplitviewAtRoot();break}switch(e){case"top":case"left":case"center":return this.createGroupAtLocation([0],void 0,n);case"bottom":case"right":return this.createGroupAtLocation([this.gridview.length],void 0,n);default:throw new Error(`dockview: unsupported position ${e}`)}}updateOptions(e){var n,i;if(super.updateOptions(e),"floatingGroupBounds"in e)for(const a of this._floatingGroups){switch(e.floatingGroupBounds){case"boundedWithinViewport":a.overlay.minimumInViewportHeight=void 0,a.overlay.minimumInViewportWidth=void 0;break;case void 0:a.overlay.minimumInViewportHeight=lu,a.overlay.minimumInViewportWidth=lu;break;default:a.overlay.minimumInViewportHeight=(n=e.floatingGroupBounds)===null||n===void 0?void 0:n.minimumHeightWithinViewport,a.overlay.minimumInViewportWidth=(i=e.floatingGroupBounds)===null||i===void 0?void 0:i.minimumWidthWithinViewport}a.overlay.setBounds()}this.updateDropTargetModel(e);const r=this.options.disableDnd;this._options=Object.assign(Object.assign({},this.options),e);const s=this.options.disableDnd;r!==s&&this.updateDragAndDropState(),"theme"in e&&this.updateTheme(),this.layout(this.gridview.width,this.gridview.height,!0)}layout(e,n,i){if(super.layout(e,n,i),this._floatingGroups)for(const r of this._floatingGroups)r.overlay.setBounds()}updateDragAndDropState(){for(const e of this.groups)e.model.updateDragAndDropState()}focus(){var e;(e=this.activeGroup)===null||e===void 0||e.focus()}getGroupPanel(e){return this.panels.find(n=>n.id===e)}setActivePanel(e){e.group.model.openPanel(e),this.doSetGroupAndPanelActive(e.group)}moveToNext(e={}){var n;if(!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}if(e.includePanel&&e.group&&e.group.activePanel!==e.group.panels[e.group.panels.length-1]){e.group.model.moveToNext({suppressRoll:!0});return}const i=et(e.group.element),r=(n=this.gridview.next(i))===null||n===void 0?void 0:n.view;this.doSetGroupAndPanelActive(r)}moveToPrevious(e={}){var n;if(!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}if(e.includePanel&&e.group&&e.group.activePanel!==e.group.panels[0]){e.group.model.moveToPrevious({suppressRoll:!0});return}const i=et(e.group.element),r=(n=this.gridview.previous(i))===null||n===void 0?void 0:n.view;r&&this.doSetGroupAndPanelActive(r)}toJSON(){var e;const n=this.gridview.serialize(),i=this.panels.reduce((o,l)=>(o[l.id]=l.toJSON(),o),{}),r=this._floatingGroups.map(o=>({data:o.group.toJSON(),position:o.overlay.toJSON()})),s=this._popoutGroups.map(o=>({data:o.popoutGroup.toJSON(),gridReferenceGroup:o.referenceGroup,position:o.window.dimensions(),url:o.popoutGroup.api.location.type==="popout"?o.popoutGroup.api.location.popoutUrl:void 0})),a={grid:n,panels:i,activeGroup:(e=this.activeGroup)===null||e===void 0?void 0:e.id};return r.length>0&&(a.floatingGroups=r),s.length>0&&(a.popoutGroups=s),a}fromJSON(e,n){var i,r;const s=new Map;let a;if(n!=null&&n.reuseExistingPanels){a=this.createGroup(),this._groups.delete(a.api.id);const c=Object.keys(e.panels);for(const h of this.panels)c.includes(h.api.id)&&s.set(h.api.id,h);this.movingLock(()=>{Array.from(s.values()).forEach(h=>{this.moveGroupOrPanel({from:{groupId:h.api.group.api.id,panelId:h.api.id},to:{group:a,position:"center"},keepEmptyGroups:!0})})})}if(this.clear(),typeof e!="object"||e===null)throw new Error("dockview: serialized layout must be a non-null object");const{grid:o,panels:l,activeGroup:u}=e;if(o.root.type!=="branch"||!Array.isArray(o.root.data))throw new Error("dockview: root must be of type branch");try{const c=this.width,h=this.height,d=f=>{const{id:v,locked:g,hideHeader:y,views:b,activeView:w}=f;if(typeof v!="string")throw new Error("dockview: group id must be of type string");const x=this.createGroup({id:v,locked:!!g,hideHeader:!!y});this._onDidAddGroup.fire(x);const k=[];for(const S of b){const E=s.get(S);if(a&&E)this.movingLock(()=>{a.model.removePanel(E)}),k.push(E),E.updateFromStateModel(l[S]);else{const A=this._deserializer.fromJSON(l[S],x);k.push(A)}}for(let S=0;S<b.length;S++){const E=k[S],A=typeof w=="string"&&w===E.id;s.has(E.api.id)?this.movingLock(()=>{x.model.openPanel(E,{skipSetActive:!A,skipSetGroupActive:!0})}):x.model.openPanel(E,{skipSetActive:!A,skipSetGroupActive:!0})}return!x.activePanel&&x.panels.length>0&&x.model.openPanel(x.panels[x.panels.length-1],{skipSetGroupActive:!0}),x};this.gridview.deserialize(o,{fromJSON:f=>d(f.data)}),this.layout(c,h,!0);const p=(i=e.floatingGroups)!==null&&i!==void 0?i:[];for(const f of p){const{data:v,position:g}=f,y=d(v);this.addFloatingGroup(y,{position:g,width:g.width,height:g.height,skipRemoveGroup:!0,inDragMode:!1})}const m=(r=e.popoutGroups)!==null&&r!==void 0?r:[],_=[];m.forEach((f,v)=>{const{data:g,position:y,gridReferenceGroup:b,url:w}=f,x=d(g),k=new Promise(S=>{setTimeout(()=>{this.addPopoutGroup(x,{position:y??void 0,overridePopoutGroup:b?x:void 0,referenceGroup:b?this.getPanel(b):void 0,popoutUrl:w}),S()},v*LT)});_.push(k)}),this._popoutRestorationPromise=Promise.all(_).then(()=>{});for(const f of this._floatingGroups)f.overlay.setBounds();if(typeof u=="string"){const f=this.getPanel(u);f&&this.doSetGroupAndPanelActive(f)}}catch(c){console.error("dockview: failed to deserialize layout. Reverting changes",c);for(const h of this.groups)for(const d of h.panels)this.removePanel(d,{removeEmptyGroup:!1,skipDispose:!1});for(const h of this.groups)h.dispose(),this._groups.delete(h.id),this._onDidRemoveGroup.fire(h);for(const h of[...this._floatingGroups])h.dispose();throw this.clear(),c}this.updateWatermark(),this.debouncedUpdateAllPositions(),this._onDidLayoutFromJSON.fire()}clear(){const e=Array.from(this._groups.values()).map(i=>i.value),n=!!this.activeGroup;for(const i of e)this.removeGroup(i,{skipActive:!0});n&&this.doSetGroupAndPanelActive(void 0),this.gridview.clear()}closeAllGroups(){for(const e of this._groups.entries()){const[n,i]=e;i.value.model.closeAllPanels()}}addPanel(e){var n,i;if(this.panels.find(l=>l.id===e.id))throw new Error(`dockview: panel with id ${e.id} already exists`);let r;if(e.position&&e.floating)throw new Error("dockview: you can only provide one of: position, floating as arguments to .addPanel(...)");const s={width:e.initialWidth,height:e.initialHeight};let a;if(e.position)if(ST(e.position)){const l=typeof e.position.referencePanel=="string"?this.getGroupPanel(e.position.referencePanel):e.position.referencePanel;if(a=e.position.index,!l)throw new Error(`dockview: referencePanel '${e.position.referencePanel}' does not exist`);r=this.findGroup(l)}else if(xT(e.position)){if(r=typeof e.position.referenceGroup=="string"?(n=this._groups.get(e.position.referenceGroup))===null||n===void 0?void 0:n.value:e.position.referenceGroup,a=e.position.index,!r)throw new Error(`dockview: referenceGroup '${e.position.referenceGroup}' does not exist`)}else{const l=this.orthogonalize(j_(e.position.direction)),u=this.createPanel(e,l);return l.model.openPanel(u,{skipSetActive:e.inactive,skipSetGroupActive:e.inactive,index:a}),e.inactive||this.doSetGroupAndPanelActive(l),l.api.setSize({height:s==null?void 0:s.height,width:s==null?void 0:s.width}),u}else r=this.activeGroup;let o;if(r){const l=Pc(((i=e.position)===null||i===void 0?void 0:i.direction)||"within");if(e.floating){const u=this.createGroup();this._onDidAddGroup.fire(u);const c=typeof e.floating=="object"&&e.floating!==null?e.floating:{};this.addFloatingGroup(u,Object.assign(Object.assign({},c),{inDragMode:!1,skipRemoveGroup:!0,skipActiveGroup:!0})),o=this.createPanel(e,u),u.model.openPanel(o,{skipSetActive:e.inactive,skipSetGroupActive:e.inactive,index:a})}else if(r.api.location.type==="floating"||l==="center")o=this.createPanel(e,r),r.model.openPanel(o,{skipSetActive:e.inactive,skipSetGroupActive:e.inactive,index:a}),r.api.setSize({width:s==null?void 0:s.width,height:s==null?void 0:s.height}),e.inactive||this.doSetGroupAndPanelActive(r);else{const u=et(r.element),c=hi(this.gridview.orientation,u,l),h=this.createGroupAtLocation(c,this.orientationAtLocation(c)===ye.VERTICAL?s==null?void 0:s.height:s==null?void 0:s.width);o=this.createPanel(e,h),h.model.openPanel(o,{skipSetActive:e.inactive,skipSetGroupActive:e.inactive,index:a}),e.inactive||this.doSetGroupAndPanelActive(h)}}else if(e.floating){const l=this.createGroup();this._onDidAddGroup.fire(l);const u=typeof e.floating=="object"&&e.floating!==null?e.floating:{};this.addFloatingGroup(l,Object.assign(Object.assign({},u),{inDragMode:!1,skipRemoveGroup:!0,skipActiveGroup:!0})),o=this.createPanel(e,l),l.model.openPanel(o,{skipSetActive:e.inactive,skipSetGroupActive:e.inactive,index:a})}else{const l=this.createGroupAtLocation([0],this.gridview.orientation===ye.VERTICAL?s==null?void 0:s.height:s==null?void 0:s.width);o=this.createPanel(e,l),l.model.openPanel(o,{skipSetActive:e.inactive,skipSetGroupActive:e.inactive,index:a}),e.inactive||this.doSetGroupAndPanelActive(l)}return o}removePanel(e,n={removeEmptyGroup:!0}){const i=e.group;if(!i)throw new Error(`dockview: cannot remove panel ${e.id}. it's missing a group.`);i.model.removePanel(e,{skipSetActiveGroup:n.skipSetActiveGroup}),n.skipDispose||(e.group.model.renderContainer.detatch(e),e.dispose()),i.size===0&&n.removeEmptyGroup&&this.removeGroup(i,{skipActive:n.skipSetActiveGroup})}createWatermarkComponent(){return this.options.createWatermarkComponent?this.options.createWatermarkComponent():new PT}updateWatermark(){var e,n;if(this.groups.filter(i=>i.api.location.type==="grid"&&i.api.isVisible).length===0){if(!this._watermark){this._watermark=this.createWatermarkComponent(),this._watermark.init({containerApi:new Nc(this)});const i=document.createElement("div");i.className="dv-watermark-container",IA(i,"watermark-component"),i.appendChild(this._watermark.element),this.gridview.element.appendChild(i)}}else this._watermark&&(this._watermark.element.parentElement.remove(),(n=(e=this._watermark).dispose)===null||n===void 0||n.call(e),this._watermark=null)}addGroup(e){var n;if(e){let i;if(kT(e)){const u=typeof e.referencePanel=="string"?this.panels.find(c=>c.id===e.referencePanel):e.referencePanel;if(!u)throw new Error(`dockview: reference panel ${e.referencePanel} does not exist`);if(i=this.findGroup(u),!i)throw new Error(`dockview: reference group for reference panel ${e.referencePanel} does not exist`)}else if(CT(e)){if(i=typeof e.referenceGroup=="string"?(n=this._groups.get(e.referenceGroup))===null||n===void 0?void 0:n.value:e.referenceGroup,!i)throw new Error(`dockview: reference group ${e.referenceGroup} does not exist`)}else{const u=this.orthogonalize(j_(e.direction),e);return e.skipSetActive||this.doSetGroupAndPanelActive(u),u}const r=Pc(e.direction||"within"),s=et(i.element),a=hi(this.gridview.orientation,s,r),o=this.createGroup(e),l=this.getLocationOrientation(a)===ye.VERTICAL?e.initialHeight:e.initialWidth;return this.doAddGroup(o,a,l),e.skipSetActive||this.doSetGroupAndPanelActive(o),o}else{const i=this.createGroup(e);return this.doAddGroup(i),this.doSetGroupAndPanelActive(i),i}}getLocationOrientation(e){return e.length%2==0&&this.gridview.orientation===ye.HORIZONTAL?ye.HORIZONTAL:ye.VERTICAL}removeGroup(e,n){this.doRemoveGroup(e,n)}doRemoveGroup(e,n){var i;const r=[...e.panels];if(!(n!=null&&n.skipDispose))for(const o of r)this.removePanel(o,{removeEmptyGroup:!1,skipDispose:(i=n==null?void 0:n.skipDispose)!==null&&i!==void 0?i:!1});const s=this.activePanel;if(e.api.location.type==="floating"){const o=this._floatingGroups.find(l=>l.group===e);if(o){if(n!=null&&n.skipDispose||(o.group.dispose(),this._groups.delete(e.id),this._onDidRemoveGroup.fire(e)),uf(this._floatingGroups,o),o.dispose(),!(n!=null&&n.skipActive)&&this._activeGroup===e){const l=Array.from(this._groups.values());this.doSetGroupAndPanelActive(l.length>0?l[0].value:void 0)}return o.group}throw new Error("dockview: failed to find floating group")}if(e.api.location.type==="popout"){const o=this._popoutGroups.find(l=>l.popoutGroup===e);if(o){if(!(n!=null&&n.skipDispose)){if(!(n!=null&&n.skipPopoutAssociated)){const u=o.referenceGroup?this.getPanel(o.referenceGroup):void 0;u&&u.panels.length===0&&this.removeGroup(u)}o.popoutGroup.dispose(),this._groups.delete(e.id),this._onDidRemoveGroup.fire(e)}uf(this._popoutGroups,o);const l=o.disposable.dispose();if(!(n!=null&&n.skipPopoutReturn)&&l&&(this.doAddGroup(l,[0]),this.doSetGroupAndPanelActive(l)),!(n!=null&&n.skipActive)&&this._activeGroup===e){const u=Array.from(this._groups.values());this.doSetGroupAndPanelActive(u.length>0?u[0].value:void 0)}return this.updateWatermark(),o.popoutGroup}throw new Error("dockview: failed to find popout group")}const a=super.doRemoveGroup(e,n);return n!=null&&n.skipActive||this.activePanel!==s&&this._onDidActivePanelChange.fire(this.activePanel),a}debouncedUpdateAllPositions(){this._updatePositionsFrameId!==void 0&&cancelAnimationFrame(this._updatePositionsFrameId),this._updatePositionsFrameId=requestAnimationFrame(()=>{this._updatePositionsFrameId=void 0,this.overlayRenderContainer.updateAllPositions()})}movingLock(e){const n=this._moving;try{return this._moving=!0,e()}finally{this._moving=n}}moveGroupOrPanel(e){var n;const i=e.to.group,r=e.from.groupId,s=e.from.panelId,a=e.to.position,o=e.to.index,l=r?(n=this._groups.get(r))===null||n===void 0?void 0:n.value:void 0;if(!l)throw new Error(`dockview: Failed to find group id ${r}`);if(s===void 0){this.moveGroup({from:{group:l},to:{group:i,position:a},skipSetActive:e.skipSetActive});return}if(!a||a==="center"){const u=this.movingLock(()=>l.model.removePanel(s,{skipSetActive:!1,skipSetActiveGroup:!0}));if(!u)throw new Error(`dockview: No panel with id ${s}`);!e.keepEmptyGroups&&l.model.size===0&&this.doRemoveGroup(l,{skipActive:!0});const c=i.model.size===0;this.movingLock(()=>{var h;return i.model.openPanel(u,{index:o,skipSetActive:((h=e.skipSetActive)!==null&&h!==void 0?h:!1)&&!c,skipSetGroupActive:!0})}),e.skipSetActive||this.doSetGroupAndPanelActive(i),this._onDidMovePanel.fire({panel:u,from:l})}else{const u=et(i.element),c=hi(this.gridview.orientation,u,a);if(l.size<2){const[h,d]=Bi(c);if(l.api.location.type==="grid"){const f=et(l.element),[v,g]=Bi(f);if(cx(v,h)){this.gridview.moveView(v,g,d),this._onDidMovePanel.fire({panel:this.getGroupPanel(s),from:l});return}}if(l.api.location.type==="popout"){const f=this._popoutGroups.find(y=>y.popoutGroup===l),v=this.movingLock(()=>f.popoutGroup.model.removePanel(f.popoutGroup.panels[0],{skipSetActive:!0,skipSetActiveGroup:!0}));this.doRemoveGroup(l,{skipActive:!0});const g=this.createGroupAtLocation(c);this.movingLock(()=>g.model.openPanel(v,{skipSetActive:!0})),this.doSetGroupAndPanelActive(g),this._onDidMovePanel.fire({panel:this.getGroupPanel(s),from:l});return}const p=this.movingLock(()=>this.doRemoveGroup(l,{skipActive:!0,skipDispose:!0})),m=et(i.element),_=hi(this.gridview.orientation,m,a);this.movingLock(()=>this.doAddGroup(p,_)),this.doSetGroupAndPanelActive(p),this._onDidMovePanel.fire({panel:this.getGroupPanel(s),from:l})}else{const h=this.movingLock(()=>l.model.removePanel(s,{skipSetActive:!1,skipSetActiveGroup:!0}));if(!h)throw new Error(`dockview: No panel with id ${s}`);const d=hi(this.gridview.orientation,u,a),p=this.createGroupAtLocation(d);this.movingLock(()=>p.model.openPanel(h,{skipSetGroupActive:!0})),this.doSetGroupAndPanelActive(p),this._onDidMovePanel.fire({panel:h,from:l})}}}moveGroup(e){const n=e.from.group,i=e.to.group,r=e.to.position;if(r==="center"){const s=n.activePanel,a=this.movingLock(()=>[...n.panels].map(o=>n.model.removePanel(o.id,{skipSetActive:!0})));(n==null?void 0:n.model.size)===0&&this.doRemoveGroup(n,{skipActive:!0}),this.movingLock(()=>{for(const o of a)i.model.openPanel(o,{skipSetActive:o!==s,skipSetGroupActive:!0})}),e.skipSetActive!==!0?this.doSetGroupAndPanelActive(i):this.activePanel||this.doSetGroupAndPanelActive(i)}else{switch(n.api.location.type){case"grid":this.gridview.removeView(et(n.element));break;case"floating":{const s=this._floatingGroups.find(a=>a.group===n);if(!s)throw new Error("dockview: failed to find floating group");s.dispose();break}case"popout":{const s=this._popoutGroups.find(o=>o.popoutGroup===n);if(!s)throw new Error("dockview: failed to find popout group");const a=this._popoutGroups.indexOf(s);if(a>=0&&this._popoutGroups.splice(a,1),s.referenceGroup){const o=this.getPanel(s.referenceGroup);o&&!o.api.isVisible&&this.doRemoveGroup(o,{skipActive:!0})}s.window.dispose(),i.api.location.type==="grid"?(n.model.renderContainer=this.overlayRenderContainer,n.model.dropTargetContainer=this.rootDropTargetContainer,n.model.location={type:"grid"}):i.api.location.type==="floating"&&(n.model.renderContainer=this.overlayRenderContainer,n.model.dropTargetContainer=this.rootDropTargetContainer,n.model.location={type:"floating"});break}}if(i.api.location.type==="grid"){const s=et(i.element),a=hi(this.gridview.orientation,s,r);let o;switch(this.gridview.orientation){case ye.VERTICAL:o=s.length%2==0?n.api.width:n.api.height;break;case ye.HORIZONTAL:o=s.length%2==0?n.api.height:n.api.width;break}this.gridview.addView(n,o,a)}else if(i.api.location.type==="floating"){const s=this._floatingGroups.find(a=>a.group===i);if(s){const a=s.overlay.toJSON();let o,l;"left"in a?o=a.left+50:"right"in a?o=Math.max(0,a.right-a.width-50):o=50,"top"in a?l=a.top+50:"bottom"in a?l=Math.max(0,a.bottom-a.height-50):l=50,this.addFloatingGroup(n,{height:a.height,width:a.width,position:{left:o,top:l}})}}}if(n.panels.forEach(s=>{this._onDidMovePanel.fire({panel:s,from:n})}),this.debouncedUpdateAllPositions(),e.skipSetActive===!1){const s=i??n;this.doSetGroupAndPanelActive(s)}}doSetGroupActive(e){super.doSetGroupActive(e);const n=this.activePanel;!this._moving&&n!==this._onDidActivePanelChange.value&&this._onDidActivePanelChange.fire(n)}doSetGroupAndPanelActive(e){super.doSetGroupActive(e);const n=this.activePanel;e&&this.hasMaximizedGroup()&&!this.isMaximizedGroup(e)&&this.exitMaximizedGroup(),!this._moving&&n!==this._onDidActivePanelChange.value&&this._onDidActivePanelChange.fire(n)}getNextGroupId(){let e=this.nextGroupId.next();for(;this._groups.has(e);)e=this.nextGroupId.next();return e}createGroup(e){e||(e={});let n=e==null?void 0:e.id;if(n&&this._groups.has(e.id)&&(console.warn(`dockview: Duplicate group id ${e==null?void 0:e.id}. reassigning group id to avoid errors`),n=void 0),!n)for(n=this.nextGroupId.next();this._groups.has(n);)n=this.nextGroupId.next();const i=new H_(this,n,e);if(i.init({params:{},accessor:this}),!this._groups.has(i.id)){const r=new Se(i.model.onTabDragStart(s=>{this._onWillDragPanel.fire(s)}),i.model.onGroupDragStart(s=>{this._onWillDragGroup.fire(s)}),i.model.onMove(s=>{const{groupId:a,itemId:o,target:l,index:u}=s;this.moveGroupOrPanel({from:{groupId:a,panelId:o},to:{group:i,position:l,index:u}})}),i.model.onDidDrop(s=>{this._onDidDrop.fire(s)}),i.model.onWillDrop(s=>{this._onWillDrop.fire(s)}),i.model.onWillShowOverlay(s=>{if(this.options.disableDnd){s.preventDefault();return}this._onWillShowOverlay.fire(s)}),i.model.onUnhandledDragOverEvent(s=>{this._onUnhandledDragOverEvent.fire(s)}),i.model.onDidAddPanel(s=>{this._moving||this._onDidAddPanel.fire(s.panel)}),i.model.onDidRemovePanel(s=>{this._moving||this._onDidRemovePanel.fire(s.panel)}),i.model.onDidActivePanelChange(s=>{this._moving||s.panel===this.activePanel&&this._onDidActivePanelChange.value!==s.panel&&this._onDidActivePanelChange.fire(s.panel)}),hs.any(i.model.onDidPanelTitleChange,i.model.onDidPanelParametersChange)(()=>{this._bufferOnDidLayoutChange.fire()}));this._groups.set(i.id,{value:i,disposable:r})}return i.initialize(),i}createPanel(e,n){var i,r,s;const a=e.component,o=(i=e.tabComponent)!==null&&i!==void 0?i:this.options.defaultTabComponent,l=new kx(this,e.id,a,o),u=new Hs(e.id,a,o,this,this._api,n,l,{renderer:e.renderer,minimumWidth:e.minimumWidth,minimumHeight:e.minimumHeight,maximumWidth:e.maximumWidth,maximumHeight:e.maximumHeight});return u.init({title:(r=e.title)!==null&&r!==void 0?r:e.id,params:(s=e==null?void 0:e.params)!==null&&s!==void 0?s:{}}),u}createGroupAtLocation(e,n,i){const r=this.createGroup(i);return this.doAddGroup(r,e,n),r}findGroup(e){var n;return(n=Array.from(this._groups.values()).find(i=>i.value.model.containsPanel(e)))===null||n===void 0?void 0:n.value}orientationAtLocation(e){const n=this.gridview.orientation;return e.length%2==1?n:pi(n)}updateDropTargetModel(e){"dndEdges"in e&&(this._rootDropTarget.disabled=typeof e.dndEdges=="boolean"&&e.dndEdges===!1,typeof e.dndEdges=="object"&&e.dndEdges!==null?this._rootDropTarget.setOverlayModel(e.dndEdges):this._rootDropTarget.setOverlayModel(G_)),"rootOverlayModel"in e&&this.updateDropTargetModel({dndEdges:e.dndEdges})}updateTheme(){var e,n;const i=(e=this._options.theme)!==null&&e!==void 0?e:MT;switch(this._themeClassnames.setClassNames(i.className),this.gridview.margin=(n=i.gap)!==null&&n!==void 0?n:0,i.dndOverlayMounting){case"absolute":this.rootDropTargetContainer.disabled=!1;break;case"relative":default:this.rootDropTargetContainer.disabled=!0;break}}}class VT extends dx{get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get options(){return this._options}get deserializer(){return this._deserializer}set deserializer(e){this._deserializer=e}constructor(e,n){var i;super(e,{proportionalLayout:(i=n.proportionalLayout)!==null&&i!==void 0?i:!0,orientation:n.orientation,styles:n.hideBorders?{separatorBorder:"transparent"}:void 0,disableAutoResizing:n.disableAutoResizing,className:n.className}),this._onDidLayoutfromJSON=new J,this.onDidLayoutFromJSON=this._onDidLayoutfromJSON.event,this._onDidRemoveGroup=new J,this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidAddGroup=new J,this.onDidAddGroup=this._onDidAddGroup.event,this._onDidActiveGroupChange=new J,this.onDidActiveGroupChange=this._onDidActiveGroupChange.event,this._options=n,this.addDisposables(this._onDidAddGroup,this._onDidRemoveGroup,this._onDidActiveGroupChange,this.onDidAdd(r=>{this._onDidAddGroup.fire(r)}),this.onDidRemove(r=>{this._onDidRemoveGroup.fire(r)}),this.onDidActiveChange(r=>{this._onDidActiveGroupChange.fire(r)}))}updateOptions(e){super.updateOptions(e);const n=typeof e.orientation=="string"&&this.gridview.orientation!==e.orientation;this._options=Object.assign(Object.assign({},this.options),e),n&&(this.gridview.orientation=e.orientation),this.layout(this.gridview.width,this.gridview.height,!0)}removePanel(e){this.removeGroup(e)}toJSON(){var e;return{grid:this.gridview.serialize(),activePanel:(e=this.activeGroup)===null||e===void 0?void 0:e.id}}setVisible(e,n){this.gridview.setViewVisible(et(e.element),n)}setActive(e){this._groups.forEach((n,i)=>{n.value.setActive(e===n.value)})}focus(){var e;(e=this.activeGroup)===null||e===void 0||e.focus()}fromJSON(e){this.clear();const{grid:n,activePanel:i}=e;try{const r=[],s=this.width,a=this.height;if(this.gridview.deserialize(n,{fromJSON:o=>{const{data:l}=o,u=this.options.createComponent({id:l.id,name:l.component});return r.push(()=>u.init({params:l.params,minimumWidth:l.minimumWidth,maximumWidth:l.maximumWidth,minimumHeight:l.minimumHeight,maximumHeight:l.maximumHeight,priority:l.priority,snap:!!l.snap,accessor:this,isVisible:o.visible})),this._onDidAddGroup.fire(u),this.registerPanel(u),u}}),this.layout(s,a,!0),r.forEach(o=>o()),typeof i=="string"){const o=this.getPanel(i);o&&this.doSetGroupActive(o)}}catch(r){for(const s of this.groups)s.dispose(),this._groups.delete(s.id),this._onDidRemoveGroup.fire(s);throw this.clear(),r}this._onDidLayoutfromJSON.fire()}clear(){const e=this.activeGroup,n=Array.from(this._groups.values());for(const i of n)i.disposable.dispose(),this.doRemoveGroup(i.value,{skipActive:!0});e&&this.doSetGroupActive(void 0),this.gridview.clear()}movePanel(e,n){var i;let r;const s=this.gridview.remove(e),a=(i=this._groups.get(n.reference))===null||i===void 0?void 0:i.value;if(!a)throw new Error(`reference group ${n.reference} does not exist`);const o=Pc(n.direction);if(o==="center")throw new Error(`${o} not supported as an option`);{const l=et(a.element);r=hi(this.gridview.orientation,l,o)}this.doAddGroup(s,r,n.size)}addPanel(e){var n,i,r,s;let a=(n=e.location)!==null&&n!==void 0?n:[0];if(!((i=e.position)===null||i===void 0)&&i.referencePanel){const l=(r=this._groups.get(e.position.referencePanel))===null||r===void 0?void 0:r.value;if(!l)throw new Error(`reference group ${e.position.referencePanel} does not exist`);const u=Pc(e.position.direction);if(u==="center")throw new Error(`${u} not supported as an option`);{const c=et(l.element);a=hi(this.gridview.orientation,c,u)}}const o=this.options.createComponent({id:e.id,name:e.component});return o.init({params:(s=e.params)!==null&&s!==void 0?s:{},minimumWidth:e.minimumWidth,maximumWidth:e.maximumWidth,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,priority:e.priority,snap:!!e.snap,accessor:this,isVisible:!0}),this.doAddGroup(o,a,e.size),this.registerPanel(o),this.doSetGroupActive(o),o}registerPanel(e){const n=new Se(e.api.onDidFocusChange(i=>{i.isFocused&&this._groups.forEach(r=>{const s=r.value;s!==e?s.setActive(!1):s.setActive(!0)})}));this._groups.set(e.id,{value:e,disposable:n})}moveGroup(e,n,i){const r=this.getPanel(n);if(!r)throw new Error("invalid operation");const s=et(e.element),a=hi(this.gridview.orientation,s,i),[o,l]=Bi(a),u=et(r.element),[c,h]=Bi(u);if(cx(c,o)){this.gridview.moveView(c,h,l);return}const d=this.doRemoveGroup(r,{skipActive:!0,skipDispose:!0}),p=et(e.element),m=hi(this.gridview.orientation,p,i);this.doAddGroup(d,m)}removeGroup(e){super.removeGroup(e)}dispose(){super.dispose(),this._onDidLayoutfromJSON.dispose()}}class GT extends eg{get panels(){return this.splitview.getViews()}get options(){return this._options}get length(){return this._panels.size}get orientation(){return this.splitview.orientation}get splitview(){return this._splitview}set splitview(e){this._splitview&&this._splitview.dispose(),this._splitview=e,this._splitviewChangeDisposable.value=new Se(this._splitview.onDidSashEnd(()=>{this._onDidLayoutChange.fire(void 0)}),this._splitview.onDidAddView(n=>this._onDidAddView.fire(n)),this._splitview.onDidRemoveView(n=>this._onDidRemoveView.fire(n)))}get minimumSize(){return this.splitview.minimumSize}get maximumSize(){return this.splitview.maximumSize}get height(){return this.splitview.orientation===ye.HORIZONTAL?this.splitview.orthogonalSize:this.splitview.size}get width(){return this.splitview.orientation===ye.HORIZONTAL?this.splitview.size:this.splitview.orthogonalSize}constructor(e,n){var i;super(document.createElement("div"),n.disableAutoResizing),this._splitviewChangeDisposable=new qt,this._panels=new Map,this._onDidLayoutfromJSON=new J,this.onDidLayoutFromJSON=this._onDidLayoutfromJSON.event,this._onDidAddView=new J,this.onDidAddView=this._onDidAddView.event,this._onDidRemoveView=new J,this.onDidRemoveView=this._onDidRemoveView.event,this._onDidLayoutChange=new J,this.onDidLayoutChange=this._onDidLayoutChange.event,this.element.style.height="100%",this.element.style.width="100%",this._classNames=new td(this.element),this._classNames.setClassNames((i=n.className)!==null&&i!==void 0?i:""),e.appendChild(this.element),this._options=n,this.splitview=new rl(this.element,n),this.addDisposables(this._onDidAddView,this._onDidLayoutfromJSON,this._onDidRemoveView,this._onDidLayoutChange)}updateOptions(e){var n,i;"className"in e&&this._classNames.setClassNames((n=e.className)!==null&&n!==void 0?n:""),"disableResizing"in e&&(this.disableResizing=(i=e.disableAutoResizing)!==null&&i!==void 0?i:!1),typeof e.orientation=="string"&&(this.splitview.orientation=e.orientation),this._options=Object.assign(Object.assign({},this.options),e),this.splitview.layout(this.splitview.size,this.splitview.orthogonalSize)}focus(){var e;(e=this._activePanel)===null||e===void 0||e.focus()}movePanel(e,n){this.splitview.moveView(e,n)}setVisible(e,n){const i=this.panels.indexOf(e);this.splitview.setViewVisible(i,n)}setActive(e,n){this._activePanel=e,this.panels.filter(i=>i!==e).forEach(i=>{i.api._onDidActiveChange.fire({isActive:!1}),n||i.focus()}),e.api._onDidActiveChange.fire({isActive:!0}),n||e.focus()}removePanel(e,n){const i=this._panels.get(e.id);if(!i)throw new Error(`unknown splitview panel ${e.id}`);i.dispose(),this._panels.delete(e.id);const r=this.panels.findIndex(o=>o===e);this.splitview.removeView(r,n).dispose();const a=this.panels;a.length>0&&this.setActive(a[a.length-1])}getPanel(e){return this.panels.find(n=>n.id===e)}addPanel(e){var n;if(this._panels.has(e.id))throw new Error(`panel ${e.id} already exists`);const i=this.options.createComponent({id:e.id,name:e.component});i.orientation=this.splitview.orientation,i.init({params:(n=e.params)!==null&&n!==void 0?n:{},minimumSize:e.minimumSize,maximumSize:e.maximumSize,snap:e.snap,priority:e.priority,accessor:this});const r=typeof e.size=="number"?e.size:Bn.Distribute,s=typeof e.index=="number"?e.index:void 0;return this.splitview.addView(i,r,s),this.doAddView(i),this.setActive(i),i}layout(e,n){const[i,r]=this.splitview.orientation===ye.HORIZONTAL?[e,n]:[n,e];this.splitview.layout(i,r)}doAddView(e){const n=e.api.onDidFocusChange(i=>{i.isFocused&&this.setActive(e,!0)});this._panels.set(e.id,n)}toJSON(){var e;return{views:this.splitview.getViews().map((i,r)=>({size:this.splitview.getViewSize(r),data:i.toJSON(),snap:!!i.snap,priority:i.priority})),activeView:(e=this._activePanel)===null||e===void 0?void 0:e.id,size:this.splitview.size,orientation:this.splitview.orientation}}fromJSON(e){this.clear();const{views:n,orientation:i,size:r,activeView:s}=e,a=[],o=this.width,l=this.height;if(this.splitview=new rl(this.element,{orientation:i,proportionalLayout:this.options.proportionalLayout,descriptor:{size:r,views:n.map(u=>{const c=u.data;if(this._panels.has(c.id))throw new Error(`panel ${c.id} already exists`);const h=this.options.createComponent({id:c.id,name:c.component});return a.push(()=>{var d;h.init({params:(d=c.params)!==null&&d!==void 0?d:{},minimumSize:c.minimumSize,maximumSize:c.maximumSize,snap:u.snap,priority:u.priority,accessor:this})}),h.orientation=i,this.doAddView(h),setTimeout(()=>{this._onDidAddView.fire(h)},0),{size:u.size,view:h}})}}),this.layout(o,l),a.forEach(u=>u()),typeof s=="string"){const u=this.getPanel(s);u&&this.setActive(u)}this._onDidLayoutfromJSON.fire()}clear(){for(const e of this._panels.values())e.dispose();for(this._panels.clear();this.splitview.length>0;)this.splitview.removeView(0,Bn.Distribute,!0).dispose()}dispose(){for(const n of this._panels.values())n.dispose();this._panels.clear();const e=this.splitview.getViews();this._splitviewChangeDisposable.dispose(),this.splitview.dispose();for(const n of e)n.dispose();this.element.remove(),super.dispose()}}class U_ extends Se{get element(){return this._element}constructor(){super(),this._expandedIcon=yT(),this._collapsedIcon=bx(),this.disposable=new qt,this.apiRef={api:null},this._element=document.createElement("div"),this.element.className="dv-default-header",this._content=document.createElement("span"),this._expander=document.createElement("div"),this._expander.className="dv-pane-header-icon",this.element.appendChild(this._expander),this.element.appendChild(this._content),this.addDisposables(Me(this._element,"click",()=>{var e;(e=this.apiRef.api)===null||e===void 0||e.setExpanded(!this.apiRef.api.isExpanded)}))}init(e){this.apiRef.api=e.api,this._content.textContent=e.title,this.updateIcon(),this.disposable.value=e.api.onDidExpansionChange(()=>{this.updateIcon()})}updateIcon(){var e;const n=!!(!((e=this.apiRef.api)===null||e===void 0)&&e.isExpanded);we(this._expander,"collapsed",!n),n?(this._expander.contains(this._collapsedIcon)&&this._collapsedIcon.remove(),this._expander.contains(this._expandedIcon)||this._expander.appendChild(this._expandedIcon)):(this._expander.contains(this._expandedIcon)&&this._expandedIcon.remove(),this._expander.contains(this._collapsedIcon)||this._expander.appendChild(this._collapsedIcon))}update(e){}dispose(){this.disposable.dispose(),super.dispose()}}const UT=Q0(),q_=22,K_=0,J_=Number.MAX_SAFE_INTEGER;class Z_ extends hT{constructor(e){super({accessor:e.accessor,id:e.id,component:e.component,headerComponent:e.headerComponent,orientation:e.orientation,isExpanded:e.isExpanded,disableDnd:e.disableDnd,headerSize:e.headerSize,minimumBodySize:e.minimumBodySize,maximumBodySize:e.maximumBodySize}),this.options=e}getBodyComponent(){return this.options.body}getHeaderComponent(){return this.options.header}}class qT extends eg{get id(){return this._id}get panels(){return this.paneview.getPanes()}set paneview(e){this._paneview=e,this._disposable.value=new Se(this._paneview.onDidChange(()=>{this._onDidLayoutChange.fire(void 0)}),this._paneview.onDidAddView(n=>this._onDidAddView.fire(n)),this._paneview.onDidRemoveView(n=>this._onDidRemoveView.fire(n)))}get paneview(){return this._paneview}get minimumSize(){return this.paneview.minimumSize}get maximumSize(){return this.paneview.maximumSize}get height(){return this.paneview.orientation===ye.HORIZONTAL?this.paneview.orthogonalSize:this.paneview.size}get width(){return this.paneview.orientation===ye.HORIZONTAL?this.paneview.size:this.paneview.orthogonalSize}get options(){return this._options}constructor(e,n){var i;super(document.createElement("div"),n.disableAutoResizing),this._id=UT.next(),this._disposable=new qt,this._viewDisposables=new Map,this._onDidLayoutfromJSON=new J,this.onDidLayoutFromJSON=this._onDidLayoutfromJSON.event,this._onDidLayoutChange=new J,this.onDidLayoutChange=this._onDidLayoutChange.event,this._onDidDrop=new J,this.onDidDrop=this._onDidDrop.event,this._onDidAddView=new J,this.onDidAddView=this._onDidAddView.event,this._onDidRemoveView=new J,this.onDidRemoveView=this._onDidRemoveView.event,this._onUnhandledDragOverEvent=new J,this.onUnhandledDragOverEvent=this._onUnhandledDragOverEvent.event,this.element.style.height="100%",this.element.style.width="100%",this.addDisposables(this._onDidLayoutChange,this._onDidLayoutfromJSON,this._onDidDrop,this._onDidAddView,this._onDidRemoveView,this._onUnhandledDragOverEvent),this._classNames=new td(this.element),this._classNames.setClassNames((i=n.className)!==null&&i!==void 0?i:""),e.appendChild(this.element),this._options=n,this.paneview=new F_(this.element,{orientation:ye.VERTICAL}),this.addDisposables(this._disposable)}setVisible(e,n){const i=this.panels.indexOf(e);this.paneview.setViewVisible(i,n)}focus(){}updateOptions(e){var n,i;"className"in e&&this._classNames.setClassNames((n=e.className)!==null&&n!==void 0?n:""),"disableResizing"in e&&(this.disableResizing=(i=e.disableAutoResizing)!==null&&i!==void 0?i:!1),this._options=Object.assign(Object.assign({},this.options),e)}addPanel(e){var n,i;const r=this.options.createComponent({id:e.id,name:e.component});let s;e.headerComponent&&this.options.createHeaderComponent&&(s=this.options.createHeaderComponent({id:e.id,name:e.headerComponent})),s||(s=new U_);const a=new Z_({id:e.id,component:e.component,headerComponent:e.headerComponent,header:s,body:r,orientation:ye.VERTICAL,isExpanded:!!e.isExpanded,disableDnd:!!this.options.disableDnd,accessor:this,headerSize:(n=e.headerSize)!==null&&n!==void 0?n:q_,minimumBodySize:K_,maximumBodySize:J_});this.doAddPanel(a);const o=typeof e.size=="number"?e.size:Bn.Distribute,l=typeof e.index=="number"?e.index:void 0;return a.init({params:(i=e.params)!==null&&i!==void 0?i:{},minimumBodySize:e.minimumBodySize,maximumBodySize:e.maximumBodySize,isExpanded:e.isExpanded,title:e.title,containerApi:new sl(this),accessor:this}),this.paneview.addPane(a,o,l),a.orientation=this.paneview.orientation,a}removePanel(e){const i=this.panels.findIndex(r=>r===e);this.paneview.removePane(i),this.doRemovePanel(e)}movePanel(e,n){this.paneview.moveView(e,n)}getPanel(e){return this.panels.find(n=>n.id===e)}layout(e,n){const[i,r]=this.paneview.orientation===ye.HORIZONTAL?[e,n]:[n,e];this.paneview.layout(i,r)}toJSON(){const e=r=>r===Number.MAX_SAFE_INTEGER||r===Number.POSITIVE_INFINITY?void 0:r,n=r=>r<=0?void 0:r;return{views:this.paneview.getPanes().map((r,s)=>({size:this.paneview.getViewSize(s),data:r.toJSON(),minimumSize:n(r.minimumBodySize),maximumSize:e(r.maximumBodySize),headerSize:r.headerSize,expanded:r.isExpanded()})),size:this.paneview.size}}fromJSON(e){this.clear();const{views:n,size:i}=e,r=[],s=this.width,a=this.height;this.paneview=new F_(this.element,{orientation:ye.VERTICAL,descriptor:{size:i,views:n.map(o=>{var l,u,c;const h=o.data,d=this.options.createComponent({id:h.id,name:h.component});let p;h.headerComponent&&this.options.createHeaderComponent&&(p=this.options.createHeaderComponent({id:h.id,name:h.headerComponent})),p||(p=new U_);const m=new Z_({id:h.id,component:h.component,headerComponent:h.headerComponent,header:p,body:d,orientation:ye.VERTICAL,isExpanded:!!o.expanded,disableDnd:!!this.options.disableDnd,accessor:this,headerSize:(l=o.headerSize)!==null&&l!==void 0?l:q_,minimumBodySize:(u=o.minimumSize)!==null&&u!==void 0?u:K_,maximumBodySize:(c=o.maximumSize)!==null&&c!==void 0?c:J_});return this.doAddPanel(m),r.push(()=>{var _;m.init({params:(_=h.params)!==null&&_!==void 0?_:{},minimumBodySize:o.minimumSize,maximumBodySize:o.maximumSize,title:h.title,isExpanded:!!o.expanded,containerApi:new sl(this),accessor:this}),m.orientation=this.paneview.orientation}),setTimeout(()=>{this._onDidAddView.fire(m)},0),{size:o.size,view:m}})}}),this.layout(s,a),r.forEach(o=>o()),this._onDidLayoutfromJSON.fire()}clear(){for(const[e,n]of this._viewDisposables.entries())n.dispose();this._viewDisposables.clear(),this.paneview.dispose()}doAddPanel(e){const n=new Se(e.onDidDrop(i=>{this._onDidDrop.fire(i)}),e.onUnhandledDragOverEvent(i=>{this._onUnhandledDragOverEvent.fire(i)}));this._viewDisposables.set(e.id,n)}doRemovePanel(e){const n=this._viewDisposables.get(e.id);n&&(n.dispose(),this._viewDisposables.delete(e.id))}dispose(){super.dispose();for(const[e,n]of this._viewDisposables.entries())n.dispose();this._viewDisposables.clear(),this.element.remove(),this.paneview.dispose()}}class KT extends ng{get priority(){return this._priority}set orientation(e){this._orientation=e}get orientation(){return this._orientation}get minimumSize(){const e=typeof this._minimumSize=="function"?this._minimumSize():this._minimumSize;return e!==this._evaluatedMinimumSize&&(this._evaluatedMinimumSize=e,this.updateConstraints()),e}get maximumSize(){const e=typeof this._maximumSize=="function"?this._maximumSize():this._maximumSize;return e!==this._evaluatedMaximumSize&&(this._evaluatedMaximumSize=e,this.updateConstraints()),e}get snap(){return this._snap}constructor(e,n){super(e,n,new _x(e,n)),this._evaluatedMinimumSize=0,this._evaluatedMaximumSize=Number.POSITIVE_INFINITY,this._minimumSize=0,this._maximumSize=Number.POSITIVE_INFINITY,this._snap=!1,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this.api.initialize(this),this.addDisposables(this._onDidChange,this.api.onWillVisibilityChange(i=>{const{isVisible:r}=i,{accessor:s}=this._params;s.setVisible(this,r)}),this.api.onActiveChange(()=>{const{accessor:i}=this._params;i.setActive(this)}),this.api.onDidConstraintsChangeInternal(i=>{(typeof i.minimumSize=="number"||typeof i.minimumSize=="function")&&(this._minimumSize=i.minimumSize),(typeof i.maximumSize=="number"||typeof i.maximumSize=="function")&&(this._maximumSize=i.maximumSize),this.updateConstraints()}),this.api.onDidSizeChange(i=>{this._onDidChange.fire({size:i.size})}))}setVisible(e){this.api._onDidVisibilityChange.fire({isVisible:e})}setActive(e){this.api._onDidActiveChange.fire({isActive:e})}layout(e,n){const[i,r]=this.orientation===ye.HORIZONTAL?[e,n]:[n,e];super.layout(i,r)}init(e){super.init(e),this._priority=e.priority,e.minimumSize&&(this._minimumSize=e.minimumSize),e.maximumSize&&(this._maximumSize=e.maximumSize),e.snap&&(this._snap=e.snap)}toJSON(){const e=i=>i===Number.MAX_SAFE_INTEGER||i===Number.POSITIVE_INFINITY?void 0:i,n=i=>i<=0?void 0:i;return Object.assign(Object.assign({},super.toJSON()),{minimumSize:n(this.minimumSize),maximumSize:e(this.maximumSize)})}updateConstraints(){this.api._onDidConstraintsChange.fire({maximumSize:this._evaluatedMaximumSize,minimumSize:this._evaluatedMinimumSize})}}function JT(t,e){return new WT(t,e).api}function ZT(t,e){const n=new GT(t,e);return new fx(n)}function YT(t,e){const n=new VT(t,e);return new px(n)}function XT(t,e){const n=new qT(t,e);return new sl(n)}const Cx=(t,e)=>{const[n,i]=ue.useState(),r=ue.useRef(t.componentProps);return ue.useImperativeHandle(e,()=>({update:s=>{r.current=Object.assign(Object.assign({},r.current),s),i(Date.now())}}),[]),ue.createElement(t.component,r.current)};Cx.displayName="DockviewReactJsBridge";const QT=(()=>{let t=1;return{next:()=>`dockview_react_portal_key_${(t++).toString()}`}})(),e6=ue.createContext({});class Ms{constructor(e,n,i,r,s){this.parent=e,this.portalStore=n,this.component=i,this.parameters=r,this.context=s,this._initialProps={},this.disposed=!1,this.createPortal()}update(e){if(this.disposed)throw new Error("invalid operation: resource is already disposed");this.componentInstance?this.componentInstance.update(e):this._initialProps=Object.assign(Object.assign({},this._initialProps),e)}createPortal(){if(this.disposed)throw new Error("invalid operation: resource is already disposed");if(!t6(this.component))throw new Error("Dockview: Only React.memo(...), React.ForwardRef(...) and functional components are accepted as components");const e=ue.createElement(ue.forwardRef(Cx),{component:this.component,componentProps:this.parameters,ref:r=>{this.componentInstance=r,Object.keys(this._initialProps).length>0&&(this.componentInstance.update(this._initialProps),this._initialProps={})}}),n=this.context?ue.createElement(e6.Provider,{value:this.context},e):e,i=ix.createPortal(n,this.parent,QT.next());this.ref={portal:i,disposable:this.portalStore.addPortal(i)}}dispose(){var e;(e=this.ref)===null||e===void 0||e.disposable.dispose(),this.disposed=!0}}const rd=()=>{const[t,e]=ue.useState([]);ue.useDebugValue(`Portal count: ${t.length}`);const n=ue.useCallback(i=>{e(s=>[...s,i]);let r=!1;return pt.from(()=>{if(r)throw new Error("invalid operation: resource already disposed");r=!0,e(s=>s.filter(a=>a!==i))})},[]);return[t,n]};function t6(t){return typeof t=="function"||!!(t!=null&&t.$$typeof)}class Y_{get element(){return this._element}constructor(e,n,i){this.id=e,this.component=n,this.reactPortalStore=i,this._onDidFocus=new J,this.onDidFocus=this._onDidFocus.event,this._onDidBlur=new J,this.onDidBlur=this._onDidBlur.event,this._element=document.createElement("div"),this._element.className="dv-react-part",this._element.style.height="100%",this._element.style.width="100%"}focus(){}init(e){this.part=new Ms(this.element,this.reactPortalStore,this.component,{params:e.params,api:e.api,containerApi:e.containerApi})}update(e){var n;(n=this.part)===null||n===void 0||n.update({params:e.params})}layout(e,n){}dispose(){var e;this._onDidFocus.dispose(),this._onDidBlur.dispose(),(e=this.part)===null||e===void 0||e.dispose()}}class X_{get element(){return this._element}constructor(e,n,i){this.id=e,this.component=n,this.reactPortalStore=i,this._element=document.createElement("div"),this._element.className="dv-react-part",this._element.style.height="100%",this._element.style.width="100%"}focus(){}init(e){this.part=new Ms(this.element,this.reactPortalStore,this.component,{params:e.params,api:e.api,containerApi:e.containerApi,tabLocation:e.tabLocation})}update(e){var n;(n=this.part)===null||n===void 0||n.update({params:e.params})}layout(e,n){}dispose(){var e;(e=this.part)===null||e===void 0||e.dispose()}}class Q_{get element(){return this._element}constructor(e,n,i){this.id=e,this.component=n,this.reactPortalStore=i,this._element=document.createElement("div"),this._element.className="dv-react-part",this._element.style.height="100%",this._element.style.width="100%"}init(e){this.part=new Ms(this.element,this.reactPortalStore,this.component,{group:e.group,containerApi:e.containerApi})}focus(){}update(e){var n,i,r;this.parameters&&(this.parameters.params=e.params),(n=this.part)===null||n===void 0||n.update({params:(r=(i=this.parameters)===null||i===void 0?void 0:i.params)!==null&&r!==void 0?r:{}})}layout(e,n){}dispose(){var e;(e=this.part)===null||e===void 0||e.dispose()}}class n6{get element(){return this._element}get part(){return this._part}constructor(e,n,i){this.component=e,this.reactPortalStore=n,this._group=i,this.mutableDisposable=new qt,this._element=document.createElement("div"),this._element.className="dv-react-part",this._element.style.height="100%",this._element.style.width="100%"}init(e){this.mutableDisposable.value=new Se(this._group.model.onDidAddPanel(()=>{this.updatePanels()}),this._group.model.onDidRemovePanel(()=>{this.updatePanels()}),this._group.model.onDidActivePanelChange(()=>{this.updateActivePanel()}),e.api.onDidActiveChange(()=>{this.updateGroupActive()})),this._part=new Ms(this.element,this.reactPortalStore,this.component,{api:e.api,containerApi:e.containerApi,panels:this._group.model.panels,activePanel:this._group.model.activePanel,isGroupActive:this._group.api.isActive,group:this._group})}dispose(){var e;this.mutableDisposable.dispose(),(e=this._part)===null||e===void 0||e.dispose()}update(e){var n;(n=this._part)===null||n===void 0||n.update(e.params)}updatePanels(){this.update({params:{panels:this._group.model.panels}})}updateActivePanel(){this.update({params:{activePanel:this._group.model.activePanel}})}updateGroupActive(){this.update({params:{isGroupActive:this._group.api.isActive}})}}function Bs(t,e){return t?n=>new n6(t,e,n):void 0}const cu="props.defaultTabComponent";function i6(t){return nm.reduce((n,i)=>(i in t&&(n[i]=t[i]),n),{})}const Ex=ue.forwardRef((t,e)=>{const n=ue.useRef(null),i=ue.useRef(),[r,s]=rd();ue.useImperativeHandle(e,()=>n.current,[]);const a=ue.useRef({});return ue.useEffect(()=>{const o={};nm.forEach(l=>{const u=l,c=t[u];u in t&&c!==a.current[u]&&(o[u]=c)}),i.current&&i.current.updateOptions(o),a.current=t},nm.map(o=>t[o])),ue.useEffect(()=>{var o;if(!n.current)return;const l=(o=t.tabComponents)!==null&&o!==void 0?o:{};t.defaultTabComponent&&(l[cu]=t.defaultTabComponent);const u={createLeftHeaderActionComponent:Bs(t.leftHeaderActionsComponent,{addPortal:s}),createRightHeaderActionComponent:Bs(t.rightHeaderActionsComponent,{addPortal:s}),createPrefixHeaderActionComponent:Bs(t.prefixHeaderActionsComponent,{addPortal:s}),createComponent:p=>new Y_(p.id,t.components[p.name],{addPortal:s}),createTabComponent(p){return new X_(p.id,l[p.name],{addPortal:s})},createWatermarkComponent:t.watermarkComponent?()=>new Q_("watermark",t.watermarkComponent,{addPortal:s}):void 0,defaultTabComponent:t.defaultTabComponent?cu:void 0},c=JT(n.current,Object.assign(Object.assign({},i6(t)),u)),{clientWidth:h,clientHeight:d}=n.current;return c.layout(h,d),t.onReady&&t.onReady({api:c}),i.current=c,()=>{i.current=void 0,c.dispose()}},[]),ue.useEffect(()=>{if(!i.current)return()=>{};const o=i.current.onDidDrop(l=>{t.onDidDrop&&t.onDidDrop(l)});return()=>{o.dispose()}},[t.onDidDrop]),ue.useEffect(()=>{if(!i.current)return()=>{};const o=i.current.onWillDrop(l=>{t.onWillDrop&&t.onWillDrop(l)});return()=>{o.dispose()}},[t.onWillDrop]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createComponent:o=>new Y_(o.id,t.components[o.name],{addPortal:s})})},[t.components]),ue.useEffect(()=>{var o;if(!i.current)return;const l=(o=t.tabComponents)!==null&&o!==void 0?o:{};t.defaultTabComponent&&(l[cu]=t.defaultTabComponent),i.current.updateOptions({defaultTabComponent:t.defaultTabComponent?cu:void 0,createTabComponent(u){return new X_(u.id,l[u.name],{addPortal:s})}})},[t.tabComponents,t.defaultTabComponent]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createWatermarkComponent:t.watermarkComponent?()=>new Q_("watermark",t.watermarkComponent,{addPortal:s}):void 0})},[t.watermarkComponent]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createRightHeaderActionComponent:Bs(t.rightHeaderActionsComponent,{addPortal:s})})},[t.rightHeaderActionsComponent]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createLeftHeaderActionComponent:Bs(t.leftHeaderActionsComponent,{addPortal:s})})},[t.leftHeaderActionsComponent]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createPrefixHeaderActionComponent:Bs(t.prefixHeaderActionsComponent,{addPortal:s})})},[t.prefixHeaderActionsComponent]),ue.createElement("div",{style:{height:"100%",width:"100%"},ref:n},r)});Ex.displayName="DockviewComponent";const r6=()=>ue.createElement("svg",{height:"11",width:"11",viewBox:"0 0 28 28","aria-hidden":"false",focusable:!1,className:"dv-svg"},ue.createElement("path",{d:"M2.1 27.3L0 25.2L11.55 13.65L0 2.1L2.1 0L13.65 11.55L25.2 0L27.3 2.1L15.75 13.65L27.3 25.2L25.2 27.3L13.65 15.75L2.1 27.3Z"}));var s6=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function o6(t){const[e,n]=ue.useState(t.title);return ue.useEffect(()=>{const i=t.onDidTitleChange(r=>{n(r.title)});return e!==t.title&&n(t.title),()=>{i.dispose()}},[t]),e}const a6=t=>{var{api:e,containerApi:n,params:i,hideClose:r,closeActionOverride:s,onPointerDown:a,onPointerUp:o,onPointerLeave:l,tabLocation:u}=t,c=s6(t,["api","containerApi","params","hideClose","closeActionOverride","onPointerDown","onPointerUp","onPointerLeave","tabLocation"]);const h=o6(e),d=ue.useRef(!1),p=ue.useCallback(g=>{g.preventDefault(),s?s():e.close()},[e,s]),m=ue.useCallback(g=>{g.preventDefault()},[]),_=ue.useCallback(g=>{d.current=g.button===1,a==null||a(g)},[a]),f=ue.useCallback(g=>{d&&g.button===1&&!r&&(d.current=!1,p(g)),o==null||o(g)},[o,p,r]),v=ue.useCallback(g=>{d.current=!1,l==null||l(g)},[l]);return ue.createElement("div",Object.assign({"data-testid":"dockview-dv-default-tab"},c,{onPointerDown:_,onPointerUp:f,onPointerLeave:v,className:"dv-default-tab"}),ue.createElement("span",{className:"dv-default-tab-content"},h),!r&&ue.createElement("div",{className:"dv-default-tab-action",onPointerDown:m,onClick:p},ue.createElement(r6,null)))};class e1 extends KT{constructor(e,n,i,r){super(e,n),this.reactComponent=i,this.reactPortalStore=r}getComponent(){var e,n;return new Ms(this.element,this.reactPortalStore,this.reactComponent,{params:(n=(e=this._params)===null||e===void 0?void 0:e.params)!==null&&n!==void 0?n:{},api:this.api,containerApi:new fx(this._params.accessor)})}}function l6(t){return Zp.reduce((n,i)=>(i in t&&(n[i]=t[i]),n),{})}const u6=ue.forwardRef((t,e)=>{const n=ue.useRef(null),i=ue.useRef(),[r,s]=rd();ue.useImperativeHandle(e,()=>n.current,[]);const a=ue.useRef({});return ue.useEffect(()=>{const o={};Zp.forEach(l=>{const u=l,c=t[u];u in t&&c!==a.current[u]&&(o[u]=c)}),i.current&&i.current.updateOptions(o),a.current=t},Zp.map(o=>t[o])),ue.useEffect(()=>{if(!n.current)return()=>{};const o={createComponent:h=>new e1(h.id,h.name,t.components[h.name],{addPortal:s})},l=ZT(n.current,Object.assign(Object.assign({},l6(t)),o)),{clientWidth:u,clientHeight:c}=n.current;return l.layout(u,c),t.onReady&&t.onReady({api:l}),i.current=l,()=>{i.current=void 0,l.dispose()}},[]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createComponent:o=>new e1(o.id,o.name,t.components[o.name],{addPortal:s})})},[t.components]),ue.createElement("div",{style:{height:"100%",width:"100%"},ref:n},r)});u6.displayName="SplitviewComponent";class t1 extends xx{constructor(e,n,i,r){super(e,n),this.reactComponent=i,this.reactPortalStore=r}getComponent(){var e,n;return new Ms(this.element,this.reactPortalStore,this.reactComponent,{params:(n=(e=this._params)===null||e===void 0?void 0:e.params)!==null&&n!==void 0?n:{},api:this.api,containerApi:new px(this._params.accessor)})}}function c6(t){return em.reduce((n,i)=>(i in t&&(n[i]=t[i]),n),{})}const h6=ue.forwardRef((t,e)=>{const n=ue.useRef(null),i=ue.useRef(),[r,s]=rd();ue.useImperativeHandle(e,()=>n.current,[]);const a=ue.useRef({});return ue.useEffect(()=>{const o={};em.forEach(l=>{const u=l,c=t[u];u in t&&c!==a.current[u]&&(o[u]=c)}),i.current&&i.current.updateOptions(o),a.current=t},em.map(o=>t[o])),ue.useEffect(()=>{if(!n.current)return()=>{};const o={createComponent:h=>new t1(h.id,h.name,t.components[h.name],{addPortal:s})},l=YT(n.current,Object.assign(Object.assign({},c6(t)),o)),{clientWidth:u,clientHeight:c}=n.current;return l.layout(u,c),t.onReady&&t.onReady({api:l}),i.current=l,()=>{i.current=void 0,l.dispose()}},[]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createComponent:o=>new t1(o.id,o.name,t.components[o.name],{addPortal:s})})},[t.components]),ue.createElement("div",{style:{height:"100%",width:"100%"},ref:n},r)});h6.displayName="GridviewComponent";class hu{get element(){return this._element}constructor(e,n,i){this.id=e,this.component=n,this.reactPortalStore=i,this._element=document.createElement("div"),this._element.style.height="100%",this._element.style.width="100%"}init(e){this.part=new Ms(this.element,this.reactPortalStore,this.component,{params:e.params,api:e.api,title:e.title,containerApi:e.containerApi})}toJSON(){return{id:this.id}}update(e){var n;(n=this.part)===null||n===void 0||n.update(e.params)}dispose(){var e;(e=this.part)===null||e===void 0||e.dispose()}}function d6(t){return tm.reduce((n,i)=>(i in t&&(n[i]=t[i]),n),{})}const f6=ue.forwardRef((t,e)=>{const n=ue.useRef(null),i=ue.useRef(),[r,s]=rd();ue.useImperativeHandle(e,()=>n.current,[]);const a=ue.useRef({});return ue.useEffect(()=>{const o={};tm.forEach(l=>{const u=l,c=t[u];u in t&&c!==a.current[u]&&(o[u]=c)}),i.current&&i.current.updateOptions(o),a.current=t},tm.map(o=>t[o])),ue.useEffect(()=>{var o;if(!n.current)return()=>{};const l=(o=t.headerComponents)!==null&&o!==void 0?o:{},u={createComponent:p=>new hu(p.id,t.components[p.name],{addPortal:s}),createHeaderComponent:p=>new hu(p.id,l[p.name],{addPortal:s})},c=XT(n.current,Object.assign(Object.assign({},d6(t)),u)),{clientWidth:h,clientHeight:d}=n.current;return c.layout(h,d),t.onReady&&t.onReady({api:c}),i.current=c,()=>{i.current=void 0,c.dispose()}},[]),ue.useEffect(()=>{i.current&&i.current.updateOptions({createComponent:o=>new hu(o.id,t.components[o.name],{addPortal:s})})},[t.components]),ue.useEffect(()=>{var o;if(!i.current)return;const l=(o=t.headerComponents)!==null&&o!==void 0?o:{};i.current.updateOptions({createHeaderComponent:u=>new hu(u.id,l[u.name],{addPortal:s})})},[t.headerComponents]),ue.useEffect(()=>{if(!i.current)return()=>{};const o=i.current.onDidDrop(l=>{t.onDidDrop&&t.onDidDrop(l)});return()=>{o.dispose()}},[t.onDidDrop]),ue.createElement("div",{style:{height:"100%",width:"100%"},ref:n},r)});f6.displayName="PaneviewComponent";const p6="",Di=t=>`${p6}${t}`,m6={projects:"",sources:"",workflows:""},g6=t=>{if(!t)return"Other";const e=t.replace(/^\./,"");return e.charAt(0).toUpperCase()+e.slice(1)};function v6({onOpen:t,onOpenToSide:e,onFileDeleted:n,onFileRenamed:i,onFileMoved:r,projectRoot:s,activeFile:a,creatingFile:o,onFileCreated:l,onCancelCreate:u}){const[c,h]=I.useState([]),[d,p]=I.useState({}),[m,_]=I.useState(""),[f,v]=I.useState([]),[g,y]=I.useState(!1),[b,w]=I.useState({}),[x,k]=I.useState(null),[S,E]=I.useState(null),[A,M]=I.useState(null),[R,P]=I.useState(null),[H,B]=I.useState(null),[L,j]=I.useState({other:!0}),D=I.useRef(null),O=I.useRef(null),N=I.useRef(d);I.useEffect(()=>{N.current=d},[d]);const z=U=>fetch(Di(`/api/tree?path=${encodeURIComponent(U)}`)).then(Q=>Q.json()).then(Q=>Q.entries||[]).catch(()=>[]),q=()=>{fetch(Di("/api/git/status")).then(U=>U.json()).then(U=>{U.available&&U.files&&w(U.files)}).catch(()=>{})},te=I.useCallback(async()=>{const U=await z(".");h(U);const Q=Object.keys(N.current);if(Q.length>0){const me=await Promise.all(Q.map(z));p(de=>{const Ae={...de};return Q.forEach((je,jt)=>{Ae[je]=me[jt]}),Ae})}q()},[]),ee=()=>{fetch(Di("/api/config")).then(U=>U.json()).then(async U=>{if(U.paths){B(U.paths);const Q=["projects","sources","workflows"],me={},de={};for(const Ae of Q){const je=U.paths[Ae];if(je){const jt=await z(je);me[je]=jt,jt.length===0&&(de[Ae]=!0)}}p(Ae=>({...Ae,...me})),Object.keys(de).length>0&&j(Ae=>({...Ae,...de}))}}).catch(()=>{})};I.useEffect(()=>{let U=0;const Q=10,me=()=>{z(".").then(je=>{je.length>0||U>=Q?h(je):(U++,setTimeout(me,300))})};me(),q(),ee();const de=setInterval(q,5e3),Ae=setInterval(te,3e3);return()=>{clearInterval(de),clearInterval(Ae)}},[]),I.useEffect(()=>{if(!m.trim()){v([]),y(!1);return}y(!0);const U=setTimeout(()=>{fetch(Di(`/api/search?q=${encodeURIComponent(m)}`)).then(Q=>Q.json()).then(Q=>{v(Q.results||[]),y(!1)}).catch(()=>{v([]),y(!1)})},200);return()=>clearTimeout(U)},[m]),I.useEffect(()=>{S&&D.current&&(D.current.focus(),D.current.select())},[S]),I.useEffect(()=>{R&&O.current&&O.current.focus()},[R]),I.useEffect(()=>{o&&P({parentDir:"",name:""})},[o]),I.useEffect(()=>{const U=()=>k(null);return document.addEventListener("click",U),()=>document.removeEventListener("click",U)},[]);const K=async U=>{if(U.is_dir){const Q=U.path;if(d[Q])p(me=>{const de={...me};return delete de[Q],de});else{const me=await z(Q);p(de=>({...de,[Q]:me}))}}else t(U.path)},ce=(U,Q)=>{U.preventDefault(),U.stopPropagation(),k({x:U.clientX,y:U.clientY,entry:Q})},T=()=>{x&&(E({entry:x.entry,newName:x.entry.name}),k(null))},$=(U=!1)=>{if(!x)return;const Q=x.entry;k(null);const me=U&&s?`${s}/${Q.path}`:Q.path;navigator.clipboard.writeText(me).catch(()=>{const de=document.createElement("textarea");de.value=me,document.body.appendChild(de),de.select(),document.execCommand("copy"),document.body.removeChild(de)})},Z=async()=>{if(!x)return;const U=x.entry;k(null);const Q=U.is_dir?`Delete folder "${U.name}" and all its contents?`:`Delete file "${U.name}"?`;if(window.confirm(Q))try{const me=await fetch(Di(`/api/file?path=${encodeURIComponent(U.path)}`),{method:"DELETE"});if(me.ok)await te(),n==null||n(U.path);else{const de=await me.json();alert(`Failed to delete: ${de.detail||"Unknown error"}`)}}catch(me){alert(`Failed to delete: ${me.message}`)}},F=async()=>{if(!S||!S.newName.trim()){E(null);return}const U=S.entry.path,Q=U.includes("/")?U.substring(0,U.lastIndexOf("/")):"",me=Q?`${Q}/${S.newName}`:S.newName;if(U===me){E(null);return}try{const de=await fetch(Di("/api/file/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({old_path:U,new_path:me})});if(de.ok)E(null),await te(),i==null||i(U,me);else{const Ae=await de.json();alert(`Failed to rename: ${Ae.detail||"Unknown error"}`)}}catch(de){alert(`Failed to rename: ${de.message}`)}},V=U=>{U.key==="Enter"?(U.preventDefault(),F()):U.key==="Escape"&&E(null)},G=(U="")=>{k(null),U&&!d[U]&&z(U).then(Q=>{p(me=>({...me,[U]:Q}))}),P({parentDir:U,name:""})},W=async()=>{if(!R||!R.name.trim()){P(null),u==null||u();return}const U=R.name.trim(),Q=R.parentDir?`${R.parentDir}/${U}`:U;try{const me=await fetch(Di(`/api/file?path=${encodeURIComponent(Q)}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:""})});if(me.ok)P(null),await te(),l==null||l(Q);else{const de=await me.json();alert(`Failed to create file: ${de.detail||"Unknown error"}`)}}catch(me){alert(`Failed to create file: ${me.message}`)}},ne=U=>{U.key==="Enter"?(U.preventDefault(),W()):U.key==="Escape"&&(P(null),u==null||u())},oe=U=>{t(U.path),_("")},ae=U=>b[U]||null,Y=U=>{const Q=U+"/";for(const me of Object.keys(b))if(me.startsWith(Q)||me===U)return!0;return!1},le=U=>{if(!U)return null;const me={M:{label:"M",className:"git-status-modified",title:"Modified"},U:{label:"N",className:"git-status-new",title:"New"},A:{label:"A",className:"git-status-added",title:"Added"},D:{label:"D",className:"git-status-deleted",title:"Deleted"}}[U];return me?C.jsx("span",{className:`git-status-badge ${me.className}`,title:me.title,children:me.label}):null},_e=(U,Q)=>{U.dataTransfer.setData("text/plain",Q.path),U.dataTransfer.setData("application/x-kurt-file",JSON.stringify({path:Q.path,name:Q.name,is_dir:Q.is_dir})),U.dataTransfer.effectAllowed="move"},fe=(U,Q)=>{Q.is_dir&&(U.preventDefault(),U.dataTransfer.dropEffect="move",M(Q.path))},xe=()=>{M(null)},De=async(U,Q)=>{if(U.preventDefault(),M(null),!Q.is_dir)return;const me=U.dataTransfer.getData("application/x-kurt-file");if(!me)return;const de=JSON.parse(me);if(de.path!==Q.path&&!Q.path.startsWith(de.path+"/"))try{const Ae=await fetch(Di("/api/file/move"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({src_path:de.path,dest_dir:Q.path})});if(Ae.ok){const je=await Ae.json();await te(),r==null||r(de.path,je.dest_path)}else{const je=await Ae.json();alert(`Failed to move: ${je.detail||"Unknown error"}`)}}catch(Ae){alert(`Failed to move: ${Ae.message}`)}},ge=async U=>{U.preventDefault(),M(null);const Q=U.dataTransfer.getData("application/x-kurt-file");if(!Q)return;const me=JSON.parse(Q);if(me.path.includes("/"))try{const de=await fetch(Di("/api/file/move"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({src_path:me.path,dest_dir:"."})});if(de.ok){const Ae=await de.json();await te(),r==null||r(me.path,Ae.dest_path)}else{const Ae=await de.json();alert(`Failed to move: ${Ae.detail||"Unknown error"}`)}}catch(de){alert(`Failed to move: ${de.message}`)}},ke=(U,Q)=>!R||R.parentDir!==Q?null:C.jsxs("div",{className:"file-item file-item-new",style:{paddingLeft:`${U*16+8}px`},children:[C.jsx("span",{className:"file-item-icon",children:""}),C.jsx("input",{ref:O,type:"text",className:"rename-input",placeholder:"filename",value:R.name,onChange:me=>P({...R,name:me.target.value}),onKeyDown:ne,onBlur:W,onClick:me=>me.stopPropagation()})]}),Pe=(U,Q=0,me="")=>U.map(de=>{const Ae=de.is_dir?null:ae(de.path),je=de.is_dir&&Y(de.path),jt=(S==null?void 0:S.entry.path)===de.path,Hl=A===de.path,$l=!de.is_dir&&a===de.path;return C.jsxs(ue.Fragment,{children:[C.jsxs("div",{className:`file-item ${je?"has-changes":""} ${Hl?"drag-over":""} ${$l?"file-item-active":""}`,style:{paddingLeft:`${Q*16+8}px`},onClick:()=>!jt&&K(de),onContextMenu:Vn=>ce(Vn,de),draggable:!jt,onDragStart:Vn=>_e(Vn,de),onDragOver:Vn=>fe(Vn,de),onDragLeave:xe,onDrop:Vn=>De(Vn,de),children:[C.jsx("span",{className:"file-item-icon",children:de.is_dir?d[de.path]?"":"":""}),jt?C.jsx("input",{ref:D,type:"text",className:"rename-input",value:S.newName,onChange:Vn=>E({...S,newName:Vn.target.value}),onKeyDown:V,onBlur:F,onClick:Vn=>Vn.stopPropagation()}):C.jsx("span",{className:`file-item-name ${Ae?`file-name-${Ae.toLowerCase()}`:""}`,children:de.name}),le(Ae),je&&C.jsx("span",{className:"dir-changes-dot",title:"Contains changes"})]}),de.is_dir&&d[de.path]&&C.jsxs(C.Fragment,{children:[ke(Q+1,de.path),Pe(d[de.path],Q+1,de.path)]})]},de.path)}),Fe=(U,Q)=>{if(!Q.trim())return U;const me=U.toLowerCase().indexOf(Q.toLowerCase());return me===-1?U:C.jsxs(C.Fragment,{children:[U.slice(0,me),C.jsx("mark",{children:U.slice(me,me+Q.length)}),U.slice(me+Q.length)]})},vt=U=>{U.target.closest(".file-item")||U.target.closest(".search-box")||(U.preventDefault(),U.stopPropagation(),k({x:U.clientX,y:U.clientY,entry:null}))},Yt=U=>{j(Q=>({...Q,[U]:!Q[U]}))},Dn=()=>{if(!H||c.length===0)return null;const U=["projects","workflows","sources"],Q={},me=new Set;for(const je of U){const jt=H[je];jt&&(Q[je]={path:jt,label:g6(jt),icon:m6[je]||"",entries:[]},me.add(jt))}const de=[];let Ae=null;for(const je of c){if(je.name==="kurt.config"&&!je.is_dir){Ae=je;continue}let jt=!1;for(const Hl of U){const $l=H[Hl];if($l&&je.path===$l){Q[Hl].entries.push(je),jt=!0;break}}jt||de.push(je)}return de.length>0&&(Q.other={path:null,label:"Other",icon:"",entries:de}),{sections:Q,configFile:Ae}},_t=(U,Q)=>{const me=L[U],de=Q.entries.some(Ae=>Ae.is_dir?Y(Ae.path):ae(Ae.path));return C.jsxs("div",{className:"file-tree-section",children:[C.jsxs("div",{className:`file-tree-section-header ${de?"has-changes":""}`,onClick:()=>Yt(U),children:[C.jsx("span",{className:"section-collapse-icon",children:me?"":""}),C.jsx("span",{className:"section-icon",children:Q.icon}),C.jsx("span",{className:"section-label",children:Q.label}),de&&C.jsx("span",{className:"dir-changes-dot",title:"Contains changes"})]}),!me&&C.jsx("div",{className:"file-tree-section-content",children:U!=="other"&&Q.path?C.jsxs(C.Fragment,{children:[ke(0,Q.path),d[Q.path]!==void 0?d[Q.path].length>0?Pe(d[Q.path],0,Q.path):C.jsx("div",{className:"file-item section-empty-placeholder",children:C.jsx("span",{className:"file-item-name",children:"Empty"})}):C.jsxs("div",{className:"file-item section-folder-placeholder",onClick:()=>{const Ae=c.find(je=>je.path===Q.path);Ae&&K(Ae)},children:[C.jsx("span",{className:"file-item-icon",children:""}),C.jsx("span",{className:"file-item-name",children:"Loading..."})]})]}):Q.entries.map(Ae=>C.jsx(ue.Fragment,{children:Pe([Ae],0,"")},Ae.path))})]},U)},St=Dn(),Ee=St==null?void 0:St.sections,Pt=St==null?void 0:St.configFile;return C.jsxs("div",{className:"file-tree",onContextMenu:vt,children:[C.jsxs("div",{className:"search-box",children:[C.jsxs("svg",{className:"search-icon",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("circle",{cx:"11",cy:"11",r:"8"}),C.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),C.jsx("input",{type:"text",className:"search-input",placeholder:"Search files...",value:m,onChange:U=>_(U.target.value)}),m&&C.jsx("button",{type:"button",className:"search-clear",onClick:()=>_(""),children:C.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),C.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),m.trim()?C.jsx("div",{className:"search-results",children:g?C.jsx("div",{className:"search-status",children:"Searching..."}):f.length===0?C.jsx("div",{className:"search-status",children:"No files found"}):f.map(U=>C.jsxs("div",{className:"search-result-item",onClick:()=>oe(U),children:[C.jsxs("span",{className:"search-result-name",children:[Fe(U.name,m),le(ae(U.path))]}),C.jsx("span",{className:"search-result-path",children:U.dir})]},U.path))}):Ee?C.jsxs("div",{className:"file-tree-sections",children:[ke(0,""),Pt&&C.jsxs("div",{className:`file-item config-file-item ${a===Pt.path?"file-item-active":""}`,onClick:()=>t(Pt.path),onContextMenu:U=>ce(U,Pt),children:[C.jsx("span",{className:"file-item-icon",children:""}),C.jsx("span",{className:"file-item-name",children:Pt.name}),le(ae(Pt.path))]}),["projects","workflows","sources"].map(U=>Ee[U]&&Ee[U].path?_t(U,Ee[U]):null),Ee.other&&Ee.other.entries.length>0&&_t("other",Ee.other)]}):C.jsxs(C.Fragment,{children:[C.jsxs("h3",{className:"file-tree-title",onDragOver:U=>{U.preventDefault(),M("root")},onDragLeave:()=>M(null),onDrop:ge,children:["Project ",A==="root"&&C.jsx("span",{className:"drop-hint",children:"(drop here)"})]}),C.jsxs("div",{children:[ke(0,""),Pe(c)]})]}),x&&C.jsx("div",{className:"context-menu",style:{top:x.y,left:x.x},onClick:U=>U.stopPropagation(),children:x.entry?C.jsxs(C.Fragment,{children:[!x.entry.is_dir&&C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"context-menu-item",onClick:()=>{e==null||e(x.entry.path),k(null)},children:"Open to the Side"}),C.jsx("div",{className:"context-menu-separator"})]}),C.jsx("div",{className:"context-menu-item",onClick:()=>{const U=x.entry.is_dir?x.entry.path:x.entry.path.includes("/")?x.entry.path.substring(0,x.entry.path.lastIndexOf("/")):"";G(U)},children:"New File"}),C.jsx("div",{className:"context-menu-separator"}),C.jsx("div",{className:"context-menu-item",onClick:()=>$(!1),children:"Copy Relative Path"}),C.jsx("div",{className:"context-menu-item",onClick:()=>$(!0),children:"Copy Path"}),C.jsx("div",{className:"context-menu-separator"}),C.jsx("div",{className:"context-menu-item",onClick:T,children:"Rename"}),C.jsx("div",{className:"context-menu-item context-menu-danger",onClick:Z,children:"Delete"})]}):C.jsx("div",{className:"context-menu-item",onClick:()=>G(""),children:"New File"})})]})}const _6="",y6=t=>`${_6}${t}`,b6={M:{label:"Modified",className:"git-status-modified",icon:"M"},U:{label:"Untracked",className:"git-status-new",icon:"U"},A:{label:"Added",className:"git-status-added",icon:"A"},D:{label:"Deleted",className:"git-status-deleted",icon:"D"}};function w6({onOpenDiff:t,activeDiffFile:e}){const[n,i]=I.useState({}),[r,s]=I.useState(!0),[a,o]=I.useState(null),l=I.useCallback(()=>{fetch(y6("/api/git/status")).then(_=>_.json()).then(_=>{_.available&&_.files?(i(_.files),o(null)):_.available||(o("Git not available"),i({})),s(!1)}).catch(_=>{o(_.message),s(!1)})},[]);I.useEffect(()=>{l();const _=setInterval(l,5e3);return()=>clearInterval(_)},[l]);const u=(_,f)=>{t&&t(_,f)},c=_=>{const f=_.split("/");return f[f.length-1]},h=_=>{const f=_.split("/");return f.length<=1?"":f.slice(0,-1).join("/")},d=Object.entries(n).reduce((_,[f,v])=>(_[v]||(_[v]=[]),_[v].push(f),_),{}),p=["M","A","U","D"];if(r)return C.jsx("div",{className:"git-changes-view",children:C.jsx("div",{className:"git-changes-loading",children:"Loading changes..."})});if(a)return C.jsx("div",{className:"git-changes-view",children:C.jsx("div",{className:"git-changes-error",children:a})});const m=Object.keys(n).length;return m===0?C.jsx("div",{className:"git-changes-view",children:C.jsxs("div",{className:"git-changes-empty",children:[C.jsx("span",{className:"git-changes-empty-icon",children:""}),C.jsx("span",{children:"No changes"})]})}):C.jsxs("div",{className:"git-changes-view",children:[C.jsxs("div",{className:"git-changes-summary",children:[m," changed file",m!==1?"s":""]}),C.jsx("div",{className:"git-changes-list",children:p.map(_=>{const f=d[_];if(!f||f.length===0)return null;const v=b6[_];return C.jsxs("div",{className:"git-changes-group",children:[C.jsxs("div",{className:"git-changes-group-header",children:[C.jsx("span",{className:`git-status-badge ${v.className}`,children:v.icon}),C.jsxs("span",{className:"git-changes-group-label",children:[v.label," (",f.length,")"]})]}),f.map(g=>{const y=e===g;return C.jsxs("div",{className:`git-change-item ${y?"git-change-item-active":""}`,onClick:()=>u(g,_),children:[C.jsx("span",{className:"git-change-icon",children:""}),C.jsxs("div",{className:"git-change-info",children:[C.jsx("span",{className:`git-change-name file-name-${_.toLowerCase()}`,children:c(g)}),h(g)&&C.jsx("span",{className:"git-change-path",children:h(g)})]})]},g)})]},_)})})]})}function S6({params:t}){const{onOpenFile:e,onOpenFileToSide:n,onOpenDiff:i,projectRoot:r,activeFile:s,activeDiffFile:a,collapsed:o,onToggleCollapse:l}=t,[u,c]=I.useState(!1),[h,d]=I.useState("files"),p=I.useRef(null),m=()=>{c(!0)},_=v=>{c(!1),v&&e(v)},f=()=>{c(!1)};return o?C.jsxs("div",{className:"panel-content filetree-panel filetree-collapsed",children:[C.jsx("button",{type:"button",className:"sidebar-toggle-btn",onClick:l,title:"Expand file tree","aria-label":"Expand file tree",children:C.jsx("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M6 3.5L10.5 8L6 12.5V3.5Z"})})}),C.jsx("div",{className:"sidebar-collapsed-label",children:h==="files"?"Files":"Changes"})]}):C.jsxs("div",{className:"panel-content filetree-panel",children:[C.jsxs("div",{className:"sidebar-header",children:[C.jsxs("div",{className:"sidebar-view-toggle",children:[C.jsx("button",{type:"button",className:`view-toggle-btn ${h==="files"?"active":""}`,onClick:()=>d("files"),title:"File tree",children:C.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M1.5 1h3l.5.5v2h9l.5.5v10l-.5.5h-12l-.5-.5v-12l.5-.5zm0 3.5V13h11V4H5l-.5-.5V2H2v2.5z"})})}),C.jsx("button",{type:"button",className:`view-toggle-btn ${h==="changes"?"active":""}`,onClick:()=>d("changes"),title:"Git changes",children:C.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M11.93 8.5a4.002 4.002 0 0 1-7.86 0H.5a.5.5 0 0 1 0-1h3.57a4.002 4.002 0 0 1 7.86 0h3.57a.5.5 0 0 1 0 1h-3.57zM8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"})})})]}),C.jsxs("div",{className:"sidebar-header-actions",children:[h==="files"&&C.jsx("button",{type:"button",className:"sidebar-action-btn",onClick:m,title:"New File","aria-label":"New File",children:C.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[C.jsx("path",{d:"M9.5 1.1l3.4 3.5c.2.2.1.4.1.4v8c0 .6-.4 1-1 1H4c-.6 0-1-.4-1-1V2c0-.5.4-1 1-1h5.5zM9 2H4v12h8V5.5L9 2zm.5 3V2l3 3h-3z"}),C.jsx("path",{d:"M8 7v2H6v1h2v2h1v-2h2V9H9V7H8z"})]})}),C.jsx("button",{type:"button",className:"sidebar-toggle-btn",onClick:l,title:"Collapse file tree","aria-label":"Collapse file tree",children:C.jsx("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M10 3.5L5.5 8L10 12.5V3.5Z"})})})]})]}),h==="files"?C.jsx(v6,{ref:p,onOpen:e,onOpenToSide:n,projectRoot:r,activeFile:s,creatingFile:u,onFileCreated:_,onCancelCreate:f}):C.jsx(w6,{onOpenDiff:i,activeDiffFile:a})]})}var Dx={exports:{}},Ax={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eo=I;function x6(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var k6=typeof Object.is=="function"?Object.is:x6,C6=Eo.useState,E6=Eo.useEffect,D6=Eo.useLayoutEffect,A6=Eo.useDebugValue;function T6(t,e){var n=e(),i=C6({inst:{value:n,getSnapshot:e}}),r=i[0].inst,s=i[1];return D6(function(){r.value=n,r.getSnapshot=e,cf(r)&&s({inst:r})},[t,n,e]),E6(function(){return cf(r)&&s({inst:r}),t(function(){cf(r)&&s({inst:r})})},[t]),A6(n),n}function cf(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!k6(t,n)}catch{return!0}}function M6(t,e){return e()}var R6=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?M6:T6;Ax.useSyncExternalStore=Eo.useSyncExternalStore!==void 0?Eo.useSyncExternalStore:R6;Dx.exports=Ax;var og=Dx.exports;function It(t){this.content=t}It.prototype={constructor:It,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var i=n&&n!=t?this.remove(n):this,r=i.find(t),s=i.content.slice();return r==-1?s.push(n||t,e):(s[r+1]=e,n&&(s[r]=n)),new It(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new It(n)},addToStart:function(t,e){return new It([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new It(n)},addBefore:function(t,e,n){var i=this.remove(e),r=i.content.slice(),s=i.find(t);return r.splice(s==-1?r.length:s,0,e,n),new It(r)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=It.from(t),t.size?new It(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=It.from(t),t.size?new It(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=It.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};It.from=function(t){if(t instanceof It)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new It(e)};function Tx(t,e,n){for(let i=0;;i++){if(i==t.childCount||i==e.childCount)return t.childCount==e.childCount?null:n;let r=t.child(i),s=e.child(i);if(r==s){n+=r.nodeSize;continue}if(!r.sameMarkup(s))return n;if(r.isText&&r.text!=s.text){for(let a=0;r.text[a]==s.text[a];a++)n++;return n}if(r.content.size||s.content.size){let a=Tx(r.content,s.content,n+1);if(a!=null)return a}n+=r.nodeSize}}function Mx(t,e,n,i){for(let r=t.childCount,s=e.childCount;;){if(r==0||s==0)return r==s?null:{a:n,b:i};let a=t.child(--r),o=e.child(--s),l=a.nodeSize;if(a==o){n-=l,i-=l;continue}if(!a.sameMarkup(o))return{a:n,b:i};if(a.isText&&a.text!=o.text){let u=0,c=Math.min(a.text.length,o.text.length);for(;u<c&&a.text[a.text.length-u-1]==o.text[o.text.length-u-1];)u++,n--,i--;return{a:n,b:i}}if(a.content.size||o.content.size){let u=Mx(a.content,o.content,n-1,i-1);if(u)return u}n-=l,i-=l}}class ie{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let i=0;i<e.length;i++)this.size+=e[i].nodeSize}nodesBetween(e,n,i,r=0,s){for(let a=0,o=0;o<n;a++){let l=this.content[a],u=o+l.nodeSize;if(u>e&&i(l,r+o,s||null,a)!==!1&&l.content.size){let c=o+1;l.nodesBetween(Math.max(0,e-c),Math.min(l.content.size,n-c),i,r+c)}o=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,i,r){let s="",a=!0;return this.nodesBetween(e,n,(o,l)=>{let u=o.isText?o.text.slice(Math.max(e,l)-l,n-l):o.isLeaf?r?typeof r=="function"?r(o):r:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&u||o.isTextblock)&&i&&(a?a=!1:s+=i),s+=u},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,i=e.firstChild,r=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(i)&&(r[r.length-1]=n.withText(n.text+i.text),s=1);s<e.content.length;s++)r.push(e.content[s]);return new ie(r,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let i=[],r=0;if(n>e)for(let s=0,a=0;a<n;s++){let o=this.content[s],l=a+o.nodeSize;l>e&&((a<e||l>n)&&(o.isText?o=o.cut(Math.max(0,e-a),Math.min(o.text.length,n-a)):o=o.cut(Math.max(0,e-a-1),Math.min(o.content.size,n-a-1))),i.push(o),r+=o.nodeSize),a=l}return new ie(i,r)}cutByIndex(e,n){return e==n?ie.empty:e==0&&n==this.content.length?this:new ie(this.content.slice(e,n))}replaceChild(e,n){let i=this.content[e];if(i==n)return this;let r=this.content.slice(),s=this.size+n.nodeSize-i.nodeSize;return r[e]=n,new ie(r,s)}addToStart(e){return new ie([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new ie(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,i=0;n<this.content.length;n++){let r=this.content[n];e(r,i,n),i+=r.nodeSize}}findDiffStart(e,n=0){return Tx(this,e,n)}findDiffEnd(e,n=this.size,i=e.size){return Mx(this,e,n,i)}findIndex(e){if(e==0)return du(0,e);if(e==this.size)return du(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let r=this.child(n),s=i+r.nodeSize;if(s>=e)return s==e?du(n+1,s):du(n,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return ie.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new ie(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return ie.empty;let n,i=0;for(let r=0;r<e.length;r++){let s=e[r];i+=s.nodeSize,r&&s.isText&&e[r-1].sameMarkup(s)?(n||(n=e.slice(0,r)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new ie(n||e,i)}static from(e){if(!e)return ie.empty;if(e instanceof ie)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new ie([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ie.empty=new ie([],0);const hf={index:0,offset:0};function du(t,e){return hf.index=t,hf.offset=e,hf}function Ic(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!Ic(t[i],e[i]))return!1}else{for(let i in t)if(!(i in e)||!Ic(t[i],e[i]))return!1;for(let i in e)if(!(i in t))return!1}return!0}let $e=class im{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,i=!1;for(let r=0;r<e.length;r++){let s=e[r];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,r));else{if(s.type.excludes(this.type))return e;!i&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,r)),n.push(this),i=!0),n&&n.push(s)}}return n||(n=e.slice()),i||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ic(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let i=e.marks[n.type];if(!i)throw new RangeError(`There is no mark type ${n.type} in this schema`);let r=i.create(n.attrs);return i.checkAttrs(r.attrs),r}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].eq(n[i]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return im.none;if(e instanceof im)return[e];let n=e.slice();return n.sort((i,r)=>i.type.rank-r.type.rank),n}};$e.none=[];class Lc extends Error{}class he{constructor(e,n,i){this.content=e,this.openStart=n,this.openEnd=i}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let i=Ox(this.content,e+this.openStart,n);return i&&new he(i,this.openStart,this.openEnd)}removeBetween(e,n){return new he(Rx(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return he.empty;let i=n.openStart||0,r=n.openEnd||0;if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new he(ie.fromJSON(e,n.content),i,r)}static maxOpen(e,n=!0){let i=0,r=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)i++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)r++;return new he(e,i,r)}}he.empty=new he(ie.empty,0,0);function Rx(t,e,n){let{index:i,offset:r}=t.findIndex(e),s=t.maybeChild(i),{index:a,offset:o}=t.findIndex(n);if(r==e||s.isText){if(o!=n&&!t.child(a).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(i!=a)throw new RangeError("Removing non-flat range");return t.replaceChild(i,s.copy(Rx(s.content,e-r-1,n-r-1)))}function Ox(t,e,n,i){let{index:r,offset:s}=t.findIndex(e),a=t.maybeChild(r);if(s==e||a.isText)return i&&!i.canReplace(r,r,n)?null:t.cut(0,e).append(n).append(t.cut(e));let o=Ox(a.content,e-s-1,n,a);return o&&t.replaceChild(r,a.copy(o))}function O6(t,e,n){if(n.openStart>t.depth)throw new Lc("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Lc("Inconsistent open depths");return Px(t,e,n,0)}function Px(t,e,n,i){let r=t.index(i),s=t.node(i);if(r==e.index(i)&&i<t.depth-n.openStart){let a=Px(t,e,n,i+1);return s.copy(s.content.replaceChild(r,a))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==i&&e.depth==i){let a=t.parent,o=a.content;return fs(a,o.cut(0,t.parentOffset).append(n.content).append(o.cut(e.parentOffset)))}else{let{start:a,end:o}=P6(n,t);return fs(s,Ix(t,a,o,e,i))}else return fs(s,Bc(t,e,i))}function Nx(t,e){if(!e.type.compatibleContent(t.type))throw new Lc("Cannot join "+e.type.name+" onto "+t.type.name)}function rm(t,e,n){let i=t.node(n);return Nx(i,e.node(n)),i}function ds(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Ta(t,e,n,i){let r=(e||t).node(n),s=0,a=e?e.index(n):r.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(ds(t.nodeAfter,i),s++));for(let o=s;o<a;o++)ds(r.child(o),i);e&&e.depth==n&&e.textOffset&&ds(e.nodeBefore,i)}function fs(t,e){return t.type.checkContent(e),t.copy(e)}function Ix(t,e,n,i,r){let s=t.depth>r&&rm(t,e,r+1),a=i.depth>r&&rm(n,i,r+1),o=[];return Ta(null,t,r,o),s&&a&&e.index(r)==n.index(r)?(Nx(s,a),ds(fs(s,Ix(t,e,n,i,r+1)),o)):(s&&ds(fs(s,Bc(t,e,r+1)),o),Ta(e,n,r,o),a&&ds(fs(a,Bc(n,i,r+1)),o)),Ta(i,null,r,o),new ie(o)}function Bc(t,e,n){let i=[];if(Ta(null,t,n,i),t.depth>n){let r=rm(t,e,n+1);ds(fs(r,Bc(t,e,n+1)),i)}return Ta(e,null,n,i),new ie(i)}function P6(t,e){let n=e.depth-t.openStart,r=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)r=e.node(s).copy(ie.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}class ol{constructor(e,n,i){this.pos=e,this.path=n,this.parentOffset=i,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let i=this.pos-this.path[this.path.length-1],r=e.child(n);return i?e.child(n).cut(i):r}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let i=this.path[n*3],r=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)r+=i.child(s).nodeSize;return r}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return $e.none;if(this.textOffset)return e.child(n).marks;let i=e.maybeChild(n-1),r=e.maybeChild(n);if(!i){let o=i;i=r,r=o}let s=i.marks;for(var a=0;a<s.length;a++)s[a].type.spec.inclusive===!1&&(!r||!s[a].isInSet(r.marks))&&(s=s[a--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let i=n.marks,r=e.parent.maybeChild(e.index());for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!r||!i[s].isInSet(r.marks))&&(i=i[s--].removeFromSet(i));return i}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let i=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);i>=0;i--)if(e.pos<=this.end(i)&&(!n||n(this.node(i))))return new zc(this,e,i);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let i=[],r=0,s=n;for(let a=e;;){let{index:o,offset:l}=a.content.findIndex(s),u=s-l;if(i.push(a,o,r+l),!u||(a=a.child(o),a.isText))break;s=u-1,r+=l+1}return new ol(n,i,s)}static resolveCached(e,n){let i=n1.get(e);if(i)for(let s=0;s<i.elts.length;s++){let a=i.elts[s];if(a.pos==n)return a}else n1.set(e,i=new N6);let r=i.elts[i.i]=ol.resolve(e,n);return i.i=(i.i+1)%I6,r}}class N6{constructor(){this.elts=[],this.i=0}}const I6=12,n1=new WeakMap;class zc{constructor(e,n,i){this.$from=e,this.$to=n,this.depth=i}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const L6=Object.create(null);let Mr=class sm{constructor(e,n,i,r=$e.none){this.type=e,this.attrs=n,this.marks=r,this.content=i||ie.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,i,r=0){this.content.nodesBetween(e,n,i,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,i,r){return this.content.textBetween(e,n,i,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,i){return this.type==e&&Ic(this.attrs,n||e.defaultAttrs||L6)&&$e.sameSet(this.marks,i||$e.none)}copy(e=null){return e==this.content?this:new sm(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new sm(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,i=!1){if(e==n)return he.empty;let r=this.resolve(e),s=this.resolve(n),a=i?0:r.sharedDepth(n),o=r.start(a),u=r.node(a).content.cut(r.pos-o,s.pos-o);return new he(u,r.depth-a,s.depth-a)}replace(e,n,i){return O6(this.resolve(e),this.resolve(n),i)}nodeAt(e){for(let n=this;;){let{index:i,offset:r}=n.content.findIndex(e);if(n=n.maybeChild(i),!n)return null;if(r==e||n.isText)return n;e-=r+1}}childAfter(e){let{index:n,offset:i}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:i}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:i}=this.content.findIndex(e);if(i<e)return{node:this.content.child(n),index:n,offset:i};let r=this.content.child(n-1);return{node:r,index:n-1,offset:i-r.nodeSize}}resolve(e){return ol.resolveCached(this,e)}resolveNoCache(e){return ol.resolve(this,e)}rangeHasMark(e,n,i){let r=!1;return n>e&&this.nodesBetween(e,n,s=>(i.isInSet(s.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Lx(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,i=ie.empty,r=0,s=i.childCount){let a=this.contentMatchAt(e).matchFragment(i,r,s),o=a&&a.matchFragment(this.content,n);if(!o||!o.validEnd)return!1;for(let l=r;l<s;l++)if(!this.type.allowsMarks(i.child(l).marks))return!1;return!0}canReplaceWith(e,n,i,r){if(r&&!this.type.allowsMarks(r))return!1;let s=this.contentMatchAt(e).matchType(i),a=s&&s.matchFragment(this.content,n);return a?a.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=$e.none;for(let n=0;n<this.marks.length;n++){let i=this.marks[n];i.type.checkAttrs(i.attrs),e=i.addToSet(e)}if(!$e.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let i;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");i=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,i)}let r=ie.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,r,i);return s.type.checkAttrs(s.attrs),s}};Mr.prototype.text=void 0;class Fc extends Mr{constructor(e,n,i,r){if(super(e,n,null,r),!i)throw new RangeError("Empty text nodes are not allowed");this.text=i}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Lx(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Fc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Fc(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Lx(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Ss{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let i=new B6(e,n);if(i.next==null)return Ss.empty;let r=Bx(i);i.next&&i.err("Unexpected trailing text");let s=V6(W6(r));return G6(s,i),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,i=e.childCount){let r=this;for(let s=n;r&&s<i;s++)r=r.matchType(e.child(s).type);return r}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let i=0;i<e.next.length;i++)if(this.next[n].type==e.next[i].type)return!0;return!1}fillBefore(e,n=!1,i=0){let r=[this];function s(a,o){let l=a.matchFragment(e,i);if(l&&(!n||l.validEnd))return ie.from(o.map(u=>u.createAndFill()));for(let u=0;u<a.next.length;u++){let{type:c,next:h}=a.next[u];if(!(c.isText||c.hasRequiredAttrs())&&r.indexOf(h)==-1){r.push(h);let d=s(h,o.concat(c));if(d)return d}}return null}return s(this,[])}findWrapping(e){for(let i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==e)return this.wrapCache[i+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),i=[{match:this,type:null,via:null}];for(;i.length;){let r=i.shift(),s=r.match;if(s.matchType(e)){let a=[];for(let o=r;o.type;o=o.via)a.push(o.type);return a.reverse()}for(let a=0;a<s.next.length;a++){let{type:o,next:l}=s.next[a];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in n)&&(!r.type||l.validEnd)&&(i.push({match:o.contentMatch,type:o,via:r}),n[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(i){e.push(i);for(let r=0;r<i.next.length;r++)e.indexOf(i.next[r].next)==-1&&n(i.next[r].next)}return n(this),e.map((i,r)=>{let s=r+(i.validEnd?"*":" ")+" ";for(let a=0;a<i.next.length;a++)s+=(a?", ":"")+i.next[a].type.name+"->"+e.indexOf(i.next[a].next);return s}).join(`
`)}}Ss.empty=new Ss(!0);class B6{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Bx(t){let e=[];do e.push(z6(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function z6(t){let e=[];do e.push(F6(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function F6(t){let e=$6(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=j6(t,e);else break;return e}function i1(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function j6(t,e){let n=i1(t),i=n;return t.eat(",")&&(t.next!="}"?i=i1(t):i=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:e}}function H6(t,e){let n=t.nodeTypes,i=n[e];if(i)return[i];let r=[];for(let s in n){let a=n[s];a.isInGroup(e)&&r.push(a)}return r.length==0&&t.err("No node type or group '"+e+"' found"),r}function $6(t){if(t.eat("(")){let e=Bx(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=H6(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function W6(t){let e=[[]];return r(s(t,0),n()),e;function n(){return e.push([])-1}function i(a,o,l){let u={term:l,to:o};return e[a].push(u),u}function r(a,o){a.forEach(l=>l.to=o)}function s(a,o){if(a.type=="choice")return a.exprs.reduce((l,u)=>l.concat(s(u,o)),[]);if(a.type=="seq")for(let l=0;;l++){let u=s(a.exprs[l],o);if(l==a.exprs.length-1)return u;r(u,o=n())}else if(a.type=="star"){let l=n();return i(o,l),r(s(a.expr,l),l),[i(l)]}else if(a.type=="plus"){let l=n();return r(s(a.expr,o),l),r(s(a.expr,l),l),[i(l)]}else{if(a.type=="opt")return[i(o)].concat(s(a.expr,o));if(a.type=="range"){let l=o;for(let u=0;u<a.min;u++){let c=n();r(s(a.expr,l),c),l=c}if(a.max==-1)r(s(a.expr,l),l);else for(let u=a.min;u<a.max;u++){let c=n();i(l,c),r(s(a.expr,l),c),l=c}return[i(l)]}else{if(a.type=="name")return[i(o,void 0,a.value)];throw new Error("Unknown expr type")}}}}function zx(t,e){return e-t}function r1(t,e){let n=[];return i(e),n.sort(zx);function i(r){let s=t[r];if(s.length==1&&!s[0].term)return i(s[0].to);n.push(r);for(let a=0;a<s.length;a++){let{term:o,to:l}=s[a];!o&&n.indexOf(l)==-1&&i(l)}}}function V6(t){let e=Object.create(null);return n(r1(t,0));function n(i){let r=[];i.forEach(a=>{t[a].forEach(({term:o,to:l})=>{if(!o)return;let u;for(let c=0;c<r.length;c++)r[c][0]==o&&(u=r[c][1]);r1(t,l).forEach(c=>{u||r.push([o,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let s=e[i.join(",")]=new Ss(i.indexOf(t.length-1)>-1);for(let a=0;a<r.length;a++){let o=r[a][1].sort(zx);s.next.push({type:r[a][0],next:e[o.join(",")]||n(o)})}return s}}function G6(t,e){for(let n=0,i=[t];n<i.length;n++){let r=i[n],s=!r.validEnd,a=[];for(let o=0;o<r.next.length;o++){let{type:l,next:u}=r.next[o];a.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),i.indexOf(u)==-1&&i.push(u)}s&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Fx(t){let e=Object.create(null);for(let n in t){let i=t[n];if(!i.hasDefault)return null;e[n]=i.default}return e}function jx(t,e){let n=Object.create(null);for(let i in t){let r=e&&e[i];if(r===void 0){let s=t[i];if(s.hasDefault)r=s.default;else throw new RangeError("No value supplied for attribute "+i)}n[i]=r}return n}function Hx(t,e,n,i){for(let r in e)if(!(r in t))throw new RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let r in t){let s=t[r];s.validate&&s.validate(e[r])}}function $x(t,e){let n=Object.create(null);if(e)for(let i in e)n[i]=new q6(t,i,e[i]);return n}let s1=class Wx{constructor(e,n,i){this.name=e,this.schema=n,this.spec=i,this.markSet=null,this.groups=i.group?i.group.split(" "):[],this.attrs=$x(e,i.attrs),this.defaultAttrs=Fx(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(i.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ss.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:jx(this.attrs,e)}create(e=null,n,i){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Mr(this,this.computeAttrs(e),ie.from(n),$e.setFrom(i))}createChecked(e=null,n,i){return n=ie.from(n),this.checkContent(n),new Mr(this,this.computeAttrs(e),n,$e.setFrom(i))}createAndFill(e=null,n,i){if(e=this.computeAttrs(e),n=ie.from(n),n.size){let a=this.contentMatch.fillBefore(n);if(!a)return null;n=a.append(n)}let r=this.contentMatch.matchFragment(n),s=r&&r.fillBefore(ie.empty,!0);return s?new Mr(this,e,n.append(s),$e.setFrom(i)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let i=0;i<e.childCount;i++)if(!this.allowsMarks(e.child(i).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Hx(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let i=0;i<e.length;i++)this.allowsMarkType(e[i].type)?n&&n.push(e[i]):n||(n=e.slice(0,i));return n?n.length?n:$e.none:e}static compile(e,n){let i=Object.create(null);e.forEach((s,a)=>i[s]=new Wx(s,n,a));let r=n.spec.topNode||"doc";if(!i[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(let s in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}};function U6(t,e,n){let i=n.split("|");return r=>{let s=r===null?"null":typeof r;if(i.indexOf(s)<0)throw new RangeError(`Expected value of type ${i} for attribute ${e} on type ${t}, got ${s}`)}}class q6{constructor(e,n,i){this.hasDefault=Object.prototype.hasOwnProperty.call(i,"default"),this.default=i.default,this.validate=typeof i.validate=="string"?U6(e,n,i.validate):i.validate}get isRequired(){return!this.hasDefault}}class sd{constructor(e,n,i,r){this.name=e,this.rank=n,this.schema=i,this.spec=r,this.attrs=$x(e,r.attrs),this.excluded=null;let s=Fx(this.attrs);this.instance=s?new $e(this,s):null}create(e=null){return!e&&this.instance?this.instance:new $e(this,jx(this.attrs,e))}static compile(e,n){let i=Object.create(null),r=0;return e.forEach((s,a)=>i[s]=new sd(s,r++,n,a)),i}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){Hx(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Vx{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let r in e)n[r]=e[r];n.nodes=It.from(e.nodes),n.marks=It.from(e.marks||{}),this.nodes=s1.compile(this.spec.nodes,this),this.marks=sd.compile(this.spec.marks,this);let i=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let s=this.nodes[r],a=s.spec.content||"",o=s.spec.marks;if(s.contentMatch=i[a]||(i[a]=Ss.parse(a,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=o=="_"?null:o?o1(this,o.split(" ")):o==""||!s.inlineContent?[]:null}for(let r in this.marks){let s=this.marks[r],a=s.spec.excludes;s.excluded=a==null?[s]:a==""?[]:o1(this,a.split(" "))}this.nodeFromJSON=r=>Mr.fromJSON(this,r),this.markFromJSON=r=>$e.fromJSON(this,r),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,i,r){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof s1){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,i,r)}text(e,n){let i=this.nodes.text;return new Fc(i,i.defaultAttrs,e,$e.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function o1(t,e){let n=[];for(let i=0;i<e.length;i++){let r=e[i],s=t.marks[r],a=s;if(s)n.push(s);else for(let o in t.marks){let l=t.marks[o];(r=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(r)>-1)&&n.push(a=l)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}function K6(t){return t.tag!=null}function J6(t){return t.style!=null}class $i{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let i=this.matchedStyles=[];n.forEach(r=>{if(K6(r))this.tags.push(r);else if(J6(r)){let s=/[^=]*/.exec(r.style)[0];i.indexOf(s)<0&&i.push(s),this.styles.push(r)}}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let s=e.nodes[r.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let i=new l1(this,n,!1);return i.addAll(e,$e.none,n.from,n.to),i.finish()}parseSlice(e,n={}){let i=new l1(this,n,!0);return i.addAll(e,$e.none,n.from,n.to),he.maxOpen(i.finish())}matchTag(e,n,i){for(let r=i?this.tags.indexOf(i)+1:0;r<this.tags.length;r++){let s=this.tags[r];if(X6(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let a=s.getAttrs(e);if(a===!1)continue;s.attrs=a||void 0}return s}}}matchStyle(e,n,i,r){for(let s=r?this.styles.indexOf(r)+1:0;s<this.styles.length;s++){let a=this.styles[s],o=a.style;if(!(o.indexOf(e)!=0||a.context&&!i.matchesContext(a.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=n))){if(a.getAttrs){let l=a.getAttrs(n);if(l===!1)continue;a.attrs=l||void 0}return a}}}static schemaRules(e){let n=[];function i(r){let s=r.priority==null?50:r.priority,a=0;for(;a<n.length;a++){let o=n[a];if((o.priority==null?50:o.priority)<s)break}n.splice(a,0,r)}for(let r in e.marks){let s=e.marks[r].spec.parseDOM;s&&s.forEach(a=>{i(a=u1(a)),a.mark||a.ignore||a.clearMark||(a.mark=r)})}for(let r in e.nodes){let s=e.nodes[r].spec.parseDOM;s&&s.forEach(a=>{i(a=u1(a)),a.node||a.ignore||a.mark||(a.node=r)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new $i(e,$i.schemaRules(e)))}}const Gx={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Z6={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ux={ol:!0,ul:!0},al=1,om=2,Ma=4;function a1(t,e,n){return e!=null?(e?al:0)|(e==="full"?om:0):t&&t.whitespace=="pre"?al|om:n&~Ma}class fu{constructor(e,n,i,r,s,a){this.type=e,this.attrs=n,this.marks=i,this.solid=r,this.options=a,this.content=[],this.activeMarks=$e.none,this.match=s||(a&Ma?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(ie.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let i=this.type.contentMatch,r;return(r=i.findWrapping(e.type))?(this.match=i,r):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&al)){let i=this.content[this.content.length-1],r;if(i&&i.isText&&(r=/[ \t\r\n\u000c]+$/.exec(i.text))){let s=i;i.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-r[0].length))}}let n=ie.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(ie.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Gx.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class l1{constructor(e,n,i){this.parser=e,this.options=n,this.isOpen=i,this.open=0,this.localPreserveWS=!1;let r=n.topNode,s,a=a1(null,n.preserveWhitespace,0)|(i?Ma:0);r?s=new fu(r.type,r.attrs,$e.none,!0,n.topMatch||r.type.contentMatch,a):i?s=new fu(null,null,$e.none,!0,null,a):s=new fu(e.schema.topNodeType,null,$e.none,!0,null,a),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let i=e.nodeValue,r=this.top,s=r.options&om?"full":this.localPreserveWS||(r.options&al)>0,{schema:a}=this.parser;if(s==="full"||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(i)){if(s)if(s==="full")i=i.replace(/\r\n?/g,`
`);else if(a.linebreakReplacement&&/[\r\n]/.test(i)&&this.top.findWrapping(a.linebreakReplacement.create())){let o=i.split(/\r?\n|\r/);for(let l=0;l<o.length;l++)l&&this.insertNode(a.linebreakReplacement.create(),n,!0),o[l]&&this.insertNode(a.text(o[l]),n,!/\S/.test(o[l]));i=""}else i=i.replace(/\r?\n|\r/g," ");else if(i=i.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(i)&&this.open==this.nodes.length-1){let o=r.content[r.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(i=i.slice(1))}i&&this.insertNode(a.text(i),n,!/\S/.test(i)),this.findInText(e)}else this.findInside(e)}addElement(e,n,i){let r=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let a=e.nodeName.toLowerCase(),o;Ux.hasOwnProperty(a)&&this.parser.normalizeLists&&Y6(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,i));e:if(l?l.ignore:Z6.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let u,c=this.needsBlock;if(Gx.hasOwnProperty(a))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),u=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let h=l&&l.skip?n:this.readStyles(e,n);h&&this.addAll(e,h),u&&this.sync(s),this.needsBlock=c}else{let u=this.readStyles(e,n);u&&this.addElementByRule(e,l,u,l.consuming===!1?o:void 0)}this.localPreserveWS=r}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let i=e.style;if(i&&i.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let s=this.parser.matchedStyles[r],a=i.getPropertyValue(s);if(a)for(let o=void 0;;){let l=this.parser.matchStyle(s,a,this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(u=>!l.clearMark(u)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)o=l;else break}}return n}addElementByRule(e,n,i,r){let s,a;if(n.node)if(a=this.parser.schema.nodes[n.node],a.isLeaf)this.insertNode(a.create(n.attrs),i,e.nodeName=="BR")||this.leafFallback(e,i);else{let l=this.enter(a,n.attrs||null,i,n.preserveWhitespace);l&&(s=!0,i=l)}else{let l=this.parser.schema.marks[n.mark];i=i.concat(l.create(n.attrs))}let o=this.top;if(a&&a.isLeaf)this.findInside(e);else if(r)this.addElement(e,i,r);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,i,!1));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,i),this.findAround(e,l,!1)}s&&this.sync(o)&&this.open--}addAll(e,n,i,r){let s=i||0;for(let a=i?e.childNodes[i]:e.firstChild,o=r==null?null:e.childNodes[r];a!=o;a=a.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(a,n);this.findAtPoint(e,s)}findPlace(e,n,i){let r,s;for(let a=this.open,o=0;a>=0;a--){let l=this.nodes[a],u=l.findWrapping(e);if(u&&(!r||r.length>u.length+o)&&(r=u,s=l,!u.length))break;if(l.solid){if(i)break;o+=2}}if(!r)return null;this.sync(s);for(let a=0;a<r.length;a++)n=this.enterInner(r[a],null,n,!1);return n}insertNode(e,n,i){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let r=this.findPlace(e,n,i);if(r){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let a=$e.none;for(let o of r.concat(e.marks))(s.type?s.type.allowsMarkType(o.type):c1(o.type,e.type))&&(a=o.addToSet(a));return s.content.push(e.mark(a)),!0}return!1}enter(e,n,i,r){let s=this.findPlace(e.create(n),i,!1);return s&&(s=this.enterInner(e,n,i,!0,r)),s}enterInner(e,n,i,r=!1,s){this.closeExtra();let a=this.top;a.match=a.match&&a.match.matchType(e);let o=a1(e,s,a.options);a.options&Ma&&a.content.length==0&&(o|=Ma);let l=$e.none;return i=i.filter(u=>(a.type?a.type.allowsMarkType(u.type):c1(u.type,e))?(l=u.addToSet(l),!1):!0),this.nodes.push(new fu(e,n,l,r,null,o)),this.open++,i}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=al)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let i=this.nodes[n].content;for(let r=i.length-1;r>=0;r--)e+=i[r].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==e&&this.find[i].offset==n&&(this.find[i].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,i){if(e!=n&&this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&n.compareDocumentPosition(this.find[r].node)&(i?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),i=this.options.context,r=!this.isOpen&&(!i||i.parent.type==this.nodes[0].type),s=-(i?i.depth+1:0)+(r?0:1),a=(o,l)=>{for(;o>=0;o--){let u=n[o];if(u==""){if(o==n.length-1||o==0)continue;for(;l>=s;l--)if(a(o-1,l))return!0;return!1}else{let c=l>0||l==0&&r?this.nodes[l].type:i&&l>=s?i.node(l-s).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;l--}}return!0};return a(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(let n in this.parser.schema.nodes){let i=this.parser.schema.nodes[n];if(i.isTextblock&&i.defaultAttrs)return i}}}function Y6(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let i=e.nodeType==1?e.nodeName.toLowerCase():null;i&&Ux.hasOwnProperty(i)&&n?(n.appendChild(e),e=n):i=="li"?n=e:i&&(n=null)}}function X6(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function u1(t){let e={};for(let n in t)e[n]=t[n];return e}function c1(t,e){let n=e.schema.nodes;for(let i in n){let r=n[i];if(!r.allowsMarkType(t))continue;let s=[],a=o=>{s.push(o);for(let l=0;l<o.edgeCount;l++){let{type:u,next:c}=o.edge(l);if(u==e||s.indexOf(c)<0&&a(c))return!0}};if(a(r.contentMatch))return!0}}class Rs{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},i){i||(i=df(n).createDocumentFragment());let r=i,s=[];return e.forEach(a=>{if(s.length||a.marks.length){let o=0,l=0;for(;o<s.length&&l<a.marks.length;){let u=a.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(s[o][0])||u.type.spec.spanning===!1)break;o++,l++}for(;o<s.length;)r=s.pop()[1];for(;l<a.marks.length;){let u=a.marks[l++],c=this.serializeMark(u,a.isInline,n);c&&(s.push([u,r]),r.appendChild(c.dom),r=c.contentDOM||c.dom)}}r.appendChild(this.serializeNodeInner(a,n))}),i}serializeNodeInner(e,n){let{dom:i,contentDOM:r}=Zu(df(n),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,r)}return i}serializeNode(e,n={}){let i=this.serializeNodeInner(e,n);for(let r=e.marks.length-1;r>=0;r--){let s=this.serializeMark(e.marks[r],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(i),i=s.dom)}return i}serializeMark(e,n,i={}){let r=this.marks[e.type.name];return r&&Zu(df(i),r(e,n),null,e.attrs)}static renderSpec(e,n,i=null,r){return Zu(e,n,i,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Rs(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=h1(e.nodes);return n.text||(n.text=i=>i.text),n}static marksFromSchema(e){return h1(e.marks)}}function h1(t){let e={};for(let n in t){let i=t[n].spec.toDOM;i&&(e[n]=i)}return e}function df(t){return t.document||window.document}const d1=new WeakMap;function Q6(t){let e=d1.get(t);return e===void 0&&d1.set(t,e=e4(t)),e}function e4(t){let e=null;function n(i){if(i&&typeof i=="object")if(Array.isArray(i))if(typeof i[0]=="string")e||(e=[]),e.push(i);else for(let r=0;r<i.length;r++)n(i[r]);else for(let r in i)n(i[r])}return n(t),e}function Zu(t,e,n,i){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let r=e[0],s;if(typeof r!="string")throw new RangeError("Invalid array passed to renderSpec");if(i&&(s=Q6(i))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a=r.indexOf(" ");a>0&&(n=r.slice(0,a),r=r.slice(a+1));let o,l=n?t.createElementNS(n,r):t.createElement(r),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let h in u)if(u[h]!=null){let d=h.indexOf(" ");d>0?l.setAttributeNS(h.slice(0,d),h.slice(d+1),u[h]):h=="style"&&l.style?l.style.cssText=u[h]:l.setAttribute(h,u[h])}}for(let h=c;h<e.length;h++){let d=e[h];if(d===0){if(h<e.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:m}=Zu(t,d,n,i);if(l.appendChild(p),m){if(o)throw new RangeError("Multiple content holes");o=m}}}return{dom:l,contentDOM:o}}const qx=65535,Kx=Math.pow(2,16);function t4(t,e){return t+e*Kx}function f1(t){return t&qx}function n4(t){return(t-(t&qx))/Kx}const Jx=1,Zx=2,Yu=4,Yx=8;class am{constructor(e,n,i){this.pos=e,this.delInfo=n,this.recover=i}get deleted(){return(this.delInfo&Yx)>0}get deletedBefore(){return(this.delInfo&(Jx|Yu))>0}get deletedAfter(){return(this.delInfo&(Zx|Yu))>0}get deletedAcross(){return(this.delInfo&Yu)>0}}class vn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&vn.empty)return vn.empty}recover(e){let n=0,i=f1(e);if(!this.inverted)for(let r=0;r<i;r++)n+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[i*3]+n+n4(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,i){let r=0,s=this.inverted?2:1,a=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?r:0);if(l>e)break;let u=this.ranges[o+s],c=this.ranges[o+a],h=l+u;if(e<=h){let d=u?e==l?-1:e==h?1:n:n,p=l+r+(d<0?0:c);if(i)return p;let m=e==(n<0?l:h)?null:t4(o/3,e-l),_=e==l?Zx:e==h?Jx:Yu;return(n<0?e!=l:e!=h)&&(_|=Yx),new am(p,_,m)}r+=c-u}return i?e+r:new am(e+r,0,null)}touches(e,n){let i=0,r=f1(n),s=this.inverted?2:1,a=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?i:0);if(l>e)break;let u=this.ranges[o+s],c=l+u;if(e<=c&&o==r*3)return!0;i+=this.ranges[o+a]-u}return!1}forEach(e){let n=this.inverted?2:1,i=this.inverted?1:2;for(let r=0,s=0;r<this.ranges.length;r+=3){let a=this.ranges[r],o=a-(this.inverted?s:0),l=a+(this.inverted?0:s),u=this.ranges[r+n],c=this.ranges[r+i];e(o,o+u,l,l+c),s+=c-u}}invert(){return new vn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?vn.empty:new vn(e<0?[0,-e,0]:[0,0,e])}}vn.empty=new vn([]);class ll{constructor(e,n,i=0,r=e?e.length:0){this.mirror=n,this.from=i,this.to=r,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new ll(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,i=this._maps.length;n<e._maps.length;n++){let r=e.getMirror(n);this.appendMap(e._maps[n],r!=null&&r<n?i+r:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,i=this._maps.length+e._maps.length;n>=0;n--){let r=e.getMirror(n);this.appendMap(e._maps[n].invert(),r!=null&&r>n?i-r-1:void 0)}}invert(){let e=new ll;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let i=this.from;i<this.to;i++)e=this._maps[i].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,i){let r=0;for(let s=this.from;s<this.to;s++){let a=this._maps[s],o=a.mapResult(e,n);if(o.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this._maps[l].recover(o.recover);continue}}r|=o.delInfo,e=o.pos}return i?e:new am(e,r,null)}}const ff=Object.create(null);class Jt{getMap(){return vn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let i=ff[n.stepType];if(!i)throw new RangeError(`No step type ${n.stepType} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in ff)throw new RangeError("Duplicate use of step JSON ID "+e);return ff[e]=n,n.prototype.jsonID=e,n}}class mt{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new mt(e,null)}static fail(e){return new mt(null,e)}static fromReplace(e,n,i,r){try{return mt.ok(e.replace(n,i,r))}catch(s){if(s instanceof Lc)return mt.fail(s.message);throw s}}}function ag(t,e,n){let i=[];for(let r=0;r<t.childCount;r++){let s=t.child(r);s.content.size&&(s=s.copy(ag(s.content,e,s))),s.isInline&&(s=e(s,n,r)),i.push(s)}return ie.fromArray(i)}class vr extends Jt{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=e.resolve(this.from),r=i.node(i.sharedDepth(this.to)),s=new he(ag(n.content,(a,o)=>!a.isAtom||!o.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),r),n.openStart,n.openEnd);return mt.fromReplace(e,this.from,this.to,s)}invert(){return new Qn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new vr(n.pos,i.pos,this.mark)}merge(e){return e instanceof vr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new vr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new vr(n.from,n.to,e.markFromJSON(n.mark))}}Jt.jsonID("addMark",vr);class Qn extends Jt{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=new he(ag(n.content,r=>r.mark(this.mark.removeFromSet(r.marks)),e),n.openStart,n.openEnd);return mt.fromReplace(e,this.from,this.to,i)}invert(){return new vr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new Qn(n.pos,i.pos,this.mark)}merge(e){return e instanceof Qn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Qn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Qn(n.from,n.to,e.markFromJSON(n.mark))}}Jt.jsonID("removeMark",Qn);class _r extends Jt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return mt.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return mt.fromReplace(e,this.pos,this.pos+1,new he(ie.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let i=this.mark.addToSet(n.marks);if(i.length==n.marks.length){for(let r=0;r<n.marks.length;r++)if(!n.marks[r].isInSet(i))return new _r(this.pos,n.marks[r]);return new _r(this.pos,this.mark)}}return new xs(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new _r(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new _r(n.pos,e.markFromJSON(n.mark))}}Jt.jsonID("addNodeMark",_r);class xs extends Jt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return mt.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return mt.fromReplace(e,this.pos,this.pos+1,new he(ie.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new _r(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new xs(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new xs(n.pos,e.markFromJSON(n.mark))}}Jt.jsonID("removeNodeMark",xs);class Dt extends Jt{constructor(e,n,i,r=!1){super(),this.from=e,this.to=n,this.slice=i,this.structure=r}apply(e){return this.structure&&lm(e,this.from,this.to)?mt.fail("Structure replace would overwrite content"):mt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new vn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Dt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deletedAcross&&i.deletedAcross?null:new Dt(n.pos,Math.max(n.pos,i.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Dt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?he.empty:new he(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Dt(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?he.empty:new he(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Dt(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Dt(n.from,n.to,he.fromJSON(e,n.slice),!!n.structure)}}Jt.jsonID("replace",Dt);class Rt extends Jt{constructor(e,n,i,r,s,a,o=!1){super(),this.from=e,this.to=n,this.gapFrom=i,this.gapTo=r,this.slice=s,this.insert=a,this.structure=o}apply(e){if(this.structure&&(lm(e,this.from,this.gapFrom)||lm(e,this.gapTo,this.to)))return mt.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return mt.fail("Gap is not a flat range");let i=this.slice.insertAt(this.insert,n.content);return i?mt.fromReplace(e,this.from,this.to,i):mt.fail("Content does not fit in gap")}getMap(){return new vn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Rt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1),r=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?i.pos:e.map(this.gapTo,1);return n.deletedAcross&&i.deletedAcross||r<n.pos||s>i.pos?null:new Rt(n.pos,i.pos,r,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Rt(n.from,n.to,n.gapFrom,n.gapTo,he.fromJSON(e,n.slice),n.insert,!!n.structure)}}Jt.jsonID("replaceAround",Rt);function lm(t,e,n){let i=t.resolve(e),r=n-e,s=i.depth;for(;r>0&&s>0&&i.indexAfter(s)==i.node(s).childCount;)s--,r--;if(r>0){let a=i.node(s).maybeChild(i.indexAfter(s));for(;r>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,r--}}return!1}function i4(t,e,n,i){let r=[],s=[],a,o;t.doc.nodesBetween(e,n,(l,u,c)=>{if(!l.isInline)return;let h=l.marks;if(!i.isInSet(h)&&c.type.allowsMarkType(i.type)){let d=Math.max(u,e),p=Math.min(u+l.nodeSize,n),m=i.addToSet(h);for(let _=0;_<h.length;_++)h[_].isInSet(m)||(a&&a.to==d&&a.mark.eq(h[_])?a.to=p:r.push(a=new Qn(d,p,h[_])));o&&o.to==d?o.to=p:s.push(o=new vr(d,p,i))}}),r.forEach(l=>t.step(l)),s.forEach(l=>t.step(l))}function r4(t,e,n,i){let r=[],s=0;t.doc.nodesBetween(e,n,(a,o)=>{if(!a.isInline)return;s++;let l=null;if(i instanceof sd){let u=a.marks,c;for(;c=i.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u)}else i?i.isInSet(a.marks)&&(l=[i]):l=a.marks;if(l&&l.length){let u=Math.min(o+a.nodeSize,n);for(let c=0;c<l.length;c++){let h=l[c],d;for(let p=0;p<r.length;p++){let m=r[p];m.step==s-1&&h.eq(r[p].style)&&(d=m)}d?(d.to=u,d.step=s):r.push({style:h,from:Math.max(o,e),to:u,step:s})}}}),r.forEach(a=>t.step(new Qn(a.from,a.to,a.style)))}function lg(t,e,n,i=n.contentMatch,r=!0){let s=t.doc.nodeAt(e),a=[],o=e+1;for(let l=0;l<s.childCount;l++){let u=s.child(l),c=o+u.nodeSize,h=i.matchType(u.type);if(!h)a.push(new Dt(o,c,he.empty));else{i=h;for(let d=0;d<u.marks.length;d++)n.allowsMarkType(u.marks[d].type)||t.step(new Qn(o,c,u.marks[d]));if(r&&u.isText&&n.whitespace!="pre"){let d,p=/\r?\n|\r/g,m;for(;d=p.exec(u.text);)m||(m=new he(ie.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),a.push(new Dt(o+d.index,o+d.index+d[0].length,m))}}o=c}if(!i.validEnd){let l=i.fillBefore(ie.empty,!0);t.replace(o,o,new he(l,0,0))}for(let l=a.length-1;l>=0;l--)t.step(a[l])}function s4(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function jo(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let i=t.depth,r=0,s=0;;--i){let a=t.$from.node(i),o=t.$from.index(i)+r,l=t.$to.indexAfter(i)-s;if(i<t.depth&&a.canReplace(o,l,n))return i;if(i==0||a.type.spec.isolating||!s4(a,o,l))break;o&&(r=1),l<a.childCount&&(s=1)}return null}function o4(t,e,n){let{$from:i,$to:r,depth:s}=e,a=i.before(s+1),o=r.after(s+1),l=a,u=o,c=ie.empty,h=0;for(let m=s,_=!1;m>n;m--)_||i.index(m)>0?(_=!0,c=ie.from(i.node(m).copy(c)),h++):l--;let d=ie.empty,p=0;for(let m=s,_=!1;m>n;m--)_||r.after(m+1)<r.end(m)?(_=!0,d=ie.from(r.node(m).copy(d)),p++):u++;t.step(new Rt(l,u,a,o,new he(c.append(d),h,p),c.size-h,!0))}function ug(t,e,n=null,i=t){let r=a4(t,e),s=r&&l4(i,e);return s?r.map(p1).concat({type:e,attrs:n}).concat(s.map(p1)):null}function p1(t){return{type:t,attrs:null}}function a4(t,e){let{parent:n,startIndex:i,endIndex:r}=t,s=n.contentMatchAt(i).findWrapping(e);if(!s)return null;let a=s.length?s[0]:e;return n.canReplaceWith(i,r,a)?s:null}function l4(t,e){let{parent:n,startIndex:i,endIndex:r}=t,s=n.child(i),a=e.contentMatch.findWrapping(s.type);if(!a)return null;let l=(a.length?a[a.length-1]:e).contentMatch;for(let u=i;l&&u<r;u++)l=l.matchType(n.child(u).type);return!l||!l.validEnd?null:a}function u4(t,e,n){let i=ie.empty;for(let a=n.length-1;a>=0;a--){if(i.size){let o=n[a].type.contentMatch.matchFragment(i);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=ie.from(n[a].type.create(n[a].attrs,i))}let r=e.start,s=e.end;t.step(new Rt(r,s,r,s,new he(i,0,0),n.length,!0))}function c4(t,e,n,i,r){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(a,o)=>{let l=typeof r=="function"?r(a):r;if(a.isTextblock&&!a.hasMarkup(i,l)&&h4(t.doc,t.mapping.slice(s).map(o),i)){let u=null;if(i.schema.linebreakReplacement){let p=i.whitespace=="pre",m=!!i.contentMatch.matchType(i.schema.linebreakReplacement);p&&!m?u=!1:!p&&m&&(u=!0)}u===!1&&Qx(t,a,o,s),lg(t,t.mapping.slice(s).map(o,1),i,void 0,u===null);let c=t.mapping.slice(s),h=c.map(o,1),d=c.map(o+a.nodeSize,1);return t.step(new Rt(h,d,h+1,d-1,new he(ie.from(i.create(l,null,a.marks)),0,0),1,!0)),u===!0&&Xx(t,a,o,s),!1}})}function Xx(t,e,n,i){e.forEach((r,s)=>{if(r.isText){let a,o=/\r?\n|\r/g;for(;a=o.exec(r.text);){let l=t.mapping.slice(i).map(n+1+s+a.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function Qx(t,e,n,i){e.forEach((r,s)=>{if(r.type==r.type.schema.linebreakReplacement){let a=t.mapping.slice(i).map(n+1+s);t.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function h4(t,e,n){let i=t.resolve(e),r=i.index();return i.parent.canReplaceWith(r,r+1,n)}function d4(t,e,n,i,r){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let a=n.create(i,null,r||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,a);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Rt(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new he(ie.from(a),0,0),1,!0))}function Wi(t,e,n=1,i){let r=t.resolve(e),s=r.depth-n,a=i&&i[i.length-1]||r.parent;if(s<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!a.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let u=r.depth-1,c=n-2;u>s;u--,c--){let h=r.node(u),d=r.index(u);if(h.type.spec.isolating)return!1;let p=h.content.cutByIndex(d,h.childCount),m=i&&i[c+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let _=i&&i[c]||h;if(!h.canReplace(d+1,h.childCount)||!_.type.validContent(p))return!1}let o=r.indexAfter(s),l=i&&i[0];return r.node(s).canReplaceWith(o,o,l?l.type:r.node(s+1).type)}function f4(t,e,n=1,i){let r=t.doc.resolve(e),s=ie.empty,a=ie.empty;for(let o=r.depth,l=r.depth-n,u=n-1;o>l;o--,u--){s=ie.from(r.node(o).copy(s));let c=i&&i[u];a=ie.from(c?c.type.create(c.attrs,a):r.node(o).copy(a))}t.step(new Dt(e,e,new he(s.append(a),n,n),!0))}function Gr(t,e){let n=t.resolve(e),i=n.index();return ek(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function p4(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:i}=t.type.schema;for(let r=0;r<e.childCount;r++){let s=e.child(r),a=s.type==i?t.type.schema.nodes.text:s.type;if(n=n.matchType(a),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function ek(t,e){return!!(t&&e&&!t.isLeaf&&p4(t,e))}function od(t,e,n=-1){let i=t.resolve(e);for(let r=i.depth;;r--){let s,a,o=i.index(r);if(r==i.depth?(s=i.nodeBefore,a=i.nodeAfter):n>0?(s=i.node(r+1),o++,a=i.node(r).maybeChild(o)):(s=i.node(r).maybeChild(o-1),a=i.node(r+1)),s&&!s.isTextblock&&ek(s,a)&&i.node(r).canReplace(o,o+1))return e;if(r==0)break;e=n<0?i.before(r):i.after(r)}}function m4(t,e,n){let i=null,{linebreakReplacement:r}=t.doc.type.schema,s=t.doc.resolve(e-n),a=s.node().type;if(r&&a.inlineContent){let c=a.whitespace=="pre",h=!!a.contentMatch.matchType(r);c&&!h?i=!1:!c&&h&&(i=!0)}let o=t.steps.length;if(i===!1){let c=t.doc.resolve(e+n);Qx(t,c.node(),c.before(),o)}a.inlineContent&&lg(t,e+n-1,a,s.node().contentMatchAt(s.index()),i==null);let l=t.mapping.slice(o),u=l.map(e-n);if(t.step(new Dt(u,l.map(e+n,-1),he.empty,!0)),i===!0){let c=t.doc.resolve(u);Xx(t,c.node(),c.before(),t.steps.length)}return t}function g4(t,e,n){let i=t.resolve(e);if(i.parent.canReplaceWith(i.index(),i.index(),n))return e;if(i.parentOffset==0)for(let r=i.depth-1;r>=0;r--){let s=i.index(r);if(i.node(r).canReplaceWith(s,s,n))return i.before(r+1);if(s>0)return null}if(i.parentOffset==i.parent.content.size)for(let r=i.depth-1;r>=0;r--){let s=i.indexAfter(r);if(i.node(r).canReplaceWith(s,s,n))return i.after(r+1);if(s<i.node(r).childCount)return null}return null}function tk(t,e,n){let i=t.resolve(e);if(!n.content.size)return e;let r=n.content;for(let s=0;s<n.openStart;s++)r=r.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let a=i.depth;a>=0;a--){let o=a==i.depth?0:i.pos<=(i.start(a+1)+i.end(a+1))/2?-1:1,l=i.index(a)+(o>0?1:0),u=i.node(a),c=!1;if(s==1)c=u.canReplace(l,l,r);else{let h=u.contentMatchAt(l).findWrapping(r.firstChild.type);c=h&&u.canReplaceWith(l,l,h[0])}if(c)return o==0?i.pos:o<0?i.before(a+1):i.after(a+1)}return null}function ad(t,e,n=e,i=he.empty){if(e==n&&!i.size)return null;let r=t.resolve(e),s=t.resolve(n);return nk(r,s,i)?new Dt(e,n,i):new v4(r,s,i).fit()}function nk(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class v4{constructor(e,n,i){this.$from=e,this.$to=n,this.unplaced=i,this.frontier=[],this.placed=ie.empty;for(let r=0;r<=e.depth;r++){let s=e.node(r);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=ie.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,i=this.$from,r=this.close(e<0?this.$to:i.doc.resolve(e));if(!r)return null;let s=this.placed,a=i.depth,o=r.depth;for(;a&&o&&s.childCount==1;)s=s.firstChild.content,a--,o--;let l=new he(s,a,o);return e>-1?new Rt(i.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||i.pos!=this.$to.pos?new Dt(i.pos,r.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,i=0,r=this.unplaced.openEnd;i<e;i++){let s=n.firstChild;if(n.childCount>1&&(r=0),s.type.spec.isolating&&r<=i){e=i;break}n=s.content}for(let n=1;n<=2;n++)for(let i=n==1?e:this.unplaced.openStart;i>=0;i--){let r,s=null;i?(s=pf(this.unplaced.content,i-1).firstChild,r=s.content):r=this.unplaced.content;let a=r.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:u}=this.frontier[o],c,h=null;if(n==1&&(a?u.matchType(a.type)||(h=u.fillBefore(ie.from(a),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:i,frontierDepth:o,parent:s,inject:h};if(n==2&&a&&(c=u.findWrapping(a.type)))return{sliceDepth:i,frontierDepth:o,parent:s,wrap:c};if(s&&u.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:i}=this.unplaced,r=pf(e,n);return!r.childCount||r.firstChild.isLeaf?!1:(this.unplaced=new he(e,n+1,Math.max(i,r.size+n>=e.size-i?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:i}=this.unplaced,r=pf(e,n);if(r.childCount<=1&&n>0){let s=e.size-n<=n+r.size;this.unplaced=new he(pa(e,n-1,1),n-1,s?n-1:i)}else this.unplaced=new he(pa(e,n,1),n,i)}placeNodes({sliceDepth:e,frontierDepth:n,parent:i,inject:r,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let _=0;_<s.length;_++)this.openFrontierNode(s[_]);let a=this.unplaced,o=i?i.content:a.content,l=a.openStart-e,u=0,c=[],{match:h,type:d}=this.frontier[n];if(r){for(let _=0;_<r.childCount;_++)c.push(r.child(_));h=h.matchFragment(r)}let p=o.size+e-(a.content.size-a.openEnd);for(;u<o.childCount;){let _=o.child(u),f=h.matchType(_.type);if(!f)break;u++,(u>1||l==0||_.content.size)&&(h=f,c.push(ik(_.mark(d.allowedMarks(_.marks)),u==1?l:0,u==o.childCount?p:-1)))}let m=u==o.childCount;m||(p=-1),this.placed=ma(this.placed,n,ie.from(c)),this.frontier[n].match=h,m&&p<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let _=0,f=o;_<p;_++){let v=f.lastChild;this.frontier.push({type:v.type,match:v.contentMatchAt(v.childCount)}),f=v.content}this.unplaced=m?e==0?he.empty:new he(pa(a.content,e-1,1),e-1,p<0?a.openEnd:e-1):new he(pa(a.content,e,u),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!mf(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:i}=this.$to,r=this.$to.after(i);for(;i>1&&r==this.$to.end(--i);)++r;return r}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:i,type:r}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),a=mf(e,n,r,i,s);if(a){for(let o=n-1;o>=0;o--){let{match:l,type:u}=this.frontier[o],c=mf(e,o,u,l,!0);if(!c||c.childCount)continue e}return{depth:n,fit:a,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=ma(this.placed,n.depth,n.fit)),e=n.move;for(let i=n.depth+1;i<=e.depth;i++){let r=e.node(i),s=r.type.contentMatch.fillBefore(r.content,!0,e.index(i));this.openFrontierNode(r.type,r.attrs,s)}return e}openFrontierNode(e,n=null,i){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=ma(this.placed,this.depth,ie.from(e.create(n,i))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(ie.empty,!0);n.childCount&&(this.placed=ma(this.placed,this.frontier.length,n))}}function pa(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(pa(t.firstChild.content,e-1,n)))}function ma(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(ma(t.lastChild.content,e-1,n)))}function pf(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function ik(t,e,n){if(e<=0)return t;let i=t.content;return e>1&&(i=i.replaceChild(0,ik(i.firstChild,e-1,i.childCount==1?n-1:0))),e>0&&(i=t.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(ie.empty,!0)))),t.copy(i)}function mf(t,e,n,i,r){let s=t.node(e),a=r?t.indexAfter(e):t.index(e);if(a==s.childCount&&!n.compatibleContent(s.type))return null;let o=i.fillBefore(s.content,!0,a);return o&&!_4(n,s.content,a)?o:null}function _4(t,e,n){for(let i=n;i<e.childCount;i++)if(!t.allowsMarks(e.child(i).marks))return!0;return!1}function y4(t){return t.spec.defining||t.spec.definingForContent}function b4(t,e,n,i){if(!i.size)return t.deleteRange(e,n);let r=t.doc.resolve(e),s=t.doc.resolve(n);if(nk(r,s,i))return t.step(new Dt(e,n,i));let a=sk(r,s);a[a.length-1]==0&&a.pop();let o=-(r.depth+1);a.unshift(o);for(let d=r.depth,p=r.pos-1;d>0;d--,p--){let m=r.node(d).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;a.indexOf(d)>-1?o=d:r.before(d)==p&&a.splice(1,0,-d)}let l=a.indexOf(o),u=[],c=i.openStart;for(let d=i.content,p=0;;p++){let m=d.firstChild;if(u.push(m),p==i.openStart)break;d=m.content}for(let d=c-1;d>=0;d--){let p=u[d],m=y4(p.type);if(m&&!p.sameMarkup(r.node(Math.abs(o)-1)))c=d;else if(m||!p.type.isTextblock)break}for(let d=i.openStart;d>=0;d--){let p=(d+c+1)%(i.openStart+1),m=u[p];if(m)for(let _=0;_<a.length;_++){let f=a[(_+l)%a.length],v=!0;f<0&&(v=!1,f=-f);let g=r.node(f-1),y=r.index(f-1);if(g.canReplaceWith(y,y,m.type,m.marks))return t.replace(r.before(f),v?s.after(f):n,new he(rk(i.content,0,i.openStart,p),p,i.openEnd))}}let h=t.steps.length;for(let d=a.length-1;d>=0&&(t.replace(e,n,i),!(t.steps.length>h));d--){let p=a[d];p<0||(e=r.before(p),n=s.after(p))}}function rk(t,e,n,i,r){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(rk(s.content,e+1,n,i,s)))}if(e>i){let s=r.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(ie.empty,!0))}return t}function w4(t,e,n,i){if(!i.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let r=g4(t.doc,e,i.type);r!=null&&(e=n=r)}t.replaceRange(e,n,new he(ie.from(i),0,0))}function S4(t,e,n){let i=t.doc.resolve(e),r=t.doc.resolve(n),s=sk(i,r);for(let a=0;a<s.length;a++){let o=s[a],l=a==s.length-1;if(l&&o==0||i.node(o).type.contentMatch.validEnd)return t.delete(i.start(o),r.end(o));if(o>0&&(l||i.node(o-1).canReplace(i.index(o-1),r.indexAfter(o-1))))return t.delete(i.before(o),r.after(o))}for(let a=1;a<=i.depth&&a<=r.depth;a++)if(e-i.start(a)==i.depth-a&&n>i.end(a)&&r.end(a)-n!=r.depth-a&&i.start(a-1)==r.start(a-1)&&i.node(a-1).canReplace(i.index(a-1),r.index(a-1)))return t.delete(i.before(a),n);t.delete(e,n)}function sk(t,e){let n=[],i=Math.min(t.depth,e.depth);for(let r=i;r>=0;r--){let s=t.start(r);if(s<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(s==e.start(r)||r==t.depth&&r==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==s-1)&&n.push(r)}return n}class go extends Jt{constructor(e,n,i){super(),this.pos=e,this.attr=n,this.value=i}apply(e){let n=e.nodeAt(this.pos);if(!n)return mt.fail("No node at attribute step's position");let i=Object.create(null);for(let s in n.attrs)i[s]=n.attrs[s];i[this.attr]=this.value;let r=n.type.create(i,null,n.marks);return mt.fromReplace(e,this.pos,this.pos+1,new he(ie.from(r),0,n.isLeaf?0:1))}getMap(){return vn.empty}invert(e){return new go(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new go(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new go(n.pos,n.attr,n.value)}}Jt.jsonID("attr",go);class ul extends Jt{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let r in e.attrs)n[r]=e.attrs[r];n[this.attr]=this.value;let i=e.type.create(n,e.content,e.marks);return mt.ok(i)}getMap(){return vn.empty}invert(e){return new ul(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ul(n.attr,n.value)}}Jt.jsonID("docAttr",ul);let Do=class extends Error{};Do=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Do.prototype=Object.create(Error.prototype);Do.prototype.constructor=Do;Do.prototype.name="TransformError";class ok{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ll}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Do(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,i=he.empty){let r=ad(this.doc,e,n,i);return r&&this.step(r),this}replaceWith(e,n,i){return this.replace(e,n,new he(ie.from(i),0,0))}delete(e,n){return this.replace(e,n,he.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,i){return b4(this,e,n,i),this}replaceRangeWith(e,n,i){return w4(this,e,n,i),this}deleteRange(e,n){return S4(this,e,n),this}lift(e,n){return o4(this,e,n),this}join(e,n=1){return m4(this,e,n),this}wrap(e,n){return u4(this,e,n),this}setBlockType(e,n=e,i,r=null){return c4(this,e,n,i,r),this}setNodeMarkup(e,n,i=null,r){return d4(this,e,n,i,r),this}setNodeAttribute(e,n,i){return this.step(new go(e,n,i)),this}setDocAttribute(e,n){return this.step(new ul(e,n)),this}addNodeMark(e,n){return this.step(new _r(e,n)),this}removeNodeMark(e,n){let i=this.doc.nodeAt(e);if(!i)throw new RangeError("No node at position "+e);if(n instanceof $e)n.isInSet(i.marks)&&this.step(new xs(e,n));else{let r=i.marks,s,a=[];for(;s=n.isInSet(r);)a.push(new xs(e,s)),r=s.removeFromSet(r);for(let o=a.length-1;o>=0;o--)this.step(a[o])}return this}split(e,n=1,i){return f4(this,e,n,i),this}addMark(e,n,i){return i4(this,e,n,i),this}removeMark(e,n,i){return r4(this,e,n,i),this}clearIncompatible(e,n,i){return lg(this,e,n,i),this}}const gf=Object.create(null);class Re{constructor(e,n,i){this.$anchor=e,this.$head=n,this.ranges=i||[new x4(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=he.empty){let i=n.content.lastChild,r=null;for(let o=0;o<n.openEnd;o++)r=i,i=i.lastChild;let s=e.steps.length,a=this.ranges;for(let o=0;o<a.length;o++){let{$from:l,$to:u}=a[o],c=e.mapping.slice(s);e.replaceRange(c.map(l.pos),c.map(u.pos),o?he.empty:n),o==0&&v1(e,s,(i?i.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,n){let i=e.steps.length,r=this.ranges;for(let s=0;s<r.length;s++){let{$from:a,$to:o}=r[s],l=e.mapping.slice(i),u=l.map(a.pos),c=l.map(o.pos);s?e.deleteRange(u,c):(e.replaceRangeWith(u,c,n),v1(e,i,n.isInline?-1:1))}}static findFrom(e,n,i=!1){let r=e.parent.inlineContent?new Ce(e):$s(e.node(0),e.parent,e.pos,e.index(),n,i);if(r)return r;for(let s=e.depth-1;s>=0;s--){let a=n<0?$s(e.node(0),e.node(s),e.before(s+1),e.index(s),n,i):$s(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,i);if(a)return a}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new wn(e.node(0))}static atStart(e){return $s(e,e,0,0,1)||new wn(e)}static atEnd(e){return $s(e,e,e.content.size,e.childCount,-1)||new wn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let i=gf[n.type];if(!i)throw new RangeError(`No selection type ${n.type} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in gf)throw new RangeError("Duplicate use of selection JSON ID "+e);return gf[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Ce.between(this.$anchor,this.$head).getBookmark()}}Re.prototype.visible=!0;class x4{constructor(e,n){this.$from=e,this.$to=n}}let m1=!1;function g1(t){!m1&&!t.parent.inlineContent&&(m1=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Ce extends Re{constructor(e,n=e){g1(e),g1(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let i=e.resolve(n.map(this.head));if(!i.parent.inlineContent)return Re.near(i);let r=e.resolve(n.map(this.anchor));return new Ce(r.parent.inlineContent?r:i,i)}replace(e,n=he.empty){if(super.replace(e,n),n==he.empty){let i=this.$from.marksAcross(this.$to);i&&e.ensureMarks(i)}}eq(e){return e instanceof Ce&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new ld(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ce(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,i=n){let r=e.resolve(n);return new this(r,i==n?r:e.resolve(i))}static between(e,n,i){let r=e.pos-n.pos;if((!i||r)&&(i=r>=0?1:-1),!n.parent.inlineContent){let s=Re.findFrom(n,i,!0)||Re.findFrom(n,-i,!0);if(s)n=s.$head;else return Re.near(n,i)}return e.parent.inlineContent||(r==0?e=n:(e=(Re.findFrom(e,-i,!0)||Re.findFrom(e,i,!0)).$anchor,e.pos<n.pos!=r<0&&(e=n))),new Ce(e,n)}}Re.jsonID("text",Ce);class ld{constructor(e,n){this.anchor=e,this.head=n}map(e){return new ld(e.map(this.anchor),e.map(this.head))}resolve(e){return Ce.between(e.resolve(this.anchor),e.resolve(this.head))}}class be extends Re{constructor(e){let n=e.nodeAfter,i=e.node(0).resolve(e.pos+n.nodeSize);super(e,i),this.node=n}map(e,n){let{deleted:i,pos:r}=n.mapResult(this.anchor),s=e.resolve(r);return i?Re.near(s):new be(s)}content(){return new he(ie.from(this.node),0,0)}eq(e){return e instanceof be&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new cg(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new be(e.resolve(n.anchor))}static create(e,n){return new be(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}be.prototype.visible=!1;Re.jsonID("node",be);class cg{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:i}=e.mapResult(this.anchor);return n?new ld(i,i):new cg(i)}resolve(e){let n=e.resolve(this.anchor),i=n.nodeAfter;return i&&be.isSelectable(i)?new be(n):Re.near(n)}}class wn extends Re{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=he.empty){if(n==he.empty){e.delete(0,e.doc.content.size);let i=Re.atStart(e.doc);i.eq(e.selection)||e.setSelection(i)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new wn(e)}map(e){return new wn(e)}eq(e){return e instanceof wn}getBookmark(){return k4}}Re.jsonID("all",wn);const k4={map(){return this},resolve(t){return new wn(t)}};function $s(t,e,n,i,r,s=!1){if(e.inlineContent)return Ce.create(t,n);for(let a=i-(r>0?0:1);r>0?a<e.childCount:a>=0;a+=r){let o=e.child(a);if(o.isAtom){if(!s&&be.isSelectable(o))return be.create(t,n-(r<0?o.nodeSize:0))}else{let l=$s(t,o,n+r,r<0?o.childCount:0,r,s);if(l)return l}n+=o.nodeSize*r}return null}function v1(t,e,n){let i=t.steps.length-1;if(i<e)return;let r=t.steps[i];if(!(r instanceof Dt||r instanceof Rt))return;let s=t.mapping.maps[i],a;s.forEach((o,l,u,c)=>{a==null&&(a=c)}),t.setSelection(Re.near(t.doc.resolve(a),n))}const _1=1,pu=2,y1=4;class C4 extends ok{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|_1)&~pu,this.storedMarks=null,this}get selectionSet(){return(this.updated&_1)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=pu,this}ensureMarks(e){return $e.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&pu)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~pu,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let i=this.selection;return n&&(e=e.mark(this.storedMarks||(i.empty?i.$from.marks():i.$from.marksAcross(i.$to)||$e.none))),i.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,i){let r=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(i==null&&(i=n),!e)return this.deleteRange(n,i);let s=this.storedMarks;if(!s){let a=this.doc.resolve(n);s=i==n?a.marks():a.marksAcross(this.doc.resolve(i))}return this.replaceRangeWith(n,i,r.text(e,s)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Re.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=y1,this}get scrolledIntoView(){return(this.updated&y1)>0}}function b1(t,e){return!e||!t?t:t.bind(e)}class ga{constructor(e,n,i){this.name=e,this.init=b1(n.init,i),this.apply=b1(n.apply,i)}}const E4=[new ga("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new ga("selection",{init(t,e){return t.selection||Re.atStart(e.doc)},apply(t){return t.selection}}),new ga("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,i){return i.selection.$cursor?t.storedMarks:null}}),new ga("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class vf{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=E4.slice(),n&&n.forEach(i=>{if(this.pluginsByKey[i.key])throw new RangeError("Adding different instances of a keyed plugin ("+i.key+")");this.plugins.push(i),this.pluginsByKey[i.key]=i,i.spec.state&&this.fields.push(new ga(i.key,i.spec.state,i))})}}class lo{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=n){let r=this.config.plugins[i];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],i=this.applyInner(e),r=null;for(;;){let s=!1;for(let a=0;a<this.config.plugins.length;a++){let o=this.config.plugins[a];if(o.spec.appendTransaction){let l=r?r[a].n:0,u=r?r[a].state:this,c=l<n.length&&o.spec.appendTransaction.call(o,l?n.slice(l):n,u,i);if(c&&i.filterTransaction(c,a)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let h=0;h<this.config.plugins.length;h++)r.push(h<a?{state:i,n:n.length}:{state:this,n:0})}n.push(c),i=i.applyInner(c),s=!0}r&&(r[a]={state:i,n:n.length})}}if(!s)return{state:i,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new lo(this.config),i=this.config.fields;for(let r=0;r<i.length;r++){let s=i[r];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new C4(this)}static create(e){let n=new vf(e.doc?e.doc.type.schema:e.schema,e.plugins),i=new lo(n);for(let r=0;r<n.fields.length;r++)i[n.fields[r].name]=n.fields[r].init(e,i);return i}reconfigure(e){let n=new vf(this.schema,e.plugins),i=n.fields,r=new lo(n);for(let s=0;s<i.length;s++){let a=i[s].name;r[a]=this.hasOwnProperty(a)?this[a]:i[s].init(e,r)}return r}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(i=>i.toJSON())),e&&typeof e=="object")for(let i in e){if(i=="doc"||i=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[i],s=r.spec.state;s&&s.toJSON&&(n[i]=s.toJSON.call(r,this[r.key]))}return n}static fromJSON(e,n,i){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new vf(e.schema,e.plugins),s=new lo(r);return r.fields.forEach(a=>{if(a.name=="doc")s.doc=Mr.fromJSON(e.schema,n.doc);else if(a.name=="selection")s.selection=Re.fromJSON(s.doc,n.selection);else if(a.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(i)for(let o in i){let l=i[o],u=l.spec.state;if(l.key==a.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,o)){s[a.name]=u.fromJSON.call(l,e,n[o],s);return}}s[a.name]=a.init(e,s)}}),s}}function ak(t,e,n){for(let i in t){let r=t[i];r instanceof Function?r=r.bind(e):i=="handleDOMEvents"&&(r=ak(r,e,{})),n[i]=r}return n}class Ye{constructor(e){this.spec=e,this.props={},e.props&&ak(e.props,this,this.props),this.key=e.key?e.key.key:lk("plugin")}getState(e){return e[this.key]}}const _f=Object.create(null);function lk(t){return t in _f?t+"$"+ ++_f[t]:(_f[t]=0,t+"$")}class dt{constructor(e="key"){this.key=lk(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const hg=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function uk(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const ck=(t,e,n)=>{let i=uk(t,n);if(!i)return!1;let r=dg(i);if(!r){let a=i.blockRange(),o=a&&jo(a);return o==null?!1:(e&&e(t.tr.lift(a,o).scrollIntoView()),!0)}let s=r.nodeBefore;if(yk(t,r,e,-1))return!0;if(i.parent.content.size==0&&(Ao(s,"end")||be.isSelectable(s)))for(let a=i.depth;;a--){let o=ad(t.doc,i.before(a),i.after(a),he.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Ao(s,"end")?Re.findFrom(l.doc.resolve(l.mapping.map(r.pos,-1)),-1):be.create(l.doc,r.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}if(a==1||i.node(a-1).childCount>1)break}return s.isAtom&&r.depth==i.depth-1?(e&&e(t.tr.delete(r.pos-s.nodeSize,r.pos).scrollIntoView()),!0):!1},D4=(t,e,n)=>{let i=uk(t,n);if(!i)return!1;let r=dg(i);return r?hk(t,r,e):!1},A4=(t,e,n)=>{let i=fk(t,n);if(!i)return!1;let r=fg(i);return r?hk(t,r,e):!1};function hk(t,e,n){let i=e.nodeBefore,r=i,s=e.pos-1;for(;!r.isTextblock;s--){if(r.type.spec.isolating)return!1;let c=r.lastChild;if(!c)return!1;r=c}let a=e.nodeAfter,o=a,l=e.pos+1;for(;!o.isTextblock;l++){if(o.type.spec.isolating)return!1;let c=o.firstChild;if(!c)return!1;o=c}let u=ad(t.doc,s,l,he.empty);if(!u||u.from!=s||u instanceof Dt&&u.slice.size>=l-s)return!1;if(n){let c=t.tr.step(u);c.setSelection(Ce.create(c.doc,s)),n(c.scrollIntoView())}return!0}function Ao(t,e,n=!1){for(let i=t;i;i=e=="start"?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&i.childCount!=1)return!1}return!1}const dk=(t,e,n)=>{let{$head:i,empty:r}=t.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):i.parentOffset>0)return!1;s=dg(i)}let a=s&&s.nodeBefore;return!a||!be.isSelectable(a)?!1:(e&&e(t.tr.setSelection(be.create(t.doc,s.pos-a.nodeSize)).scrollIntoView()),!0)};function dg(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function fk(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const pk=(t,e,n)=>{let i=fk(t,n);if(!i)return!1;let r=fg(i);if(!r)return!1;let s=r.nodeAfter;if(yk(t,r,e,1))return!0;if(i.parent.content.size==0&&(Ao(s,"start")||be.isSelectable(s))){let a=ad(t.doc,i.before(),i.after(),he.empty);if(a&&a.slice.size<a.to-a.from){if(e){let o=t.tr.step(a);o.setSelection(Ao(s,"start")?Re.findFrom(o.doc.resolve(o.mapping.map(r.pos)),1):be.create(o.doc,o.mapping.map(r.pos))),e(o.scrollIntoView())}return!0}}return s.isAtom&&r.depth==i.depth-1?(e&&e(t.tr.delete(r.pos,r.pos+s.nodeSize).scrollIntoView()),!0):!1},mk=(t,e,n)=>{let{$head:i,empty:r}=t.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):i.parentOffset<i.parent.content.size)return!1;s=fg(i)}let a=s&&s.nodeAfter;return!a||!be.isSelectable(a)?!1:(e&&e(t.tr.setSelection(be.create(t.doc,s.pos)).scrollIntoView()),!0)};function fg(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const T4=(t,e)=>{let n=t.selection,i=n instanceof be,r;if(i){if(n.node.isTextblock||!Gr(t.doc,n.from))return!1;r=n.from}else if(r=od(t.doc,n.from,-1),r==null)return!1;if(e){let s=t.tr.join(r);i&&s.setSelection(be.create(s.doc,r-t.doc.resolve(r).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},M4=(t,e)=>{let n=t.selection,i;if(n instanceof be){if(n.node.isTextblock||!Gr(t.doc,n.to))return!1;i=n.to}else if(i=od(t.doc,n.to,1),i==null)return!1;return e&&e(t.tr.join(i).scrollIntoView()),!0},R4=(t,e)=>{let{$from:n,$to:i}=t.selection,r=n.blockRange(i),s=r&&jo(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)},gk=(t,e)=>{let{$head:n,$anchor:i}=t.selection;return!n.parent.type.spec.code||!n.sameParent(i)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function pg(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const O4=(t,e)=>{let{$head:n,$anchor:i}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let r=n.node(-1),s=n.indexAfter(-1),a=pg(r.contentMatchAt(s));if(!a||!r.canReplaceWith(s,s,a))return!1;if(e){let o=n.after(),l=t.tr.replaceWith(o,o,a.createAndFill());l.setSelection(Re.near(l.doc.resolve(o),1)),e(l.scrollIntoView())}return!0},vk=(t,e)=>{let n=t.selection,{$from:i,$to:r}=n;if(n instanceof wn||i.parent.inlineContent||r.parent.inlineContent)return!1;let s=pg(r.parent.contentMatchAt(r.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let a=(!i.parentOffset&&r.index()<r.parent.childCount?i:r).pos,o=t.tr.insert(a,s.createAndFill());o.setSelection(Ce.create(o.doc,a+1)),e(o.scrollIntoView())}return!0},_k=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(Wi(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let i=n.blockRange(),r=i&&jo(i);return r==null?!1:(e&&e(t.tr.lift(i,r).scrollIntoView()),!0)};function P4(t){return(e,n)=>{let{$from:i,$to:r}=e.selection;if(e.selection instanceof be&&e.selection.node.isBlock)return!i.parentOffset||!Wi(e.doc,i.pos)?!1:(n&&n(e.tr.split(i.pos).scrollIntoView()),!0);if(!i.depth)return!1;let s=[],a,o,l=!1,u=!1;for(let p=i.depth;;p--)if(i.node(p).isBlock){l=i.end(p)==i.pos+(i.depth-p),u=i.start(p)==i.pos-(i.depth-p),o=pg(i.node(p-1).contentMatchAt(i.indexAfter(p-1))),s.unshift(l&&o?{type:o}:null),a=p;break}else{if(p==1)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof Ce||e.selection instanceof wn)&&c.deleteSelection();let h=c.mapping.map(i.pos),d=Wi(c.doc,h,s.length,s);if(d||(s[0]=o?{type:o}:null,d=Wi(c.doc,h,s.length,s)),!d)return!1;if(c.split(h,s.length,s),!l&&u&&i.node(a).type!=o){let p=c.mapping.map(i.before(a)),m=c.doc.resolve(p);o&&i.node(a-1).canReplaceWith(m.index(),m.index()+1,o)&&c.setNodeMarkup(c.mapping.map(i.before(a)),o)}return n&&n(c.scrollIntoView()),!0}}const N4=P4(),I4=(t,e)=>{let{$from:n,to:i}=t.selection,r,s=n.sharedDepth(i);return s==0?!1:(r=n.before(s),e&&e(t.tr.setSelection(be.create(t.doc,r))),!0)};function L4(t,e,n){let i=e.nodeBefore,r=e.nodeAfter,s=e.index();return!i||!r||!i.type.compatibleContent(r.type)?!1:!i.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-i.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(r.isTextblock||Gr(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function yk(t,e,n,i){let r=e.nodeBefore,s=e.nodeAfter,a,o,l=r.type.spec.isolating||s.type.spec.isolating;if(!l&&L4(t,e,n))return!0;let u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(a=(o=r.contentMatchAt(r.childCount)).findWrapping(s.type))&&o.matchType(a[0]||s.type).validEnd){if(n){let p=e.pos+s.nodeSize,m=ie.empty;for(let v=a.length-1;v>=0;v--)m=ie.from(a[v].create(null,m));m=ie.from(r.copy(m));let _=t.tr.step(new Rt(e.pos-1,p,e.pos,p,new he(m,1,0),a.length,!0)),f=_.doc.resolve(p+2*a.length);f.nodeAfter&&f.nodeAfter.type==r.type&&Gr(_.doc,f.pos)&&_.join(f.pos),n(_.scrollIntoView())}return!0}let c=s.type.spec.isolating||i>0&&l?null:Re.findFrom(e,1),h=c&&c.$from.blockRange(c.$to),d=h&&jo(h);if(d!=null&&d>=e.depth)return n&&n(t.tr.lift(h,d).scrollIntoView()),!0;if(u&&Ao(s,"start",!0)&&Ao(r,"end")){let p=r,m=[];for(;m.push(p),!p.isTextblock;)p=p.lastChild;let _=s,f=1;for(;!_.isTextblock;_=_.firstChild)f++;if(p.canReplace(p.childCount,p.childCount,_.content)){if(n){let v=ie.empty;for(let y=m.length-1;y>=0;y--)v=ie.from(m[y].copy(v));let g=t.tr.step(new Rt(e.pos-m.length,e.pos+s.nodeSize,e.pos+f,e.pos+s.nodeSize-f,new he(v,m.length,0),0,!0));n(g.scrollIntoView())}return!0}}return!1}function bk(t){return function(e,n){let i=e.selection,r=t<0?i.$from:i.$to,s=r.depth;for(;r.node(s).isInline;){if(!s)return!1;s--}return r.node(s).isTextblock?(n&&n(e.tr.setSelection(Ce.create(e.doc,t<0?r.start(s):r.end(s)))),!0):!1}}const B4=bk(-1),z4=bk(1);function F4(t,e=null){return function(n,i){let{$from:r,$to:s}=n.selection,a=r.blockRange(s),o=a&&ug(a,t,e);return o?(i&&i(n.tr.wrap(a,o).scrollIntoView()),!0):!1}}function w1(t,e=null){return function(n,i){let r=!1;for(let s=0;s<n.selection.ranges.length&&!r;s++){let{$from:{pos:a},$to:{pos:o}}=n.selection.ranges[s];n.doc.nodesBetween(a,o,(l,u)=>{if(r)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)r=!0;else{let c=n.doc.resolve(u),h=c.index();r=c.parent.canReplaceWith(h,h+1,t)}})}if(!r)return!1;if(i){let s=n.tr;for(let a=0;a<n.selection.ranges.length;a++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[a];s.setBlockType(o,l,t,e)}i(s.scrollIntoView())}return!0}}function mg(...t){return function(e,n,i){for(let r=0;r<t.length;r++)if(t[r](e,n,i))return!0;return!1}}mg(hg,ck,dk);mg(hg,pk,mk);mg(gk,vk,_k,N4);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function j4(t,e=null){return function(n,i){let{$from:r,$to:s}=n.selection,a=r.blockRange(s);if(!a)return!1;let o=i?n.tr:null;return H4(o,a,t,e)?(i&&i(o.scrollIntoView()),!0):!1}}function H4(t,e,n,i=null){let r=!1,s=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=a.resolve(e.start-2);s=new zc(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new zc(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),r=!0}let o=ug(s,n,i,e);return o?(t&&$4(t,e,o,r,n),!0):!1}function $4(t,e,n,i,r){let s=ie.empty;for(let c=n.length-1;c>=0;c--)s=ie.from(n[c].type.create(n[c].attrs,s));t.step(new Rt(e.start-(i?2:0),e.end,e.start,e.end,new he(s,0,0),n.length,!0));let a=0;for(let c=0;c<n.length;c++)n[c].type==r&&(a=c+1);let o=n.length-a,l=e.start+n.length-(i?2:0),u=e.parent;for(let c=e.startIndex,h=e.endIndex,d=!0;c<h;c++,d=!1)!d&&Wi(t.doc,l,o)&&(t.split(l,o),l+=2*o),l+=u.child(c).nodeSize;return t}function W4(t){return function(e,n){let{$from:i,$to:r}=e.selection,s=i.blockRange(r,a=>a.childCount>0&&a.firstChild.type==t);return s?n?i.node(s.depth-1).type==t?V4(e,n,t,s):G4(e,n,s):!0:!1}}function V4(t,e,n,i){let r=t.tr,s=i.end,a=i.$to.end(i.depth);s<a&&(r.step(new Rt(s-1,a,s,a,new he(ie.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new zc(r.doc.resolve(i.$from.pos),r.doc.resolve(a),i.depth));const o=jo(i);if(o==null)return!1;r.lift(i,o);let l=r.doc.resolve(r.mapping.map(s,-1)-1);return Gr(r.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&r.join(l.pos),e(r.scrollIntoView()),!0}function G4(t,e,n){let i=t.tr,r=n.parent;for(let p=n.end,m=n.endIndex-1,_=n.startIndex;m>_;m--)p-=r.child(m).nodeSize,i.delete(p-1,p+1);let s=i.doc.resolve(n.start),a=s.nodeAfter;if(i.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let o=n.startIndex==0,l=n.endIndex==r.childCount,u=s.node(-1),c=s.index(-1);if(!u.canReplace(c+(o?0:1),c+1,a.content.append(l?ie.empty:ie.from(r))))return!1;let h=s.pos,d=h+a.nodeSize;return i.step(new Rt(h-(o?1:0),d+(l?1:0),h+1,d-1,new he((o?ie.empty:ie.from(r.copy(ie.empty))).append(l?ie.empty:ie.from(r.copy(ie.empty))),o?0:1,l?0:1),o?0:1)),e(i.scrollIntoView()),!0}function U4(t){return function(e,n){let{$from:i,$to:r}=e.selection,s=i.blockRange(r,u=>u.childCount>0&&u.firstChild.type==t);if(!s)return!1;let a=s.startIndex;if(a==0)return!1;let o=s.parent,l=o.child(a-1);if(l.type!=t)return!1;if(n){let u=l.lastChild&&l.lastChild.type==o.type,c=ie.from(u?t.create():null),h=new he(ie.from(t.create(null,ie.from(o.type.create(null,c)))),u?3:1,0),d=s.start,p=s.end;n(e.tr.step(new Rt(d-(u?3:1),p,d,p,h,1,!0)).scrollIntoView())}return!0}}const Lt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},To=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let um=null;const Pi=function(t,e,n){let i=um||(um=document.createRange());return i.setEnd(t,n??t.nodeValue.length),i.setStart(t,e||0),i},q4=function(){um=null},ks=function(t,e,n,i){return n&&(S1(t,e,n,i,-1)||S1(t,e,n,i,1))},K4=/^(img|br|input|textarea|hr)$/i;function S1(t,e,n,i,r){for(var s;;){if(t==n&&e==i)return!0;if(e==(r<0?0:In(t))){let a=t.parentNode;if(!a||a.nodeType!=1||Rl(t)||K4.test(t.nodeName)||t.contentEditable=="false")return!1;e=Lt(t)+(r<0?0:1),t=a}else if(t.nodeType==1){let a=t.childNodes[e+(r<0?-1:0)];if(a.nodeType==1&&a.contentEditable=="false")if(!((s=a.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=r;else return!1;else t=a,e=r<0?In(t):0}else return!1}}function In(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function J4(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=In(t)}else if(t.parentNode&&!Rl(t))e=Lt(t),t=t.parentNode;else return null}}function Z4(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Rl(t))e=Lt(t)+1,t=t.parentNode;else return null}}function Y4(t,e,n){for(let i=e==0,r=e==In(t);i||r;){if(t==n)return!0;let s=Lt(t);if(t=t.parentNode,!t)return!1;i=i&&s==0,r=r&&s==In(t)}}function Rl(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const ud=function(t){return t.focusNode&&ks(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Qr(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function X4(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Q4(t,e,n){if(t.caretPositionFromPoint)try{let i=t.caretPositionFromPoint(e,n);if(i)return{node:i.offsetNode,offset:Math.min(In(i.offsetNode),i.offset)}}catch{}if(t.caretRangeFromPoint){let i=t.caretRangeFromPoint(e,n);if(i)return{node:i.startContainer,offset:Math.min(In(i.startContainer),i.startOffset)}}}const Si=typeof navigator<"u"?navigator:null,x1=typeof document<"u"?document:null,Ur=Si&&Si.userAgent||"",cm=/Edge\/(\d+)/.exec(Ur),wk=/MSIE \d/.exec(Ur),hm=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ur),fn=!!(wk||hm||cm),Rr=wk?document.documentMode:hm?+hm[1]:cm?+cm[1]:0,Fn=!fn&&/gecko\/(\d+)/i.test(Ur);Fn&&+(/Firefox\/(\d+)/.exec(Ur)||[0,0])[1];const dm=!fn&&/Chrome\/(\d+)/.exec(Ur),Tt=!!dm,Sk=dm?+dm[1]:0,Kt=!fn&&!!Si&&/Apple Computer/.test(Si.vendor),Mo=Kt&&(/Mobile\/\w+/.test(Ur)||!!Si&&Si.maxTouchPoints>2),On=Mo||(Si?/Mac/.test(Si.platform):!1),xk=Si?/Win/.test(Si.platform):!1,zi=/Android \d/.test(Ur),Ol=!!x1&&"webkitFontSmoothing"in x1.documentElement.style,e5=Ol?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function t5(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Ai(t,e){return typeof t=="number"?t:t[e]}function n5(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,i=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*i}}function k1(t,e,n){let i=t.someProp("scrollThreshold")||0,r=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let a=n||t.dom;a;){if(a.nodeType!=1){a=To(a);continue}let o=a,l=o==s.body,u=l?t5(s):n5(o),c=0,h=0;if(e.top<u.top+Ai(i,"top")?h=-(u.top-e.top+Ai(r,"top")):e.bottom>u.bottom-Ai(i,"bottom")&&(h=e.bottom-e.top>u.bottom-u.top?e.top+Ai(r,"top")-u.top:e.bottom-u.bottom+Ai(r,"bottom")),e.left<u.left+Ai(i,"left")?c=-(u.left-e.left+Ai(r,"left")):e.right>u.right-Ai(i,"right")&&(c=e.right-u.right+Ai(r,"right")),c||h)if(l)s.defaultView.scrollBy(c,h);else{let p=o.scrollLeft,m=o.scrollTop;h&&(o.scrollTop+=h),c&&(o.scrollLeft+=c);let _=o.scrollLeft-p,f=o.scrollTop-m;e={left:e.left-_,top:e.top-f,right:e.right-_,bottom:e.bottom-f}}let d=l?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(d))break;a=d=="absolute"?a.offsetParent:To(a)}}function i5(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),i,r;for(let s=(e.left+e.right)/2,a=n+1;a<Math.min(innerHeight,e.bottom);a+=5){let o=t.root.elementFromPoint(s,a);if(!o||o==t.dom||!t.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=n-20){i=o,r=l.top;break}}return{refDOM:i,refTop:r,stack:kk(t.dom)}}function kk(t){let e=[],n=t.ownerDocument;for(let i=t;i&&(e.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),t!=n);i=To(i));return e}function r5({refDOM:t,refTop:e,stack:n}){let i=t?t.getBoundingClientRect().top:0;Ck(n,i==0?0:i-e)}function Ck(t,e){for(let n=0;n<t.length;n++){let{dom:i,top:r,left:s}=t[n];i.scrollTop!=r+e&&(i.scrollTop=r+e),i.scrollLeft!=s&&(i.scrollLeft=s)}}let zs=null;function s5(t){if(t.setActive)return t.setActive();if(zs)return t.focus(zs);let e=kk(t);t.focus(zs==null?{get preventScroll(){return zs={preventScroll:!0},!0}}:void 0),zs||(zs=!1,Ck(e,0))}function Ek(t,e){let n,i=2e8,r,s=0,a=e.top,o=e.top,l,u;for(let c=t.firstChild,h=0;c;c=c.nextSibling,h++){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=Pi(c).getClientRects();else continue;for(let p=0;p<d.length;p++){let m=d[p];if(m.top<=a&&m.bottom>=o){a=Math.max(m.bottom,a),o=Math.min(m.top,o);let _=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(_<i){n=c,i=_,r=_&&n.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,c.nodeType==1&&_&&(s=h+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=c,u={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!n&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(s=h+1)}}return!n&&l&&(n=l,r=u,i=0),n&&n.nodeType==3?o5(n,r):!n||i&&n.nodeType==1?{node:t,offset:s}:Ek(n,r)}function o5(t,e){let n=t.nodeValue.length,i=document.createRange(),r;for(let s=0;s<n;s++){i.setEnd(t,s+1),i.setStart(t,s);let a=ir(i,1);if(a.top!=a.bottom&&gg(e,a)){r={node:t,offset:s+(e.left>=(a.left+a.right)/2?1:0)};break}}return i.detach(),r||{node:t,offset:0}}function gg(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function a5(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function l5(t,e,n){let{node:i,offset:r}=Ek(e,n),s=-1;if(i.nodeType==1&&!i.firstChild){let a=i.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(i,r,s)}function u5(t,e,n,i){let r=-1;for(let s=e,a=!1;s!=t.dom;){let o=t.docView.nearestDesc(s,!0),l;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!a&&l.left>i.left||l.top>i.top?r=o.posBefore:(!a&&l.right<i.left||l.bottom<i.top)&&(r=o.posAfter),a=!0),!o.contentDOM&&r<0&&!o.node.isText))return(o.node.isBlock?i.top<(l.top+l.bottom)/2:i.left<(l.left+l.right)/2)?o.posBefore:o.posAfter;s=o.dom.parentNode}return r>-1?r:t.docView.posFromDOM(e,n,-1)}function Dk(t,e,n){let i=t.childNodes.length;if(i&&n.top<n.bottom)for(let r=Math.max(0,Math.min(i-1,Math.floor(i*(e.top-n.top)/(n.bottom-n.top))-2)),s=r;;){let a=t.childNodes[s];if(a.nodeType==1){let o=a.getClientRects();for(let l=0;l<o.length;l++){let u=o[l];if(gg(e,u))return Dk(a,e,u)}}if((s=(s+1)%i)==r)break}return t}function c5(t,e){let n=t.dom.ownerDocument,i,r=0,s=Q4(n,e.left,e.top);s&&({node:i,offset:r}=s);let a=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),o;if(!a||!t.dom.contains(a.nodeType!=1?a.parentNode:a)){let u=t.dom.getBoundingClientRect();if(!gg(e,u)||(a=Dk(t.dom,e,u),!a))return null}if(Kt)for(let u=a;i&&u;u=To(u))u.draggable&&(i=void 0);if(a=a5(a,e),i){if(Fn&&i.nodeType==1&&(r=Math.min(r,i.childNodes.length),r<i.childNodes.length)){let c=i.childNodes[r],h;c.nodeName=="IMG"&&(h=c.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&r++}let u;Ol&&r&&i.nodeType==1&&(u=i.childNodes[r-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&r--,i==t.dom&&r==i.childNodes.length-1&&i.lastChild.nodeType==1&&e.top>i.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(r==0||i.nodeType!=1||i.childNodes[r-1].nodeName!="BR")&&(o=u5(t,i,r,e))}o==null&&(o=l5(t,a,e));let l=t.docView.nearestDesc(a,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function C1(t){return t.top<t.bottom||t.left<t.right}function ir(t,e){let n=t.getClientRects();if(n.length){let i=n[e<0?0:n.length-1];if(C1(i))return i}return Array.prototype.find.call(n,C1)||t.getBoundingClientRect()}const h5=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Ak(t,e,n){let{node:i,offset:r,atom:s}=t.docView.domFromPos(e,n<0?-1:1),a=Ol||Fn;if(i.nodeType==3)if(a&&(h5.test(i.nodeValue)||(n<0?!r:r==i.nodeValue.length))){let l=ir(Pi(i,r,r),n);if(Fn&&r&&/\s/.test(i.nodeValue[r-1])&&r<i.nodeValue.length){let u=ir(Pi(i,r-1,r-1),-1);if(u.top==l.top){let c=ir(Pi(i,r,r+1),-1);if(c.top!=l.top)return Qo(c,c.left<u.left)}}return l}else{let l=r,u=r,c=n<0?1:-1;return n<0&&!r?(u++,c=-1):n>=0&&r==i.nodeValue.length?(l--,c=1):n<0?l--:u++,Qo(ir(Pi(i,l,u),c),c<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&r&&(n<0||r==In(i))){let l=i.childNodes[r-1];if(l.nodeType==1)return yf(l.getBoundingClientRect(),!1)}if(s==null&&r<In(i)){let l=i.childNodes[r];if(l.nodeType==1)return yf(l.getBoundingClientRect(),!0)}return yf(i.getBoundingClientRect(),n>=0)}if(s==null&&r&&(n<0||r==In(i))){let l=i.childNodes[r-1],u=l.nodeType==3?Pi(l,In(l)-(a?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return Qo(ir(u,1),!1)}if(s==null&&r<In(i)){let l=i.childNodes[r];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?Pi(l,0,a?0:1):l.nodeType==1?l:null:null;if(u)return Qo(ir(u,-1),!0)}return Qo(ir(i.nodeType==3?Pi(i):i,-n),n>=0)}function Qo(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function yf(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Tk(t,e,n){let i=t.state,r=t.root.activeElement;i!=e&&t.updateState(e),r!=t.dom&&t.focus();try{return n()}finally{i!=e&&t.updateState(i),r!=t.dom&&r&&r.focus()}}function d5(t,e,n){let i=e.selection,r=n=="up"?i.$from:i.$to;return Tk(t,e,()=>{let{node:s}=t.docView.domFromPos(r.pos,n=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(s,!0);if(!o)break;if(o.node.isBlock){s=o.contentDOM||o.dom;break}s=o.dom.parentNode}let a=Ak(t,r.pos,1);for(let o=s.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=Pi(o,0,o.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let c=l[u];if(c.bottom>c.top+1&&(n=="up"?a.top-c.top>(c.bottom-a.top)*2:c.bottom-a.bottom>(a.bottom-c.top)*2))return!1}}return!0})}const f5=/[\u0590-\u08ac]/;function p5(t,e,n){let{$head:i}=e.selection;if(!i.parent.isTextblock)return!1;let r=i.parentOffset,s=!r,a=r==i.parent.content.size,o=t.domSelection();return o?!f5.test(i.parent.textContent)||!o.modify?n=="left"||n=="backward"?s:a:Tk(t,e,()=>{let{focusNode:l,focusOffset:u,anchorNode:c,anchorOffset:h}=t.domSelectionRange(),d=o.caretBidiLevel;o.modify("move",n,"character");let p=i.depth?t.docView.domAfterPos(i.before()):t.dom,{focusNode:m,focusOffset:_}=t.domSelectionRange(),f=m&&!p.contains(m.nodeType==1?m:m.parentNode)||l==m&&u==_;try{o.collapse(c,h),l&&(l!=c||u!=h)&&o.extend&&o.extend(l,u)}catch{}return d!=null&&(o.caretBidiLevel=d),f}):i.pos==i.start()||i.pos==i.end()}let E1=null,D1=null,A1=!1;function m5(t,e,n){return E1==e&&D1==n?A1:(E1=e,D1=n,A1=n=="up"||n=="down"?d5(t,e,n):p5(t,e,n))}const jn=0,T1=1,is=2,xi=3;class Pl{constructor(e,n,i,r){this.parent=e,this.children=n,this.dom=i,this.contentDOM=r,this.dirty=jn,i.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,i){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,i=this.posAtStart;;n++){let r=this.children[n];if(r==e)return i;i+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,i){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(i<0){let s,a;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(a)+a.size:this.posAtStart}else{let s,a;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(a):this.posAtEnd}let r;if(e==this.dom&&this.contentDOM)r=n>Lt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){r=!1;break}if(s.previousSibling)break}if(r==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){r=!0;break}if(s.nextSibling)break}}return r??i>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let i=!0,r=e;r;r=r.parentNode){let s=this.getDesc(r),a;if(s&&(!n||s.node))if(i&&(a=s.nodeDOM)&&!(a.nodeType==1?a.contains(e.nodeType==1?e:e.parentNode):a==e))i=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let i=n;i;i=i.parent)if(i==this)return n}posFromDOM(e,n,i){for(let r=e;r;r=r.parentNode){let s=this.getDesc(r);if(s)return s.localPosFromDOM(e,n,i)}return-1}descAt(e){for(let n=0,i=0;n<this.children.length;n++){let r=this.children[n],s=i+r.size;if(i==e&&s!=i){for(;!r.border&&r.children.length;)for(let a=0;a<r.children.length;a++){let o=r.children[a];if(o.size){r=o;break}}return r}if(e<s)return r.descAt(e-i-r.border);i=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let i=0,r=0;for(let s=0;i<this.children.length;i++){let a=this.children[i],o=s+a.size;if(o>e||a instanceof Rk){r=e-s;break}s=o}if(r)return this.children[i].domFromPos(r-this.children[i].border,n);for(let s;i&&!(s=this.children[i-1]).size&&s instanceof Mk&&s.side>=0;i--);if(n<=0){let s,a=!0;for(;s=i?this.children[i-1]:null,!(!s||s.dom.parentNode==this.contentDOM);i--,a=!1);return s&&n&&a&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?Lt(s.dom)+1:0}}else{let s,a=!0;for(;s=i<this.children.length?this.children[i]:null,!(!s||s.dom.parentNode==this.contentDOM);i++,a=!1);return s&&a&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?Lt(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,i=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,s=-1;for(let a=i,o=0;;o++){let l=this.children[o],u=a+l.size;if(r==-1&&e<=u){let c=a+l.border;if(e>=c&&n<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,c);e=a;for(let h=o;h>0;h--){let d=this.children[h-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){r=Lt(d.dom)+1;break}e-=d.size}r==-1&&(r=0)}if(r>-1&&(u>n||o==this.children.length-1)){n=u;for(let c=o+1;c<this.children.length;c++){let h=this.children[c];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){s=Lt(h.dom);break}n+=h.size}s==-1&&(s=this.contentDOM.childNodes.length);break}a=u}return{node:this.contentDOM,from:e,to:n,fromOffset:r,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:i}=this.domFromPos(e,0);if(n.nodeType!=1||i==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[i]}setSelection(e,n,i,r=!1){let s=Math.min(e,n),a=Math.max(e,n);for(let p=0,m=0;p<this.children.length;p++){let _=this.children[p],f=m+_.size;if(s>m&&a<f)return _.setSelection(e-m-_.border,n-m-_.border,i,r);m=f}let o=this.domFromPos(e,e?-1:1),l=n==e?o:this.domFromPos(n,n?-1:1),u=i.root.getSelection(),c=i.domSelectionRange(),h=!1;if((Fn||Kt)&&e==n){let{node:p,offset:m}=o;if(p.nodeType==3){if(h=!!(m&&p.nodeValue[m-1]==`
`),h&&m==p.nodeValue.length)for(let _=p,f;_;_=_.parentNode){if(f=_.nextSibling){f.nodeName=="BR"&&(o=l={node:f.parentNode,offset:Lt(f)+1});break}let v=_.pmViewDesc;if(v&&v.node&&v.node.isBlock)break}}else{let _=p.childNodes[m-1];h=_&&(_.nodeName=="BR"||_.contentEditable=="false")}}if(Fn&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(r=!0)}if(!(r||h&&Kt)&&ks(o.node,o.offset,c.anchorNode,c.anchorOffset)&&ks(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((u.extend||e==n)&&!(h&&Fn)){u.collapse(o.node,o.offset);try{e!=n&&u.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(e>n){let m=o;o=l,l=m}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(o.node,o.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let i=0,r=0;r<this.children.length;r++){let s=this.children[r],a=i+s.size;if(i==a?e<=a&&n>=i:e<a&&n>i){let o=i+s.border,l=a-s.border;if(e>=o&&n<=l){this.dirty=e==i||n==a?is:T1,e==o&&n==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=xi:s.markDirty(e-o,n-o);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?is:xi}i=a}this.dirty=is}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let i=e==1?is:T1;n.dirty<i&&(n.dirty=i)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Mk extends Pl{constructor(e,n,i,r){let s,a=n.type.toDOM;if(typeof a=="function"&&(a=a(i,()=>{if(!s)return r;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(a.nodeType!=1){let o=document.createElement("span");o.appendChild(a),a=o}a.contentEditable="false",a.classList.add("ProseMirror-widget")}super(e,[],a,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==jn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class g5 extends Pl{constructor(e,n,i,r){super(e,[],n,null),this.textDOM=i,this.text=r}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Cs extends Pl{constructor(e,n,i,r,s){super(e,[],i,r),this.mark=n,this.spec=s}static create(e,n,i,r){let s=r.nodeViews[n.type.name],a=s&&s(n,r,i);return(!a||!a.dom)&&(a=Rs.renderSpec(document,n.type.spec.toDOM(n,i),null,n.attrs)),new Cs(e,n,a.dom,a.contentDOM||a.dom,a)}parseRule(){return this.dirty&xi||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=xi&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=jn){let i=this.parent;for(;!i.node;)i=i.parent;i.dirty<this.dirty&&(i.dirty=this.dirty),this.dirty=jn}}slice(e,n,i){let r=Cs.create(this.parent,this.mark,!0,i),s=this.children,a=this.size;n<a&&(s=pm(s,n,a,i)),e>0&&(s=pm(s,0,e,i));for(let o=0;o<s.length;o++)s[o].parent=r;return r.children=s,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Or extends Pl{constructor(e,n,i,r,s,a,o,l,u){super(e,[],s,a),this.node=n,this.outerDeco=i,this.innerDeco=r,this.nodeDOM=o}static create(e,n,i,r,s,a){let o=s.nodeViews[n.type.name],l,u=o&&o(n,s,()=>{if(!l)return a;if(l.parent)return l.parent.posBeforeChild(l)},i,r),c=u&&u.dom,h=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:h}=Rs.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!h&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let d=c;return c=Nk(c,i,n),u?l=new v5(e,n,i,r,c,h||null,d,u,s,a+1):n.isText?new cd(e,n,i,r,c,d,s):new Or(e,n,i,r,c,h||null,d,s,a+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let i=this.children[n];if(this.dom.contains(i.dom.parentNode)){e.contentElement=i.dom.parentNode;break}}e.contentElement||(e.getContent=()=>ie.empty)}return e}matchesNode(e,n,i){return this.dirty==jn&&e.eq(this.node)&&jc(n,this.outerDeco)&&i.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let i=this.node.inlineContent,r=n,s=e.composing?this.localCompositionInfo(e,n):null,a=s&&s.pos>-1?s:null,o=s&&s.pos<0,l=new y5(this,a&&a.node,e);S5(this.node,this.innerDeco,(u,c,h)=>{u.spec.marks?l.syncToMarks(u.spec.marks,i,e):u.type.side>=0&&!h&&l.syncToMarks(c==this.node.childCount?$e.none:this.node.child(c).marks,i,e),l.placeWidget(u,e,r)},(u,c,h,d)=>{l.syncToMarks(u.marks,i,e);let p;l.findNodeMatch(u,c,h,d)||o&&e.state.selection.from>r&&e.state.selection.to<r+u.nodeSize&&(p=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(u,c,h,p,e)||l.updateNextNode(u,c,h,e,d,r)||l.addNode(u,c,h,e,r),r+=u.nodeSize}),l.syncToMarks([],i,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==is)&&(a&&this.protectLocalComposition(e,a),Ok(this.contentDOM,this.children,e),Mo&&x5(this.dom))}localCompositionInfo(e,n){let{from:i,to:r}=e.state.selection;if(!(e.state.selection instanceof Ce)||i<n||r>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let a=s.nodeValue,o=k5(this.node.content,a,i-n,r-n);return o<0?null:{node:s,pos:o,text:a}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:i,text:r}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let a=new g5(this,s,n,r);e.input.compositionNodes.push(a),this.children=pm(this.children,i,i+r.length,e,a)}update(e,n,i,r){return this.dirty==xi||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,i,r),!0)}updateInner(e,n,i,r){this.updateOuterDeco(n),this.node=e,this.innerDeco=i,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=jn}updateOuterDeco(e){if(jc(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,i=this.dom;this.dom=Pk(this.dom,this.nodeDOM,fm(this.outerDeco,this.node,n),fm(e,this.node,n)),this.dom!=i&&(i.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function M1(t,e,n,i,r){Nk(i,e,t);let s=new Or(void 0,t,e,n,i,i,i,r,0);return s.contentDOM&&s.updateChildren(r,0),s}class cd extends Or{constructor(e,n,i,r,s,a,o){super(e,n,i,r,s,null,a,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,i,r){return this.dirty==xi||this.dirty!=jn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=jn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=jn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,i){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,i)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,i){let r=this.node.cut(e,n),s=document.createTextNode(r.text);return new cd(this.parent,r,this.outerDeco,this.innerDeco,s,s,i)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=xi)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Rk extends Pl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==jn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class v5 extends Or{constructor(e,n,i,r,s,a,o,l,u,c){super(e,n,i,r,s,a,o,u,c),this.spec=l}update(e,n,i,r){if(this.dirty==xi)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,i);return s&&this.updateInner(e,n,i,r),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,i,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,i,r){this.spec.setSelection?this.spec.setSelection(e,n,i.root):super.setSelection(e,n,i,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Ok(t,e,n){let i=t.firstChild,r=!1;for(let s=0;s<e.length;s++){let a=e[s],o=a.dom;if(o.parentNode==t){for(;o!=i;)i=R1(i),r=!0;i=i.nextSibling}else r=!0,t.insertBefore(o,i);if(a instanceof Cs){let l=i?i.previousSibling:t.lastChild;Ok(a.contentDOM,a.children,n),i=l?l.nextSibling:t.firstChild}}for(;i;)i=R1(i),r=!0;r&&n.trackWrites==t&&(n.trackWrites=null)}const Ra=function(t){t&&(this.nodeName=t)};Ra.prototype=Object.create(null);const rs=[new Ra];function fm(t,e,n){if(t.length==0)return rs;let i=n?rs[0]:new Ra,r=[i];for(let s=0;s<t.length;s++){let a=t[s].type.attrs;if(a){a.nodeName&&r.push(i=new Ra(a.nodeName));for(let o in a){let l=a[o];l!=null&&(n&&r.length==1&&r.push(i=new Ra(e.isInline?"span":"div")),o=="class"?i.class=(i.class?i.class+" ":"")+l:o=="style"?i.style=(i.style?i.style+";":"")+l:o!="nodeName"&&(i[o]=l))}}}return r}function Pk(t,e,n,i){if(n==rs&&i==rs)return e;let r=e;for(let s=0;s<i.length;s++){let a=i[s],o=n[s];if(s){let l;o&&o.nodeName==a.nodeName&&r!=t&&(l=r.parentNode)&&l.nodeName.toLowerCase()==a.nodeName||(l=document.createElement(a.nodeName),l.pmIsDeco=!0,l.appendChild(r),o=rs[0]),r=l}_5(r,o||rs[0],a)}return r}function _5(t,e,n){for(let i in e)i!="class"&&i!="style"&&i!="nodeName"&&!(i in n)&&t.removeAttribute(i);for(let i in n)i!="class"&&i!="style"&&i!="nodeName"&&n[i]!=e[i]&&t.setAttribute(i,n[i]);if(e.class!=n.class){let i=e.class?e.class.split(" ").filter(Boolean):[],r=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&t.classList.remove(i[s]);for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&t.classList.add(r[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=i.exec(e.style);)t.style.removeProperty(r[1])}n.style&&(t.style.cssText+=n.style)}}function Nk(t,e,n){return Pk(t,t,rs,fm(e,n,t.nodeType!=1))}function jc(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function R1(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class y5{constructor(e,n,i){this.lock=n,this.view=i,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=b5(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let i=e;i<n;i++)this.top.children[i].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,i){let r=0,s=this.stack.length>>1,a=Math.min(s,e.length);for(;r<a&&(r==s-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&e[r].type.spec.spanning!==!1;)r++;for(;r<s;)this.destroyRest(),this.top.dirty=jn,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let o=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let u=this.top.children[l];if(u.matchesMark(e[s])&&!this.isLocked(u.dom)){o=l;break}}if(o>-1)o>this.index&&(this.changed=!0,this.destroyBetween(this.index,o)),this.top=this.top.children[this.index];else{let l=Cs.create(this.top,e[s],n,i);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,i,r){let s=-1,a;if(r>=this.preMatch.index&&(a=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&a.matchesNode(e,n,i))s=this.top.children.indexOf(a,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let u=this.top.children[o];if(u.matchesNode(e,n,i)&&!this.preMatch.matched.has(u)){s=o;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,i,r,s){let a=this.top.children[r];return a.dirty==xi&&a.dom==a.contentDOM&&(a.dirty=is),a.update(e,n,i,s)?(this.destroyBetween(this.index,r),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let i=e.pmViewDesc;if(i){for(let r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==i)return r}return-1}e=n}}updateNextNode(e,n,i,r,s,a){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof Or){let u=this.preMatch.matched.get(l);if(u!=null&&u!=s)return!1;let c=l.dom,h,d=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=xi&&jc(n,l.outerDeco));if(!d&&l.update(e,n,i,r))return this.destroyBetween(this.index,o),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(h=this.recreateWrapper(l,e,n,i,r,a)))return this.destroyBetween(this.index,o),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=is,h.updateChildren(r,a+1),h.dirty=jn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,i,r,s,a){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!jc(i,e.outerDeco)||!r.eq(e.innerDeco))return null;let o=Or.create(this.top,n,i,r,s,a);if(o.contentDOM){o.children=e.children,e.children=[];for(let l of o.children)l.parent=o}return e.destroy(),o}addNode(e,n,i,r,s){let a=Or.create(this.top,e,n,i,r,s);a.contentDOM&&a.updateChildren(r,s+1),this.top.children.splice(this.index++,0,a),this.changed=!0}placeWidget(e,n,i){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let s=new Mk(this.top,e,n,i);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Cs;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof cd)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Kt||Tt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let i=document.createElement(e);e=="IMG"&&(i.className="ProseMirror-separator",i.alt=""),e=="BR"&&(i.className="ProseMirror-trailingBreak");let r=new Rk(this.top,[],i,null);n!=this.top?n.children.push(r):n.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function b5(t,e){let n=e,i=n.children.length,r=t.childCount,s=new Map,a=[];e:for(;r>0;){let o;for(;;)if(i){let u=n.children[i-1];if(u instanceof Cs)n=u,i=u.children.length;else{o=u,i--;break}}else{if(n==e)break e;i=n.parent.children.indexOf(n),n=n.parent}let l=o.node;if(l){if(l!=t.child(r-1))break;--r,s.set(o,r),a.push(o)}}return{index:r,matched:s,matches:a.reverse()}}function w5(t,e){return t.type.side-e.type.side}function S5(t,e,n,i){let r=e.locals(t),s=0;if(r.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);i(c,r,e.forChild(s,c),u),s+=c.nodeSize}return}let a=0,o=[],l=null;for(let u=0;;){let c,h;for(;a<r.length&&r[a].to==s;){let f=r[a++];f.widget&&(c?(h||(h=[c])).push(f):c=f)}if(c)if(h){h.sort(w5);for(let f=0;f<h.length;f++)n(h[f],u,!!l)}else n(c,u,!!l);let d,p;if(l)p=-1,d=l,l=null;else if(u<t.childCount)p=u,d=t.child(u++);else break;for(let f=0;f<o.length;f++)o[f].to<=s&&o.splice(f--,1);for(;a<r.length&&r[a].from<=s&&r[a].to>s;)o.push(r[a++]);let m=s+d.nodeSize;if(d.isText){let f=m;a<r.length&&r[a].from<f&&(f=r[a].from);for(let v=0;v<o.length;v++)o[v].to<f&&(f=o[v].to);f<m&&(l=d.cut(f-s),d=d.cut(0,f-s),m=f,p=-1)}else for(;a<r.length&&r[a].to<m;)a++;let _=d.isInline&&!d.isLeaf?o.filter(f=>!f.inline):o.slice();i(d,_,e.forChild(s,d),p),s=m}}function x5(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function k5(t,e,n,i){for(let r=0,s=0;r<t.childCount&&s<=i;){let a=t.child(r++),o=s;if(s+=a.nodeSize,!a.isText)continue;let l=a.text;for(;r<t.childCount;){let u=t.child(r++);if(s+=u.nodeSize,!u.isText)break;l+=u.text}if(s>=n){if(s>=i&&l.slice(i-e.length-o,i-o)==e)return i-e.length;let u=o<i?l.lastIndexOf(e,i-o-1):-1;if(u>=0&&u+e.length+o>=n)return o+u;if(n==i&&l.length>=i+e.length-o&&l.slice(i-o,i-o+e.length)==e)return i}}return-1}function pm(t,e,n,i,r){let s=[];for(let a=0,o=0;a<t.length;a++){let l=t[a],u=o,c=o+=l.size;u>=n||c<=e?s.push(l):(u<e&&s.push(l.slice(0,e-u,i)),r&&(s.push(r),r=void 0),c>n&&s.push(l.slice(n-u,l.size,i)))}return s}function vg(t,e=null){let n=t.domSelectionRange(),i=t.state.doc;if(!n.focusNode)return null;let r=t.docView.nearestDesc(n.focusNode),s=r&&r.size==0,a=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(a<0)return null;let o=i.resolve(a),l,u;if(ud(n)){for(l=a;r&&!r.node;)r=r.parent;let h=r.node;if(r&&h.isAtom&&be.isSelectable(h)&&r.parent&&!(h.isInline&&Y4(n.focusNode,n.focusOffset,r.dom))){let d=r.posBefore;u=new be(a==d?o:i.resolve(d))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let h=a,d=a;for(let p=0;p<n.rangeCount;p++){let m=n.getRangeAt(p);h=Math.min(h,t.docView.posFromDOM(m.startContainer,m.startOffset,1)),d=Math.max(d,t.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(h<0)return null;[l,a]=d==t.state.selection.anchor?[d,h]:[h,d],o=i.resolve(a)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let c=i.resolve(l);if(!u){let h=e=="pointer"||t.state.selection.head<o.pos&&!s?1:-1;u=_g(t,c,o,h)}return u}function Ik(t){return t.editable?t.hasFocus():Bk(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Vi(t,e=!1){let n=t.state.selection;if(Lk(t,n),!!Ik(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Tt){let i=t.domSelectionRange(),r=t.domObserver.currentSelection;if(i.anchorNode&&r.anchorNode&&ks(i.anchorNode,i.anchorOffset,r.anchorNode,r.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)E5(t);else{let{anchor:i,head:r}=n,s,a;O1&&!(n instanceof Ce)&&(n.$from.parent.inlineContent||(s=P1(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(a=P1(t,n.to))),t.docView.setSelection(i,r,t,e),O1&&(s&&N1(s),a&&N1(a)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&C5(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const O1=Kt||Tt&&Sk<63;function P1(t,e){let{node:n,offset:i}=t.docView.domFromPos(e,0),r=i<n.childNodes.length?n.childNodes[i]:null,s=i?n.childNodes[i-1]:null;if(Kt&&r&&r.contentEditable=="false")return bf(r);if((!r||r.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(r)return bf(r);if(s)return bf(s)}}function bf(t){return t.contentEditable="true",Kt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function N1(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function C5(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),i=n.anchorNode,r=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=i||n.anchorOffset!=r)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Ik(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function E5(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,i=n.nodeName=="IMG";i?e.collapse(n.parentNode,Lt(n)+1):e.collapse(n,0),!i&&!t.state.selection.visible&&fn&&Rr<=11&&(n.disabled=!0,n.disabled=!1)}function Lk(t,e){if(e instanceof be){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(I1(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else I1(t)}function I1(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function _g(t,e,n,i){return t.someProp("createSelectionBetween",r=>r(t,e,n))||Ce.between(e,n,i)}function L1(t){return t.editable&&!t.hasFocus()?!1:Bk(t)}function Bk(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function D5(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return ks(e.node,e.offset,n.anchorNode,n.anchorOffset)}function mm(t,e){let{$anchor:n,$head:i}=t.selection,r=e>0?n.max(i):n.min(i),s=r.parent.inlineContent?r.depth?t.doc.resolve(e>0?r.after():r.before()):null:r;return s&&Re.findFrom(s,e)}function or(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function B1(t,e,n){let i=t.state.selection;if(i instanceof Ce)if(n.indexOf("s")>-1){let{$head:r}=i,s=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let a=t.state.doc.resolve(r.pos+s.nodeSize*(e<0?-1:1));return or(t,new Ce(i.$anchor,a))}else if(i.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let r=mm(t.state,e);return r&&r instanceof be?or(t,r):!1}else if(!(On&&n.indexOf("m")>-1)){let r=i.$head,s=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter,a;if(!s||s.isText)return!1;let o=e<0?r.pos-s.nodeSize:r.pos;return s.isAtom||(a=t.docView.descAt(o))&&!a.contentDOM?be.isSelectable(s)?or(t,new be(e<0?t.state.doc.resolve(r.pos-s.nodeSize):r)):Ol?or(t,new Ce(t.state.doc.resolve(e<0?o:o+s.nodeSize))):!1:!1}}else return!1;else{if(i instanceof be&&i.node.isInline)return or(t,new Ce(e>0?i.$to:i.$from));{let r=mm(t.state,e);return r?or(t,r):!1}}}function Hc(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Oa(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Fs(t,e){return e<0?A5(t):T5(t)}function A5(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let r,s,a=!1;for(Fn&&n.nodeType==1&&i<Hc(n)&&Oa(n.childNodes[i],-1)&&(a=!0);;)if(i>0){if(n.nodeType!=1)break;{let o=n.childNodes[i-1];if(Oa(o,-1))r=n,s=--i;else if(o.nodeType==3)n=o,i=n.nodeValue.length;else break}}else{if(zk(n))break;{let o=n.previousSibling;for(;o&&Oa(o,-1);)r=n.parentNode,s=Lt(o),o=o.previousSibling;if(o)n=o,i=Hc(n);else{if(n=n.parentNode,n==t.dom)break;i=0}}}a?gm(t,n,i):r&&gm(t,r,s)}function T5(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let r=Hc(n),s,a;for(;;)if(i<r){if(n.nodeType!=1)break;let o=n.childNodes[i];if(Oa(o,1))s=n,a=++i;else break}else{if(zk(n))break;{let o=n.nextSibling;for(;o&&Oa(o,1);)s=o.parentNode,a=Lt(o)+1,o=o.nextSibling;if(o)n=o,i=0,r=Hc(n);else{if(n=n.parentNode,n==t.dom)break;i=r=0}}}s&&gm(t,s,a)}function zk(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function M5(t,e){for(;t&&e==t.childNodes.length&&!Rl(t);)e=Lt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function R5(t,e){for(;t&&!e&&!Rl(t);)e=Lt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function gm(t,e,n){if(e.nodeType!=3){let s,a;(a=M5(e,n))?(e=a,n=0):(s=R5(e,n))&&(e=s,n=s.nodeValue.length)}let i=t.domSelection();if(!i)return;if(ud(i)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),i.removeAllRanges(),i.addRange(s)}else i.extend&&i.extend(e,n);t.domObserver.setCurSelection();let{state:r}=t;setTimeout(()=>{t.state==r&&Vi(t)},50)}function z1(t,e){let n=t.state.doc.resolve(e);if(!(Tt||xk)&&n.parent.inlineContent){let r=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),a=(s.top+s.bottom)/2;if(a>r.top&&a<r.bottom&&Math.abs(s.left-r.left)>1)return s.left<r.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),a=(s.top+s.bottom)/2;if(a>r.top&&a<r.bottom&&Math.abs(s.left-r.left)>1)return s.left>r.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function F1(t,e,n){let i=t.state.selection;if(i instanceof Ce&&!i.empty||n.indexOf("s")>-1||On&&n.indexOf("m")>-1)return!1;let{$from:r,$to:s}=i;if(!r.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let a=mm(t.state,e);if(a&&a instanceof be)return or(t,a)}if(!r.parent.inlineContent){let a=e<0?r:s,o=i instanceof wn?Re.near(a,e):Re.findFrom(a,e);return o?or(t,o):!1}return!1}function j1(t,e){if(!(t.state.selection instanceof Ce))return!0;let{$head:n,$anchor:i,empty:r}=t.state.selection;if(!n.sameParent(i))return!0;if(!r)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let a=t.state.tr;return e<0?a.delete(n.pos-s.nodeSize,n.pos):a.delete(n.pos,n.pos+s.nodeSize),t.dispatch(a),!0}return!1}function H1(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function O5(t){if(!Kt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let i=e.firstChild;H1(t,i,"true"),setTimeout(()=>H1(t,i,"false"),20)}return!1}function P5(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function N5(t,e){let n=e.keyCode,i=P5(e);if(n==8||On&&n==72&&i=="c")return j1(t,-1)||Fs(t,-1);if(n==46&&!e.shiftKey||On&&n==68&&i=="c")return j1(t,1)||Fs(t,1);if(n==13||n==27)return!0;if(n==37||On&&n==66&&i=="c"){let r=n==37?z1(t,t.state.selection.from)=="ltr"?-1:1:-1;return B1(t,r,i)||Fs(t,r)}else if(n==39||On&&n==70&&i=="c"){let r=n==39?z1(t,t.state.selection.from)=="ltr"?1:-1:1;return B1(t,r,i)||Fs(t,r)}else{if(n==38||On&&n==80&&i=="c")return F1(t,-1,i)||Fs(t,-1);if(n==40||On&&n==78&&i=="c")return O5(t)||F1(t,1,i)||Fs(t,1);if(i==(On?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function yg(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:i,openStart:r,openEnd:s}=e;for(;r>1&&s>1&&i.childCount==1&&i.firstChild.childCount==1;){r--,s--;let p=i.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),i=p.content}let a=t.someProp("clipboardSerializer")||Rs.fromSchema(t.state.schema),o=Vk(),l=o.createElement("div");l.appendChild(a.serializeFragment(i,{document:o}));let u=l.firstChild,c,h=0;for(;u&&u.nodeType==1&&(c=Wk[u.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let m=o.createElement(c[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),h++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${r} ${s}${h?` -${h}`:""} ${JSON.stringify(n)}`);let d=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:d,slice:e}}function Fk(t,e,n,i,r){let s=r.parent.type.spec.code,a,o;if(!n&&!e)return null;let l=!!e&&(i||s||!n);if(l){if(t.someProp("transformPastedText",d=>{e=d(e,s||i,t)}),s)return o=new he(ie.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",d=>{o=d(o,t,!0)}),o;let h=t.someProp("clipboardTextParser",d=>d(e,r,i,t));if(h)o=h;else{let d=r.marks(),{schema:p}=t.state,m=Rs.fromSchema(p);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(_=>{let f=a.appendChild(document.createElement("p"));_&&f.appendChild(m.serializeNode(p.text(_,d)))})}}else t.someProp("transformPastedHTML",h=>{n=h(n,t)}),a=z5(n),Ol&&F5(a);let u=a&&a.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let h=+c[3];h>0;h--){let d=a.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;a=d}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||$i.fromSchema(t.state.schema)).parseSlice(a,{preserveWhitespace:!!(l||c),context:r,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!I5.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)o=j5($1(o,+c[1],+c[2]),c[4]);else if(o=he.maxOpen(L5(o.content,r),!0),o.openStart||o.openEnd){let h=0,d=0;for(let p=o.content.firstChild;h<o.openStart&&!p.type.spec.isolating;h++,p=p.firstChild);for(let p=o.content.lastChild;d<o.openEnd&&!p.type.spec.isolating;d++,p=p.lastChild);o=$1(o,h,d)}return t.someProp("transformPasted",h=>{o=h(o,t,l)}),o}const I5=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function L5(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.index(n)),s,a=[];if(t.forEach(o=>{if(!a)return;let l=r.findWrapping(o.type),u;if(!l)return a=null;if(u=a.length&&s.length&&Hk(l,s,o,a[a.length-1],0))a[a.length-1]=u;else{a.length&&(a[a.length-1]=$k(a[a.length-1],s.length));let c=jk(o,l);a.push(c),r=r.matchType(c.type),s=l}}),a)return ie.from(a)}return t}function jk(t,e,n=0){for(let i=e.length-1;i>=n;i--)t=e[i].create(null,ie.from(t));return t}function Hk(t,e,n,i,r){if(r<t.length&&r<e.length&&t[r]==e[r]){let s=Hk(t,e,n,i.lastChild,r+1);if(s)return i.copy(i.content.replaceChild(i.childCount-1,s));if(i.contentMatchAt(i.childCount).matchType(r==t.length-1?n.type:t[r+1]))return i.copy(i.content.append(ie.from(jk(n,t,r+1))))}}function $k(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,$k(t.lastChild,e-1)),i=t.contentMatchAt(t.childCount).fillBefore(ie.empty,!0);return t.copy(n.append(i))}function vm(t,e,n,i,r,s){let a=e<0?t.firstChild:t.lastChild,o=a.content;return t.childCount>1&&(s=0),r<i-1&&(o=vm(o,e,n,i,r+1,s)),r>=n&&(o=e<0?a.contentMatchAt(0).fillBefore(o,s<=r).append(o):o.append(a.contentMatchAt(a.childCount).fillBefore(ie.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,a.copy(o))}function $1(t,e,n){return e<t.openStart&&(t=new he(vm(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new he(vm(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const Wk={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let W1=null;function Vk(){return W1||(W1=document.implementation.createHTMLDocument("title"))}let wf=null;function B5(t){let e=window.trustedTypes;return e?(wf||(wf=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),wf.createHTML(t)):t}function z5(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=Vk().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(t),r;if((r=i&&Wk[i[1].toLowerCase()])&&(t=r.map(s=>"<"+s+">").join("")+t+r.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=B5(t),r)for(let s=0;s<r.length;s++)n=n.querySelector(r[s])||n;return n}function F5(t){let e=t.querySelectorAll(Tt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let i=e[n];i.childNodes.length==1&&i.textContent==""&&i.parentNode&&i.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),i)}}function j5(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,i;try{i=JSON.parse(e)}catch{return t}let{content:r,openStart:s,openEnd:a}=t;for(let o=i.length-2;o>=0;o-=2){let l=n.nodes[i[o]];if(!l||l.hasRequiredAttrs())break;r=ie.from(l.create(i[o+1],r)),s++,a++}return new he(r,s,a)}const tn={},nn={},H5={touchstart:!0,touchmove:!0};class $5{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function W5(t){for(let e in tn){let n=tn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=i=>{G5(t,i)&&!bg(t,i)&&(t.editable||!(i.type in nn))&&n(t,i)},H5[e]?{passive:!0}:void 0)}Kt&&t.dom.addEventListener("input",()=>null),_m(t)}function yr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function V5(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function _m(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=i=>bg(t,i))})}function bg(t,e){return t.someProp("handleDOMEvents",n=>{let i=n[e.type];return i?i(t,e)||e.defaultPrevented:!1})}function G5(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function U5(t,e){!bg(t,e)&&tn[e.type]&&(t.editable||!(e.type in nn))&&tn[e.type](t,e)}nn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Uk(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(zi&&Tt&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Mo&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let i=Date.now();t.input.lastIOSEnter=i,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==i&&(t.someProp("handleKeyDown",r=>r(t,Qr(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",i=>i(t,n))||N5(t,n)?n.preventDefault():yr(t,"key")};nn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};nn.keypress=(t,e)=>{let n=e;if(Uk(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||On&&n.metaKey)return;if(t.someProp("handleKeyPress",r=>r(t,n))){n.preventDefault();return}let i=t.state.selection;if(!(i instanceof Ce)||!i.$from.sameParent(i.$to)){let r=String.fromCharCode(n.charCode),s=()=>t.state.tr.insertText(r).scrollIntoView();!/[\r\n]/.test(r)&&!t.someProp("handleTextInput",a=>a(t,i.$from.pos,i.$to.pos,r,s))&&t.dispatch(s()),n.preventDefault()}};function hd(t){return{left:t.clientX,top:t.clientY}}function q5(t,e){let n=e.x-t.clientX,i=e.y-t.clientY;return n*n+i*i<100}function wg(t,e,n,i,r){if(i==-1)return!1;let s=t.state.doc.resolve(i);for(let a=s.depth+1;a>0;a--)if(t.someProp(e,o=>a>s.depth?o(t,n,s.nodeAfter,s.before(a),r,!0):o(t,n,s.node(a),s.before(a),r,!1)))return!0;return!1}function vo(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let i=t.state.tr.setSelection(e);i.setMeta("pointer",!0),t.dispatch(i)}function K5(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),i=n.nodeAfter;return i&&i.isAtom&&be.isSelectable(i)?(vo(t,new be(n)),!0):!1}function J5(t,e){if(e==-1)return!1;let n=t.state.selection,i,r;n instanceof be&&(i=n.node);let s=t.state.doc.resolve(e);for(let a=s.depth+1;a>0;a--){let o=a>s.depth?s.nodeAfter:s.node(a);if(be.isSelectable(o)){i&&n.$from.depth>0&&a>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?r=s.before(n.$from.depth):r=s.before(a);break}}return r!=null?(vo(t,be.create(t.state.doc,r)),!0):!1}function Z5(t,e,n,i,r){return wg(t,"handleClickOn",e,n,i)||t.someProp("handleClick",s=>s(t,e,i))||(r?J5(t,n):K5(t,n))}function Y5(t,e,n,i){return wg(t,"handleDoubleClickOn",e,n,i)||t.someProp("handleDoubleClick",r=>r(t,e,i))}function X5(t,e,n,i){return wg(t,"handleTripleClickOn",e,n,i)||t.someProp("handleTripleClick",r=>r(t,e,i))||Q5(t,n,i)}function Q5(t,e,n){if(n.button!=0)return!1;let i=t.state.doc;if(e==-1)return i.inlineContent?(vo(t,Ce.create(i,0,i.content.size)),!0):!1;let r=i.resolve(e);for(let s=r.depth+1;s>0;s--){let a=s>r.depth?r.nodeAfter:r.node(s),o=r.before(s);if(a.inlineContent)vo(t,Ce.create(i,o+1,o+1+a.content.size));else if(be.isSelectable(a))vo(t,be.create(i,o));else continue;return!0}}function Sg(t){return $c(t)}const Gk=On?"metaKey":"ctrlKey";tn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let i=Sg(t),r=Date.now(),s="singleClick";r-t.input.lastClick.time<500&&q5(n,t.input.lastClick)&&!n[Gk]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:r,x:n.clientX,y:n.clientY,type:s,button:n.button};let a=t.posAtCoords(hd(n));a&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new eM(t,a,n,!!i)):(s=="doubleClick"?Y5:X5)(t,a.pos,a.inside,n)?n.preventDefault():yr(t,"pointer"))};class eM{constructor(e,n,i,r){this.view=e,this.pos=n,this.event=i,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!i[Gk],this.allowDefault=i.shiftKey;let s,a;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),a=n.inside;else{let c=e.state.doc.resolve(n.pos);s=c.parent,a=c.depth?c.before():0}const o=r?null:i.target,l=o?e.docView.nearestDesc(o,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:u}=e.state;(i.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof be&&u.from<=a&&u.to>a)&&(this.mightDrag={node:s,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Fn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),yr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Vi(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(hd(e))),this.updateAllowDefault(e),this.allowDefault||!n?yr(this.view,"pointer"):Z5(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Kt&&this.mightDrag&&!this.mightDrag.node.isAtom||Tt&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(vo(this.view,Re.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):yr(this.view,"pointer")}move(e){this.updateAllowDefault(e),yr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}tn.touchstart=t=>{t.input.lastTouch=Date.now(),Sg(t),yr(t,"pointer")};tn.touchmove=t=>{t.input.lastTouch=Date.now(),yr(t,"pointer")};tn.contextmenu=t=>Sg(t);function Uk(t,e){return t.composing?!0:Kt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const tM=zi?5e3:-1;nn.compositionstart=nn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Ce&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(i=>i.type.spec.inclusive===!1)||Tt&&xk&&nM(t)))t.markCursor=t.state.storedMarks||n.marks(),$c(t,!0),t.markCursor=null;else if($c(t,!e.selection.empty),Fn&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let i=t.domSelectionRange();for(let r=i.focusNode,s=i.focusOffset;r&&r.nodeType==1&&s!=0;){let a=s<0?r.lastChild:r.childNodes[s-1];if(!a)break;if(a.nodeType==3){let o=t.domSelection();o&&o.collapse(a,a.nodeValue.length);break}else r=a,s=-1}}t.input.composing=!0}qk(t,tM)};function nM(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let i=e.childNodes[n];return i.nodeType==1&&i.contentEditable=="false"}nn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,qk(t,20))};function qk(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>$c(t),e))}function Kk(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=rM());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function iM(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=J4(e.focusNode,e.focusOffset),i=Z4(e.focusNode,e.focusOffset);if(n&&i&&n!=i){let r=i.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(n==s||i==s)return s;if(!r||!r.isText(i.nodeValue))return i;if(t.input.compositionNode==i){let a=n.pmViewDesc;if(!(!a||!a.isText(n.nodeValue)))return i}}return n||i}function rM(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function $c(t,e=!1){if(!(zi&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Kk(t),e||t.docView&&t.docView.dirty){let n=vg(t),i=t.state.selection;return n&&!n.eq(i)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!i.$from.node(i.$from.sharedDepth(i.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function sM(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),r=document.createRange();r.selectNodeContents(e),t.dom.blur(),i.removeAllRanges(),i.addRange(r),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const cl=fn&&Rr<15||Mo&&e5<604;tn.copy=nn.cut=(t,e)=>{let n=e,i=t.state.selection,r=n.type=="cut";if(i.empty)return;let s=cl?null:n.clipboardData,a=i.content(),{dom:o,text:l}=yg(t,a);s?(n.preventDefault(),s.clearData(),s.setData("text/html",o.innerHTML),s.setData("text/plain",l)):sM(t,o),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function oM(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function aM(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,i=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus();let r=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),i.parentNode&&i.parentNode.removeChild(i),n?hl(t,i.value,null,r,e):hl(t,i.textContent,i.innerHTML,r,e)},50)}function hl(t,e,n,i,r){let s=Fk(t,e,n,i,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,r,s||he.empty)))return!0;if(!s)return!1;let a=oM(s),o=a?t.state.tr.replaceSelectionWith(a,i):t.state.tr.replaceSelection(s);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Jk(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}nn.paste=(t,e)=>{let n=e;if(t.composing&&!zi)return;let i=cl?null:n.clipboardData,r=t.input.shiftKey&&t.input.lastKeyCode!=45;i&&hl(t,Jk(i),i.getData("text/html"),r,n)?n.preventDefault():aM(t,n)};class Zk{constructor(e,n,i){this.slice=e,this.move=n,this.node=i}}const lM=On?"altKey":"ctrlKey";function Yk(t,e){let n=t.someProp("dragCopies",i=>!i(e));return n??!e[lM]}tn.dragstart=(t,e)=>{let n=e,i=t.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let r=t.state.selection,s=r.empty?null:t.posAtCoords(hd(n)),a;if(!(s&&s.pos>=r.from&&s.pos<=(r instanceof be?r.to-1:r.to))){if(i&&i.mightDrag)a=be.create(t.state.doc,i.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let h=t.docView.nearestDesc(n.target,!0);h&&h.node.type.spec.draggable&&h!=t.docView&&(a=be.create(t.state.doc,h.posBefore))}}let o=(a||t.state.selection).content(),{dom:l,text:u,slice:c}=yg(t,o);(!n.dataTransfer.files.length||!Tt||Sk>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(cl?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",cl||n.dataTransfer.setData("text/plain",u),t.dragging=new Zk(c,Yk(t,n),a)};tn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};nn.dragover=nn.dragenter=(t,e)=>e.preventDefault();nn.drop=(t,e)=>{try{uM(t,e,t.dragging)}finally{t.dragging=null}};function uM(t,e,n){if(!e.dataTransfer)return;let i=t.posAtCoords(hd(e));if(!i)return;let r=t.state.doc.resolve(i.pos),s=n&&n.slice;s?t.someProp("transformPasted",p=>{s=p(s,t,!1)}):s=Fk(t,Jk(e.dataTransfer),cl?null:e.dataTransfer.getData("text/html"),!1,r);let a=!!(n&&Yk(t,e));if(t.someProp("handleDrop",p=>p(t,e,s||he.empty,a))){e.preventDefault();return}if(!s)return;e.preventDefault();let o=s?tk(t.state.doc,r.pos,s):r.pos;o==null&&(o=r.pos);let l=t.state.tr;if(a){let{node:p}=n;p?p.replace(l):l.deleteSelection()}let u=l.mapping.map(o),c=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=l.doc;if(c?l.replaceRangeWith(u,u,s.content.firstChild):l.replaceRange(u,u,s),l.doc.eq(h))return;let d=l.doc.resolve(u);if(c&&be.isSelectable(s.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(s.content.firstChild))l.setSelection(new be(d));else{let p=l.mapping.map(o);l.mapping.maps[l.mapping.maps.length-1].forEach((m,_,f,v)=>p=v),l.setSelection(_g(t,d,l.doc.resolve(p)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}tn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Vi(t)},20))};tn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};tn.beforeinput=(t,e)=>{if(Tt&&zi&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:i}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=i||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Qr(8,"Backspace")))))return;let{$cursor:r}=t.state.selection;r&&r.pos>0&&t.dispatch(t.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let t in nn)tn[t]=nn[t];function dl(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Wc{constructor(e,n){this.toDOM=e,this.spec=n||ps,this.side=this.spec.side||0}map(e,n,i,r){let{pos:s,deleted:a}=e.mapResult(n.from+r,this.side<0?-1:1);return a?null:new nt(s-i,s-i,this)}valid(){return!0}eq(e){return this==e||e instanceof Wc&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&dl(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Pr{constructor(e,n){this.attrs=e,this.spec=n||ps}map(e,n,i,r){let s=e.map(n.from+r,this.spec.inclusiveStart?-1:1)-i,a=e.map(n.to+r,this.spec.inclusiveEnd?1:-1)-i;return s>=a?null:new nt(s,a,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Pr&&dl(this.attrs,e.attrs)&&dl(this.spec,e.spec)}static is(e){return e.type instanceof Pr}destroy(){}}class xg{constructor(e,n){this.attrs=e,this.spec=n||ps}map(e,n,i,r){let s=e.mapResult(n.from+r,1);if(s.deleted)return null;let a=e.mapResult(n.to+r,-1);return a.deleted||a.pos<=s.pos?null:new nt(s.pos-i,a.pos-i,this)}valid(e,n){let{index:i,offset:r}=e.content.findIndex(n.from),s;return r==n.from&&!(s=e.child(i)).isText&&r+s.nodeSize==n.to}eq(e){return this==e||e instanceof xg&&dl(this.attrs,e.attrs)&&dl(this.spec,e.spec)}destroy(){}}class nt{constructor(e,n,i){this.from=e,this.to=n,this.type=i}copy(e,n){return new nt(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,i){return this.type.map(e,this,n,i)}static widget(e,n,i){return new nt(e,e,new Wc(n,i))}static inline(e,n,i,r){return new nt(e,n,new Pr(i,r))}static node(e,n,i,r){return new nt(e,n,new xg(i,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof Pr}get widget(){return this.type instanceof Wc}}const Ws=[],ps={};class We{constructor(e,n){this.local=e.length?e:Ws,this.children=n.length?n:Ws}static create(e,n){return n.length?Vc(n,e,0,ps):Wt}find(e,n,i){let r=[];return this.findInner(e??0,n??1e9,r,0,i),r}findInner(e,n,i,r,s){for(let a=0;a<this.local.length;a++){let o=this.local[a];o.from<=n&&o.to>=e&&(!s||s(o.spec))&&i.push(o.copy(o.from+r,o.to+r))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<n&&this.children[a+1]>e){let o=this.children[a]+1;this.children[a+2].findInner(e-o,n-o,i,r+o,s)}}map(e,n,i){return this==Wt||e.maps.length==0?this:this.mapInner(e,n,0,0,i||ps)}mapInner(e,n,i,r,s){let a;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(e,i,r);l&&l.type.valid(n,l)?(a||(a=[])).push(l):s.onRemove&&s.onRemove(this.local[o].spec)}return this.children.length?cM(this.children,a||[],e,n,i,r,s):a?new We(a.sort(ms),Ws):Wt}add(e,n){return n.length?this==Wt?We.create(e,n):this.addInner(e,n,0):this}addInner(e,n,i){let r,s=0;e.forEach((o,l)=>{let u=l+i,c;if(c=Qk(n,o,u)){for(r||(r=this.children.slice());s<r.length&&r[s]<l;)s+=3;r[s]==l?r[s+2]=r[s+2].addInner(o,c,u+1):r.splice(s,0,l,l+o.nodeSize,Vc(c,o,u+1,ps)),s+=3}});let a=Xk(s?eC(n):n,-i);for(let o=0;o<a.length;o++)a[o].type.valid(e,a[o])||a.splice(o--,1);return new We(a.length?this.local.concat(a).sort(ms):this.local,r||this.children)}remove(e){return e.length==0||this==Wt?this:this.removeInner(e,0)}removeInner(e,n){let i=this.children,r=this.local;for(let s=0;s<i.length;s+=3){let a,o=i[s]+n,l=i[s+1]+n;for(let c=0,h;c<e.length;c++)(h=e[c])&&h.from>o&&h.to<l&&(e[c]=null,(a||(a=[])).push(h));if(!a)continue;i==this.children&&(i=this.children.slice());let u=i[s+2].removeInner(a,o+1);u!=Wt?i[s+2]=u:(i.splice(s,3),s-=3)}if(r.length){for(let s=0,a;s<e.length;s++)if(a=e[s])for(let o=0;o<r.length;o++)r[o].eq(a,n)&&(r==this.local&&(r=this.local.slice()),r.splice(o--,1))}return i==this.children&&r==this.local?this:r.length||i.length?new We(r,i):Wt}forChild(e,n){if(this==Wt)return this;if(n.isLeaf)return We.empty;let i,r;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(i=this.children[o+2]);break}let s=e+1,a=s+n.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<a&&l.to>s&&l.type instanceof Pr){let u=Math.max(s,l.from)-s,c=Math.min(a,l.to)-s;u<c&&(r||(r=[])).push(l.copy(u,c))}}if(r){let o=new We(r.sort(ms),Ws);return i?new dr([o,i]):o}return i||Wt}eq(e){if(this==e)return!0;if(!(e instanceof We)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return kg(this.localsInner(e))}localsInner(e){if(this==Wt)return Ws;if(e.inlineContent||!this.local.some(Pr.is))return this.local;let n=[];for(let i=0;i<this.local.length;i++)this.local[i].type instanceof Pr||n.push(this.local[i]);return n}forEachSet(e){e(this)}}We.empty=new We([],[]);We.removeOverlap=kg;const Wt=We.empty;class dr{constructor(e){this.members=e}map(e,n){const i=this.members.map(r=>r.map(e,n,ps));return dr.from(i)}forChild(e,n){if(n.isLeaf)return We.empty;let i=[];for(let r=0;r<this.members.length;r++){let s=this.members[r].forChild(e,n);s!=Wt&&(s instanceof dr?i=i.concat(s.members):i.push(s))}return dr.from(i)}eq(e){if(!(e instanceof dr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,i=!0;for(let r=0;r<this.members.length;r++){let s=this.members[r].localsInner(e);if(s.length)if(!n)n=s;else{i&&(n=n.slice(),i=!1);for(let a=0;a<s.length;a++)n.push(s[a])}}return n?kg(i?n:n.sort(ms)):Ws}static from(e){switch(e.length){case 0:return Wt;case 1:return e[0];default:return new dr(e.every(n=>n instanceof We)?e:e.reduce((n,i)=>n.concat(i instanceof We?i:i.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function cM(t,e,n,i,r,s,a){let o=t.slice();for(let u=0,c=s;u<n.maps.length;u++){let h=0;n.maps[u].forEach((d,p,m,_)=>{let f=_-m-(p-d);for(let v=0;v<o.length;v+=3){let g=o[v+1];if(g<0||d>g+c-h)continue;let y=o[v]+c-h;p>=y?o[v+1]=d<=y?-2:-1:d>=c&&f&&(o[v]+=f,o[v+1]+=f)}h+=f}),c=n.maps[u].map(c,-1)}let l=!1;for(let u=0;u<o.length;u+=3)if(o[u+1]<0){if(o[u+1]==-2){l=!0,o[u+1]=-1;continue}let c=n.map(t[u]+s),h=c-r;if(h<0||h>=i.content.size){l=!0;continue}let d=n.map(t[u+1]+s,-1),p=d-r,{index:m,offset:_}=i.content.findIndex(h),f=i.maybeChild(m);if(f&&_==h&&_+f.nodeSize==p){let v=o[u+2].mapInner(n,f,c+1,t[u]+s+1,a);v!=Wt?(o[u]=h,o[u+1]=p,o[u+2]=v):(o[u+1]=-2,l=!0)}else l=!0}if(l){let u=hM(o,t,e,n,r,s,a),c=Vc(u,i,0,a);e=c.local;for(let h=0;h<o.length;h+=3)o[h+1]<0&&(o.splice(h,3),h-=3);for(let h=0,d=0;h<c.children.length;h+=3){let p=c.children[h];for(;d<o.length&&o[d]<p;)d+=3;o.splice(d,0,c.children[h],c.children[h+1],c.children[h+2])}}return new We(e.sort(ms),o)}function Xk(t,e){if(!e||!t.length)return t;let n=[];for(let i=0;i<t.length;i++){let r=t[i];n.push(new nt(r.from+e,r.to+e,r.type))}return n}function hM(t,e,n,i,r,s,a){function o(l,u){for(let c=0;c<l.local.length;c++){let h=l.local[c].map(i,r,u);h?n.push(h):a.onRemove&&a.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)o(l.children[c+2],l.children[c]+u+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&o(t[l+2],e[l]+s+1);return n}function Qk(t,e,n){if(e.isLeaf)return null;let i=n+e.nodeSize,r=null;for(let s=0,a;s<t.length;s++)(a=t[s])&&a.from>n&&a.to<i&&((r||(r=[])).push(a),t[s]=null);return r}function eC(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Vc(t,e,n,i){let r=[],s=!1;e.forEach((o,l)=>{let u=Qk(t,o,l+n);if(u){s=!0;let c=Vc(u,o,n+l+1,i);c!=Wt&&r.push(l,l+o.nodeSize,c)}});let a=Xk(s?eC(t):t,-n).sort(ms);for(let o=0;o<a.length;o++)a[o].type.valid(e,a[o])||(i.onRemove&&i.onRemove(a[o].spec),a.splice(o--,1));return a.length||r.length?new We(a,r):Wt}function ms(t,e){return t.from-e.from||t.to-e.to}function kg(t){let e=t;for(let n=0;n<e.length-1;n++){let i=e[n];if(i.from!=i.to)for(let r=n+1;r<e.length;r++){let s=e[r];if(s.from==i.from){s.to!=i.to&&(e==t&&(e=t.slice()),e[r]=s.copy(s.from,i.to),V1(e,r+1,s.copy(i.to,s.to)));continue}else{s.from<i.to&&(e==t&&(e=t.slice()),e[n]=i.copy(i.from,s.from),V1(e,r,i.copy(s.from,i.to)));break}}}return e}function V1(t,e,n){for(;e<t.length&&ms(n,t[e])>0;)e++;t.splice(e,0,n)}function Sf(t){let e=[];return t.someProp("decorations",n=>{let i=n(t.state);i&&i!=Wt&&e.push(i)}),t.cursorWrapper&&e.push(We.create(t.state.doc,[t.cursorWrapper.deco])),dr.from(e)}const dM={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},fM=fn&&Rr<=11;class pM{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class mM{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new pM,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(i=>{for(let r=0;r<i.length;r++)this.queue.push(i[r]);fn&&Rr<=11&&i.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),fM&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,dM)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(L1(this.view)){if(this.suppressingSelectionUpdates)return Vi(this.view);if(fn&&Rr<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&ks(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,i;for(let s=e.focusNode;s;s=To(s))n.add(s);for(let s=e.anchorNode;s;s=To(s))if(n.has(s)){i=s;break}let r=i&&this.view.docView.nearestDesc(i);if(r&&r.ignoreMutation({type:"selection",target:i.nodeType==3?i.parentNode:i}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let i=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(i)&&L1(e)&&!this.ignoreSelectionChange(i),s=-1,a=-1,o=!1,l=[];if(e.editable)for(let c=0;c<n.length;c++){let h=this.registerMutation(n[c],l);h&&(s=s<0?h.from:Math.min(h.from,s),a=a<0?h.to:Math.max(h.to,a),h.typeOver&&(o=!0))}if(Fn&&l.length){let c=l.filter(h=>h.nodeName=="BR");if(c.length==2){let[h,d]=c;h.parentNode&&h.parentNode.parentNode==d.parentNode?d.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let d of c){let p=d.parentNode;p&&p.nodeName=="LI"&&(!h||_M(e,h)!=p)&&d.remove()}}}else if((Tt||Kt)&&l.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of l)if(c.nodeName=="BR"&&c.parentNode){let h=c.nextSibling;h&&h.nodeType==1&&h.contentEditable=="false"&&c.parentNode.removeChild(c)}}let u=null;s<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ud(i)&&(u=vg(e))&&u.eq(Re.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Vi(e),this.currentSelection.set(i),e.scrollToSelection()):(s>-1||r)&&(s>-1&&(e.docView.markDirty(s,a),gM(e)),this.handleDOMChange(s,a,o,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(i)||Vi(e),this.currentSelection.set(i))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let i=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(i==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!i||i.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let h=e.addedNodes[c];n.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(i.contentDOM&&i.contentDOM!=i.dom&&!i.contentDOM.contains(e.target))return{from:i.posBefore,to:i.posAfter};let r=e.previousSibling,s=e.nextSibling;if(fn&&Rr<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:h,nextSibling:d}=e.addedNodes[c];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(r=h),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(s=d)}let a=r&&r.parentNode==e.target?Lt(r)+1:0,o=i.localPosFromDOM(e.target,a,-1),l=s&&s.parentNode==e.target?Lt(s):e.target.childNodes.length,u=i.localPosFromDOM(e.target,l,1);return{from:o,to:u}}else return e.type=="attributes"?{from:i.posAtStart-i.border,to:i.posAtEnd+i.border}:(this.lastChangedTextNode=e.target,{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let G1=new WeakMap,U1=!1;function gM(t){if(!G1.has(t)&&(G1.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Fn,U1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),U1=!0}}function q1(t,e){let n=e.startContainer,i=e.startOffset,r=e.endContainer,s=e.endOffset,a=t.domAtPos(t.state.selection.anchor);return ks(a.node,a.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}function vM(t,e){if(e.getComposedRanges){let r=e.getComposedRanges(t.root)[0];if(r)return q1(t,r)}let n;function i(r){r.preventDefault(),r.stopImmediatePropagation(),n=r.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",i,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",i,!0),n?q1(t,n):null}function _M(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let i=t.docView.nearestDesc(n,!0);if(i&&i.node.isBlock)return n}return null}function yM(t,e,n){let{node:i,fromOffset:r,toOffset:s,from:a,to:o}=t.docView.parseRange(e,n),l=t.domSelectionRange(),u,c=l.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:l.anchorOffset}],ud(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Tt&&t.input.lastKeyCode===8)for(let f=s;f>r;f--){let v=i.childNodes[f-1],g=v.pmViewDesc;if(v.nodeName=="BR"&&!g){s=f;break}if(!g||g.size)break}let h=t.state.doc,d=t.someProp("domParser")||$i.fromSchema(t.state.schema),p=h.resolve(a),m=null,_=d.parse(i,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:r,to:s,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:bM,context:p});if(u&&u[0].pos!=null){let f=u[0].pos,v=u[1]&&u[1].pos;v==null&&(v=f),m={anchor:f+a,head:v+a}}return{doc:_,sel:m,from:a,to:o}}function bM(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Kt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Kt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const wM=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function SM(t,e,n,i,r){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let k=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,S=vg(t,k);if(S&&!t.state.selection.eq(S)){if(Tt&&zi&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",A=>A(t,Qr(13,"Enter"))))return;let E=t.state.tr.setSelection(S);k=="pointer"?E.setMeta("pointer",!0):k=="key"&&E.scrollIntoView(),s&&E.setMeta("composition",s),t.dispatch(E)}return}let a=t.state.doc.resolve(e),o=a.sharedDepth(n);e=a.before(o+1),n=t.state.doc.resolve(n).after(o+1);let l=t.state.selection,u=yM(t,e,n),c=t.state.doc,h=c.slice(u.from,u.to),d,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(d=t.state.selection.to,p="end"):(d=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let m=CM(h.content,u.doc.content,u.from,d,p);if(m&&t.input.domChangeCount++,(Mo&&t.input.lastIOSEnter>Date.now()-225||zi)&&r.some(k=>k.nodeType==1&&!wM.test(k.nodeName))&&(!m||m.endA>=m.endB)&&t.someProp("handleKeyDown",k=>k(t,Qr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!m)if(i&&l instanceof Ce&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let k=K1(t,t.state.doc,u.sel);if(k&&!k.eq(t.state.selection)){let S=t.state.tr.setSelection(k);s&&S.setMeta("composition",s),t.dispatch(S)}}return}t.state.selection.from<t.state.selection.to&&m.start==m.endB&&t.state.selection instanceof Ce&&(m.start>t.state.selection.from&&m.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?m.start=t.state.selection.from:m.endA<t.state.selection.to&&m.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(m.endB+=t.state.selection.to-m.endA,m.endA=t.state.selection.to)),fn&&Rr<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>u.from&&u.doc.textBetween(m.start-u.from-1,m.start-u.from+1)==" "&&(m.start--,m.endA--,m.endB--);let _=u.doc.resolveNoCache(m.start-u.from),f=u.doc.resolveNoCache(m.endB-u.from),v=c.resolve(m.start),g=_.sameParent(f)&&_.parent.inlineContent&&v.end()>=m.endA;if((Mo&&t.input.lastIOSEnter>Date.now()-225&&(!g||r.some(k=>k.nodeName=="DIV"||k.nodeName=="P"))||!g&&_.pos<u.doc.content.size&&(!_.sameParent(f)||!_.parent.inlineContent)&&_.pos<f.pos&&!/\S/.test(u.doc.textBetween(_.pos,f.pos,"","")))&&t.someProp("handleKeyDown",k=>k(t,Qr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>m.start&&kM(c,m.start,m.endA,_,f)&&t.someProp("handleKeyDown",k=>k(t,Qr(8,"Backspace")))){zi&&Tt&&t.domObserver.suppressSelectionUpdates();return}Tt&&m.endB==m.start&&(t.input.lastChromeDelete=Date.now()),zi&&!g&&_.start()!=f.start()&&f.parentOffset==0&&_.depth==f.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==m.endA&&(m.endB-=2,f=u.doc.resolveNoCache(m.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(k){return k(t,Qr(13,"Enter"))})},20));let y=m.start,b=m.endA,w=k=>{let S=k||t.state.tr.replace(y,b,u.doc.slice(m.start-u.from,m.endB-u.from));if(u.sel){let E=K1(t,S.doc,u.sel);E&&!(Tt&&t.composing&&E.empty&&(m.start!=m.endB||t.input.lastChromeDelete<Date.now()-100)&&(E.head==y||E.head==S.mapping.map(b)-1)||fn&&E.empty&&E.head==y)&&S.setSelection(E)}return s&&S.setMeta("composition",s),S.scrollIntoView()},x;if(g)if(_.pos==f.pos){fn&&Rr<=11&&_.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Vi(t),20));let k=w(t.state.tr.delete(y,b)),S=c.resolve(m.start).marksAcross(c.resolve(m.endA));S&&k.ensureMarks(S),t.dispatch(k)}else if(m.endA==m.endB&&(x=xM(_.parent.content.cut(_.parentOffset,f.parentOffset),v.parent.content.cut(v.parentOffset,m.endA-v.start())))){let k=w(t.state.tr);x.type=="add"?k.addMark(y,b,x.mark):k.removeMark(y,b,x.mark),t.dispatch(k)}else if(_.parent.child(_.index()).isText&&_.index()==f.index()-(f.textOffset?0:1)){let k=_.parent.textBetween(_.parentOffset,f.parentOffset),S=()=>w(t.state.tr.insertText(k,y,b));t.someProp("handleTextInput",E=>E(t,y,b,k,S))||t.dispatch(S())}else t.dispatch(w());else t.dispatch(w())}function K1(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:_g(t,e.resolve(n.anchor),e.resolve(n.head))}function xM(t,e){let n=t.firstChild.marks,i=e.firstChild.marks,r=n,s=i,a,o,l;for(let c=0;c<i.length;c++)r=i[c].removeFromSet(r);for(let c=0;c<n.length;c++)s=n[c].removeFromSet(s);if(r.length==1&&s.length==0)o=r[0],a="add",l=c=>c.mark(o.addToSet(c.marks));else if(r.length==0&&s.length==1)o=s[0],a="remove",l=c=>c.mark(o.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(l(e.child(c)));if(ie.from(u).eq(t))return{mark:o,type:a}}function kM(t,e,n,i,r){if(n-e<=r.pos-i.pos||xf(i,!0,!1)<r.pos)return!1;let s=t.resolve(e);if(!i.parent.isTextblock){let o=s.nodeAfter;return o!=null&&n==e+o.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let a=t.resolve(xf(s,!0,!0));return!a.parent.isTextblock||a.pos>n||xf(a,!0,!1)<n?!1:i.parent.content.cut(i.parentOffset).eq(a.parent.content)}function xf(t,e,n){let i=t.depth,r=e?t.end():t.pos;for(;i>0&&(e||t.indexAfter(i)==t.node(i).childCount);)i--,r++,e=!1;if(n){let s=t.node(i).maybeChild(t.indexAfter(i));for(;s&&!s.isLeaf;)s=s.firstChild,r++}return r}function CM(t,e,n,i,r){let s=t.findDiffStart(e,n);if(s==null)return null;let{a,b:o}=t.findDiffEnd(e,n+t.size,n+e.size);if(r=="end"){let l=Math.max(0,s-Math.min(a,o));i-=a+l-s}if(a<s&&t.size<e.size){let l=i<=s&&i>=a?s-i:0;s-=l,s&&s<e.size&&J1(e.textBetween(s-1,s+1))&&(s+=l?1:-1),o=s+(o-a),a=s}else if(o<s){let l=i<=s&&i>=o?s-i:0;s-=l,s&&s<t.size&&J1(t.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-o),o=s}return{start:s,endA:a,endB:o}}function J1(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class tC{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new $5,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(ey),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=X1(this),Y1(this),this.nodeViews=Q1(this),this.docView=M1(this.state.doc,Z1(this),Sf(this),this.dom,this),this.domObserver=new mM(this,(i,r,s,a)=>SM(this,i,r,s,a)),this.domObserver.start(),W5(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&_m(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(ey),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let i in this._props)n[i]=this._props[i];n.state=this.state;for(let i in e)n[i]=e[i];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var i;let r=this.state,s=!1,a=!1;e.storedMarks&&this.composing&&(Kk(this),a=!0),this.state=e;let o=r.plugins!=e.plugins||this._props.plugins!=n.plugins;if(o||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=Q1(this);DM(p,this.nodeViews)&&(this.nodeViews=p,s=!0)}(o||n.handleDOMEvents!=this._props.handleDOMEvents)&&_m(this),this.editable=X1(this),Y1(this);let l=Sf(this),u=Z1(this),c=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",h=s||!this.docView.matchesNode(e.doc,u,l);(h||!e.selection.eq(r.selection))&&(a=!0);let d=c=="preserve"&&a&&this.dom.style.overflowAnchor==null&&i5(this);if(a){this.domObserver.stop();let p=h&&(fn||Tt)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&EM(r.selection,e.selection);if(h){let m=Tt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=iM(this)),(s||!this.docView.update(e.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=M1(e.doc,u,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&D5(this))?Vi(this,p):(Lk(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),!((i=this.dragging)===null||i===void 0)&&i.node&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&r5(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof be){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&k1(this,n.getBoundingClientRect(),e)}else k1(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let i=this.state.plugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let i=this.pluginViews[n];i.update&&i.update(this,e)}}updateDraggedNode(e,n){let i=e.node,r=-1;if(this.state.doc.nodeAt(i.from)==i.node)r=i.from;else{let s=i.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==i.node&&(r=s)}this.dragging=new Zk(e.slice,e.move,r<0?void 0:be.create(this.state.doc,r))}someProp(e,n){let i=this._props&&this._props[e],r;if(i!=null&&(r=n?n(i):i))return r;for(let a=0;a<this.directPlugins.length;a++){let o=this.directPlugins[a].props[e];if(o!=null&&(r=n?n(o):o))return r}let s=this.state.plugins;if(s)for(let a=0;a<s.length;a++){let o=s[a].props[e];if(o!=null&&(r=n?n(o):o))return r}}hasFocus(){if(fn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&s5(this.dom),Vi(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return c5(this,e)}coordsAtPos(e,n=1){return Ak(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,i=-1){let r=this.docView.posFromDOM(e,n,i);if(r==null)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,n){return m5(this,n||this.state,e)}pasteHTML(e,n){return hl(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return hl(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return yg(this,e)}destroy(){this.docView&&(V5(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Sf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,q4())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return U5(this,e)}domSelectionRange(){let e=this.domSelection();return e?Kt&&this.root.nodeType===11&&X4(this.dom.ownerDocument)==this.dom&&vM(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}tC.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function Z1(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let i in n)i=="class"?e.class+=" "+n[i]:i=="style"?e.style=(e.style?e.style+";":"")+n[i]:!e[i]&&i!="contenteditable"&&i!="nodeName"&&(e[i]=String(n[i]))}),e.translate||(e.translate="no"),[nt.node(0,t.state.doc.content.size,e)]}function Y1(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:nt.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function X1(t){return!t.someProp("editable",e=>e(t.state)===!1)}function EM(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Q1(t){let e=Object.create(null);function n(i){for(let r in i)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=i[r])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function DM(t,e){let n=0,i=0;for(let r in t){if(t[r]!=e[r])return!0;n++}for(let r in e)i++;return n!=i}function ey(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var zr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Gc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},AM=typeof navigator<"u"&&/Mac/.test(navigator.platform),TM=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Bt=0;Bt<10;Bt++)zr[48+Bt]=zr[96+Bt]=String(Bt);for(var Bt=1;Bt<=24;Bt++)zr[Bt+111]="F"+Bt;for(var Bt=65;Bt<=90;Bt++)zr[Bt]=String.fromCharCode(Bt+32),Gc[Bt]=String.fromCharCode(Bt);for(var kf in zr)Gc.hasOwnProperty(kf)||(Gc[kf]=zr[kf]);function MM(t){var e=AM&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||TM&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Gc:zr)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const RM=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),OM=typeof navigator<"u"&&/Win/.test(navigator.platform);function PM(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let i,r,s,a;for(let o=0;o<e.length-1;o++){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))a=!0;else if(/^a(lt)?$/i.test(l))i=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))RM?a=!0:r=!0;else throw new Error("Unrecognized modifier name: "+l)}return i&&(n="Alt-"+n),r&&(n="Ctrl-"+n),a&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function NM(t){let e=Object.create(null);for(let n in t)e[PM(n)]=t[n];return e}function Cf(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function IM(t){return new Ye({props:{handleKeyDown:nC(t)}})}function nC(t){let e=NM(t);return function(n,i){let r=MM(i),s,a=e[Cf(r,i)];if(a&&a(n.state,n.dispatch,n))return!0;if(r.length==1&&r!=" "){if(i.shiftKey){let o=e[Cf(r,i,!1)];if(o&&o(n.state,n.dispatch,n))return!0}if((i.altKey||i.metaKey||i.ctrlKey)&&!(OM&&i.ctrlKey&&i.altKey)&&(s=zr[i.keyCode])&&s!=r){let o=e[Cf(s,i)];if(o&&o(n.state,n.dispatch,n))return!0}}return!1}}var LM=Object.defineProperty,Cg=(t,e)=>{for(var n in e)LM(t,n,{get:e[n],enumerable:!0})};function dd(t){const{state:e,transaction:n}=t;let{selection:i}=n,{doc:r}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return i},get doc(){return r},get tr(){return i=n.selection,r=n.doc,s=n.storedMarks,n}}}var fd=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:i}=e,{tr:r}=n,s=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([a,o])=>[a,(...u)=>{const c=o(...u)(s);return!r.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(r),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:i,state:r}=this,{view:s}=i,a=[],o=!!t,l=t||r.tr,u=()=>(!o&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(l),a.every(h=>h===!0)),c={...Object.fromEntries(Object.entries(n).map(([h,d])=>[h,(...m)=>{const _=this.buildProps(l,e),f=d(...m)(_);return a.push(f),c}])),run:u};return c}createCan(t){const{rawCommands:e,state:n}=this,i=!1,r=t||n.tr,s=this.buildProps(r,i);return{...Object.fromEntries(Object.entries(e).map(([o,l])=>[o,(...u)=>l(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(r,i)}}buildProps(t,e=!0){const{rawCommands:n,editor:i,state:r}=this,{view:s}=i,a={tr:t,editor:i,view:s,state:dd({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([o,l])=>[o,(...u)=>l(...u)(a)]))}};return a}},qn={};Cg(qn,{blur:()=>BM,clearContent:()=>zM,clearNodes:()=>FM,command:()=>jM,createParagraphNear:()=>HM,cut:()=>$M,deleteCurrentNode:()=>WM,deleteNode:()=>VM,deleteRange:()=>GM,deleteSelection:()=>UM,enter:()=>qM,exitCode:()=>KM,extendMarkRange:()=>JM,first:()=>ZM,focus:()=>XM,forEach:()=>QM,insertContent:()=>eR,insertContentAt:()=>iR,joinBackward:()=>oR,joinDown:()=>sR,joinForward:()=>aR,joinItemBackward:()=>lR,joinItemForward:()=>uR,joinTextblockBackward:()=>cR,joinTextblockForward:()=>hR,joinUp:()=>rR,keyboardShortcut:()=>fR,lift:()=>pR,liftEmptyBlock:()=>mR,liftListItem:()=>gR,newlineInCode:()=>vR,resetAttributes:()=>_R,scrollIntoView:()=>yR,selectAll:()=>bR,selectNodeBackward:()=>wR,selectNodeForward:()=>SR,selectParentNode:()=>xR,selectTextblockEnd:()=>kR,selectTextblockStart:()=>CR,setContent:()=>ER,setMark:()=>qR,setMeta:()=>KR,setNode:()=>JR,setNodeSelection:()=>ZR,setTextDirection:()=>YR,setTextSelection:()=>XR,sinkListItem:()=>QR,splitBlock:()=>eO,splitListItem:()=>tO,toggleList:()=>nO,toggleMark:()=>iO,toggleNode:()=>rO,toggleWrap:()=>sO,undoInputRule:()=>oO,unsetAllMarks:()=>aO,unsetMark:()=>lO,unsetTextDirection:()=>uO,updateAttributes:()=>cO,wrapIn:()=>hO,wrapInList:()=>dO});var BM=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),zM=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),FM=()=>({state:t,tr:e,dispatch:n})=>{const{selection:i}=e,{ranges:r}=i;return n&&r.forEach(({$from:s,$to:a})=>{t.doc.nodesBetween(s.pos,a.pos,(o,l)=>{if(o.type.isText)return;const{doc:u,mapping:c}=e,h=u.resolve(c.map(l)),d=u.resolve(c.map(l+o.nodeSize)),p=h.blockRange(d);if(!p)return;const m=jo(p);if(o.type.isTextblock){const{defaultType:_}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(p.start,_)}(m||m===0)&&e.lift(p,m)})}),!0},jM=t=>e=>t(e),HM=()=>({state:t,dispatch:e})=>vk(t,e),$M=(t,e)=>({editor:n,tr:i})=>{const{state:r}=n,s=r.doc.slice(t.from,t.to);i.deleteRange(t.from,t.to);const a=i.mapping.map(e);return i.insert(a,s.content),i.setSelection(new Ce(i.doc.resolve(Math.max(a-1,0)))),!0},WM=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,i=n.$anchor.node();if(i.content.size>0)return!1;const r=t.selection.$anchor;for(let s=r.depth;s>0;s-=1)if(r.node(s).type===i.type){if(e){const o=r.before(s),l=r.after(s);t.delete(o,l).scrollIntoView()}return!0}return!1};function gt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var VM=t=>({tr:e,state:n,dispatch:i})=>{const r=gt(t,n.schema),s=e.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===r){if(i){const l=s.before(a),u=s.after(a);e.delete(l,u).scrollIntoView()}return!0}return!1},GM=t=>({tr:e,dispatch:n})=>{const{from:i,to:r}=t;return n&&e.delete(i,r),!0},UM=()=>({state:t,dispatch:e})=>hg(t,e),qM=()=>({commands:t})=>t.keyboardShortcut("Enter"),KM=()=>({state:t,dispatch:e})=>O4(t,e);function Eg(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Uc(t,e,n={strict:!0}){const i=Object.keys(e);return i.length?i.every(r=>n.strict?e[r]===t[r]:Eg(e[r])?e[r].test(t[r]):e[r]===t[r]):!0}function iC(t,e,n={}){return t.find(i=>i.type===e&&Uc(Object.fromEntries(Object.keys(n).map(r=>[r,i.attrs[r]])),n))}function ty(t,e,n={}){return!!iC(t,e,n)}function Dg(t,e,n){var i;if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if((!r.node||!r.node.marks.some(c=>c.type===e))&&(r=t.parent.childBefore(t.parentOffset)),!r.node||!r.node.marks.some(c=>c.type===e)||(n=n||((i=r.node.marks[0])==null?void 0:i.attrs),!iC([...r.node.marks],e,n)))return;let a=r.index,o=t.start()+r.offset,l=a+1,u=o+r.node.nodeSize;for(;a>0&&ty([...t.parent.child(a-1).marks],e,n);)a-=1,o-=t.parent.child(a).nodeSize;for(;l<t.parent.childCount&&ty([...t.parent.child(l).marks],e,n);)u+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:u}}function Yi(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var JM=(t,e={})=>({tr:n,state:i,dispatch:r})=>{const s=Yi(t,i.schema),{doc:a,selection:o}=n,{$from:l,from:u,to:c}=o;if(r){const h=Dg(l,s,e);if(h&&h.from<=u&&h.to>=c){const d=Ce.create(a,h.from,h.to);n.setSelection(d)}}return!0},ZM=t=>e=>{const n=typeof t=="function"?t(e):t;for(let i=0;i<n.length;i+=1)if(n[i](e))return!0;return!1};function rC(t){return t instanceof Ce}function ss(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function sC(t,e=null){if(!e)return null;const n=Re.atStart(t),i=Re.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return i;const r=n.from,s=i.to;return e==="all"?Ce.create(t,ss(0,r,s),ss(t.content.size,r,s)):Ce.create(t,ss(e,r,s),ss(e,r,s))}function ny(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function qc(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function YM(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var XM=(t=null,e={})=>({editor:n,view:i,tr:r,dispatch:s})=>{e={scrollIntoView:!0,...e};const a=()=>{(qc()||ny())&&i.dom.focus(),YM()&&!qc()&&!ny()&&i.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(i.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(i.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!rC(n.state.selection))return a(),!0;const o=sC(r.doc,t)||n.state.selection,l=n.state.selection.eq(o);return s&&(l||r.setSelection(o),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),a()),!0},QM=(t,e)=>n=>t.every((i,r)=>e(i,{...n,index:r})),eR=(t,e)=>({tr:n,commands:i})=>i.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),oC=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const i=e[n];i.nodeType===3&&i.nodeValue&&/^(\n\s\s|\n)$/.test(i.nodeValue)?t.removeChild(i):i.nodeType===1&&oC(i)}return t};function va(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return oC(n)}function fl(t,e,n){if(t instanceof Mr||t instanceof ie)return t;n={slice:!0,parseOptions:{},...n};const i=typeof t=="object"&&t!==null,r=typeof t=="string";if(i)try{if(Array.isArray(t)&&t.length>0)return ie.fromArray(t.map(o=>e.nodeFromJSON(o)));const a=e.nodeFromJSON(t);return n.errorOnInvalidContent&&a.check(),a}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),fl("",e,n)}if(r){if(n.errorOnInvalidContent){let a=!1,o="";const l=new Vx({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(a=!0,o=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?$i.fromSchema(l).parseSlice(va(t),n.parseOptions):$i.fromSchema(l).parse(va(t),n.parseOptions),n.errorOnInvalidContent&&a)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const s=$i.fromSchema(e);return n.slice?s.parseSlice(va(t),n.parseOptions).content:s.parse(va(t),n.parseOptions)}return fl("",e,n)}function tR(t,e,n){const i=t.steps.length-1;if(i<e)return;const r=t.steps[i];if(!(r instanceof Dt||r instanceof Rt))return;const s=t.mapping.maps[i];let a=0;s.forEach((o,l,u,c)=>{a===0&&(a=c)}),t.setSelection(Re.near(t.doc.resolve(a),n))}var nR=t=>!("type"in t),iR=(t,e,n)=>({tr:i,dispatch:r,editor:s})=>{var a;if(r){n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let o;const l=f=>{s.emit("contentError",{editor:s,error:f,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{fl(e,s.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(f){l(f)}try{o=fl(e,s.schema,{parseOptions:u,errorOnInvalidContent:(a=n.errorOnInvalidContent)!=null?a:s.options.enableContentCheck})}catch(f){return l(f),!1}let{from:c,to:h}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},d=!0,p=!0;if((nR(o)?o:[o]).forEach(f=>{f.check(),d=d?f.isText&&f.marks.length===0:!1,p=p?f.isBlock:!1}),c===h&&p){const{parent:f}=i.doc.resolve(c);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(c-=1,h+=1)}let _;if(d){if(Array.isArray(e))_=e.map(f=>f.text||"").join("");else if(e instanceof ie){let f="";e.forEach(v=>{v.text&&(f+=v.text)}),_=f}else typeof e=="object"&&e&&e.text?_=e.text:_=e;i.insertText(_,c,h)}else{_=o;const f=i.doc.resolve(c),v=f.node(),g=f.parentOffset===0,y=v.isText||v.isTextblock,b=v.content.size>0;g&&y&&b&&(c=Math.max(0,c-1)),i.replaceWith(c,h,_)}n.updateSelection&&tR(i,i.steps.length-1,-1),n.applyInputRules&&i.setMeta("applyInputRules",{from:c,text:_}),n.applyPasteRules&&i.setMeta("applyPasteRules",{from:c,text:_})}return!0},rR=()=>({state:t,dispatch:e})=>T4(t,e),sR=()=>({state:t,dispatch:e})=>M4(t,e),oR=()=>({state:t,dispatch:e})=>ck(t,e),aR=()=>({state:t,dispatch:e})=>pk(t,e),lR=()=>({state:t,dispatch:e,tr:n})=>{try{const i=od(t.doc,t.selection.$from.pos,-1);return i==null?!1:(n.join(i,2),e&&e(n),!0)}catch{return!1}},uR=()=>({state:t,dispatch:e,tr:n})=>{try{const i=od(t.doc,t.selection.$from.pos,1);return i==null?!1:(n.join(i,2),e&&e(n),!0)}catch{return!1}},cR=()=>({state:t,dispatch:e})=>D4(t,e),hR=()=>({state:t,dispatch:e})=>A4(t,e);function aC(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function dR(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let i,r,s,a;for(let o=0;o<e.length-1;o+=1){const l=e[o];if(/^(cmd|meta|m)$/i.test(l))a=!0;else if(/^a(lt)?$/i.test(l))i=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))qc()||aC()?a=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return i&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),a&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}var fR=t=>({editor:e,view:n,tr:i,dispatch:r})=>{const s=dR(t).split(/-(?!$)/),a=s.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),o=new KeyboardEvent("keydown",{key:a==="Space"?" ":a,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,o))});return l==null||l.steps.forEach(u=>{const c=u.map(i.mapping);c&&r&&i.maybeStep(c)}),!0};function Fr(t,e,n={}){const{from:i,to:r,empty:s}=t.selection,a=e?gt(e,t.schema):null,o=[];t.doc.nodesBetween(i,r,(h,d)=>{if(h.isText)return;const p=Math.max(i,d),m=Math.min(r,d+h.nodeSize);o.push({node:h,from:p,to:m})});const l=r-i,u=o.filter(h=>a?a.name===h.node.type.name:!0).filter(h=>Uc(h.node.attrs,n,{strict:!1}));return s?!!u.length:u.reduce((h,d)=>h+d.to-d.from,0)>=l}var pR=(t,e={})=>({state:n,dispatch:i})=>{const r=gt(t,n.schema);return Fr(n,r,e)?R4(n,i):!1},mR=()=>({state:t,dispatch:e})=>_k(t,e),gR=t=>({state:e,dispatch:n})=>{const i=gt(t,e.schema);return W4(i)(e,n)},vR=()=>({state:t,dispatch:e})=>gk(t,e);function pd(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function iy(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((i,r)=>(n.includes(r)||(i[r]=t[r]),i),{})}var _R=(t,e)=>({tr:n,state:i,dispatch:r})=>{let s=null,a=null;const o=pd(typeof t=="string"?t:t.name,i.schema);if(!o)return!1;o==="node"&&(s=gt(t,i.schema)),o==="mark"&&(a=Yi(t,i.schema));let l=!1;return n.selection.ranges.forEach(u=>{i.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,h)=>{s&&s===c.type&&(l=!0,r&&n.setNodeMarkup(h,void 0,iy(c.attrs,e))),a&&c.marks.length&&c.marks.forEach(d=>{a===d.type&&(l=!0,r&&n.addMark(h,h+c.nodeSize,a.create(iy(d.attrs,e))))})})}),l},yR=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),bR=()=>({tr:t,dispatch:e})=>{if(e){const n=new wn(t.doc);t.setSelection(n)}return!0},wR=()=>({state:t,dispatch:e})=>dk(t,e),SR=()=>({state:t,dispatch:e})=>mk(t,e),xR=()=>({state:t,dispatch:e})=>I4(t,e),kR=()=>({state:t,dispatch:e})=>z4(t,e),CR=()=>({state:t,dispatch:e})=>B4(t,e);function ym(t,e,n={},i={}){return fl(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:i.errorOnInvalidContent})}var ER=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:i={}}={})=>({editor:r,tr:s,dispatch:a,commands:o})=>{const{doc:l}=s;if(i.preserveWhitespace!=="full"){const u=ym(t,r.schema,i,{errorOnInvalidContent:e??r.options.enableContentCheck});return a&&s.replaceWith(0,l.content.size,u).setMeta("preventUpdate",!n),!0}return a&&s.setMeta("preventUpdate",!n),o.insertContentAt({from:0,to:l.content.size},t,{parseOptions:i,errorOnInvalidContent:e??r.options.enableContentCheck})};function lC(t,e){const n=Yi(e,t.schema),{from:i,to:r,empty:s}=t.selection,a=[];s?(t.storedMarks&&a.push(...t.storedMarks),a.push(...t.selection.$head.marks())):t.doc.nodesBetween(i,r,l=>{a.push(...l.marks)});const o=a.find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function uC(t,e){const n=new ok(t);return e.forEach(i=>{i.steps.forEach(r=>{n.step(r)})}),n}function DR(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function AR(t,e,n){const i=[];return t.nodesBetween(e.from,e.to,(r,s)=>{n(r)&&i.push({node:r,pos:s})}),i}function TR(t,e){for(let n=t.depth;n>0;n-=1){const i=t.node(n);if(e(i))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:i}}}function md(t){return e=>TR(e.$from,t)}function ve(t,e,n){return t.config[e]===void 0&&t.parent?ve(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?ve(t.parent,e,n):null}):t.config[e]}function gd(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},i=ve(e,"addExtensions",n);return i?[e,...gd(i())]:e}).flat(10)}function Ag(t,e){const n=Rs.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function cC(t){return typeof t=="function"}function Le(t,e=void 0,...n){return cC(t)?e?t.bind(e)(...n):t(...n):t}function MR(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Ro(t){const e=t.filter(r=>r.type==="extension"),n=t.filter(r=>r.type==="node"),i=t.filter(r=>r.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:i}}function hC(t){const e=[],{nodeExtensions:n,markExtensions:i}=Ro(t),r=[...n,...i],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(a=>{const o={name:a.name,options:a.options,storage:a.storage,extensions:r},l=ve(a,"addGlobalAttributes",o);if(!l)return;l().forEach(c=>{c.types.forEach(h=>{Object.entries(c.attributes).forEach(([d,p])=>{e.push({type:h,name:d,attribute:{...s,...p}})})})})}),r.forEach(a=>{const o={name:a.name,options:a.options,storage:a.storage},l=ve(a,"addAttributes",o);if(!l)return;const u=l();Object.entries(u).forEach(([c,h])=>{const d={...s,...h};typeof(d==null?void 0:d.default)=="function"&&(d.default=d.default()),d!=null&&d.isRequired&&(d==null?void 0:d.default)===void 0&&delete d.default,e.push({type:a.name,name:c,attribute:d})})}),e}function ht(...t){return t.filter(e=>!!e).reduce((e,n)=>{const i={...e};return Object.entries(n).forEach(([r,s])=>{if(!i[r]){i[r]=s;return}if(r==="class"){const o=s?String(s).split(" "):[],l=i[r]?i[r].split(" "):[],u=o.filter(c=>!l.includes(c));i[r]=[...l,...u].join(" ")}else if(r==="style"){const o=s?s.split(";").map(c=>c.trim()).filter(Boolean):[],l=i[r]?i[r].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;l.forEach(c=>{const[h,d]=c.split(":").map(p=>p.trim());u.set(h,d)}),o.forEach(c=>{const[h,d]=c.split(":").map(p=>p.trim());u.set(h,d)}),i[r]=Array.from(u.entries()).map(([c,h])=>`${c}: ${h}`).join("; ")}else i[r]=s}),i},{})}function pl(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,i)=>ht(n,i),{})}function RR(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function ry(t,e){return"style"in t?t:{...t,getAttrs:n=>{const i=t.getAttrs?t.getAttrs(n):t.attrs;if(i===!1)return!1;const r=e.reduce((s,a)=>{const o=a.attribute.parseHTML?a.attribute.parseHTML(n):RR(n.getAttribute(a.name));return o==null?s:{...s,[a.name]:o}},{});return{...i,...r}}}}function sy(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&MR(n)?!1:n!=null))}function oy(t){var e,n;const i={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(i.default=t.attribute.default),((n=t==null?void 0:t.attribute)==null?void 0:n.validate)!==void 0&&(i.validate=t.attribute.validate),[t.name,i]}function dC(t,e){var n;const i=hC(t),{nodeExtensions:r,markExtensions:s}=Ro(t),a=(n=r.find(u=>ve(u,"topNode")))==null?void 0:n.name,o=Object.fromEntries(r.map(u=>{const c=i.filter(v=>v.type===u.name),h={name:u.name,options:u.options,storage:u.storage,editor:e},d=t.reduce((v,g)=>{const y=ve(g,"extendNodeSchema",h);return{...v,...y?y(u):{}}},{}),p=sy({...d,content:Le(ve(u,"content",h)),marks:Le(ve(u,"marks",h)),group:Le(ve(u,"group",h)),inline:Le(ve(u,"inline",h)),atom:Le(ve(u,"atom",h)),selectable:Le(ve(u,"selectable",h)),draggable:Le(ve(u,"draggable",h)),code:Le(ve(u,"code",h)),whitespace:Le(ve(u,"whitespace",h)),linebreakReplacement:Le(ve(u,"linebreakReplacement",h)),defining:Le(ve(u,"defining",h)),isolating:Le(ve(u,"isolating",h)),attrs:Object.fromEntries(c.map(oy))}),m=Le(ve(u,"parseHTML",h));m&&(p.parseDOM=m.map(v=>ry(v,c)));const _=ve(u,"renderHTML",h);_&&(p.toDOM=v=>_({node:v,HTMLAttributes:pl(v,c)}));const f=ve(u,"renderText",h);return f&&(p.toText=f),[u.name,p]})),l=Object.fromEntries(s.map(u=>{const c=i.filter(f=>f.type===u.name),h={name:u.name,options:u.options,storage:u.storage,editor:e},d=t.reduce((f,v)=>{const g=ve(v,"extendMarkSchema",h);return{...f,...g?g(u):{}}},{}),p=sy({...d,inclusive:Le(ve(u,"inclusive",h)),excludes:Le(ve(u,"excludes",h)),group:Le(ve(u,"group",h)),spanning:Le(ve(u,"spanning",h)),code:Le(ve(u,"code",h)),attrs:Object.fromEntries(c.map(oy))}),m=Le(ve(u,"parseHTML",h));m&&(p.parseDOM=m.map(f=>ry(f,c)));const _=ve(u,"renderHTML",h);return _&&(p.toDOM=f=>_({mark:f,HTMLAttributes:pl(f,c)})),[u.name,p]}));return new Vx({topNode:a,nodes:o,marks:l})}function OR(t){const e=t.filter((n,i)=>t.indexOf(n)!==i);return Array.from(new Set(e))}function Kc(t){return t.sort((n,i)=>{const r=ve(n,"priority")||100,s=ve(i,"priority")||100;return r>s?-1:r<s?1:0})}function Tg(t){const e=Kc(gd(t)),n=OR(e.map(i=>i.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}function PR(t,e){const n=Tg(t);return dC(n,e)}function NR(t,e){const n=PR(e),i=va(t);return $i.fromSchema(n).parse(i).toJSON()}function fC(t,e,n){const{from:i,to:r}=e,{blockSeparator:s=`

`,textSerializers:a={}}=n||{};let o="";return t.nodesBetween(i,r,(l,u,c,h)=>{var d;l.isBlock&&u>i&&(o+=s);const p=a==null?void 0:a[l.type.name];if(p)return c&&(o+=p({node:l,pos:u,parent:c,index:h,range:e})),!1;l.isText&&(o+=(d=l==null?void 0:l.text)==null?void 0:d.slice(Math.max(i,u)-u,r-u))}),o}function IR(t,e){const n={from:0,to:t.content.size};return fC(t,n,e)}function pC(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function LR(t,e){const n=gt(e,t.schema),{from:i,to:r}=t.selection,s=[];t.doc.nodesBetween(i,r,o=>{s.push(o)});const a=s.reverse().find(o=>o.type.name===n.name);return a?{...a.attrs}:{}}function mC(t,e){const n=pd(typeof e=="string"?e:e.name,t.schema);return n==="node"?LR(t,e):n==="mark"?lC(t,e):{}}function BR(t,e=JSON.stringify){const n={};return t.filter(i=>{const r=e(i);return Object.prototype.hasOwnProperty.call(n,r)?!1:n[r]=!0})}function zR(t){const e=BR(t);return e.length===1?e:e.filter((n,i)=>!e.filter((s,a)=>a!==i).some(s=>n.oldRange.from>=s.oldRange.from&&n.oldRange.to<=s.oldRange.to&&n.newRange.from>=s.newRange.from&&n.newRange.to<=s.newRange.to))}function gC(t){const{mapping:e,steps:n}=t,i=[];return e.maps.forEach((r,s)=>{const a=[];if(r.ranges.length)r.forEach((o,l)=>{a.push({from:o,to:l})});else{const{from:o,to:l}=n[s];if(o===void 0||l===void 0)return;a.push({from:o,to:l})}a.forEach(({from:o,to:l})=>{const u=e.slice(s).map(o,-1),c=e.slice(s).map(l),h=e.invert().map(u,-1),d=e.invert().map(c);i.push({oldRange:{from:h,to:d},newRange:{from:u,to:c}})})}),zR(i)}function Mg(t,e,n){const i=[];return t===e?n.resolve(t).marks().forEach(r=>{const s=n.resolve(t),a=Dg(s,r.type);a&&i.push({mark:r,...a})}):n.nodesBetween(t,e,(r,s)=>{!r||(r==null?void 0:r.nodeSize)===void 0||i.push(...r.marks.map(a=>({from:s,to:s+r.nodeSize,mark:a})))}),i}var FR=(t,e,n,i=20)=>{const r=t.doc.resolve(n);let s=i,a=null;for(;s>0&&a===null;){const o=r.node(s);(o==null?void 0:o.type.name)===e?a=o:s-=1}return[a,s]};function mu(t,e){return e.nodes[t]||e.marks[t]||null}function Xu(t,e,n){return Object.fromEntries(Object.entries(n).filter(([i])=>{const r=t.find(s=>s.type===e&&s.name===i);return r?r.attribute.keepOnSplit:!1}))}var jR=(t,e=500)=>{let n="";const i=t.parentOffset;return t.parent.nodesBetween(Math.max(0,i-e),i,(r,s,a,o)=>{var l,u;const c=((u=(l=r.type.spec).toText)==null?void 0:u.call(l,{node:r,pos:s,parent:a,index:o}))||r.textContent||"%leaf%";n+=r.isAtom&&!r.isText?c:c.slice(0,Math.max(0,i-s))}),n};function bm(t,e,n={}){const{empty:i,ranges:r}=t.selection,s=e?Yi(e,t.schema):null;if(i)return!!(t.storedMarks||t.selection.$from.marks()).filter(h=>s?s.name===h.type.name:!0).find(h=>Uc(h.attrs,n,{strict:!1}));let a=0;const o=[];if(r.forEach(({$from:h,$to:d})=>{const p=h.pos,m=d.pos;t.doc.nodesBetween(p,m,(_,f)=>{if(!_.isText&&!_.marks.length)return;const v=Math.max(p,f),g=Math.min(m,f+_.nodeSize),y=g-v;a+=y,o.push(..._.marks.map(b=>({mark:b,from:v,to:g})))})}),a===0)return!1;const l=o.filter(h=>s?s.name===h.mark.type.name:!0).filter(h=>Uc(h.mark.attrs,n,{strict:!1})).reduce((h,d)=>h+d.to-d.from,0),u=o.filter(h=>s?h.mark.type!==s&&h.mark.type.excludes(s):!0).reduce((h,d)=>h+d.to-d.from,0);return(l>0?l+u:l)>=a}function HR(t,e,n={}){if(!e)return Fr(t,null,n)||bm(t,null,n);const i=pd(e,t.schema);return i==="node"?Fr(t,e,n):i==="mark"?bm(t,e,n):!1}var $R=(t,e)=>{const{$from:n,$to:i,$anchor:r}=t.selection;if(e){const s=md(o=>o.type.name===e)(t.selection);if(!s)return!1;const a=t.doc.resolve(s.pos+1);return r.pos+1===a.end()}return!(i.parentOffset<i.parent.nodeSize-2||n.pos!==i.pos)},WR=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function ay(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function ly(t,e){const{nodeExtensions:n}=Ro(e),i=n.find(a=>a.name===t);if(!i)return!1;const r={name:i.name,options:i.options,storage:i.storage},s=Le(ve(i,"group",r));return typeof s!="string"?!1:s.split(" ").includes("list")}function vd(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var i;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((i=t.text)!=null?i:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let r=!0;return t.content.forEach(s=>{r!==!1&&(vd(s,{ignoreWhitespace:n,checkChildren:e})||(r=!1))}),r}return!1}function vC(t){return t instanceof be}var _C=class yC{constructor(e){this.position=e}static fromJSON(e){return new yC(e.position)}toJSON(){return{position:this.position}}};function VR(t,e){const n=e.mapping.mapResult(t.position);return{position:new _C(n.pos),mapResult:n}}function GR(t){return new _C(t)}function UR(t,e,n){var i;const{selection:r}=e;let s=null;if(rC(r)&&(s=r.$cursor),s){const o=(i=t.storedMarks)!=null?i:s.marks();return s.parent.type.allowsMarkType(n)&&(!!n.isInSet(o)||!o.some(u=>u.type.excludes(n)))}const{ranges:a}=r;return a.some(({$from:o,$to:l})=>{let u=o.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(o.pos,l.pos,(c,h,d)=>{if(u)return!1;if(c.isInline){const p=!d||d.type.allowsMarkType(n),m=!!n.isInSet(c.marks)||!c.marks.some(_=>_.type.excludes(n));u=p&&m}return!u}),u})}var qR=(t,e={})=>({tr:n,state:i,dispatch:r})=>{const{selection:s}=n,{empty:a,ranges:o}=s,l=Yi(t,i.schema);if(r)if(a){const u=lC(i,l);n.addStoredMark(l.create({...u,...e}))}else o.forEach(u=>{const c=u.$from.pos,h=u.$to.pos;i.doc.nodesBetween(c,h,(d,p)=>{const m=Math.max(p,c),_=Math.min(p+d.nodeSize,h);d.marks.find(v=>v.type===l)?d.marks.forEach(v=>{l===v.type&&n.addMark(m,_,l.create({...v.attrs,...e}))}):n.addMark(m,_,l.create(e))})});return UR(i,n,l)},KR=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),JR=(t,e={})=>({state:n,dispatch:i,chain:r})=>{const s=gt(t,n.schema);let a;return n.selection.$anchor.sameParent(n.selection.$head)&&(a=n.selection.$anchor.parent.attrs),s.isTextblock?r().command(({commands:o})=>w1(s,{...a,...e})(n)?!0:o.clearNodes()).command(({state:o})=>w1(s,{...a,...e})(o,i)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},ZR=t=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,r=ss(t,0,i.content.size),s=be.create(i,r);e.setSelection(s)}return!0},YR=(t,e)=>({tr:n,state:i,dispatch:r})=>{const{selection:s}=i;let a,o;return typeof e=="number"?(a=e,o=e):e&&"from"in e&&"to"in e?(a=e.from,o=e.to):(a=s.from,o=s.to),r&&n.doc.nodesBetween(a,o,(l,u)=>{l.isText||n.setNodeMarkup(u,void 0,{...l.attrs,dir:t})}),!0},XR=t=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,{from:r,to:s}=typeof t=="number"?{from:t,to:t}:t,a=Ce.atStart(i).from,o=Ce.atEnd(i).to,l=ss(r,a,o),u=ss(s,a,o),c=Ce.create(i,l,u);e.setSelection(c)}return!0},QR=t=>({state:e,dispatch:n})=>{const i=gt(t,e.schema);return U4(i)(e,n)};function uy(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const i=n.filter(r=>e==null?void 0:e.includes(r.type.name));t.tr.ensureMarks(i)}}var eO=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:i,editor:r})=>{const{selection:s,doc:a}=e,{$from:o,$to:l}=s,u=r.extensionManager.attributes,c=Xu(u,o.node().type.name,o.node().attrs);if(s instanceof be&&s.node.isBlock)return!o.parentOffset||!Wi(a,o.pos)?!1:(i&&(t&&uy(n,r.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,d=o.depth===0?void 0:DR(o.node(-1).contentMatchAt(o.indexAfter(-1)));let p=h&&d?[{type:d,attrs:c}]:void 0,m=Wi(e.doc,e.mapping.map(o.pos),1,p);if(!p&&!m&&Wi(e.doc,e.mapping.map(o.pos),1,d?[{type:d}]:void 0)&&(m=!0,p=d?[{type:d,attrs:c}]:void 0),i){if(m&&(s instanceof Ce&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,p),d&&!h&&!o.parentOffset&&o.parent.type!==d)){const _=e.mapping.map(o.before()),f=e.doc.resolve(_);o.node(-1).canReplaceWith(f.index(),f.index()+1,d)&&e.setNodeMarkup(e.mapping.map(o.before()),d)}t&&uy(n,r.extensionManager.splittableMarks),e.scrollIntoView()}return m},tO=(t,e={})=>({tr:n,state:i,dispatch:r,editor:s})=>{var a;const o=gt(t,i.schema),{$from:l,$to:u}=i.selection,c=i.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(u))return!1;const h=l.node(-1);if(h.type!==o)return!1;const d=s.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let v=ie.empty;const g=l.index(-1)?1:l.index(-2)?2:3;for(let S=l.depth-g;S>=l.depth-3;S-=1)v=ie.from(l.node(S).copy(v));const y=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,b={...Xu(d,l.node().type.name,l.node().attrs),...e},w=((a=o.contentMatch.defaultType)==null?void 0:a.createAndFill(b))||void 0;v=v.append(ie.from(o.createAndFill(null,w)||void 0));const x=l.before(l.depth-(g-1));n.replace(x,l.after(-y),new he(v,4-g,0));let k=-1;n.doc.nodesBetween(x,n.doc.content.size,(S,E)=>{if(k>-1)return!1;S.isTextblock&&S.content.size===0&&(k=E+1)}),k>-1&&n.setSelection(Ce.near(n.doc.resolve(k))),n.scrollIntoView()}return!0}const p=u.pos===l.end()?h.contentMatchAt(0).defaultType:null,m={...Xu(d,h.type.name,h.attrs),...e},_={...Xu(d,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,u.pos);const f=p?[{type:o,attrs:m},{type:p,attrs:_}]:[{type:o,attrs:m}];if(!Wi(n.doc,l.pos,2))return!1;if(r){const{selection:v,storedMarks:g}=i,{splittableMarks:y}=s.extensionManager,b=g||v.$to.parentOffset&&v.$from.marks();if(n.split(l.pos,2,f).scrollIntoView(),!b||!r)return!0;const w=b.filter(x=>y.includes(x.type.name));n.ensureMarks(w)}return!0},Ef=(t,e)=>{const n=md(a=>a.type===e)(t.selection);if(!n)return!0;const i=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(i===void 0)return!0;const r=t.doc.nodeAt(i);return n.node.type===(r==null?void 0:r.type)&&Gr(t.doc,n.pos)&&t.join(n.pos),!0},Df=(t,e)=>{const n=md(a=>a.type===e)(t.selection);if(!n)return!0;const i=t.doc.resolve(n.start).after(n.depth);if(i===void 0)return!0;const r=t.doc.nodeAt(i);return n.node.type===(r==null?void 0:r.type)&&Gr(t.doc,i)&&t.join(i),!0},nO=(t,e,n,i={})=>({editor:r,tr:s,state:a,dispatch:o,chain:l,commands:u,can:c})=>{const{extensions:h,splittableMarks:d}=r.extensionManager,p=gt(t,a.schema),m=gt(e,a.schema),{selection:_,storedMarks:f}=a,{$from:v,$to:g}=_,y=v.blockRange(g),b=f||_.$to.parentOffset&&_.$from.marks();if(!y)return!1;const w=md(x=>ly(x.type.name,h))(_);if(y.depth>=1&&w&&y.depth-w.depth<=1){if(w.node.type===p)return u.liftListItem(m);if(ly(w.node.type.name,h)&&p.validContent(w.node.content)&&o)return l().command(()=>(s.setNodeMarkup(w.pos,p),!0)).command(()=>Ef(s,p)).command(()=>Df(s,p)).run()}return!n||!b||!o?l().command(()=>c().wrapInList(p,i)?!0:u.clearNodes()).wrapInList(p,i).command(()=>Ef(s,p)).command(()=>Df(s,p)).run():l().command(()=>{const x=c().wrapInList(p,i),k=b.filter(S=>d.includes(S.type.name));return s.ensureMarks(k),x?!0:u.clearNodes()}).wrapInList(p,i).command(()=>Ef(s,p)).command(()=>Df(s,p)).run()},iO=(t,e={},n={})=>({state:i,commands:r})=>{const{extendEmptyMarkRange:s=!1}=n,a=Yi(t,i.schema);return bm(i,a,e)?r.unsetMark(a,{extendEmptyMarkRange:s}):r.setMark(a,e)},rO=(t,e,n={})=>({state:i,commands:r})=>{const s=gt(t,i.schema),a=gt(e,i.schema),o=Fr(i,s,n);let l;return i.selection.$anchor.sameParent(i.selection.$head)&&(l=i.selection.$anchor.parent.attrs),o?r.setNode(a,l):r.setNode(s,{...l,...n})},sO=(t,e={})=>({state:n,commands:i})=>{const r=gt(t,n.schema);return Fr(n,r,e)?i.lift(r):i.wrapIn(r,e)},oO=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let i=0;i<n.length;i+=1){const r=n[i];let s;if(r.spec.isInputRules&&(s=r.getState(t))){if(e){const a=t.tr,o=s.transform;for(let l=o.steps.length-1;l>=0;l-=1)a.step(o.steps[l].invert(o.docs[l]));if(s.text){const l=a.doc.resolve(s.from).marks();a.replaceWith(s.from,s.to,t.schema.text(s.text,l))}else a.delete(s.from,s.to)}return!0}}return!1},aO=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:i,ranges:r}=n;return i||e&&r.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},lO=(t,e={})=>({tr:n,state:i,dispatch:r})=>{var s;const{extendEmptyMarkRange:a=!1}=e,{selection:o}=n,l=Yi(t,i.schema),{$from:u,empty:c,ranges:h}=o;if(!r)return!0;if(c&&a){let{from:d,to:p}=o;const m=(s=u.marks().find(f=>f.type===l))==null?void 0:s.attrs,_=Dg(u,l,m);_&&(d=_.from,p=_.to),n.removeMark(d,p,l)}else h.forEach(d=>{n.removeMark(d.$from.pos,d.$to.pos,l)});return n.removeStoredMark(l),!0},uO=t=>({tr:e,state:n,dispatch:i})=>{const{selection:r}=n;let s,a;return typeof t=="number"?(s=t,a=t):t&&"from"in t&&"to"in t?(s=t.from,a=t.to):(s=r.from,a=r.to),i&&e.doc.nodesBetween(s,a,(o,l)=>{if(o.isText)return;const u={...o.attrs};delete u.dir,e.setNodeMarkup(l,void 0,u)}),!0},cO=(t,e={})=>({tr:n,state:i,dispatch:r})=>{let s=null,a=null;const o=pd(typeof t=="string"?t:t.name,i.schema);if(!o)return!1;o==="node"&&(s=gt(t,i.schema)),o==="mark"&&(a=Yi(t,i.schema));let l=!1;return n.selection.ranges.forEach(u=>{const c=u.$from.pos,h=u.$to.pos;let d,p,m,_;n.selection.empty?i.doc.nodesBetween(c,h,(f,v)=>{s&&s===f.type&&(l=!0,m=Math.max(v,c),_=Math.min(v+f.nodeSize,h),d=v,p=f)}):i.doc.nodesBetween(c,h,(f,v)=>{v<c&&s&&s===f.type&&(l=!0,m=Math.max(v,c),_=Math.min(v+f.nodeSize,h),d=v,p=f),v>=c&&v<=h&&(s&&s===f.type&&(l=!0,r&&n.setNodeMarkup(v,void 0,{...f.attrs,...e})),a&&f.marks.length&&f.marks.forEach(g=>{if(a===g.type&&(l=!0,r)){const y=Math.max(v,c),b=Math.min(v+f.nodeSize,h);n.addMark(y,b,a.create({...g.attrs,...e}))}}))}),p&&(d!==void 0&&r&&n.setNodeMarkup(d,void 0,{...p.attrs,...e}),a&&p.marks.length&&p.marks.forEach(f=>{a===f.type&&r&&n.addMark(m,_,a.create({...f.attrs,...e}))}))}),l},hO=(t,e={})=>({state:n,dispatch:i})=>{const r=gt(t,n.schema);return F4(r,e)(n,i)},dO=(t,e={})=>({state:n,dispatch:i})=>{const r=gt(t,n.schema);return j4(r,e)(n,i)},fO=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(i=>i.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(i=>i!==e):delete this.callbacks[t]),this}once(t,e){const n=(...i)=>{this.off(t,n),e.apply(this,i)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},_d=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},pO=(t,e)=>{if(Eg(e))return e.exec(t);const n=e(t);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=t,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i};function gu(t){var e;const{editor:n,from:i,to:r,text:s,rules:a,plugin:o}=t,{view:l}=n;if(l.composing)return!1;const u=l.state.doc.resolve(i);if(u.parent.type.spec.code||(e=u.nodeBefore||u.nodeAfter)!=null&&e.marks.find(d=>d.type.spec.code))return!1;let c=!1;const h=jR(u)+s;return a.forEach(d=>{if(c)return;const p=pO(h,d.find);if(!p)return;const m=l.state.tr,_=dd({state:l.state,transaction:m}),f={from:i-(p[0].length-s.length),to:r},{commands:v,chain:g,can:y}=new fd({editor:n,state:_});d.handler({state:_,range:f,match:p,commands:v,chain:g,can:y})===null||!m.steps.length||(d.undoable&&m.setMeta(o,{transform:m,from:i,to:r,text:s}),l.dispatch(m),c=!0)}),c}function mO(t){const{editor:e,rules:n}=t,i=new Ye({state:{init(){return null},apply(r,s,a){const o=r.getMeta(i);if(o)return o;const l=r.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=Ag(ie.from(c),a.schema);const{from:h}=l,d=h+c.length;gu({editor:e,from:h,to:d,text:c,rules:n,plugin:i})}),r.selectionSet||r.docChanged?null:s}},props:{handleTextInput(r,s,a,o){return gu({editor:e,from:s,to:a,text:o,rules:n,plugin:i})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:s}=r.state.selection;s&&gu({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:i})}),!1)},handleKeyDown(r,s){if(s.key!=="Enter")return!1;const{$cursor:a}=r.state.selection;return a?gu({editor:e,from:a.pos,to:a.pos,text:`
`,rules:n,plugin:i}):!1}},isInputRules:!0});return i}function gO(t){return Object.prototype.toString.call(t).slice(8,-1)}function vu(t){return gO(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function bC(t,e){const n={...t};return vu(t)&&vu(e)&&Object.keys(e).forEach(i=>{vu(e[i])&&vu(t[i])?n[i]=bC(t[i],e[i]):n[i]=e[i]}),n}var Rg=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Le(ve(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Le(ve(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>bC(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},qr=class wC extends Rg{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new wC(n)}static handleExit({editor:e,mark:n}){const{tr:i}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const a=r.marks();if(!!!a.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const l=a.find(u=>(u==null?void 0:u.type.name)===n.name);return l&&i.removeStoredMark(l),i.insertText(" ",r.pos),e.view.dispatch(i),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function vO(t){return typeof t=="number"}var _O=class{constructor(t){this.find=t.find,this.handler=t.handler}},yO=(t,e,n)=>{if(Eg(e))return[...t.matchAll(e)];const i=e(t,n);return i?i.map(r=>{const s=[r.text];return s.index=r.index,s.input=t,s.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(r.replaceWith)),s}):[]};function bO(t){const{editor:e,state:n,from:i,to:r,rule:s,pasteEvent:a,dropEvent:o}=t,{commands:l,chain:u,can:c}=new fd({editor:e,state:n}),h=[];return n.doc.nodesBetween(i,r,(p,m)=>{var _,f,v,g,y;if((f=(_=p.type)==null?void 0:_.spec)!=null&&f.code||!(p.isText||p.isTextblock||p.isInline))return;const b=(y=(g=(v=p.content)==null?void 0:v.size)!=null?g:p.nodeSize)!=null?y:0,w=Math.max(i,m),x=Math.min(r,m+b);if(w>=x)return;const k=p.isText?p.text||"":p.textBetween(w-m,x-m,void 0,"");yO(k,s.find,a).forEach(E=>{if(E.index===void 0)return;const A=w+E.index+1,M=A+E[0].length,R={from:n.tr.mapping.map(A),to:n.tr.mapping.map(M)},P=s.handler({state:n,range:R,match:E,commands:l,chain:u,can:c,pasteEvent:a,dropEvent:o});h.push(P)})}),h.every(p=>p!==null)}var _u=null,wO=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function SO(t){const{editor:e,rules:n}=t;let i=null,r=!1,s=!1,a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const l=({state:c,from:h,to:d,rule:p,pasteEvt:m})=>{const _=c.tr,f=dd({state:c,transaction:_});if(!(!bO({editor:e,state:f,from:Math.max(h-1,0),to:d.b-1,rule:p,pasteEvent:m,dropEvent:o})||!_.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,_}};return n.map(c=>new Ye({view(h){const d=m=>{var _;i=(_=h.dom.parentElement)!=null&&_.contains(m.target)?h.dom.parentElement:null,i&&(_u=e)},p=()=>{_u&&(_u=null)};return window.addEventListener("dragstart",d),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",d),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(h,d)=>{if(s=i===h.dom.parentElement,o=d,!s){const p=_u;p!=null&&p.isEditable&&setTimeout(()=>{const m=p.state.selection;m&&p.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(h,d)=>{var p;const m=(p=d.clipboardData)==null?void 0:p.getData("text/html");return a=d,r=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(h,d,p)=>{const m=h[0],_=m.getMeta("uiEvent")==="paste"&&!r,f=m.getMeta("uiEvent")==="drop"&&!s,v=m.getMeta("applyPasteRules"),g=!!v;if(!_&&!f&&!g)return;if(g){let{text:w}=v;typeof w=="string"?w=w:w=Ag(ie.from(w),p.schema);const{from:x}=v,k=x+w.length,S=wO(w);return l({rule:c,state:p,from:x,to:{b:k},pasteEvt:S})}const y=d.doc.content.findDiffStart(p.doc.content),b=d.doc.content.findDiffEnd(p.doc.content);if(!(!vO(y)||!b||y===b.b))return l({rule:c,state:p,from:y,to:b,pasteEvt:a})}}))}var yd=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=Tg(t),this.schema=dC(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:mu(e.name,this.schema)},i=ve(e,"addCommands",n);return i?{...t,...i()}:t},{})}get plugins(){const{editor:t}=this;return Kc([...this.extensions].reverse()).flatMap(i=>{const r={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:mu(i.name,this.schema)},s=[],a=ve(i,"addKeyboardShortcuts",r);let o={};if(i.type==="mark"&&ve(i,"exitable",r)&&(o.ArrowRight=()=>qr.handleExit({editor:t,mark:i})),a){const d=Object.fromEntries(Object.entries(a()).map(([p,m])=>[p,()=>m({editor:t})]));o={...o,...d}}const l=IM(o);s.push(l);const u=ve(i,"addInputRules",r);if(ay(i,t.options.enableInputRules)&&u){const d=u();if(d&&d.length){const p=mO({editor:t,rules:d}),m=Array.isArray(p)?p:[p];s.push(...m)}}const c=ve(i,"addPasteRules",r);if(ay(i,t.options.enablePasteRules)&&c){const d=c();if(d&&d.length){const p=SO({editor:t,rules:d});s.push(...p)}}const h=ve(i,"addProseMirrorPlugins",r);if(h){const d=h();s.push(...d)}return s})}get attributes(){return hC(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Ro(this.extensions);return Object.fromEntries(e.filter(n=>!!ve(n,"addNodeView")).map(n=>{const i=this.attributes.filter(l=>l.type===n.name),r={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:gt(n.name,this.schema)},s=ve(n,"addNodeView",r);if(!s)return[];const a=s();if(!a)return[];const o=(l,u,c,h,d)=>{const p=pl(l,i);return a({node:l,view:u,getPos:c,decorations:h,innerDecorations:d,editor:t,extension:n,HTMLAttributes:p})};return[n.name,o]}))}dispatchTransaction(t){const{editor:e}=this;return Kc([...this.extensions].reverse()).reduceRight((i,r)=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:mu(r.name,this.schema)},a=ve(r,"dispatchTransaction",s);return a?o=>{a.call(s,{transaction:o,next:i})}:i},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=Ro(this.extensions);return Object.fromEntries(e.filter(n=>!!ve(n,"addMarkView")).map(n=>{const i=this.attributes.filter(o=>o.type===n.name),r={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Yi(n.name,this.schema)},s=ve(n,"addMarkView",r);if(!s)return[];const a=(o,l,u)=>{const c=pl(o,i);return s()({mark:o,view:l,inline:u,editor:t,extension:n,HTMLAttributes:c,updateAttributes:h=>{LO(o,t,h)}})};return[n.name,a]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:mu(e.name,this.schema)};e.type==="mark"&&((n=Le(ve(e,"keepOnSplit",i)))==null||n)&&this.splittableMarks.push(e.name);const r=ve(e,"onBeforeCreate",i),s=ve(e,"onCreate",i),a=ve(e,"onUpdate",i),o=ve(e,"onSelectionUpdate",i),l=ve(e,"onTransaction",i),u=ve(e,"onFocus",i),c=ve(e,"onBlur",i),h=ve(e,"onDestroy",i);r&&this.editor.on("beforeCreate",r),s&&this.editor.on("create",s),a&&this.editor.on("update",a),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),h&&this.editor.on("destroy",h)})}};yd.resolve=Tg;yd.sort=Kc;yd.flatten=gd;var xO={};Cg(xO,{ClipboardTextSerializer:()=>xC,Commands:()=>kC,Delete:()=>CC,Drop:()=>EC,Editable:()=>DC,FocusEvents:()=>TC,Keymap:()=>MC,Paste:()=>RC,Tabindex:()=>OC,TextDirection:()=>PC,focusEventsPluginKey:()=>AC});var Xe=class SC extends Rg{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new SC(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},xC=Xe.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ye({key:new dt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:i,selection:r}=e,{ranges:s}=r,a=Math.min(...s.map(c=>c.$from.pos)),o=Math.max(...s.map(c=>c.$to.pos)),l=pC(n);return fC(i,{from:a,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),kC=Xe.create({name:"commands",addCommands(){return{...qn}}}),CC=Xe.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,i,r;const s=()=>{var a,o,l,u;if((u=(l=(o=(a=this.editor.options.coreExtensionOptions)==null?void 0:a.delete)==null?void 0:o.filterTransaction)==null?void 0:l.call(o,t))!=null?u:t.getMeta("y-sync$"))return;const c=uC(t.before,[t,...e]);gC(c).forEach(p=>{c.mapping.mapResult(p.oldRange.from).deletedAfter&&c.mapping.mapResult(p.oldRange.to).deletedBefore&&c.before.nodesBetween(p.oldRange.from,p.oldRange.to,(m,_)=>{const f=_+m.nodeSize-2,v=p.oldRange.from<=_&&f<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:m,from:_,to:f,newFrom:c.mapping.map(_),newTo:c.mapping.map(f),deletedRange:p.oldRange,newRange:p.newRange,partial:!v,editor:this.editor,transaction:t,combinedTransform:c})})});const d=c.mapping;c.steps.forEach((p,m)=>{var _,f;if(p instanceof Qn){const v=d.slice(m).map(p.from,-1),g=d.slice(m).map(p.to),y=d.invert().map(v,-1),b=d.invert().map(g),w=(_=c.doc.nodeAt(v-1))==null?void 0:_.marks.some(k=>k.eq(p.mark)),x=(f=c.doc.nodeAt(g))==null?void 0:f.marks.some(k=>k.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:y,to:b},newRange:{from:v,to:g},partial:!!(x||w),editor:this.editor,transaction:t,combinedTransform:c})}})};(r=(i=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:i.async)==null||r?setTimeout(s,0):s()}}),EC=Xe.create({name:"drop",addProseMirrorPlugins(){return[new Ye({key:new dt("tiptapDrop"),props:{handleDrop:(t,e,n,i)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:i})}}})]}}),DC=Xe.create({name:"editable",addProseMirrorPlugins(){return[new Ye({key:new dt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),AC=new dt("focusEvents"),TC=Xe.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ye({key:AC,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const i=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1},blur:(e,n)=>{t.isFocused=!1;const i=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1}}}})]}}),MC=Xe.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:o})=>{const{selection:l,doc:u}=o,{empty:c,$anchor:h}=l,{pos:d,parent:p}=h,m=h.parent.isTextblock&&d>0?o.doc.resolve(d-1):h,_=m.parent.type.spec.isolating,f=h.pos-h.parentOffset,v=_&&m.parent.childCount===1?f===h.pos:Re.atStart(u).from===d;return!c||!p.type.isTextblock||p.textContent.length||!v||v&&h.parent.type.name==="paragraph"?!1:a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.deleteCurrentNode(),()=>a.joinForward(),()=>a.selectNodeForward()]),i={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...i},s={...i,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return qc()||aC()?s:r},addProseMirrorPlugins(){return[new Ye({key:new dt("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(_=>_.getMeta("composition")))return;const i=t.some(_=>_.docChanged)&&!e.doc.eq(n.doc),r=t.some(_=>_.getMeta("preventClearDocument"));if(!i||r)return;const{empty:s,from:a,to:o}=e.selection,l=Re.atStart(e.doc).from,u=Re.atEnd(e.doc).to;if(s||!(a===l&&o===u)||!vd(n.doc))return;const d=n.tr,p=dd({state:n,transaction:d}),{commands:m}=new fd({editor:this.editor,state:p});if(m.clearNodes(),!!d.steps.length)return d}})]}}),RC=Xe.create({name:"paste",addProseMirrorPlugins(){return[new Ye({key:new dt("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),OC=Xe.create({name:"tabindex",addProseMirrorPlugins(){return[new Ye({key:new dt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),PC=Xe.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Ro(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new Ye({key:new dt("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),kO=class Vs{constructor(e,n,i=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=i,this.resolvedPos=e,this.editor=n,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,i=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,i=this.to-1}this.editor.commands.insertContentAt({from:n,to:i},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Vs(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Vs(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Vs(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,i)=>{const r=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,a=this.pos+i+(s?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(a);if(!r&&o.depth<=this.depth)return;const l=new Vs(o,this.editor,r,r?n:null);r&&(l.actualDepth=this.depth+1),e.push(new Vs(o,this.editor,r,r?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let i=null,r=this.parent;for(;r&&!i;){if(r.node.type.name===e)if(Object.keys(n).length>0){const s=r.node.attrs,a=Object.keys(n);for(let o=0;o<a.length;o+=1){const l=a[o];if(s[l]!==n[l])break}}else i=r;r=r.parent}return i}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},i=!1){let r=[];if(!this.children||this.children.length===0)return r;const s=Object.keys(n);return this.children.forEach(a=>{i&&r.length>0||(a.node.type.name===e&&s.every(l=>n[l]===a.node.attrs[l])&&r.push(a),!(i&&r.length>0)&&(r=r.concat(a.querySelectorAll(e,n,i))))}),r}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},CO=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function EO(t,e,n){const i=document.querySelector("style[data-tiptap-style]");if(i!==null)return i;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}var DO=class extends fO{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:VR,createMappablePosition:GR},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:a})=>this.options.onDrop(r,s,a)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const n=this.createDoc(),i=sC(n,this.options.autofocus);this.editorState=lo.create({doc:n,schema:this.schema,selection:i||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;e!=null&&e.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=EO(CO,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,n)=>{if(this.editorView)return this.editorView[n];if(n==="state")return this.editorState;if(n in e)return Reflect.get(e,n);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${n}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,n){const i=cC(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:i});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let i=n;if([].concat(e).forEach(s=>{const a=typeof s=="string"?`${s}$`:s.key;i=i.filter(o=>!o.key.startsWith(a))}),n.length===i.length)return;const r=this.state.reconfigure({plugins:i});return this.view.updateState(r),r}createExtensionManager(){var e,n;const r=[...this.options.enableCoreExtensions?[DC,xC.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:n.blockSeparator}),kC,TC,MC,OC,EC,RC,CC,PC.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new yd(r,this)}createCommandManager(){this.commandManager=new fd({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=ym(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(n){if(!(n instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(n.message))throw n;this.emit("contentError",{editor:this,error:n,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),e=ym(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){const{editorProps:n,enableExtensionDispatchTransaction:i}=this.options,r=n.dispatchTransaction||this.dispatchTransaction.bind(this),s=i?this.extensionManager.dispatchTransaction(r):r;this.editorView=new tC(e,{...n,attributes:{role:"textbox",...n==null?void 0:n.attributes},dispatchTransaction:s,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(c=>{var h;return(h=this.capturedTransaction)==null?void 0:h.step(c)});return}const{state:n,transactions:i}=this.state.applyTransaction(e),r=!this.state.selection.eq(n.selection),s=i.includes(e),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),!s)return;this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:i.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const o=i.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),l=o==null?void 0:o.getMeta("focus"),u=o==null?void 0:o.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:o}),u&&this.emit("blur",{editor:this,event:u.event,transaction:o}),!(e.getMeta("preventUpdate")||!i.some(c=>c.docChanged)||a.doc.eq(n.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:i.slice(1)})}getAttributes(e){return mC(this.state,e)}isActive(e,n){const i=typeof e=="string"?e:null,r=typeof e=="string"?n:e;return HR(this.state,i,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ag(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:i={}}=e||{};return IR(this.state.doc,{blockSeparator:n,textSerializers:{...pC(this.schema),...i}})}get isEmpty(){return vd(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,n;return(n=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?n:!0}$node(e,n){var i;return((i=this.$doc)==null?void 0:i.querySelector(e,n))||null}$nodes(e,n){var i;return((i=this.$doc)==null?void 0:i.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new kO(n,this)}get $doc(){return this.$pos(0)}};function Es(t){return new _d({find:t.find,handler:({state:e,range:n,match:i})=>{const r=Le(t.getAttributes,void 0,i);if(r===!1||r===null)return null;const{tr:s}=e,a=i[i.length-1],o=i[0];if(a){const l=o.search(/\S/),u=n.from+o.indexOf(a),c=u+a.length;if(Mg(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(_=>_===t.type&&_!==p.mark.type)).filter(p=>p.to>u).length)return null;c<n.to&&s.delete(c,n.to),u>n.from&&s.delete(n.from+l,u);const d=n.from+l+a.length;s.addMark(n.from+l,d,t.type.create(r||{})),s.removeStoredMark(t.type)}},undoable:t.undoable})}function AO(t){return new _d({find:t.find,handler:({state:e,range:n,match:i})=>{const r=Le(t.getAttributes,void 0,i)||{},{tr:s}=e,a=n.from;let o=n.to;const l=t.type.create(r);if(i[1]){const u=i[0].lastIndexOf(i[1]);let c=a+u;c>o?c=o:o=c+i[1].length;const h=i[0][i[0].length-1];s.insertText(h,a+i[0].length-1),s.replaceWith(c,o,l)}else if(i[0]){const u=t.type.isInline?a:a-1;s.insert(u,t.type.create(r)).delete(s.mapping.map(a),s.mapping.map(o))}s.scrollIntoView()},undoable:t.undoable})}function wm(t){return new _d({find:t.find,handler:({state:e,range:n,match:i})=>{const r=e.doc.resolve(n.from),s=Le(t.getAttributes,void 0,i)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)},undoable:t.undoable})}function Oo(t){return new _d({find:t.find,handler:({state:e,range:n,match:i,chain:r})=>{const s=Le(t.getAttributes,void 0,i)||{},a=e.tr.delete(n.from,n.to),l=a.doc.resolve(n.from).blockRange(),u=l&&ug(l,t.type,s);if(!u)return null;if(a.wrap(l,u),t.keepMarks&&t.editor){const{selection:h,storedMarks:d}=e,{splittableMarks:p}=t.editor.extensionManager,m=d||h.$to.parentOffset&&h.$from.marks();if(m){const _=m.filter(f=>p.includes(f.type.name));a.ensureMarks(_)}}if(t.keepAttributes){const h=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(h,s).run()}const c=a.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&Gr(a.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(i,c))&&a.join(n.from-1)},undoable:t.undoable})}function TO(t,e){const{selection:n}=t,{$from:i}=n;if(n instanceof be){const s=i.index();return i.parent.canReplaceWith(s,s+1,e)}let r=i.depth;for(;r>=0;){const s=i.index(r);if(i.node(r).contentMatchAt(s).matchType(e))return!0;r-=1}return!1}var MO={};Cg(MO,{createAtomBlockMarkdownSpec:()=>RO,createBlockMarkdownSpec:()=>OO,createInlineMarkdownSpec:()=>IO,parseAttributes:()=>Og,parseIndentedBlocks:()=>Sm,renderNestedMarkdownContent:()=>Ng,serializeAttributes:()=>Pg});function Og(t){if(!(t!=null&&t.trim()))return{};const e={},n=[],i=t.replace(/["']([^"']*)["']/g,u=>(n.push(u),`__QUOTED_${n.length-1}__`)),r=i.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(r){const u=r.map(c=>c.trim().slice(1));e.class=u.join(" ")}const s=i.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(e.id=s[1]);const a=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(i.matchAll(a)).forEach(([,u,c])=>{var h;const d=parseInt(((h=c.match(/__QUOTED_(\d+)__/))==null?void 0:h[1])||"0",10),p=n[d];p&&(e[u]=p.slice(1,-1))});const l=i.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(e[c]=!0)}),e}function Pg(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(i=>e.push(`.${i}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,i])=>{n==="class"||n==="id"||(i===!0?e.push(n):i!==!1&&i!=null&&e.push(`${n}="${String(i)}"`))}),e.join(" ")}function RO(t){const{nodeName:e,name:n,parseAttributes:i=Og,serializeAttributes:r=Pg,defaultAttributes:s={},requiredAttributes:a=[],allowedAttributes:o}=t,l=n||e,u=c=>{if(!o)return c;const h={};return o.forEach(d=>{d in c&&(h[d]=c[d])}),h};return{parseMarkdown:(c,h)=>{const d={...s,...c.attributes};return h.createNode(e,d,[])},markdownTokenizer:{name:e,level:"block",start(c){var h;const d=new RegExp(`^:::${l}(?:\\s|$)`,"m"),p=(h=c.match(d))==null?void 0:h.index;return p!==void 0?p:-1},tokenize(c,h,d){const p=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),m=c.match(p);if(!m)return;const _=m[1]||"",f=i(_);if(!a.find(g=>!(g in f)))return{type:e,raw:m[0],attributes:f}}},renderMarkdown:c=>{const h=u(c.attrs||{}),d=r(h),p=d?` {${d}}`:"";return`:::${l}${p} :::`}}}function OO(t){const{nodeName:e,name:n,getContent:i,parseAttributes:r=Og,serializeAttributes:s=Pg,defaultAttributes:a={},content:o="block",allowedAttributes:l}=t,u=n||e,c=h=>{if(!l)return h;const d={};return l.forEach(p=>{p in h&&(d[p]=h[p])}),d};return{parseMarkdown:(h,d)=>{let p;if(i){const _=i(h);p=typeof _=="string"?[{type:"text",text:_}]:_}else o==="block"?p=d.parseChildren(h.tokens||[]):p=d.parseInline(h.tokens||[]);const m={...a,...h.attributes};return d.createNode(e,m,p)},markdownTokenizer:{name:e,level:"block",start(h){var d;const p=new RegExp(`^:::${u}`,"m"),m=(d=h.match(p))==null?void 0:d.index;return m!==void 0?m:-1},tokenize(h,d,p){var m;const _=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),f=h.match(_);if(!f)return;const[v,g=""]=f,y=r(g);let b=1;const w=v.length;let x="";const k=/^:::([\w-]*)(\s.*)?/gm,S=h.slice(w);for(k.lastIndex=0;;){const E=k.exec(S);if(E===null)break;const A=E.index,M=E[1];if(!((m=E[2])!=null&&m.endsWith(":::"))){if(M)b+=1;else if(b-=1,b===0){const R=S.slice(0,A);x=R.trim();const P=h.slice(0,w+A+E[0].length);let H=[];if(x)if(o==="block")for(H=p.blockTokens(R),H.forEach(B=>{B.text&&(!B.tokens||B.tokens.length===0)&&(B.tokens=p.inlineTokens(B.text))});H.length>0;){const B=H[H.length-1];if(B.type==="paragraph"&&(!B.text||B.text.trim()===""))H.pop();else break}else H=p.inlineTokens(x);return{type:e,raw:P,attributes:y,content:x,tokens:H}}}}}},renderMarkdown:(h,d)=>{const p=c(h.attrs||{}),m=s(p),_=m?` {${m}}`:"",f=d.renderChildren(h.content||[],`

`);return`:::${u}${_}

${f}

:::`}}}function PO(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let i=n.exec(t);for(;i!==null;){const[,r,s,a]=i;e[r]=s||a,i=n.exec(t)}return e}function NO(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function IO(t){const{nodeName:e,name:n,getContent:i,parseAttributes:r=PO,serializeAttributes:s=NO,defaultAttributes:a={},selfClosing:o=!1,allowedAttributes:l}=t,u=n||e,c=d=>{if(!l)return d;const p={};return l.forEach(m=>{const _=typeof m=="string"?m:m.name,f=typeof m=="string"?void 0:m.skipIfDefault;if(_ in d){const v=d[_];if(f!==void 0&&v===f)return;p[_]=v}}),p},h=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(d,p)=>{const m={...a,...d.attributes};if(o)return p.createNode(e,m);const _=i?i(d):d.content||"";return _?p.createNode(e,m,[p.createTextNode(_)]):p.createNode(e,m,[])},markdownTokenizer:{name:e,level:"inline",start(d){const p=o?new RegExp(`\\[${h}\\s*[^\\]]*\\]`):new RegExp(`\\[${h}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${h}\\]`),m=d.match(p),_=m==null?void 0:m.index;return _!==void 0?_:-1},tokenize(d,p,m){const _=o?new RegExp(`^\\[${h}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${h}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${h}\\]`),f=d.match(_);if(!f)return;let v="",g="";if(o){const[,b]=f;g=b}else{const[,b,w]=f;g=b,v=w||""}const y=r(g.trim());return{type:e,raw:f[0],content:v.trim(),attributes:y}}},renderMarkdown:d=>{let p="";i?p=i(d):d.content&&d.content.length>0&&(p=d.content.filter(v=>v.type==="text").map(v=>v.text).join(""));const m=c(d.attrs||{}),_=s(m),f=_?` ${_}`:"";return o?`[${u}${f}]`:`[${u}${f}]${p}[/${u}]`}}}function Sm(t,e,n){var i,r,s,a;const o=t.split(`
`),l=[];let u="",c=0;const h=e.baseIndentSize||2;for(;c<o.length;){const d=o[c],p=d.match(e.itemPattern);if(!p){if(l.length>0)break;if(d.trim()===""){c+=1,u=`${u}${d}
`;continue}else return}const m=e.extractItemData(p),{indentLevel:_,mainContent:f}=m;u=`${u}${d}
`;const v=[f];for(c+=1;c<o.length;){const w=o[c];if(w.trim()===""){const k=o.slice(c+1).findIndex(A=>A.trim()!=="");if(k===-1)break;if((((r=(i=o[c+1+k].match(/^(\s*)/))==null?void 0:i[1])==null?void 0:r.length)||0)>_){v.push(w),u=`${u}${w}
`,c+=1;continue}else break}if((((a=(s=w.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:a.length)||0)>_)v.push(w),u=`${u}${w}
`,c+=1;else break}let g;const y=v.slice(1);if(y.length>0){const w=y.map(x=>x.slice(_+h)).join(`
`);w.trim()&&(e.customNestedParser?g=e.customNestedParser(w):g=n.blockTokens(w))}const b=e.createToken(m,g);l.push(b)}if(l.length!==0)return{items:l,raw:u}}function Ng(t,e,n,i){if(!t||!Array.isArray(t.content))return"";const r=typeof n=="function"?n(i):n,[s,...a]=t.content,o=e.renderChildren([s]),l=[`${r}${o}`];return a&&a.length>0&&a.forEach(u=>{const c=e.renderChildren([u]);if(c){const h=c.split(`
`).map(d=>d?e.indent(d):"").join(`
`);l.push(h)}}),l.join(`
`)}function LO(t,e,n={}){const{state:i}=e,{doc:r,tr:s}=i,a=t;r.descendants((o,l)=>{const u=s.mapping.map(l),c=s.mapping.map(l)+o.nodeSize;let h=null;if(o.marks.forEach(p=>{if(p!==a)return!1;h=p}),!h)return;let d=!1;if(Object.keys(n).forEach(p=>{n[p]!==h.attrs[p]&&(d=!0)}),d){const p=t.type.create({...t.attrs,...n});s.removeMark(u,c,t.type),s.addMark(u,c,p)}}),s.docChanged&&e.view.dispatch(s)}var En=class NC extends Rg{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new NC(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function jr(t){return new _O({find:t.find,handler:({state:e,range:n,match:i,pasteEvent:r})=>{const s=Le(t.getAttributes,void 0,i,r);if(s===!1||s===null)return null;const{tr:a}=e,o=i[i.length-1],l=i[0];let u=n.to;if(o){const c=l.search(/\S/),h=n.from+l.indexOf(o),d=h+o.length;if(Mg(n.from,n.to,e.doc).filter(m=>m.mark.type.excluded.find(f=>f===t.type&&f!==m.mark.type)).filter(m=>m.to>h).length)return null;d<n.to&&a.delete(d,n.to),h>n.from&&a.delete(n.from+c,h),u=n.from+c+o.length,a.addMark(n.from+c,u,t.type.create(s||{})),a.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:BO,getOwnPropertySymbols:zO}=Object,{hasOwnProperty:FO}=Object.prototype;function Af(t,e){return function(i,r,s){return t(i,r,s)&&e(i,r,s)}}function yu(t){return function(n,i,r){if(!n||!i||typeof n!="object"||typeof i!="object")return t(n,i,r);const{cache:s}=r,a=s.get(n),o=s.get(i);if(a&&o)return a===i&&o===n;s.set(n,i),s.set(i,n);const l=t(n,i,r);return s.delete(n),s.delete(i),l}}function jO(t){return t!=null?t[Symbol.toStringTag]:void 0}function cy(t){return BO(t).concat(zO(t))}const HO=Object.hasOwn||((t,e)=>FO.call(t,e));function Os(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const $O="__v",WO="__o",VO="_owner",{getOwnPropertyDescriptor:hy,keys:dy}=Object;function GO(t,e){return t.byteLength===e.byteLength&&Jc(new Uint8Array(t),new Uint8Array(e))}function UO(t,e,n){let i=t.length;if(e.length!==i)return!1;for(;i-- >0;)if(!n.equals(t[i],e[i],i,i,t,e,n))return!1;return!0}function qO(t,e){return t.byteLength===e.byteLength&&Jc(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function KO(t,e){return Os(t.getTime(),e.getTime())}function JO(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function ZO(t,e){return t===e}function fy(t,e,n){const i=t.size;if(i!==e.size)return!1;if(!i)return!0;const r=new Array(i),s=t.entries();let a,o,l=0;for(;(a=s.next())&&!a.done;){const u=e.entries();let c=!1,h=0;for(;(o=u.next())&&!o.done;){if(r[h]){h++;continue}const d=a.value,p=o.value;if(n.equals(d[0],p[0],l,h,t,e,n)&&n.equals(d[1],p[1],d[0],p[0],t,e,n)){c=r[h]=!0;break}h++}if(!c)return!1;l++}return!0}const YO=Os;function XO(t,e,n){const i=dy(t);let r=i.length;if(dy(e).length!==r)return!1;for(;r-- >0;)if(!IC(t,e,n,i[r]))return!1;return!0}function ea(t,e,n){const i=cy(t);let r=i.length;if(cy(e).length!==r)return!1;let s,a,o;for(;r-- >0;)if(s=i[r],!IC(t,e,n,s)||(a=hy(t,s),o=hy(e,s),(a||o)&&(!a||!o||a.configurable!==o.configurable||a.enumerable!==o.enumerable||a.writable!==o.writable)))return!1;return!0}function QO(t,e){return Os(t.valueOf(),e.valueOf())}function eP(t,e){return t.source===e.source&&t.flags===e.flags}function py(t,e,n){const i=t.size;if(i!==e.size)return!1;if(!i)return!0;const r=new Array(i),s=t.values();let a,o;for(;(a=s.next())&&!a.done;){const l=e.values();let u=!1,c=0;for(;(o=l.next())&&!o.done;){if(!r[c]&&n.equals(a.value,o.value,a.value,o.value,t,e,n)){u=r[c]=!0;break}c++}if(!u)return!1}return!0}function Jc(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function tP(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function IC(t,e,n,i){return(i===VO||i===WO||i===$O)&&(t.$$typeof||e.$$typeof)?!0:HO(e,i)&&n.equals(t[i],e[i],i,i,t,e,n)}const nP="[object ArrayBuffer]",iP="[object Arguments]",rP="[object Boolean]",sP="[object DataView]",oP="[object Date]",aP="[object Error]",lP="[object Map]",uP="[object Number]",cP="[object Object]",hP="[object RegExp]",dP="[object Set]",fP="[object String]",pP={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},mP="[object URL]",gP=Object.prototype.toString;function vP({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:i,areErrorsEqual:r,areFunctionsEqual:s,areMapsEqual:a,areNumbersEqual:o,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:c,areSetsEqual:h,areTypedArraysEqual:d,areUrlsEqual:p,unknownTagComparators:m}){return function(f,v,g){if(f===v)return!0;if(f==null||v==null)return!1;const y=typeof f;if(y!==typeof v)return!1;if(y!=="object")return y==="number"?o(f,v,g):y==="function"?s(f,v,g):!1;const b=f.constructor;if(b!==v.constructor)return!1;if(b===Object)return l(f,v,g);if(Array.isArray(f))return e(f,v,g);if(b===Date)return i(f,v,g);if(b===RegExp)return c(f,v,g);if(b===Map)return a(f,v,g);if(b===Set)return h(f,v,g);const w=gP.call(f);if(w===oP)return i(f,v,g);if(w===hP)return c(f,v,g);if(w===lP)return a(f,v,g);if(w===dP)return h(f,v,g);if(w===cP)return typeof f.then!="function"&&typeof v.then!="function"&&l(f,v,g);if(w===mP)return p(f,v,g);if(w===aP)return r(f,v,g);if(w===iP)return l(f,v,g);if(pP[w])return d(f,v,g);if(w===nP)return t(f,v,g);if(w===sP)return n(f,v,g);if(w===rP||w===uP||w===fP)return u(f,v,g);if(m){let x=m[w];if(!x){const k=jO(f);k&&(x=m[k])}if(x)return x(f,v,g)}return!1}}function _P({circular:t,createCustomConfig:e,strict:n}){let i={areArrayBuffersEqual:GO,areArraysEqual:n?ea:UO,areDataViewsEqual:qO,areDatesEqual:KO,areErrorsEqual:JO,areFunctionsEqual:ZO,areMapsEqual:n?Af(fy,ea):fy,areNumbersEqual:YO,areObjectsEqual:n?ea:XO,arePrimitiveWrappersEqual:QO,areRegExpsEqual:eP,areSetsEqual:n?Af(py,ea):py,areTypedArraysEqual:n?Af(Jc,ea):Jc,areUrlsEqual:tP,unknownTagComparators:void 0};if(e&&(i=Object.assign({},i,e(i))),t){const r=yu(i.areArraysEqual),s=yu(i.areMapsEqual),a=yu(i.areObjectsEqual),o=yu(i.areSetsEqual);i=Object.assign({},i,{areArraysEqual:r,areMapsEqual:s,areObjectsEqual:a,areSetsEqual:o})}return i}function yP(t){return function(e,n,i,r,s,a,o){return t(e,n,o)}}function bP({circular:t,comparator:e,createState:n,equals:i,strict:r}){if(n)return function(o,l){const{cache:u=t?new WeakMap:void 0,meta:c}=n();return e(o,l,{cache:u,equals:i,meta:c,strict:r})};if(t)return function(o,l){return e(o,l,{cache:new WeakMap,equals:i,meta:void 0,strict:r})};const s={cache:void 0,equals:i,meta:void 0,strict:r};return function(o,l){return e(o,l,s)}}const wP=Kr();Kr({strict:!0});Kr({circular:!0});Kr({circular:!0,strict:!0});Kr({createInternalComparator:()=>Os});Kr({strict:!0,createInternalComparator:()=>Os});Kr({circular:!0,createInternalComparator:()=>Os});Kr({circular:!0,createInternalComparator:()=>Os,strict:!0});function Kr(t={}){const{circular:e=!1,createInternalComparator:n,createState:i,strict:r=!1}=t,s=_P(t),a=vP(s),o=n?n(a):yP(a);return bP({circular:e,comparator:a,createState:i,equals:o,strict:r})}var LC={exports:{}},BC={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bd=I,SP=og;function xP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var kP=typeof Object.is=="function"?Object.is:xP,CP=SP.useSyncExternalStore,EP=bd.useRef,DP=bd.useEffect,AP=bd.useMemo,TP=bd.useDebugValue;BC.useSyncExternalStoreWithSelector=function(t,e,n,i,r){var s=EP(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=AP(function(){function l(p){if(!u){if(u=!0,c=p,p=i(p),r!==void 0&&a.hasValue){var m=a.value;if(r(m,p))return h=m}return h=p}if(m=h,kP(c,p))return m;var _=i(p);return r!==void 0&&r(m,_)?(c=p,m):(c=p,h=_)}var u=!1,c,h,d=n===void 0?null:n;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,n,i,r]);var o=CP(t,s[0],s[1]);return DP(function(){a.hasValue=!0,a.value=o},[o]),TP(o),o};LC.exports=BC;var MP=LC.exports,RP=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},OP=({contentComponent:t})=>{const e=og.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return C.jsx(C.Fragment,{children:Object.values(e)})};function PP(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,i){e={...e,[n]:ix.createPortal(i.reactElement,i.element,n)},t.forEach(r=>r())},removeRenderer(n){const i={...e};delete i[n],e=i,t.forEach(r=>r())}}}var NP=class extends ue.Component{constructor(t){var e;super(t),this.editorContentRef=ue.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=PP(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(i=>i.hasContentComponentInitialized?i:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return C.jsxs(C.Fragment,{children:[C.jsx("div",{ref:RP(e,this.editorContentRef),...n}),(t==null?void 0:t.contentComponent)&&C.jsx(OP,{contentComponent:t.contentComponent})]})}},IP=I.forwardRef((t,e)=>{const n=ue.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return ue.createElement(NP,{key:n,innerRef:e,...t})}),zC=ue.memo(IP),LP=typeof window<"u"?I.useLayoutEffect:I.useEffect,BP=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function zP(t){var e;const[n]=I.useState(()=>new BP(t.editor)),i=MP.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:wP);return LP(()=>n.watch(t.editor),[t.editor,n]),I.useDebugValue(i),i}var FP=!1,xm=typeof window>"u",jP=xm||!!(typeof window<"u"&&window.next),HP=class FC{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?xm||jP?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...i)=>{var r,s;return(s=(r=this.options.current).onBeforeCreate)==null?void 0:s.call(r,...i)},onBlur:(...i)=>{var r,s;return(s=(r=this.options.current).onBlur)==null?void 0:s.call(r,...i)},onCreate:(...i)=>{var r,s;return(s=(r=this.options.current).onCreate)==null?void 0:s.call(r,...i)},onDestroy:(...i)=>{var r,s;return(s=(r=this.options.current).onDestroy)==null?void 0:s.call(r,...i)},onFocus:(...i)=>{var r,s;return(s=(r=this.options.current).onFocus)==null?void 0:s.call(r,...i)},onSelectionUpdate:(...i)=>{var r,s;return(s=(r=this.options.current).onSelectionUpdate)==null?void 0:s.call(r,...i)},onTransaction:(...i)=>{var r,s;return(s=(r=this.options.current).onTransaction)==null?void 0:s.call(r,...i)},onUpdate:(...i)=>{var r,s;return(s=(r=this.options.current).onUpdate)==null?void 0:s.call(r,...i)},onContentError:(...i)=>{var r,s;return(s=(r=this.options.current).onContentError)==null?void 0:s.call(r,...i)},onDrop:(...i)=>{var r,s;return(s=(r=this.options.current).onDrop)==null?void 0:s.call(r,...i)},onPaste:(...i)=>{var r,s;return(s=(r=this.options.current).onPaste)==null?void 0:s.call(r,...i)},onDelete:(...i)=>{var r,s;return(s=(r=this.options.current).onDelete)==null?void 0:s.call(r,...i)}};return new DO(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(i=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(i)?!0:i==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((r,s)=>{var a;return r===((a=n.extensions)==null?void 0:a[s])}):e[i]===n[i])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?FC.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((i,r)=>i===e[r]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function jC(t={},e=[]){const n=I.useRef(t);n.current=t;const[i]=I.useState(()=>new HP(n)),r=og.useSyncExternalStore(i.subscribe,i.getEditor,i.getServerSnapshot);return I.useDebugValue(r),I.useEffect(i.onRender(e)),zP({editor:r,selector:({transactionNumber:s})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&s===0?0:s+1}),r}var $P=I.createContext({editor:null});$P.Consumer;var WP=I.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),VP=()=>I.useContext(WP);ue.forwardRef((t,e)=>{const{onDragStart:n}=VP(),i=t.as||"div";return C.jsx(i,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});ue.createContext({markViewContentRef:()=>{}});var Zc=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...i}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,i,n]},GP=/^\s*>\s$/,UP=En.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Zc("blockquote",{...ht(this.options.HTMLAttributes,t),children:Zc("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",i=[];return t.content.forEach(r=>{const o=e.renderChildren([r]).split(`
`).map(l=>l.trim()===""?n:`${n} ${l}`);i.push(o.join(`
`))}),i.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Oo({find:GP,type:this.type})]}}),qP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,KP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,JP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ZP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,YP=qr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Zc("strong",{...ht(this.options.HTMLAttributes,t),children:Zc("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Es({find:qP,type:this.type}),Es({find:JP,type:this.type})]},addPasteRules(){return[jr({find:KP,type:this.type}),jr({find:ZP,type:this.type})]}}),XP=/(^|[^`])`([^`]+)`(?!`)$/,QP=/(^|[^`])`([^`]+)`(?!`)/g,eN=qr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",ht(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Es({find:XP,type:this.type})]},addPasteRules(){return[jr({find:QP,type:this.type})]}}),Tf=4,tN=/^```([a-z]+)?[\s\n]$/,nN=/^~~~([a-z]+)?[\s\n]$/,iN=En.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Tf,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const s=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(a=>a.startsWith(n)).map(a=>a.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",ht(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let i="";const r=((n=t.attrs)==null?void 0:n.language)||"";return t.content?i=[`\`\`\`${r}`,e.renderChildren(t.content),"```"].join(`
`):i=`\`\`\`${r}

\`\`\``,i},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Tf,{state:i}=t,{selection:r}=i,{$from:s,empty:a}=r;if(s.parent.type!==this.type)return!1;const o=" ".repeat(n);return a?t.commands.insertContent(o):t.commands.command(({tr:l})=>{const{from:u,to:c}=r,p=i.doc.textBetween(u,c,`
`,`
`).split(`
`).map(m=>o+m).join(`
`);return l.replaceWith(u,c,i.schema.text(p)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Tf,{state:i}=t,{selection:r}=i,{$from:s,empty:a}=r;return s.parent.type!==this.type?!1:a?t.commands.command(({tr:o})=>{var l;const{pos:u}=s,c=s.start(),h=s.end(),p=i.doc.textBetween(c,h,`
`,`
`).split(`
`);let m=0,_=0;const f=u-c;for(let x=0;x<p.length;x+=1){if(_+p[x].length>=f){m=x;break}_+=p[x].length+1}const g=((l=p[m].match(/^ */))==null?void 0:l[0])||"",y=Math.min(g.length,n);if(y===0)return!0;let b=c;for(let x=0;x<m;x+=1)b+=p[x].length+1;return o.delete(b,b+y),u-b<=y&&o.setSelection(Ce.create(o.doc,b)),!0}):t.commands.command(({tr:o})=>{const{from:l,to:u}=r,d=i.doc.textBetween(l,u,`
`,`
`).split(`
`).map(p=>{var m;const _=((m=p.match(/^ */))==null?void 0:m[0])||"",f=Math.min(_.length,n);return p.slice(f)}).join(`
`);return o.replaceWith(l,u,i.schema.text(d)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:i,empty:r}=n;if(!r||i.parent.type!==this.type)return!1;const s=i.parentOffset===i.parent.nodeSize-2,a=i.parent.textContent.endsWith(`

`);return!s||!a?!1:t.chain().command(({tr:o})=>(o.delete(i.pos-2,i.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:i}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const o=r.after();return o===void 0?!1:i.nodeAt(o)?t.commands.command(({tr:u})=>(u.setSelection(Re.near(i.resolve(o))),!0)):t.commands.exitCode()}}},addInputRules(){return[wm({find:tN,type:this.type,getAttributes:t=>({language:t[1]})}),wm({find:nN,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Ye({key:new dt("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),i=e.clipboardData.getData("vscode-editor-data"),r=i?JSON.parse(i):void 0,s=r==null?void 0:r.mode;if(!n||!s)return!1;const{tr:a,schema:o}=t.state,l=o.text(n.replace(/\r\n?/g,`
`));return a.replaceSelectionWith(this.type.create({language:s},l)),a.selection.$from.parent.type!==this.type&&a.setSelection(Ce.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),t.dispatch(a),!0}}})]}}),rN=En.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),sN=En.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",ht(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:i})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:r,storedMarks:s}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:a}=this.options,{splittableMarks:o}=i.extensionManager,l=s||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&a){const h=l.filter(d=>o.includes(d.type.name));u.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),oN=En.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,ht(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const i=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,r="#".repeat(i);return t.content?`${r} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>wm({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),aN=En.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",ht(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!TO(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:i}=n,r=t();return vC(n)?r.insertContentAt(i.pos,{type:this.name}):r.insertContent({type:this.name}),r.command(({state:s,tr:a,dispatch:o})=>{if(o){const{$to:l}=a.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?a.setSelection(Ce.create(a.doc,l.pos+1)):l.nodeAfter.isBlock?a.setSelection(be.create(a.doc,l.pos)):a.setSelection(Ce.create(a.doc,l.pos));else{const c=s.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,h=c==null?void 0:c.create();h&&(a.insert(u,h),a.setSelection(Ce.create(a.doc,u+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[AO({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),lN=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,uN=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,cN=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,hN=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,dN=qr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Es({find:lN,type:this.type}),Es({find:cN,type:this.type})]},addPasteRules(){return[jr({find:uN,type:this.type}),jr({find:hN,type:this.type})]}});const fN="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",pN="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",km="numeric",Cm="ascii",Em="alpha",Pa="asciinumeric",_a="alphanumeric",Dm="domain",HC="emoji",mN="scheme",gN="slashscheme",Mf="whitespace";function vN(t,e){return t in e||(e[t]=[]),e[t]}function as(t,e,n){e[km]&&(e[Pa]=!0,e[_a]=!0),e[Cm]&&(e[Pa]=!0,e[Em]=!0),e[Pa]&&(e[_a]=!0),e[Em]&&(e[_a]=!0),e[_a]&&(e[Dm]=!0),e[HC]&&(e[Dm]=!0);for(const i in e){const r=vN(i,n);r.indexOf(t)<0&&r.push(t)}}function _N(t,e){const n={};for(const i in e)e[i].indexOf(t)>=0&&(n[i]=!0);return n}function ln(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}ln.groups={};ln.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let i=0;i<e.jr.length;i++){const r=e.jr[i][0],s=e.jr[i][1];if(s&&r.test(t))return s}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,i){for(let r=0;r<t.length;r++)this.tt(t[r],e,n,i)},tr(t,e,n,i){i=i||ln.groups;let r;return e&&e.j?r=e:(r=new ln(e),n&&i&&as(e,n,i)),this.jr.push([t,r]),r},ts(t,e,n,i){let r=this;const s=t.length;if(!s)return r;for(let a=0;a<s-1;a++)r=r.tt(t[a]);return r.tt(t[s-1],e,n,i)},tt(t,e,n,i){i=i||ln.groups;const r=this;if(e&&e.j)return r.j[t]=e,e;const s=e;let a,o=r.go(t);if(o?(a=new ln,Object.assign(a.j,o.j),a.jr.push.apply(a.jr,o.jr),a.jd=o.jd,a.t=o.t):a=new ln,s){if(i)if(a.t&&typeof a.t=="string"){const l=Object.assign(_N(a.t,i),n);as(s,l,i)}else n&&as(s,n,i);a.t=s}return r.j[t]=a,a}};const Te=(t,e,n,i,r)=>t.ta(e,n,i,r),st=(t,e,n,i,r)=>t.tr(e,n,i,r),my=(t,e,n,i,r)=>t.ts(e,n,i,r),re=(t,e,n,i,r)=>t.tt(e,n,i,r),Ri="WORD",Am="UWORD",$C="ASCIINUMERICAL",WC="ALPHANUMERICAL",ml="LOCALHOST",Tm="TLD",Mm="UTLD",Qu="SCHEME",Gs="SLASH_SCHEME",Ig="NUM",Rm="WS",Lg="NL",Na="OPENBRACE",Ia="CLOSEBRACE",Yc="OPENBRACKET",Xc="CLOSEBRACKET",Qc="OPENPAREN",eh="CLOSEPAREN",th="OPENANGLEBRACKET",nh="CLOSEANGLEBRACKET",ih="FULLWIDTHLEFTPAREN",rh="FULLWIDTHRIGHTPAREN",sh="LEFTCORNERBRACKET",oh="RIGHTCORNERBRACKET",ah="LEFTWHITECORNERBRACKET",lh="RIGHTWHITECORNERBRACKET",uh="FULLWIDTHLESSTHAN",ch="FULLWIDTHGREATERTHAN",hh="AMPERSAND",dh="APOSTROPHE",fh="ASTERISK",ar="AT",ph="BACKSLASH",mh="BACKTICK",gh="CARET",fr="COLON",Bg="COMMA",vh="DOLLAR",li="DOT",_h="EQUALS",zg="EXCLAMATION",Rn="HYPHEN",La="PERCENT",yh="PIPE",bh="PLUS",wh="POUND",Ba="QUERY",Fg="QUOTE",VC="FULLWIDTHMIDDLEDOT",jg="SEMI",ui="SLASH",za="TILDE",Sh="UNDERSCORE",GC="EMOJI",xh="SYM";var UC=Object.freeze({__proto__:null,ALPHANUMERICAL:WC,AMPERSAND:hh,APOSTROPHE:dh,ASCIINUMERICAL:$C,ASTERISK:fh,AT:ar,BACKSLASH:ph,BACKTICK:mh,CARET:gh,CLOSEANGLEBRACKET:nh,CLOSEBRACE:Ia,CLOSEBRACKET:Xc,CLOSEPAREN:eh,COLON:fr,COMMA:Bg,DOLLAR:vh,DOT:li,EMOJI:GC,EQUALS:_h,EXCLAMATION:zg,FULLWIDTHGREATERTHAN:ch,FULLWIDTHLEFTPAREN:ih,FULLWIDTHLESSTHAN:uh,FULLWIDTHMIDDLEDOT:VC,FULLWIDTHRIGHTPAREN:rh,HYPHEN:Rn,LEFTCORNERBRACKET:sh,LEFTWHITECORNERBRACKET:ah,LOCALHOST:ml,NL:Lg,NUM:Ig,OPENANGLEBRACKET:th,OPENBRACE:Na,OPENBRACKET:Yc,OPENPAREN:Qc,PERCENT:La,PIPE:yh,PLUS:bh,POUND:wh,QUERY:Ba,QUOTE:Fg,RIGHTCORNERBRACKET:oh,RIGHTWHITECORNERBRACKET:lh,SCHEME:Qu,SEMI:jg,SLASH:ui,SLASH_SCHEME:Gs,SYM:xh,TILDE:za,TLD:Tm,UNDERSCORE:Sh,UTLD:Mm,UWORD:Am,WORD:Ri,WS:Rm});const Ti=/[a-z]/,ta=new RegExp("\\p{L}","u"),Rf=new RegExp("\\p{Emoji}","u"),Mi=/\d/,Of=/\s/,gy="\r",Pf=`
`,yN="",bN="",Nf="";let bu=null,wu=null;function wN(t=[]){const e={};ln.groups=e;const n=new ln;bu==null&&(bu=vy(fN)),wu==null&&(wu=vy(pN)),re(n,"'",dh),re(n,"{",Na),re(n,"}",Ia),re(n,"[",Yc),re(n,"]",Xc),re(n,"(",Qc),re(n,")",eh),re(n,"<",th),re(n,">",nh),re(n,"",ih),re(n,"",rh),re(n,"",sh),re(n,"",oh),re(n,"",ah),re(n,"",lh),re(n,"",uh),re(n,"",ch),re(n,"&",hh),re(n,"*",fh),re(n,"@",ar),re(n,"`",mh),re(n,"^",gh),re(n,":",fr),re(n,",",Bg),re(n,"$",vh),re(n,".",li),re(n,"=",_h),re(n,"!",zg),re(n,"-",Rn),re(n,"%",La),re(n,"|",yh),re(n,"+",bh),re(n,"#",wh),re(n,"?",Ba),re(n,'"',Fg),re(n,"/",ui),re(n,";",jg),re(n,"~",za),re(n,"_",Sh),re(n,"\\",ph),re(n,"",VC);const i=st(n,Mi,Ig,{[km]:!0});st(i,Mi,i);const r=st(i,Ti,$C,{[Pa]:!0}),s=st(i,ta,WC,{[_a]:!0}),a=st(n,Ti,Ri,{[Cm]:!0});st(a,Mi,r),st(a,Ti,a),st(r,Mi,r),st(r,Ti,r);const o=st(n,ta,Am,{[Em]:!0});st(o,Ti),st(o,Mi,s),st(o,ta,o),st(s,Mi,s),st(s,Ti),st(s,ta,s);const l=re(n,Pf,Lg,{[Mf]:!0}),u=re(n,gy,Rm,{[Mf]:!0}),c=st(n,Of,Rm,{[Mf]:!0});re(n,Nf,c),re(u,Pf,l),re(u,Nf,c),st(u,Of,c),re(c,gy),re(c,Pf),st(c,Of,c),re(c,Nf,c);const h=st(n,Rf,GC,{[HC]:!0});re(h,"#"),st(h,Rf,h),re(h,yN,h);const d=re(h,bN);re(d,"#"),st(d,Rf,h);const p=[[Ti,a],[Mi,r]],m=[[Ti,null],[ta,o],[Mi,s]];for(let _=0;_<bu.length;_++)tr(n,bu[_],Tm,Ri,p);for(let _=0;_<wu.length;_++)tr(n,wu[_],Mm,Am,m);as(Tm,{tld:!0,ascii:!0},e),as(Mm,{utld:!0,alpha:!0},e),tr(n,"file",Qu,Ri,p),tr(n,"mailto",Qu,Ri,p),tr(n,"http",Gs,Ri,p),tr(n,"https",Gs,Ri,p),tr(n,"ftp",Gs,Ri,p),tr(n,"ftps",Gs,Ri,p),as(Qu,{scheme:!0,ascii:!0},e),as(Gs,{slashscheme:!0,ascii:!0},e),t=t.sort((_,f)=>_[0]>f[0]?1:-1);for(let _=0;_<t.length;_++){const f=t[_][0],g=t[_][1]?{[mN]:!0}:{[gN]:!0};f.indexOf("-")>=0?g[Dm]=!0:Ti.test(f)?Mi.test(f)?g[Pa]=!0:g[Cm]=!0:g[km]=!0,my(n,f,f,g)}return my(n,"localhost",ml,{ascii:!0}),n.jd=new ln(xh),{start:n,tokens:Object.assign({groups:e},UC)}}function qC(t,e){const n=SN(e.replace(/[A-Z]/g,o=>o.toLowerCase())),i=n.length,r=[];let s=0,a=0;for(;a<i;){let o=t,l=null,u=0,c=null,h=-1,d=-1;for(;a<i&&(l=o.go(n[a]));)o=l,o.accepts()?(h=0,d=0,c=o):h>=0&&(h+=n[a].length,d++),u+=n[a].length,s+=n[a].length,a++;s-=h,a-=d,u-=h,r.push({t:c.t,v:e.slice(s-u,s),s:s-u,e:s})}return r}function SN(t){const e=[],n=t.length;let i=0;for(;i<n;){let r=t.charCodeAt(i),s,a=r<55296||r>56319||i+1===n||(s=t.charCodeAt(i+1))<56320||s>57343?t[i]:t.slice(i,i+2);e.push(a),i+=a.length}return e}function tr(t,e,n,i,r){let s;const a=e.length;for(let o=0;o<a-1;o++){const l=e[o];t.j[l]?s=t.j[l]:(s=new ln(i),s.jr=r.slice(),t.j[l]=s),t=s}return s=new ln(n),s.jr=r.slice(),t.j[e[a-1]]=s,s}function vy(t){const e=[],n=[];let i=0,r="0123456789";for(;i<t.length;){let s=0;for(;r.indexOf(t[i+s])>=0;)s++;if(s>0){e.push(n.join(""));for(let a=parseInt(t.substring(i,i+s),10);a>0;a--)n.pop();i+=s}else n.push(t[i]),i++}return e}const gl={defaultProtocol:"http",events:null,format:_y,formatHref:_y,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Hg(t,e=null){let n=Object.assign({},gl);t&&(n=Object.assign(n,t instanceof Hg?t.o:t));const i=n.ignoreTags,r=[];for(let s=0;s<i.length;s++)r.push(i[s].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=r}Hg.prototype={o:gl,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const i=e!=null;let r=this.o[t];return r&&(typeof r=="object"?(r=n.t in r?r[n.t]:gl[t],typeof r=="function"&&i&&(r=r(e,n))):typeof r=="function"&&i&&(r=r(e,n.t,n)),r)},getObj(t,e,n){let i=this.o[t];return typeof i=="function"&&e!=null&&(i=i(e,n.t,n)),i},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function _y(t){return t}function KC(t,e){this.t="token",this.v=t,this.tk=e}KC.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),i=t.get("format",e,this);return n&&i.length>n?i.substring(0,n)+"":i},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=gl.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),i=t.get("formatHref",n,this),r=t.get("tagName",n,e),s=this.toFormattedString(t),a={},o=t.get("className",n,e),l=t.get("target",n,e),u=t.get("rel",n,e),c=t.getObj("attributes",n,e),h=t.getObj("events",n,e);return a.href=i,o&&(a.class=o),l&&(a.target=l),u&&(a.rel=u),c&&Object.assign(a,c),{tagName:r,attributes:a,content:s,eventListeners:h}}};function wd(t,e){class n extends KC{constructor(r,s){super(r,s),this.t=t}}for(const i in e)n.prototype[i]=e[i];return n.t=t,n}const yy=wd("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),by=wd("text"),xN=wd("nl"),Su=wd("url",{isLink:!0,toHref(t=gl.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==ml&&t[1].t===fr}}),An=t=>new ln(t);function kN({groups:t}){const e=t.domain.concat([hh,fh,ar,ph,mh,gh,vh,_h,Rn,Ig,La,yh,bh,wh,ui,xh,za,Sh]),n=[dh,fr,Bg,li,zg,La,Ba,Fg,jg,th,nh,Na,Ia,Xc,Yc,Qc,eh,ih,rh,sh,oh,ah,lh,uh,ch],i=[hh,dh,fh,ph,mh,gh,vh,_h,Rn,Na,Ia,La,yh,bh,wh,Ba,ui,xh,za,Sh],r=An(),s=re(r,za);Te(s,i,s),Te(s,t.domain,s);const a=An(),o=An(),l=An();Te(r,t.domain,a),Te(r,t.scheme,o),Te(r,t.slashscheme,l),Te(a,i,s),Te(a,t.domain,a);const u=re(a,ar);re(s,ar,u),re(o,ar,u),re(l,ar,u);const c=re(s,li);Te(c,i,s),Te(c,t.domain,s);const h=An();Te(u,t.domain,h),Te(h,t.domain,h);const d=re(h,li);Te(d,t.domain,h);const p=An(yy);Te(d,t.tld,p),Te(d,t.utld,p),re(u,ml,p);const m=re(h,Rn);re(m,Rn,m),Te(m,t.domain,h),Te(p,t.domain,h),re(p,li,d),re(p,Rn,m);const _=re(p,fr);Te(_,t.numeric,yy);const f=re(a,Rn),v=re(a,li);re(f,Rn,f),Te(f,t.domain,a),Te(v,i,s),Te(v,t.domain,a);const g=An(Su);Te(v,t.tld,g),Te(v,t.utld,g),Te(g,t.domain,a),Te(g,i,s),re(g,li,v),re(g,Rn,f),re(g,ar,u);const y=re(g,fr),b=An(Su);Te(y,t.numeric,b);const w=An(Su),x=An();Te(w,e,w),Te(w,n,x),Te(x,e,w),Te(x,n,x),re(g,ui,w),re(b,ui,w);const k=re(o,fr),S=re(l,fr),E=re(S,ui),A=re(E,ui);Te(o,t.domain,a),re(o,li,v),re(o,Rn,f),Te(l,t.domain,a),re(l,li,v),re(l,Rn,f),Te(k,t.domain,w),re(k,ui,w),re(k,Ba,w),Te(A,t.domain,w),Te(A,e,w),re(A,ui,w);const M=[[Na,Ia],[Yc,Xc],[Qc,eh],[th,nh],[ih,rh],[sh,oh],[ah,lh],[uh,ch]];for(let R=0;R<M.length;R++){const[P,H]=M[R],B=re(w,P);re(x,P,B),re(B,H,w);const L=An(Su);Te(B,e,L);const j=An();Te(B,n),Te(L,e,L),Te(L,n,j),Te(j,e,L),Te(j,n,j),re(L,H,w),re(j,H,w)}return re(r,ml,g),re(r,Lg,xN),{start:r,tokens:UC}}function CN(t,e,n){let i=n.length,r=0,s=[],a=[];for(;r<i;){let o=t,l=null,u=null,c=0,h=null,d=-1;for(;r<i&&!(l=o.go(n[r].t));)a.push(n[r++]);for(;r<i&&(u=l||o.go(n[r].t));)l=null,o=u,o.accepts()?(d=0,h=o):d>=0&&d++,r++,c++;if(d<0)r-=c,r<i&&(a.push(n[r]),r++);else{a.length>0&&(s.push(If(by,e,a)),a=[]),r-=d,c-=d;const p=h.t,m=n.slice(r-c,r);s.push(If(p,e,m))}}return a.length>0&&s.push(If(by,e,a)),s}function If(t,e,n){const i=n[0].s,r=n[n.length-1].e,s=e.slice(i,r);return new t(s,n)}const EN=typeof console<"u"&&console&&console.warn||(()=>{}),DN="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Ke={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function AN(){return ln.groups={},Ke.scanner=null,Ke.parser=null,Ke.tokenQueue=[],Ke.pluginQueue=[],Ke.customSchemes=[],Ke.initialized=!1,Ke}function wy(t,e=!1){if(Ke.initialized&&EN(`linkifyjs: already initialized - will not register custom scheme "${t}" ${DN}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Ke.customSchemes.push([t,e])}function TN(){Ke.scanner=wN(Ke.customSchemes);for(let t=0;t<Ke.tokenQueue.length;t++)Ke.tokenQueue[t][1]({scanner:Ke.scanner});Ke.parser=kN(Ke.scanner.tokens);for(let t=0;t<Ke.pluginQueue.length;t++)Ke.pluginQueue[t][1]({scanner:Ke.scanner,parser:Ke.parser});return Ke.initialized=!0,Ke}function $g(t){return Ke.initialized||TN(),CN(Ke.parser.start,t,qC(Ke.scanner.start,t))}$g.scan=qC;function JC(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const i=new Hg(n),r=$g(t),s=[];for(let a=0;a<r.length;a++){const o=r[a];o.isLink&&(!e||o.t===e)&&i.check(o)&&s.push(o.toFormattedObject(i))}return s}var Wg="[\0- -\u2029]",MN=new RegExp(Wg),RN=new RegExp(`${Wg}$`),ON=new RegExp(Wg,"g");function PN(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function NN(t){return new Ye({key:new dt("autolink"),appendTransaction:(e,n,i)=>{const r=e.some(u=>u.docChanged)&&!n.doc.eq(i.doc),s=e.some(u=>u.getMeta("preventAutolink"));if(!r||s)return;const{tr:a}=i,o=uC(n.doc,[...e]);if(gC(o).forEach(({newRange:u})=>{const c=AR(i.doc,u,p=>p.isTextblock);let h,d;if(c.length>1)h=c[0],d=i.doc.textBetween(h.pos,h.pos+h.node.nodeSize,void 0," ");else if(c.length){const p=i.doc.textBetween(u.from,u.to," "," ");if(!RN.test(p))return;h=c[0],d=i.doc.textBetween(h.pos,u.to,void 0," ")}if(h&&d){const p=d.split(MN).filter(Boolean);if(p.length<=0)return!1;const m=p[p.length-1],_=h.pos+d.lastIndexOf(m);if(!m)return!1;const f=$g(m).map(v=>v.toObject(t.defaultProtocol));if(!PN(f))return!1;f.filter(v=>v.isLink).map(v=>({...v,from:_+v.start+1,to:_+v.end+1})).filter(v=>i.schema.marks.code?!i.doc.rangeHasMark(v.from,v.to,i.schema.marks.code):!0).filter(v=>t.validate(v.value)).filter(v=>t.shouldAutoLink(v.value)).forEach(v=>{Mg(v.from,v.to,i.doc).some(g=>g.mark.type===t.type)||a.addMark(v.from,v.to,t.type.create({href:v.href}))})}}),!!a.steps.length)return a}})}function IN(t){return new Ye({key:new dt("handleClickLink"),props:{handleClick:(e,n,i)=>{var r,s;if(i.button!==0||!e.editable)return!1;let a=!1;if(t.enableClickSelection&&(a=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){let o=null;if(i.target instanceof HTMLAnchorElement)o=i.target;else{let h=i.target;const d=[];for(;h.nodeName!=="DIV";)d.push(h),h=h.parentNode;o=d.find(p=>p.nodeName==="A")}if(!o)return a;const l=mC(e.state,t.type.name),u=(r=o==null?void 0:o.href)!=null?r:l.href,c=(s=o==null?void 0:o.target)!=null?s:l.target;o&&u&&(window.open(u,c),a=!0)}return a}}})}function LN(t){return new Ye({key:new dt("handlePasteLink"),props:{handlePaste:(e,n,i)=>{const{shouldAutoLink:r}=t,{state:s}=e,{selection:a}=s,{empty:o}=a;if(o)return!1;let l="";i.content.forEach(c=>{l+=c.textContent});const u=JC(l,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!u||r!==void 0&&!r(u.value)?!1:t.editor.commands.setMark(t.type,{href:u.href})}}})}function Jr(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(i=>{const r=typeof i=="string"?i:i.scheme;r&&n.push(r)}),!t||t.replace(ON,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var ZC=qr.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){wy(t);return}wy(t.scheme,t.optionalSlashes)})},onDestroy(){AN()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Jr(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),n=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||n&&!t.includes("@"))return!0;const r=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(r)||!/\./.test(r))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Jr(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Jr(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",ht(this.options.HTMLAttributes,t),0]:["a",ht(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const i=((n=t.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(t)}](${i})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:i=>!!Jr(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:i=>!!Jr(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[jr({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:i}=this.options,r=JC(t).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:a=>!!Jr(a,n),protocols:n,defaultProtocol:i}));r.length&&r.forEach(s=>{this.options.shouldAutoLink(s.value)&&e.push({text:s.value,data:{href:s.href},index:s.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(NN({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:i=>this.options.isAllowedUri(i,{defaultValidate:r=>!!Jr(r,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(IN({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(LN({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),BN=ZC,zN=Object.defineProperty,FN=(t,e)=>{for(var n in e)zN(t,n,{get:e[n],enumerable:!0})},jN="listItem",Sy="textStyle",xy=/^\s*([-+*])\s$/,YC=En.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",ht(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(jN,this.editor.getAttributes(Sy)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Oo({find:xy,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Oo({find:xy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Sy),editor:this.editor})),[t]}}),XC=En.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",ht(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(r=>r.type==="paragraph"))n=e.parseChildren(t.tokens);else{const r=t.tokens[0];if(r&&r.type==="text"&&r.tokens&&r.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(r.tokens)}],t.tokens.length>1){const a=t.tokens.slice(1),o=e.parseChildren(a);n.push(...o)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Ng(t,e,i=>i.parentType==="bulletList"?"- ":i.parentType==="orderedList"?`${i.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),HN={};FN(HN,{findListItemPos:()=>Nl,getNextListDepth:()=>Vg,handleBackspace:()=>Om,handleDelete:()=>Pm,hasListBefore:()=>QC,hasListItemAfter:()=>$N,hasListItemBefore:()=>e2,listItemHasSubList:()=>t2,nextListIsDeeper:()=>n2,nextListIsHigher:()=>i2});var Nl=(t,e)=>{const{$from:n}=e.selection,i=gt(t,e.schema);let r=null,s=n.depth,a=n.pos,o=null;for(;s>0&&o===null;)r=n.node(s),r.type===i?o=s:(s-=1,a-=1);return o===null?null:{$pos:e.doc.resolve(a),depth:o}},Vg=(t,e)=>{const n=Nl(t,e);if(!n)return!1;const[,i]=FR(e,t,n.$pos.pos+4);return i},QC=(t,e,n)=>{const{$anchor:i}=t.selection,r=Math.max(0,i.pos-2),s=t.doc.resolve(r).node();return!(!s||!n.includes(s.type.name))},e2=(t,e)=>{var n;const{$anchor:i}=e.selection,r=e.doc.resolve(i.pos-2);return!(r.index()===0||((n=r.nodeBefore)==null?void 0:n.type.name)!==t)},t2=(t,e,n)=>{if(!n)return!1;const i=gt(t,e.schema);let r=!1;return n.descendants(s=>{s.type===i&&(r=!0)}),r},Om=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Fr(t.state,e)&&QC(t.state,e,n)){const{$anchor:o}=t.state.selection,l=t.state.doc.resolve(o.before()-1),u=[];l.node().descendants((d,p)=>{d.type.name===e&&u.push({node:d,pos:p})});const c=u.at(-1);if(!c)return!1;const h=t.state.doc.resolve(l.start()+c.pos+1);return t.chain().cut({from:o.start()-1,to:o.end()+1},h.end()).joinForward().run()}if(!Fr(t.state,e)||!WR(t.state))return!1;const i=Nl(e,t.state);if(!i)return!1;const s=t.state.doc.resolve(i.$pos.pos-2).node(i.depth),a=t2(e,t.state,s);return e2(e,t.state)&&!a?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},n2=(t,e)=>{const n=Vg(t,e),i=Nl(t,e);return!i||!n?!1:n>i.depth},i2=(t,e)=>{const n=Vg(t,e),i=Nl(t,e);return!i||!n?!1:n<i.depth},Pm=(t,e)=>{if(!Fr(t.state,e)||!$R(t.state,e))return!1;const{selection:n}=t.state,{$from:i,$to:r}=n;return!n.empty&&i.sameParent(r)?!1:n2(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():i2(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},$N=(t,e)=>{var n;const{$anchor:i}=e.selection,r=e.doc.resolve(i.pos-i.parentOffset-2);return!(r.index()===r.parent.childCount-1||((n=r.nodeAfter)==null?void 0:n.type.name)!==t)},r2=Xe.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Pm(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Pm(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:i})=>{t.state.schema.nodes[n]!==void 0&&Om(t,n,i)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:i})=>{t.state.schema.nodes[n]!==void 0&&Om(t,n,i)&&(e=!0)}),e}}}}),ky=/^(\s*)(\d+)\.\s+(.*)$/,WN=/^\s/;function VN(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n],s=r.match(ky);if(!s)break;const[,a,o,l]=s,u=a.length;let c=l,h=n+1;const d=[r];for(;h<t.length;){const p=t[h];if(p.match(ky))break;if(p.trim()==="")d.push(p),c+=`
`,h+=1;else if(p.match(WN))d.push(p),c+=`
${p.slice(u+2)}`,h+=1;else break}e.push({indent:u,number:parseInt(o,10),content:c.trim(),raw:d.join(`
`)}),i=h,n=h}return[e,i]}function s2(t,e,n){var i;const r=[];let s=0;for(;s<t.length;){const a=t[s];if(a.indent===e){const o=a.content.split(`
`),l=((i=o[0])==null?void 0:i.trim())||"",u=[];l&&u.push({type:"paragraph",raw:l,tokens:n.inlineTokens(l)});const c=o.slice(1).join(`
`).trim();if(c){const p=n.blockTokens(c);u.push(...p)}let h=s+1;const d=[];for(;h<t.length&&t[h].indent>e;)d.push(t[h]),h+=1;if(d.length>0){const p=Math.min(...d.map(_=>_.indent)),m=s2(d,p,n);u.push({type:"list",ordered:!0,start:d[0].number,items:m,raw:d.map(_=>_.raw).join(`
`)})}r.push({type:"list_item",raw:a.raw,tokens:u}),s=h}else s+=1}return r}function GN(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const i=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(r=>{if(r.type==="paragraph"||r.type==="list"||r.type==="blockquote"||r.type==="code")i.push(...e.parseChildren([r]));else if(r.type==="text"&&r.tokens){const s=e.parseChildren([r]);i.push({type:"paragraph",content:s})}else{const s=e.parseChildren([r]);s.length>0&&i.push(...s)}}),{type:"listItem",content:i}})}var UN="listItem",Cy="textStyle",Ey=/^(\d+)\.\s$/,o2=En.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",ht(this.options.HTMLAttributes,n),0]:["ol",ht(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,i=t.items?GN(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:i}:{type:"orderedList",content:i}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e==null?void 0:e.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var i;const r=t.split(`
`),[s,a]=VN(r);if(s.length===0)return;const o=s2(s,0,n);return o.length===0?void 0:{type:"list",ordered:!0,start:((i=s[0])==null?void 0:i.number)||1,items:o,raw:r.slice(0,a).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(UN,this.editor.getAttributes(Cy)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Oo({find:Ey,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Oo({find:Ey,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Cy)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),qN=/^\s*(\[([( |x])?\])\s$/,a2=En.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",ht(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const i=e.parseChildren(t.nestedTokens);n.push(...i)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const r=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Ng(t,e,r)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:i})=>{const r=document.createElement("li"),s=document.createElement("label"),a=document.createElement("span"),o=document.createElement("input"),l=document.createElement("div"),u=h=>{var d,p;o.ariaLabel=((p=(d=this.options.a11y)==null?void 0:d.checkboxLabel)==null?void 0:p.call(d,h,o.checked))||`Task item checkbox for ${h.textContent||"empty task item"}`};u(t),s.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",h=>h.preventDefault()),o.addEventListener("change",h=>{if(!i.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}const{checked:d}=h.target;i.isEditable&&typeof n=="function"&&i.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:p})=>{const m=n();if(typeof m!="number")return!1;const _=p.doc.nodeAt(m);return p.setNodeMarkup(m,void 0,{..._==null?void 0:_.attrs,checked:d}),!0}).run(),!i.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,d)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([h,d])=>{r.setAttribute(h,d)}),r.dataset.checked=t.attrs.checked,o.checked=t.attrs.checked,s.append(o,a),r.append(s,l),Object.entries(e).forEach(([h,d])=>{r.setAttribute(h,d)});let c=new Set(Object.keys(e));return{dom:r,contentDOM:l,update:h=>{if(h.type!==this.type)return!1;r.dataset.checked=h.attrs.checked,o.checked=h.attrs.checked,u(h);const d=i.extensionManager.attributes,p=pl(h,d),m=new Set(Object.keys(p)),_=this.options.HTMLAttributes;return c.forEach(f=>{m.has(f)||(f in _?r.setAttribute(f,_[f]):r.removeAttribute(f))}),Object.entries(p).forEach(([f,v])=>{v==null?f in _?r.setAttribute(f,_[f]):r.removeAttribute(f):r.setAttribute(f,v)}),c=m,!0}}}},addInputRules(){return[Oo({find:qN,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),l2=En.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",ht(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const i=s=>{const a=Sm(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,l)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:n.inlineTokens(o.mainContent),nestedTokens:l}),customNestedParser:i},n);return a?[{type:"taskList",raw:a.raw,items:a.items}]:n.blockTokens(s)},r=Sm(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,a)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:n.inlineTokens(s.mainContent),nestedTokens:a}),customNestedParser:i},n);if(r)return{type:"taskList",raw:r.raw,items:r.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Xe.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(YC.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(XC.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(r2.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(o2.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(a2.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(l2.configure(this.options.taskList)),t}});var KN=En.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",ht(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),JN=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,ZN=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,YN=qr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",ht(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Es({find:JN,type:this.type})]},addPasteRules(){return[jr({find:ZN,type:this.type})]}}),XN=En.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),u2=qr.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",ht(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!r)return;const s=r[2].trim();return{type:"underline",raw:r[0],text:s,tokens:n.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),QN=u2;function eI(t={}){return new Ye({view(e){return new tI(e,t)}})}class tI{constructor(e,n){var i;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=n.width)!==null&&i!==void 0?i:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let s=a=>{this[r](a)};return e.dom.addEventListener(r,s),{name:r,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,i,r=this.editorView.dom,s=r.getBoundingClientRect(),a=s.width/r.offsetWidth,o=s.height/r.offsetHeight;if(n){let h=e.nodeBefore,d=e.nodeAfter;if(h||d){let p=this.editorView.nodeDOM(this.cursorPos-(h?h.nodeSize:0));if(p){let m=p.getBoundingClientRect(),_=h?m.bottom:m.top;h&&d&&(_=(_+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let f=this.width/2*o;i={left:m.left,right:m.right,top:_-f,bottom:_+f}}}}if(!i){let h=this.editorView.coordsAtPos(this.cursorPos),d=this.width/2*a;i={left:h.left-d,right:h.left+d,top:h.top,bottom:h.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,c;if(!l||l==document.body&&getComputedStyle(l).position=="static")u=-pageXOffset,c=-pageYOffset;else{let h=l.getBoundingClientRect(),d=h.width/l.offsetWidth,p=h.height/l.offsetHeight;u=h.left-l.scrollLeft*d,c=h.top-l.scrollTop*p}this.element.style.left=(i.left-u)/a+"px",this.element.style.top=(i.top-c)/o+"px",this.element.style.width=(i.right-i.left)/a+"px",this.element.style.height=(i.bottom-i.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),i=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),r=i&&i.type.spec.disableDropCursor,s=typeof r=="function"?r(this.editorView,n,e):r;if(n&&!s){let a=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=tk(this.editorView.state.doc,a,this.editorView.dragging.slice);o!=null&&(a=o)}this.setCursor(a),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class lt extends Re{constructor(e){super(e,e)}map(e,n){let i=e.resolve(n.map(this.head));return lt.valid(i)?new lt(i):Re.near(i)}content(){return he.empty}eq(e){return e instanceof lt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new lt(e.resolve(n.pos))}getBookmark(){return new Gg(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!nI(e)||!iI(e))return!1;let i=n.type.spec.allowGapCursor;if(i!=null)return i;let r=n.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,n,i=!1){e:for(;;){if(!i&&lt.valid(e))return e;let r=e.pos,s=null;for(let a=e.depth;;a--){let o=e.node(a);if(n>0?e.indexAfter(a)<o.childCount:e.index(a)>0){s=o.child(n>0?e.indexAfter(a):e.index(a)-1);break}else if(a==0)return null;r+=n;let l=e.doc.resolve(r);if(lt.valid(l))return l}for(;;){let a=n>0?s.firstChild:s.lastChild;if(!a){if(s.isAtom&&!s.isText&&!be.isSelectable(s)){e=e.doc.resolve(r+s.nodeSize*n),i=!1;continue e}break}s=a,r+=n;let o=e.doc.resolve(r);if(lt.valid(o))return o}return null}}}lt.prototype.visible=!1;lt.findFrom=lt.findGapCursorFrom;Re.jsonID("gapcursor",lt);class Gg{constructor(e){this.pos=e}map(e){return new Gg(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return lt.valid(n)?new lt(n):Re.near(n)}}function c2(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function nI(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),i=t.node(e);if(n==0){if(i.type.spec.isolating)return!0;continue}for(let r=i.child(n-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||c2(r.type))return!0;if(r.inlineContent)return!1}}return!0}function iI(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),i=t.node(e);if(n==i.childCount){if(i.type.spec.isolating)return!0;continue}for(let r=i.child(n);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||c2(r.type))return!0;if(r.inlineContent)return!1}}return!0}function rI(){return new Ye({props:{decorations:lI,createSelectionBetween(t,e,n){return e.pos==n.pos&&lt.valid(n)?new lt(n):null},handleClick:oI,handleKeyDown:sI,handleDOMEvents:{beforeinput:aI}}})}const sI=nC({ArrowLeft:xu("horiz",-1),ArrowRight:xu("horiz",1),ArrowUp:xu("vert",-1),ArrowDown:xu("vert",1)});function xu(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(i,r,s){let a=i.selection,o=e>0?a.$to:a.$from,l=a.empty;if(a instanceof Ce){if(!s.endOfTextblock(n)||o.depth==0)return!1;l=!1,o=i.doc.resolve(e>0?o.after():o.before())}let u=lt.findGapCursorFrom(o,e,l);return u?(r&&r(i.tr.setSelection(new lt(u))),!0):!1}}function oI(t,e,n){if(!t||!t.editable)return!1;let i=t.state.doc.resolve(e);if(!lt.valid(i))return!1;let r=t.posAtCoords({left:n.clientX,top:n.clientY});return r&&r.inside>-1&&be.isSelectable(t.state.doc.nodeAt(r.inside))?!1:(t.dispatch(t.state.tr.setSelection(new lt(i))),!0)}function aI(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof lt))return!1;let{$from:n}=t.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!i)return!1;let r=ie.empty;for(let a=i.length-1;a>=0;a--)r=ie.from(i[a].createAndFill(null,r));let s=t.state.tr.replace(n.pos,n.pos,new he(r,0,0));return s.setSelection(Ce.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function lI(t){if(!(t.selection instanceof lt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",We.create(t.doc,[nt.widget(t.selection.head,e,{key:"gapcursor"})])}var kh=200,Ot=function(){};Ot.prototype.append=function(e){return e.length?(e=Ot.from(e),!this.length&&e||e.length<kh&&this.leafAppend(e)||this.length<kh&&e.leafPrepend(this)||this.appendInner(e)):this};Ot.prototype.prepend=function(e){return e.length?Ot.from(e).append(this):this};Ot.prototype.appendInner=function(e){return new uI(this,e)};Ot.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Ot.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Ot.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ot.prototype.forEach=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length),n<=i?this.forEachInner(e,n,i,0):this.forEachInvertedInner(e,n,i,0)};Ot.prototype.map=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length);var r=[];return this.forEach(function(s,a){return r.push(e(s,a))},n,i),r};Ot.from=function(e){return e instanceof Ot?e:e&&e.length?new h2(e):Ot.empty};var h2=function(t){function e(i){t.call(this),this.values=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(r,s){return r==0&&s==this.length?this:new e(this.values.slice(r,s))},e.prototype.getInner=function(r){return this.values[r]},e.prototype.forEachInner=function(r,s,a,o){for(var l=s;l<a;l++)if(r(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,a,o){for(var l=s-1;l>=a;l--)if(r(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(r){if(this.length+r.length<=kh)return new e(this.values.concat(r.flatten()))},e.prototype.leafPrepend=function(r){if(this.length+r.length<=kh)return new e(r.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Ot);Ot.empty=new h2([]);var uI=function(t){function e(n,i){t.call(this),this.left=n,this.right=i,this.length=n.length+i.length,this.depth=Math.max(n.depth,i.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},e.prototype.forEachInner=function(i,r,s,a){var o=this.left.length;if(r<o&&this.left.forEachInner(i,r,Math.min(s,o),a)===!1||s>o&&this.right.forEachInner(i,Math.max(r-o,0),Math.min(this.length,s)-o,a+o)===!1)return!1},e.prototype.forEachInvertedInner=function(i,r,s,a){var o=this.left.length;if(r>o&&this.right.forEachInvertedInner(i,r-o,Math.max(s,o)-o,a+o)===!1||s<o&&this.left.forEachInvertedInner(i,Math.min(r,o),s,a)===!1)return!1},e.prototype.sliceInner=function(i,r){if(i==0&&r==this.length)return this;var s=this.left.length;return r<=s?this.left.slice(i,r):i>=s?this.right.slice(i-s,r-s):this.left.slice(i,s).append(this.right.slice(0,r-s))},e.prototype.leafAppend=function(i){var r=this.right.leafAppend(i);if(r)return new e(this.left,r)},e.prototype.leafPrepend=function(i){var r=this.left.leafPrepend(i);if(r)return new e(r,this.right)},e.prototype.appendInner=function(i){return this.left.depth>=Math.max(this.right.depth,i.depth)+1?new e(this.left,new e(this.right,i)):new e(this,i)},e}(Ot);const cI=500;class Yn{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let i=this.items.length;for(;;i--)if(this.items.get(i-1).selection){--i;break}let r,s;n&&(r=this.remapping(i,this.items.length),s=r.maps.length);let a=e.tr,o,l,u=[],c=[];return this.items.forEach((h,d)=>{if(!h.step){r||(r=this.remapping(i,d+1),s=r.maps.length),s--,c.push(h);return}if(r){c.push(new ci(h.map));let p=h.step.map(r.slice(s)),m;p&&a.maybeStep(p).doc&&(m=a.mapping.maps[a.mapping.maps.length-1],u.push(new ci(m,void 0,void 0,u.length+c.length))),s--,m&&r.appendMap(m,s)}else a.maybeStep(h.step);if(h.selection)return o=r?h.selection.map(r.slice(s)):h.selection,l=new Yn(this.items.slice(0,i).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:a,selection:o}}addTransform(e,n,i,r){let s=[],a=this.eventCount,o=this.items,l=!r&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let h=e.steps[c].invert(e.docs[c]),d=new ci(e.mapping.maps[c],h,n),p;(p=l&&l.merge(d))&&(d=p,c?s.pop():o=o.slice(0,o.length-1)),s.push(d),n&&(a++,n=void 0),r||(l=d)}let u=a-i.depth;return u>dI&&(o=hI(o,u),a-=u),new Yn(o.append(s),a)}remapping(e,n){let i=new ll;return this.items.forEach((r,s)=>{let a=r.mirrorOffset!=null&&s-r.mirrorOffset>=e?i.maps.length-r.mirrorOffset:void 0;i.appendMap(r.map,a)},e,n),i}addMaps(e){return this.eventCount==0?this:new Yn(this.items.append(e.map(n=>new ci(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let i=[],r=Math.max(0,this.items.length-n),s=e.mapping,a=e.steps.length,o=this.eventCount;this.items.forEach(d=>{d.selection&&o--},r);let l=n;this.items.forEach(d=>{let p=s.getMirror(--l);if(p==null)return;a=Math.min(a,p);let m=s.maps[p];if(d.step){let _=e.steps[p].invert(e.docs[p]),f=d.selection&&d.selection.map(s.slice(l+1,p));f&&o++,i.push(new ci(m,_,f))}else i.push(new ci(m))},r);let u=[];for(let d=n;d<a;d++)u.push(new ci(s.maps[d]));let c=this.items.slice(0,r).append(u).append(i),h=new Yn(c,o);return h.emptyItemCount()>cI&&(h=h.compress(this.items.length-i.length)),h}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),i=n.maps.length,r=[],s=0;return this.items.forEach((a,o)=>{if(o>=e)r.push(a),a.selection&&s++;else if(a.step){let l=a.step.map(n.slice(i)),u=l&&l.getMap();if(i--,u&&n.appendMap(u,i),l){let c=a.selection&&a.selection.map(n.slice(i));c&&s++;let h=new ci(u.invert(),l,c),d,p=r.length-1;(d=r.length&&r[p].merge(h))?r[p]=d:r.push(h)}}else a.map&&i--},this.items.length,0),new Yn(Ot.from(r.reverse()),s)}}Yn.empty=new Yn(Ot.empty,0);function hI(t,e){let n;return t.forEach((i,r)=>{if(i.selection&&e--==0)return n=r,!1}),t.slice(n)}class ci{constructor(e,n,i,r){this.map=e,this.step=n,this.selection=i,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new ci(n.getMap().invert(),n,this.selection)}}}class lr{constructor(e,n,i,r,s){this.done=e,this.undone=n,this.prevRanges=i,this.prevTime=r,this.prevComposition=s}}const dI=20;function fI(t,e,n,i){let r=n.getMeta(gs),s;if(r)return r.historyState;n.getMeta(gI)&&(t=new lr(t.done,t.undone,null,0,-1));let a=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(a&&a.getMeta(gs))return a.getMeta(gs).redo?new lr(t.done.addTransform(n,void 0,i,ec(e)),t.undone,Dy(n.mapping.maps),t.prevTime,t.prevComposition):new lr(t.done,t.undone.addTransform(n,void 0,i,ec(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){let o=n.getMeta("composition"),l=t.prevTime==0||!a&&t.prevComposition!=o&&(t.prevTime<(n.time||0)-i.newGroupDelay||!pI(n,t.prevRanges)),u=a?Lf(t.prevRanges,n.mapping):Dy(n.mapping.maps);return new lr(t.done.addTransform(n,l?e.selection.getBookmark():void 0,i,ec(e)),Yn.empty,u,n.time,o??t.prevComposition)}else return(s=n.getMeta("rebased"))?new lr(t.done.rebased(n,s),t.undone.rebased(n,s),Lf(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new lr(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Lf(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function pI(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((i,r)=>{for(let s=0;s<e.length;s+=2)i<=e[s+1]&&r>=e[s]&&(n=!0)}),n}function Dy(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((i,r,s,a)=>e.push(s,a));return e}function Lf(t,e){if(!t)return null;let n=[];for(let i=0;i<t.length;i+=2){let r=e.map(t[i],1),s=e.map(t[i+1],-1);r<=s&&n.push(r,s)}return n}function mI(t,e,n){let i=ec(e),r=gs.get(e).spec.config,s=(n?t.undone:t.done).popEvent(e,i);if(!s)return null;let a=s.selection.resolve(s.transform.doc),o=(n?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),r,i),l=new lr(n?o:s.remaining,n?s.remaining:o,null,0,-1);return s.transform.setSelection(a).setMeta(gs,{redo:n,historyState:l})}let Bf=!1,Ay=null;function ec(t){let e=t.plugins;if(Ay!=e){Bf=!1,Ay=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Bf=!0;break}}return Bf}const gs=new dt("history"),gI=new dt("closeHistory");function vI(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Ye({key:gs,state:{init(){return new lr(Yn.empty,Yn.empty,null,0,-1)},apply(e,n,i){return fI(n,i,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let i=n.inputType,r=i=="historyUndo"?f2:i=="historyRedo"?p2:null;return!r||!e.editable?!1:(n.preventDefault(),r(e.state,e.dispatch))}}}})}function d2(t,e){return(n,i)=>{let r=gs.getState(n);if(!r||(t?r.undone:r.done).eventCount==0)return!1;if(i){let s=mI(r,n,t);s&&i(e?s.scrollIntoView():s)}return!0}}const f2=d2(!1,!0),p2=d2(!0,!0);Xe.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const i=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(i)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new Ye({key:new dt("characterCount"),appendTransaction:(e,n,i)=>{if(t)return;const r=this.options.limit;if(r==null||r===0){t=!0;return}const s=this.storage.characters({node:i.doc});if(s>r){const a=s-r,o=0,l=a;console.warn(`[CharacterCount] Initial content exceeded limit of ${r} characters. Content was automatically trimmed.`);const u=i.tr.deleteRange(o,l);return t=!0,u}t=!0},filterTransaction:(e,n)=>{const i=this.options.limit;if(!e.docChanged||i===0||i===null||i===void 0)return!0;const r=this.storage.characters({node:n.doc}),s=this.storage.characters({node:e.doc});if(s<=i||r>i&&s>i&&s<=r)return!0;if(r>i&&s>i&&s>r||!e.getMeta("paste"))return!1;const o=e.selection.$head.pos,l=s-i,u=o-l,c=o;return e.deleteRange(u,c),!(this.storage.characters({node:e.doc})>i)}})]}});var _I=Xe.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[eI(this.options)]}});Xe.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Ye({key:new dt("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:i}=this.editor,{anchor:r}=e,s=[];if(!n||!i)return We.create(t,[]);let a=0;this.options.mode==="deepest"&&t.descendants((l,u)=>{if(l.isText)return;if(!(r>=u&&r<=u+l.nodeSize-1))return!1;a+=1});let o=0;return t.descendants((l,u)=>{if(l.isText||!(r>=u&&r<=u+l.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&a-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";s.push(nt.node(u,u+l.nodeSize,{class:this.options.className}))}),We.create(t,s)}}})]}});var yI=Xe.create({name:"gapCursor",addProseMirrorPlugins(){return[rI()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Le(ve(t,"allowGapCursor",n)))!=null?e:null}}}),bI=Xe.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Ye({key:new dt("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,r=[];if(!n)return null;const s=this.editor.isEmpty;return t.descendants((a,o)=>{const l=i>=o&&i<=o+a.nodeSize,u=!a.isLeaf&&vd(a);if((l||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];s&&c.push(this.options.emptyEditorClass);const h=nt.node(o,o+a.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:o,hasAnchor:l}):this.options.placeholder});r.push(h)}return this.options.includeChildren}),We.create(t,r)}}})]}});Xe.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new Ye({key:new dt("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||vC(n.selection)||t.view.dragging?null:We.create(n.doc,[nt.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function Ty({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var wI=Xe.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new dt(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",i=Object.entries(this.editor.schema.nodes).map(([,r])=>r).filter(r=>(this.options.notAfter||[]).concat(n).includes(r.name));return[new Ye({key:e,appendTransaction:(r,s,a)=>{const{doc:o,tr:l,schema:u}=a,c=e.getState(a),h=o.content.size,d=u.nodes[n];if(c)return l.insert(h,d.create())},state:{init:(r,s)=>{const a=s.tr.doc.lastChild;return!Ty({node:a,types:i})},apply:(r,s)=>{if(!r.docChanged||r.getMeta("__uniqueIDTransaction"))return s;const a=r.doc.lastChild;return!Ty({node:a,types:i})}}})]}}),SI=Xe.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>f2(t,e),redo:()=>({state:t,dispatch:e})=>p2(t,e)}},addProseMirrorPlugins(){return[vI(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),xI=Xe.create({name:"starterKit",addExtensions(){var t,e,n,i;const r=[];return this.options.bold!==!1&&r.push(YP.configure(this.options.bold)),this.options.blockquote!==!1&&r.push(UP.configure(this.options.blockquote)),this.options.bulletList!==!1&&r.push(YC.configure(this.options.bulletList)),this.options.code!==!1&&r.push(eN.configure(this.options.code)),this.options.codeBlock!==!1&&r.push(iN.configure(this.options.codeBlock)),this.options.document!==!1&&r.push(rN.configure(this.options.document)),this.options.dropcursor!==!1&&r.push(_I.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&r.push(yI.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&r.push(sN.configure(this.options.hardBreak)),this.options.heading!==!1&&r.push(oN.configure(this.options.heading)),this.options.undoRedo!==!1&&r.push(SI.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&r.push(aN.configure(this.options.horizontalRule)),this.options.italic!==!1&&r.push(dN.configure(this.options.italic)),this.options.listItem!==!1&&r.push(XC.configure(this.options.listItem)),this.options.listKeymap!==!1&&r.push(r2.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&r.push(ZC.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&r.push(o2.configure(this.options.orderedList)),this.options.paragraph!==!1&&r.push(KN.configure(this.options.paragraph)),this.options.strike!==!1&&r.push(YN.configure(this.options.strike)),this.options.text!==!1&&r.push(XN.configure(this.options.text)),this.options.underline!==!1&&r.push(u2.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&r.push(wI.configure((i=this.options)==null?void 0:i.trailingNode)),r}}),m2=xI,kI=bI,CI=l2,EI=a2,DI=Xe.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).some(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).some(e=>e),toggleTextAlign:t=>({editor:e,commands:n})=>this.options.alignments.includes(t)?e.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),AI=DI,TI=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,MI=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,RI=qr.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",ht(this.options.HTMLAttributes,t),0]},renderMarkdown:(t,e)=>`==${e.renderChildren(t)}==`,parseMarkdown:(t,e)=>e.applyMark("highlight",e.parseInline(t.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:t=>t.indexOf("=="),tokenize(t,e,n){const r=/^(==)([^=]+)(==)/.exec(t);if(r){const s=r[2].trim(),a=n.inlineTokens(s);return{type:"highlight",raw:r[0],text:s,tokens:a}}}},addCommands(){return{setHighlight:t=>({commands:e})=>e.setMark(this.name,t),toggleHighlight:t=>({commands:e})=>e.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Es({find:TI,type:this.type})]},addPasteRules(){return[jr({find:MI,type:this.type})]}}),OI=RI;function Ug(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ps=Ug();function g2(t){Ps=t}var Fa={exec:()=>null};function Ie(t,e=""){let n=typeof t=="string"?t:t.source;const i={replace:(r,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(Qt.caret,"$1"),n=n.replace(r,a),i},getRegex:()=>new RegExp(n,e)};return i}var Qt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},PI=/^(?:[ \t]*(?:\n|$))+/,NI=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,II=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Il=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,LI=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,qg=/(?:[*+-]|\d{1,9}[.)])/,v2=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_2=Ie(v2).replace(/bull/g,qg).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),BI=Ie(v2).replace(/bull/g,qg).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Kg=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,zI=/^[^\n]+/,Jg=/(?!\s*\])(?:\\.|[^\[\]\\])+/,FI=Ie(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Jg).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),jI=Ie(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,qg).getRegex(),Sd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Zg=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,HI=Ie("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Zg).replace("tag",Sd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),y2=Ie(Kg).replace("hr",Il).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Sd).getRegex(),$I=Ie(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",y2).getRegex(),Yg={blockquote:$I,code:NI,def:FI,fences:II,heading:LI,hr:Il,html:HI,lheading:_2,list:jI,newline:PI,paragraph:y2,table:Fa,text:zI},My=Ie("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Il).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Sd).getRegex(),WI={...Yg,lheading:BI,table:My,paragraph:Ie(Kg).replace("hr",Il).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",My).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Sd).getRegex()},VI={...Yg,html:Ie(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Zg).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Fa,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ie(Kg).replace("hr",Il).replace("heading",` *#{1,6} *[^
]`).replace("lheading",_2).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},GI=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,UI=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,b2=/^( {2,}|\\)\n(?!\s*$)/,qI=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,xd=/[\p{P}\p{S}]/u,Xg=/[\s\p{P}\p{S}]/u,w2=/[^\s\p{P}\p{S}]/u,KI=Ie(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Xg).getRegex(),S2=/(?!~)[\p{P}\p{S}]/u,JI=/(?!~)[\s\p{P}\p{S}]/u,ZI=/(?:[^\s\p{P}\p{S}]|~)/u,YI=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,x2=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,XI=Ie(x2,"u").replace(/punct/g,xd).getRegex(),QI=Ie(x2,"u").replace(/punct/g,S2).getRegex(),k2="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",eL=Ie(k2,"gu").replace(/notPunctSpace/g,w2).replace(/punctSpace/g,Xg).replace(/punct/g,xd).getRegex(),tL=Ie(k2,"gu").replace(/notPunctSpace/g,ZI).replace(/punctSpace/g,JI).replace(/punct/g,S2).getRegex(),nL=Ie("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,w2).replace(/punctSpace/g,Xg).replace(/punct/g,xd).getRegex(),iL=Ie(/\\(punct)/,"gu").replace(/punct/g,xd).getRegex(),rL=Ie(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),sL=Ie(Zg).replace("(?:-->|$)","-->").getRegex(),oL=Ie("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",sL).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ch=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,aL=Ie(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ch).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),C2=Ie(/^!?\[(label)\]\[(ref)\]/).replace("label",Ch).replace("ref",Jg).getRegex(),E2=Ie(/^!?\[(ref)\](?:\[\])?/).replace("ref",Jg).getRegex(),lL=Ie("reflink|nolink(?!\\()","g").replace("reflink",C2).replace("nolink",E2).getRegex(),Qg={_backpedal:Fa,anyPunctuation:iL,autolink:rL,blockSkip:YI,br:b2,code:UI,del:Fa,emStrongLDelim:XI,emStrongRDelimAst:eL,emStrongRDelimUnd:nL,escape:GI,link:aL,nolink:E2,punctuation:KI,reflink:C2,reflinkSearch:lL,tag:oL,text:qI,url:Fa},uL={...Qg,link:Ie(/^!?\[(label)\]\((.*?)\)/).replace("label",Ch).getRegex(),reflink:Ie(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ch).getRegex()},Nm={...Qg,emStrongRDelimAst:tL,emStrongLDelim:QI,url:Ie(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},cL={...Nm,br:Ie(b2).replace("{2,}","*").getRegex(),text:Ie(Nm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ku={normal:Yg,gfm:WI,pedantic:VI},na={normal:Qg,gfm:Nm,breaks:cL,pedantic:uL},hL={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ry=t=>hL[t];function oi(t,e){if(e){if(Qt.escapeTest.test(t))return t.replace(Qt.escapeReplace,Ry)}else if(Qt.escapeTestNoEncode.test(t))return t.replace(Qt.escapeReplaceNoEncode,Ry);return t}function Oy(t){try{t=encodeURI(t).replace(Qt.percentDecode,"%")}catch{return null}return t}function Py(t,e){var s;const n=t.replace(Qt.findPipe,(a,o,l)=>{let u=!1,c=o;for(;--c>=0&&l[c]==="\\";)u=!u;return u?"|":" |"}),i=n.split(Qt.splitPipe);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!((s=i.at(-1))!=null&&s.trim())&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(Qt.slashPipe,"|");return i}function ia(t,e,n){const i=t.length;if(i===0)return"";let r=0;for(;r<i&&t.charAt(i-r-1)===e;)r++;return t.slice(0,i-r)}function dL(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let i=0;i<t.length;i++)if(t[i]==="\\")i++;else if(t[i]===e[0])n++;else if(t[i]===e[1]&&(n--,n<0))return i;return n>0?-2:-1}function Ny(t,e,n,i,r){const s=e.href,a=e.title||null,o=t[1].replace(r.other.outputLinkReplace,"$1");i.state.inLink=!0;const l={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:a,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,l}function fL(t,e,n){const i=t.match(n.other.indentCodeCompensation);if(i===null)return e;const r=i[1];return e.split(`
`).map(s=>{const a=s.match(n.other.beginningSpace);if(a===null)return s;const[o]=a;return o.length>=r.length?s.slice(r.length):s}).join(`
`)}var Eh=class{constructor(t){He(this,"options");He(this,"rules");He(this,"lexer");this.options=t||Ps}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:ia(n,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const n=e[0],i=fL(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){const i=ia(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:ia(e[0],`
`)}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){let n=ia(e[0],`
`).split(`
`),i="",r="";const s=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const u=o.join(`
`),c=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,r=r?`${r}
${c}`:c;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,s,!0),this.lexer.state.top=h,n.length===0)break;const d=s.at(-1);if((d==null?void 0:d.type)==="code")break;if((d==null?void 0:d.type)==="blockquote"){const p=d,m=p.raw+`
`+n.join(`
`),_=this.blockquote(m);s[s.length-1]=_,i=i.substring(0,i.length-p.raw.length)+_.raw,r=r.substring(0,r.length-p.text.length)+_.text;break}else if((d==null?void 0:d.type)==="list"){const p=d,m=p.raw+`
`+n.join(`
`),_=this.list(m);s[s.length-1]=_,i=i.substring(0,i.length-d.raw.length)+_.raw,r=r.substring(0,r.length-p.raw.length)+_.raw,n=m.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:r}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim();const i=n.length>1,r={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");const s=this.rules.other.listItemRegex(n);let a=!1;for(;t;){let l=!1,u="",c="";if(!(e=s.exec(t))||this.rules.block.hr.test(t))break;u=e[0],t=t.substring(u.length);let h=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,v=>" ".repeat(3*v.length)),d=t.split(`
`,1)[0],p=!h.trim(),m=0;if(this.options.pedantic?(m=2,c=h.trimStart()):p?m=e[1].length+1:(m=e[2].search(this.rules.other.nonSpaceChar),m=m>4?1:m,c=h.slice(m),m+=e[1].length),p&&this.rules.other.blankLine.test(d)&&(u+=d+`
`,t=t.substring(d.length+1),l=!0),!l){const v=this.rules.other.nextBulletRegex(m),g=this.rules.other.hrRegex(m),y=this.rules.other.fencesBeginRegex(m),b=this.rules.other.headingBeginRegex(m),w=this.rules.other.htmlBeginRegex(m);for(;t;){const x=t.split(`
`,1)[0];let k;if(d=x,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),k=d):k=d.replace(this.rules.other.tabCharGlobal,"    "),y.test(d)||b.test(d)||w.test(d)||v.test(d)||g.test(d))break;if(k.search(this.rules.other.nonSpaceChar)>=m||!d.trim())c+=`
`+k.slice(m);else{if(p||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||y.test(h)||b.test(h)||g.test(h))break;c+=`
`+d}!p&&!d.trim()&&(p=!0),u+=x+`
`,t=t.substring(x.length+1),h=k.slice(m)}}r.loose||(a?r.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(a=!0));let _=null,f;this.options.gfm&&(_=this.rules.other.listIsTask.exec(c),_&&(f=_[0]!=="[ ] ",c=c.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:u,task:!!_,checked:f,loose:!1,text:c,tokens:[]}),r.raw+=u}const o=r.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let l=0;l<r.items.length;l++)if(this.lexer.state.top=!1,r.items[l].tokens=this.lexer.blockTokens(r.items[l].text,[]),!r.loose){const u=r.items[l].tokens.filter(h=>h.type==="space"),c=u.length>0&&u.some(h=>this.rules.other.anyLine.test(h.raw));r.loose=c}if(r.loose)for(let l=0;l<r.items.length;l++)r.items[l].loose=!0;return r}}html(t){const e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){const e=this.rules.block.def.exec(t);if(e){const n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:i,title:r}}}table(t){var a;const e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const n=Py(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===i.length){for(const o of i)this.rules.other.tableAlignRight.test(o)?s.align.push("right"):this.rules.other.tableAlignCenter.test(o)?s.align.push("center"):this.rules.other.tableAlignLeft.test(o)?s.align.push("left"):s.align.push(null);for(let o=0;o<n.length;o++)s.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:s.align[o]});for(const o of r)s.rows.push(Py(o,s.header.length).map((l,u)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:s.align[u]})));return s}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const s=ia(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{const s=dL(e[2],"()");if(s===-2)return;if(s>-1){const o=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let i=e[2],r="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],r=s[3])}else r=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),Ny(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){const i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[i.toLowerCase()];if(!r){const s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return Ny(n,r,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const s=[...i[0]].length-1;let a,o,l=s,u=0;const c=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*t.length+s);(i=c.exec(e))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(o=[...a].length,i[3]||i[4]){l+=o;continue}else if((i[5]||i[6])&&s%3&&!((s+o)%3)){u+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+u);const h=[...i[0]][0].length,d=t.slice(0,s+i.index+h+o);if(Math.min(s,o)%2){const m=d.slice(1,-1);return{type:"em",raw:d,text:m,tokens:this.lexer.inlineTokens(m)}}const p=d.slice(2,-2);return{type:"strong",raw:d,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(n),r=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&r&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){const e=this.rules.inline.autolink.exec(t);if(e){let n,i;return e[2]==="@"?(n=e[1],i="mailto:"+n):(n=e[1],i=n),{type:"link",raw:e[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n;let e;if(e=this.rules.inline.url.exec(t)){let i,r;if(e[2]==="@")i=e[0],r="mailto:"+i;else{let s;do s=e[0],e[0]=((n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])??"";while(s!==e[0]);i=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t){const e=this.rules.inline.text.exec(t);if(e){const n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},Fi=class Im{constructor(e){He(this,"tokens");He(this,"options");He(this,"state");He(this,"tokenizer");He(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ps,this.options.tokenizer=this.options.tokenizer||new Eh,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:Qt,block:ku.normal,inline:na.normal};this.options.pedantic?(n.block=ku.pedantic,n.inline=na.pedantic):this.options.gfm&&(n.block=ku.gfm,this.options.breaks?n.inline=na.breaks:n.inline=na.gfm),this.tokenizer.rules=n}static get rules(){return{block:ku,inline:na}}static lex(e,n){return new Im(n).lex(e)}static lexInline(e,n){return new Im(n).inlineTokens(e)}lex(e){e=e.replace(Qt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const i=this.inlineQueue[n];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],i=!1){var r,s,a;for(this.options.pedantic&&(e=e.replace(Qt.tabCharGlobal,"    ").replace(Qt.spaceLine,""));e;){let o;if((s=(r=this.options.extensions)==null?void 0:r.block)!=null&&s.some(u=>(o=u.call({lexer:this},e,n))?(e=e.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);const u=n.at(-1);o.raw.length===1&&u!==void 0?u.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);const u=n.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.at(-1).src=u.text):n.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);const u=n.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.raw,this.inlineQueue.at(-1).src=u.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),n.push(o);continue}let l=e;if((a=this.options.extensions)!=null&&a.startBlock){let u=1/0;const c=e.slice(1);let h;this.options.extensions.startBlock.forEach(d=>{h=d.call({lexer:this},c),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(l=e.substring(0,u+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const u=n.at(-1);i&&(u==null?void 0:u.type)==="paragraph"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):n.push(o),i=l.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);const u=n.at(-1);(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):n.push(o);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var o,l,u;let i=e,r=null;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)c.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,r.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,a="";for(;e;){s||(a=""),s=!1;let c;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(d=>(c=d.call({lexer:this},e,n))?(e=e.substring(c.raw.length),n.push(c),!0):!1))continue;if(c=this.tokenizer.escape(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.tag(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.link(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(c.raw.length);const d=n.at(-1);c.type==="text"&&(d==null?void 0:d.type)==="text"?(d.raw+=c.raw,d.text+=c.text):n.push(c);continue}if(c=this.tokenizer.emStrong(e,i,a)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.codespan(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.br(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.del(e)){e=e.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.autolink(e)){e=e.substring(c.raw.length),n.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(e))){e=e.substring(c.raw.length),n.push(c);continue}let h=e;if((u=this.options.extensions)!=null&&u.startInline){let d=1/0;const p=e.slice(1);let m;this.options.extensions.startInline.forEach(_=>{m=_.call({lexer:this},p),typeof m=="number"&&m>=0&&(d=Math.min(d,m))}),d<1/0&&d>=0&&(h=e.substring(0,d+1))}if(c=this.tokenizer.inlineText(h)){e=e.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(a=c.raw.slice(-1)),s=!0;const d=n.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=c.raw,d.text+=c.text):n.push(c);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return n}},Dh=class{constructor(t){He(this,"options");He(this,"parser");this.options=t||Ps}space(t){return""}code({text:t,lang:e,escaped:n}){var s;const i=(s=(e||"").match(Qt.notSpaceStart))==null?void 0:s[0],r=t.replace(Qt.endingNewline,"")+`
`;return i?'<pre><code class="language-'+oi(i)+'">'+(n?r:oi(r,!0))+`</code></pre>
`:"<pre><code>"+(n?r:oi(r,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){const e=t.ordered,n=t.start;let i="";for(let a=0;a<t.items.length;a++){const o=t.items[a];i+=this.listitem(o)}const r=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+i+"</"+r+`>
`}listitem(t){var n;let e="";if(t.task){const i=this.checkbox({checked:!!t.checked});t.loose?((n=t.tokens[0])==null?void 0:n.type)==="paragraph"?(t.tokens[0].text=i+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=i+" "+oi(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):e+=i+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let r=0;r<t.header.length;r++)n+=this.tablecell(t.header[r]);e+=this.tablerow({text:n});let i="";for(let r=0;r<t.rows.length;r++){const s=t.rows[r];n="";for(let a=0;a<s.length;a++)n+=this.tablecell(s[a]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${oi(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){const i=this.parser.parseInline(n),r=Oy(t);if(r===null)return i;t=r;let s='<a href="'+t+'"';return e&&(s+=' title="'+oi(e)+'"'),s+=">"+i+"</a>",s}image({href:t,title:e,text:n,tokens:i}){i&&(n=this.parser.parseInline(i,this.parser.textRenderer));const r=Oy(t);if(r===null)return oi(n);t=r;let s=`<img src="${t}" alt="${n}"`;return e&&(s+=` title="${oi(e)}"`),s+=">",s}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:oi(t.text)}},ev=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},ji=class Lm{constructor(e){He(this,"options");He(this,"renderer");He(this,"textRenderer");this.options=e||Ps,this.options.renderer=this.options.renderer||new Dh,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ev}static parse(e,n){return new Lm(n).parse(e)}static parseInline(e,n){return new Lm(n).parseInline(e)}parse(e,n=!0){var r,s;let i="";for(let a=0;a<e.length;a++){const o=e[a];if((s=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&s[o.type]){const u=o,c=this.options.extensions.renderers[u.type].call({parser:this},u);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)){i+=c||"";continue}}const l=o;switch(l.type){case"space":{i+=this.renderer.space(l);continue}case"hr":{i+=this.renderer.hr(l);continue}case"heading":{i+=this.renderer.heading(l);continue}case"code":{i+=this.renderer.code(l);continue}case"table":{i+=this.renderer.table(l);continue}case"blockquote":{i+=this.renderer.blockquote(l);continue}case"list":{i+=this.renderer.list(l);continue}case"html":{i+=this.renderer.html(l);continue}case"paragraph":{i+=this.renderer.paragraph(l);continue}case"text":{let u=l,c=this.renderer.text(u);for(;a+1<e.length&&e[a+1].type==="text";)u=e[++a],c+=`
`+this.renderer.text(u);n?i+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):i+=c;continue}default:{const u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return i}parseInline(e,n=this.renderer){var r,s;let i="";for(let a=0;a<e.length;a++){const o=e[a];if((s=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&s[o.type]){const u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){i+=u||"";continue}}const l=o;switch(l.type){case"escape":{i+=n.text(l);break}case"html":{i+=n.html(l);break}case"link":{i+=n.link(l);break}case"image":{i+=n.image(l);break}case"strong":{i+=n.strong(l);break}case"em":{i+=n.em(l);break}case"codespan":{i+=n.codespan(l);break}case"br":{i+=n.br(l);break}case"del":{i+=n.del(l);break}case"text":{i+=n.text(l);break}default:{const u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return i}},tp,tc=(tp=class{constructor(t){He(this,"options");He(this,"block");this.options=t||Ps}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?Fi.lex:Fi.lexInline}provideParser(){return this.block?ji.parse:ji.parseInline}},He(tp,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),tp),pL=class{constructor(...t){He(this,"defaults",Ug());He(this,"options",this.setOptions);He(this,"parse",this.parseMarkdown(!0));He(this,"parseInline",this.parseMarkdown(!1));He(this,"Parser",ji);He(this,"Renderer",Dh);He(this,"TextRenderer",ev);He(this,"Lexer",Fi);He(this,"Tokenizer",Eh);He(this,"Hooks",tc);this.use(...t)}walkTokens(t,e){var i,r;let n=[];for(const s of t)switch(n=n.concat(e.call(this,s)),s.type){case"table":{const a=s;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,e));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,e));break}case"list":{const a=s;n=n.concat(this.walkTokens(a.items,e));break}default:{const a=s;(r=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&r[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,e))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,e)))}}return n}use(...t){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{const i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const s=e.renderers[r.name];s?e.renderers[r.name]=function(...a){let o=r.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=e[r.level];s?s.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),i.extensions=e),n.renderer){const r=this.defaults.renderer||new Dh(this.defaults);for(const s in n.renderer){if(!(s in r))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const a=s,o=n.renderer[a],l=r[a];r[a]=(...u)=>{let c=o.apply(r,u);return c===!1&&(c=l.apply(r,u)),c||""}}i.renderer=r}if(n.tokenizer){const r=this.defaults.tokenizer||new Eh(this.defaults);for(const s in n.tokenizer){if(!(s in r))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const a=s,o=n.tokenizer[a],l=r[a];r[a]=(...u)=>{let c=o.apply(r,u);return c===!1&&(c=l.apply(r,u)),c}}i.tokenizer=r}if(n.hooks){const r=this.defaults.hooks||new tc;for(const s in n.hooks){if(!(s in r))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const a=s,o=n.hooks[a],l=r[a];tc.passThroughHooks.has(s)?r[a]=u=>{if(this.defaults.async)return Promise.resolve(o.call(r,u)).then(h=>l.call(r,h));const c=o.call(r,u);return l.call(r,c)}:r[a]=(...u)=>{let c=o.apply(r,u);return c===!1&&(c=l.apply(r,u)),c}}i.hooks=r}if(n.walkTokens){const r=this.defaults.walkTokens,s=n.walkTokens;i.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),r&&(o=o.concat(r.call(this,a))),o}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Fi.lex(t,e??this.defaults)}parser(t,e){return ji.parse(t,e??this.defaults)}parseMarkdown(t){return(n,i)=>{const r={...i},s={...this.defaults,...r},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=t);const o=s.hooks?s.hooks.provideLexer():t?Fi.lex:Fi.lexInline,l=s.hooks?s.hooks.provideParser():t?ji.parse:ji.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(n):n).then(u=>o(u,s)).then(u=>s.hooks?s.hooks.processAllTokens(u):u).then(u=>s.walkTokens?Promise.all(this.walkTokens(u,s.walkTokens)).then(()=>u):u).then(u=>l(u,s)).then(u=>s.hooks?s.hooks.postprocess(u):u).catch(a);try{s.hooks&&(n=s.hooks.preprocess(n));let u=o(n,s);s.hooks&&(u=s.hooks.processAllTokens(u)),s.walkTokens&&this.walkTokens(u,s.walkTokens);let c=l(u,s);return s.hooks&&(c=s.hooks.postprocess(c)),c}catch(u){return a(u)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const i="<p>An error occurred:</p><pre>"+oi(n.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(n);throw n}}},Ds=new pL;function Be(t,e){return Ds.parse(t,e)}Be.options=Be.setOptions=function(t){return Ds.setOptions(t),Be.defaults=Ds.defaults,g2(Be.defaults),Be};Be.getDefaults=Ug;Be.defaults=Ps;Be.use=function(...t){return Ds.use(...t),Be.defaults=Ds.defaults,g2(Be.defaults),Be};Be.walkTokens=function(t,e){return Ds.walkTokens(t,e)};Be.parseInline=Ds.parseInline;Be.Parser=ji;Be.parser=ji.parse;Be.Renderer=Dh;Be.TextRenderer=ev;Be.Lexer=Fi;Be.lexer=Fi.lex;Be.Tokenizer=Eh;Be.Hooks=tc;Be.parse=Be;Be.options;Be.setOptions;Be.use;Be.walkTokens;Be.parseInline;ji.parse;Fi.lex;function mL(t,e){const i=e.split(`
`).flatMap(r=>[r,""]).map(r=>`${t}${r}`).join(`
`);return i.slice(0,i.length-1)}function gL(t,e){const n=[];return Array.from(t.keys()).forEach(i=>{e.has(i)||n.push(i)}),n}function vL(t,e){const n=[];return Array.from(e.entries()).forEach(([i,r])=>{t.has(i)||n.push({type:i,mark:r})}),n}function _L(t,e,n,i){const r=!n,s=n&&n.type==="text"&&(!n.marks||n.marks.length===0),a=n&&n.type==="text"&&n.marks&&!i(e,new Map(n.marks.map(l=>[l.type,l]))),o=[];if(r||s||a)if(n&&n.type==="text"&&n.marks){const l=new Map(n.marks.map(u=>[u.type,u]));Array.from(t.keys()).forEach(u=>{l.has(u)||o.push(u)})}else(r||s)&&o.push(...Array.from(t.keys()));return o}function yL(t,e){let n="";return Array.from(t.keys()).reverse().forEach(i=>{const r=t.get(i),s=e(i,r);s&&(n=s+n)}),t.clear(),n}function bL(t,e,n){let i="";return Array.from(t.entries()).forEach(([r,s])=>{const a=n(r,s);a&&(i+=a),e.set(r,s)}),i}function zf(t){const n=(t.raw||t.text||"").match(/^(\s*)[-+*]\s+\[([ xX])\]\s+/);return n?{isTask:!0,checked:n[2].toLowerCase()==="x",indentLevel:n[1].length}:{isTask:!1,indentLevel:0}}function Cu(t,e){return typeof t!="string"?"json":e}var wL=class{constructor(t){this.baseExtensions=[],this.extensions=[],this.lastParseResult=null;var e,n,i,r,s;this.markedInstance=(e=t==null?void 0:t.marked)!=null?e:Be,this.lexer=new this.markedInstance.Lexer,this.indentStyle=(i=(n=t==null?void 0:t.indentation)==null?void 0:n.style)!=null?i:"space",this.indentSize=(s=(r=t==null?void 0:t.indentation)==null?void 0:r.size)!=null?s:2,this.baseExtensions=(t==null?void 0:t.extensions)||[],t!=null&&t.markedOptions&&typeof this.markedInstance.setOptions=="function"&&this.markedInstance.setOptions(t.markedOptions),this.registry=new Map,this.nodeTypeRegistry=new Map,t!=null&&t.extensions&&(this.baseExtensions=t.extensions,gd(t.extensions).forEach(o=>this.registerExtension(o,!1))),this.lexer=new this.markedInstance.Lexer}get instance(){return this.markedInstance}get indentCharacter(){return this.indentStyle==="space"?" ":"	"}get indentString(){return this.indentCharacter.repeat(this.indentSize)}hasMarked(){return!!this.markedInstance}registerExtension(t,e=!0){var n,i;this.extensions.push(t);const r=t.name,s=ve(t,"markdownTokenName")||r,a=ve(t,"parseMarkdown"),o=ve(t,"renderMarkdown"),l=ve(t,"markdownTokenizer"),u=(n=ve(t,"markdownOptions"))!=null?n:null,c=(i=u==null?void 0:u.indentsContent)!=null?i:!1,h={tokenName:s,nodeName:r,parseMarkdown:a,renderMarkdown:o,isIndenting:c,tokenizer:l};if(s&&a){const d=this.registry.get(s)||[];d.push(h),this.registry.set(s,d)}if(o){const d=this.nodeTypeRegistry.get(r)||[];d.push(h),this.nodeTypeRegistry.set(r,d)}l&&this.hasMarked()&&(this.registerTokenizer(l),e&&(this.lexer=new this.markedInstance.Lexer))}registerTokenizer(t){if(!this.hasMarked())return;const{name:e,start:n,level:i="inline",tokenize:r}=t,o={inlineTokens:c=>this.lexer.inlineTokens(c),blockTokens:c=>this.lexer.blockTokens(c)};let l;n?l=typeof n=="function"?n:c=>c.indexOf(n):l=c=>{const h=r(c,[],o);return h&&h.raw?c.indexOf(h.raw):-1};const u={name:e,level:i,start:l,tokenizer:(c,h)=>{const d=r(c,h,o);if(d&&d.type)return{...d,type:d.type||e,raw:d.raw||"",tokens:d.tokens||[]}},childTokens:[]};this.markedInstance.use({extensions:[u]})}getHandlersForToken(t){try{return this.registry.get(t)||[]}catch{return[]}}getHandlerForToken(t){const e=this.getHandlersForToken(t);if(e.length>0)return e[0];const n=this.getHandlersForNodeType(t);return n.length>0?n[0]:void 0}getHandlersForNodeType(t){try{return this.nodeTypeRegistry.get(t)||[]}catch{return[]}}serialize(t){return t?Array.isArray(t)?this.renderNodes(t,t):this.renderNodes(t,t):""}parse(t){if(!this.hasMarked())throw new Error("No marked instance available for parsing");const e=this.markedInstance.lexer(t);return{type:"doc",content:this.parseTokens(e)}}parseTokens(t){return t.map(e=>this.parseToken(e)).filter(e=>e!==null).flatMap(e=>Array.isArray(e)?e:[e])}parseToken(t){if(!t.type)return null;if(t.type==="list")return this.parseListToken(t);const e=this.getHandlersForToken(t.type),n=this.createParseHelpers();if(e.find(r=>{if(!r.parseMarkdown)return!1;const s=r.parseMarkdown(t,n),a=this.normalizeParseResult(s);return a&&(!Array.isArray(a)||a.length>0)?(this.lastParseResult=a,!0):!1})&&this.lastParseResult){const r=this.lastParseResult;return this.lastParseResult=null,r}return this.parseFallbackToken(t)}parseListToken(t){if(!t.items||t.items.length===0)return this.parseTokenWithHandlers(t);const e=t.items.some(o=>zf(o).isTask),n=t.items.some(o=>!zf(o).isTask);if(!e||!n||this.getHandlersForToken("taskList").length===0)return this.parseTokenWithHandlers(t);const i=[];let r=[],s=null;for(let o=0;o<t.items.length;o+=1){const l=t.items[o],{isTask:u,checked:c,indentLevel:h}=zf(l);let d=l;if(u){const _=(l.raw||l.text||"").split(`
`),f=_[0].match(/^\s*[-+*]\s+\[([ xX])\]\s+(.*)$/),v=f?f[2]:"";let g=[];if(_.length>1&&_.slice(1).join(`
`).trim()){const b=_.slice(1),w=b.filter(x=>x.trim());if(w.length>0){const x=Math.min(...w.map(E=>E.length-E.trimStart().length)),S=b.map(E=>E.trim()?E.slice(x):"").join(`
`).trim();S&&(g=this.markedInstance.lexer(`${S}
`))}}d={type:"taskItem",raw:"",mainContent:v,indentLevel:h,checked:c??!1,text:v,tokens:this.lexer.inlineTokens(v),nestedTokens:g}}const p=u?"taskList":"list";s!==p?(r.length>0&&i.push({type:s,items:r}),r=[d],s=p):r.push(d)}r.length>0&&i.push({type:s,items:r});const a=[];for(let o=0;o<i.length;o+=1){const l=i[o],u={...t,type:l.type,items:l.items},c=this.parseToken(u);c&&(Array.isArray(c)?a.push(...c):a.push(c))}return a.length>0?a:null}parseTokenWithHandlers(t){if(!t.type)return null;const e=this.getHandlersForToken(t.type),n=this.createParseHelpers();if(e.find(r=>{if(!r.parseMarkdown)return!1;const s=r.parseMarkdown(t,n),a=this.normalizeParseResult(s);return a&&(!Array.isArray(a)||a.length>0)?(this.lastParseResult=a,!0):!1})&&this.lastParseResult){const r=this.lastParseResult;return this.lastParseResult=null,r}return this.parseFallbackToken(t)}createParseHelpers(){return{parseInline:t=>this.parseInlineTokens(t),parseChildren:t=>this.parseTokens(t),createTextNode:(t,e)=>({type:"text",text:t,marks:e||void 0}),createNode:(t,e,n)=>{const i={type:t,attrs:e||void 0,content:n||void 0};return(!e||Object.keys(e).length===0)&&delete i.attrs,i},applyMark:(t,e,n)=>({mark:t,content:e,attrs:n&&Object.keys(n).length>0?n:void 0})}}escapeRegex(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}parseInlineTokens(t){var e,n,i,r;const s=[];for(let a=0;a<t.length;a+=1){const o=t[a];if(o.type==="text")s.push({type:"text",text:o.text||""});else if(o.type==="html"){const l=((n=(e=o.raw)!=null?e:o.text)!=null?n:"").toString(),u=/^<\/[\s]*[\w-]+/i.test(l),c=l.match(/^<[\s]*([\w-]+)(\s|>|\/|$)/i);if(!u&&c&&!/\/>$/.test(l)){const d=c[1],p=this.escapeRegex(d),m=new RegExp(`^<\\/\\s*${p}\\b`,"i");let _=-1;const f=[l];for(let v=a+1;v<t.length;v+=1){const g=t[v],y=((r=(i=g.raw)!=null?i:g.text)!=null?r:"").toString();if(f.push(y),g.type==="html"&&m.test(y)){_=v;break}}if(_!==-1){const v=f.join(""),g={type:"html",raw:v,text:v,block:!1},y=this.parseHTMLToken(g);if(y){const b=this.normalizeParseResult(y);Array.isArray(b)?s.push(...b):b&&s.push(b)}a=_;continue}}const h=this.parseHTMLToken(o);if(h){const d=this.normalizeParseResult(h);Array.isArray(d)?s.push(...d):d&&s.push(d)}}else if(o.type){const l=this.getHandlerForToken(o.type);if(l&&l.parseMarkdown){const u=this.createParseHelpers(),c=l.parseMarkdown(o,u);if(this.isMarkResult(c)){const h=this.applyMarkToContent(c.mark,c.content,c.attrs);s.push(...h)}else{const h=this.normalizeParseResult(c);Array.isArray(h)?s.push(...h):h&&s.push(h)}}else o.tokens&&s.push(...this.parseInlineTokens(o.tokens))}}return s}applyMarkToContent(t,e,n){return e.map(i=>{if(i.type==="text"){const r=i.marks||[],s=n?{type:t,attrs:n}:{type:t};return{...i,marks:[...r,s]}}return{...i,content:i.content?this.applyMarkToContent(t,i.content,n):void 0}})}isMarkResult(t){return t&&typeof t=="object"&&"mark"in t}normalizeParseResult(t){return t?this.isMarkResult(t)?t.content:t:null}parseFallbackToken(t){switch(t.type){case"paragraph":return{type:"paragraph",content:t.tokens?this.parseInlineTokens(t.tokens):[]};case"heading":return{type:"heading",attrs:{level:t.depth||1},content:t.tokens?this.parseInlineTokens(t.tokens):[]};case"text":return{type:"text",text:t.text||""};case"html":return this.parseHTMLToken(t);case"space":return null;default:return t.tokens?this.parseTokens(t.tokens):null}}parseHTMLToken(t){const e=t.text||t.raw||"";if(!e.trim())return null;try{const n=NR(e,this.baseExtensions);return n.type==="doc"&&n.content?t.block?n.content:n.content.length===1&&n.content[0].type==="paragraph"&&n.content[0].content?n.content[0].content:n.content:n}catch(n){throw new Error(`Failed to parse HTML in markdown: ${n}`)}}renderNodeToMarkdown(t,e,n=0,i=0){var r;if(t.type==="text")return t.text||"";if(!t.type)return"";const s=this.getHandlerForToken(t.type);if(!s)return"";const a={renderChildren:(u,c)=>{const h=s.isIndenting?i+1:i;return!Array.isArray(u)&&u.content?this.renderNodes(u.content,t,c||"",n,h):this.renderNodes(u,t,c||"",n,h)},indent:u=>this.indentString+u,wrapInBlock:mL},o={index:n,level:i,parentType:e==null?void 0:e.type,meta:{}};return((r=s.renderMarkdown)==null?void 0:r.call(s,t,a,o))||""}renderNodes(t,e,n="",i=0,r=0){return Array.isArray(t)?this.renderNodesWithMarkBoundaries(t,e,n,r):t.type?this.renderNodeToMarkdown(t,e,i,r):""}renderNodesWithMarkBoundaries(t,e,n="",i=0){const r=[],s=new Map;return t.forEach((a,o)=>{const l=o<t.length-1?t[o+1]:null;if(a.type)if(a.type==="text"){let u=a.text||"";const c=new Map((a.marks||[]).map(f=>[f.type,f])),h=gL(s,c),d=vL(s,c);h.forEach(f=>{const v=s.get(f),g=this.getMarkClosing(f,v);g&&(u+=g),s.delete(f)});let p="";if(d.length>0){const f=u.match(/^(\s+)/);f&&(p=f[1],u=u.slice(p.length))}d.forEach(({type:f,mark:v})=>{const g=this.getMarkOpening(f,v);g&&(u=g+u),s.set(f,v)}),u=p+u;const m=_L(s,c,l,this.markSetsEqual.bind(this));let _="";if(m.length>0){const f=u.match(/(\s+)$/);f&&(_=f[1],u=u.slice(0,-_.length))}m.forEach(f=>{const v=s.get(f),g=this.getMarkClosing(f,v);g&&(u+=g),s.delete(f)}),u+=_,r.push(u)}else{const u=new Map(s),c=yL(s,this.getMarkClosing.bind(this)),h=this.renderNodeToMarkdown(a,e,o,i),d=a.type==="hardBreak"?"":bL(u,s,this.getMarkOpening.bind(this));r.push(c+h+d)}}),r.join(n)}getMarkOpening(t,e){const n=this.getHandlersForNodeType(t),i=n.length>0?n[0]:void 0;if(!i||!i.renderMarkdown)return"";const r="__TIPTAP_MARKDOWN_PLACEHOLDER__",s={type:t,attrs:e.attrs||{},content:[{type:"text",text:r}]};try{const a=i.renderMarkdown(s,{renderChildren:()=>r,indent:l=>l,wrapInBlock:(l,u)=>l+u},{index:0,level:0,parentType:"text",meta:{}}),o=a.indexOf(r);return o>=0?a.substring(0,o):""}catch(a){throw new Error(`Failed to get mark opening for ${t}: ${a}`)}}getMarkClosing(t,e){const n=this.getHandlersForNodeType(t),i=n.length>0?n[0]:void 0;if(!i||!i.renderMarkdown)return"";const r="__TIPTAP_MARKDOWN_PLACEHOLDER__",s={type:t,attrs:e.attrs||{},content:[{type:"text",text:r}]};try{const a=i.renderMarkdown(s,{renderChildren:()=>r,indent:u=>u,wrapInBlock:(u,c)=>u+c},{index:0,level:0,parentType:"text",meta:{}}),o=a.indexOf(r),l=o+r.length;return o>=0?a.substring(l):""}catch(a){throw new Error(`Failed to get mark closing for ${t}: ${a}`)}}markSetsEqual(t,e){return t.size!==e.size?!1:Array.from(t.keys()).every(n=>e.has(n))}},Iy=wL,SL=Xe.create({name:"markdown",addOptions(){return{indentation:{style:"space",size:2},marked:void 0,markedOptions:{}}},addCommands(){return{setContent:(t,e)=>{if(!(e!=null&&e.contentType)||Cu(t,e==null?void 0:e.contentType)!=="markdown"||!this.editor.markdown)return qn.setContent(t,e);const i=this.editor.markdown.parse(t);return qn.setContent(i,e)},insertContent:(t,e)=>{if(!(e!=null&&e.contentType)||Cu(t,e==null?void 0:e.contentType)!=="markdown"||!this.editor.markdown)return qn.insertContent(t,e);const i=this.editor.markdown.parse(t);return qn.insertContent(i,e)},insertContentAt:(t,e,n)=>{if(!(n!=null&&n.contentType)||Cu(e,n==null?void 0:n.contentType)!=="markdown"||!this.editor.markdown)return qn.insertContentAt(t,e,n);const r=this.editor.markdown.parse(e);return qn.insertContentAt(t,r,n)}}},addStorage(){return{manager:new Iy({indentation:this.options.indentation,marked:this.options.marked,markedOptions:this.options.markedOptions,extensions:[]})}},onBeforeCreate(){if(this.editor.markdown){console.error("[tiptap][markdown]: There is already a `markdown` property on the editor instance. This might lead to unexpected behavior.");return}if(this.storage.manager=new Iy({indentation:this.options.indentation,marked:this.options.marked,markedOptions:this.options.markedOptions,extensions:this.editor.extensionManager.baseExtensions}),this.editor.markdown=this.storage.manager,this.editor.getMarkdown=()=>this.storage.manager.serialize(this.editor.getJSON()),!this.editor.options.contentType||Cu(this.editor.options.content,this.editor.options.contentType)!=="markdown")return;if(!this.editor.markdown)throw new Error('[tiptap][markdown]: The `contentType` option is set to "markdown", but the Markdown extension is not added to the editor. Please add the Markdown extension to use this feature.');if(this.editor.options.content===void 0||typeof this.editor.options.content!="string")throw new Error('[tiptap][markdown]: The `contentType` option is set to "markdown", but the initial content is not a string. Please provide the initial content as a markdown string.');const e=this.editor.markdown.parse(this.editor.options.content);this.editor.options.content=e}});let D2=class{diff(e,n,i={}){let r;typeof i=="function"?(r=i,i={}):"callback"in i&&(r=i.callback);const s=this.castInput(e,i),a=this.castInput(n,i),o=this.removeEmpty(this.tokenize(s,i)),l=this.removeEmpty(this.tokenize(a,i));return this.diffWithOptionsObj(o,l,i,r)}diffWithOptionsObj(e,n,i,r){var s;const a=g=>{if(g=this.postProcess(g,i),r){setTimeout(function(){r(g)},0);return}else return g},o=n.length,l=e.length;let u=1,c=o+l;i.maxEditLength!=null&&(c=Math.min(c,i.maxEditLength));const h=(s=i.timeout)!==null&&s!==void 0?s:1/0,d=Date.now()+h,p=[{oldPos:-1,lastComponent:void 0}];let m=this.extractCommon(p[0],n,e,0,i);if(p[0].oldPos+1>=l&&m+1>=o)return a(this.buildValues(p[0].lastComponent,n,e));let _=-1/0,f=1/0;const v=()=>{for(let g=Math.max(_,-u);g<=Math.min(f,u);g+=2){let y;const b=p[g-1],w=p[g+1];b&&(p[g-1]=void 0);let x=!1;if(w){const S=w.oldPos-g;x=w&&0<=S&&S<o}const k=b&&b.oldPos+1<l;if(!x&&!k){p[g]=void 0;continue}if(!k||x&&b.oldPos<w.oldPos?y=this.addToPath(w,!0,!1,0,i):y=this.addToPath(b,!1,!0,1,i),m=this.extractCommon(y,n,e,g,i),y.oldPos+1>=l&&m+1>=o)return a(this.buildValues(y.lastComponent,n,e))||!0;p[g]=y,y.oldPos+1>=l&&(f=Math.min(f,g-1)),m+1>=o&&(_=Math.max(_,g+1))}u++};if(r)(function g(){setTimeout(function(){if(u>c||Date.now()>d)return r(void 0);v()||g()},0)})();else for(;u<=c&&Date.now()<=d;){const g=v();if(g)return g}}addToPath(e,n,i,r,s){const a=e.lastComponent;return a&&!s.oneChangePerToken&&a.added===n&&a.removed===i?{oldPos:e.oldPos+r,lastComponent:{count:a.count+1,added:n,removed:i,previousComponent:a.previousComponent}}:{oldPos:e.oldPos+r,lastComponent:{count:1,added:n,removed:i,previousComponent:a}}}extractCommon(e,n,i,r,s){const a=n.length,o=i.length;let l=e.oldPos,u=l-r,c=0;for(;u+1<a&&l+1<o&&this.equals(i[l+1],n[u+1],s);)u++,l++,c++,s.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!s.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,n,i){return i.comparator?i.comparator(e,n):e===n||!!i.ignoreCase&&e.toLowerCase()===n.toLowerCase()}removeEmpty(e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(e[i]);return n}castInput(e,n){return e}tokenize(e,n){return Array.from(e)}join(e){return e.join("")}postProcess(e,n){return e}get useLongestToken(){return!1}buildValues(e,n,i){const r=[];let s;for(;e;)r.push(e),s=e.previousComponent,delete e.previousComponent,e=s;r.reverse();const a=r.length;let o=0,l=0,u=0;for(;o<a;o++){const c=r[o];if(c.removed)c.value=this.join(i.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=n.slice(l,l+c.count);h=h.map(function(d,p){const m=i[u+p];return m.length>d.length?m:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return r}};function Ly(t,e){let n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function By(t,e){let n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function Bm(t,e,n){if(t.slice(0,e.length)!=e)throw Error(`string ${JSON.stringify(t)} doesn't start with prefix ${JSON.stringify(e)}; this is a bug`);return n+t.slice(e.length)}function zm(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error(`string ${JSON.stringify(t)} doesn't end with suffix ${JSON.stringify(e)}; this is a bug`);return t.slice(0,-e.length)+n}function ra(t,e){return Bm(t,e,"")}function Eu(t,e){return zm(t,e,"")}function zy(t,e){return e.slice(0,xL(t,e))}function xL(t,e){let n=0;t.length>e.length&&(n=t.length-e.length);let i=e.length;t.length<e.length&&(i=t.length);const r=Array(i);let s=0;r[0]=0;for(let a=1;a<i;a++){for(e[a]==e[s]?r[a]=r[s]:r[a]=s;s>0&&e[a]!=e[s];)s=r[s];e[a]==e[s]&&s++}s=0;for(let a=n;a<t.length;a++){for(;s>0&&t[a]!=e[s];)s=r[s];t[a]==e[s]&&s++}return s}function sa(t){let e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function nr(t){const e=t.match(/^\s*/);return e?e[0]:""}const Fy="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",kL=new RegExp(`[${Fy}]+|\\s+|[^${Fy}]`,"ug");class CL extends D2{equals(e,n,i){return i.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e.trim()===n.trim()}tokenize(e,n={}){let i;if(n.intlSegmenter){const a=n.intlSegmenter;if(a.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(a.segment(e),o=>o.segment)}else i=e.match(kL)||[];const r=[];let s=null;return i.forEach(a=>{/\s/.test(a)?s==null?r.push(a):r.push(r.pop()+a):s!=null&&/\s/.test(s)?r[r.length-1]==s?r.push(r.pop()+a):r.push(s+a):r.push(a),s=a}),r}join(e){return e.map((n,i)=>i==0?n:n.replace(/^\s+/,"")).join("")}postProcess(e,n){if(!e||n.oneChangePerToken)return e;let i=null,r=null,s=null;return e.forEach(a=>{a.added?r=a:a.removed?s=a:((r||s)&&jy(i,s,r,a),i=a,r=null,s=null)}),(r||s)&&jy(i,s,r,null),e}}const EL=new CL;function Ah(t,e,n){return EL.diff(t,e,n)}function jy(t,e,n,i){if(e&&n){const r=nr(e.value),s=sa(e.value),a=nr(n.value),o=sa(n.value);if(t){const l=Ly(r,a);t.value=zm(t.value,a,l),e.value=ra(e.value,l),n.value=ra(n.value,l)}if(i){const l=By(s,o);i.value=Bm(i.value,o,l),e.value=Eu(e.value,l),n.value=Eu(n.value,l)}}else if(n){if(t){const r=nr(n.value);n.value=n.value.substring(r.length)}if(i){const r=nr(i.value);i.value=i.value.substring(r.length)}}else if(t&&i){const r=nr(i.value),s=nr(e.value),a=sa(e.value),o=Ly(r,s);e.value=ra(e.value,o);const l=By(ra(r,o),a);e.value=Eu(e.value,l),i.value=Bm(i.value,r,l),t.value=zm(t.value,r,r.slice(0,r.length-l.length))}else if(i){const r=nr(i.value),s=sa(e.value),a=zy(s,r);e.value=Eu(e.value,a)}else if(t){const r=sa(t.value),s=nr(e.value),a=zy(r,s);e.value=ra(e.value,a)}}class DL extends D2{constructor(){super(...arguments),this.tokenize=TL}equals(e,n,i){return i.ignoreWhitespace?((!i.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(e,n,i)}}const AL=new DL;function tv(t,e,n){return AL.diff(t,e,n)}function TL(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const n=[],i=t.split(/(\n|\r\n)/);i[i.length-1]||i.pop();for(let r=0;r<i.length;r++){const s=i[r];r%2&&!e.newlineIsToken?n[n.length-1]+=s:n.push(s)}return n}function Hy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Hy(Object(n),!0).forEach(function(i){Fm(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hy(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Fm(t,e,n){return(e=function(i){var r=function(s,a){if(typeof s!="object"||s===null)return s;var o=s[Symbol.toPrimitive];if(o!==void 0){var l=o.call(s,a);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(s)}(i,"string");return typeof r=="symbol"?r:String(r)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Po(t,e){if(t==null)return{};var n,i,r=function(a,o){if(a==null)return{};var l,u,c={},h=Object.keys(a);for(u=0;u<h.length;u++)l=h[u],o.indexOf(l)>=0||(c[l]=a[l]);return c}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ii(t,e){return RL(t)||function(n,i){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,a,o,l,u=[],c=!0,h=!1;try{if(o=(r=r.call(n)).next,i===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(s=o.call(r)).done)&&(u.push(s.value),u.length!==i);c=!0);}catch(d){h=!0,a=d}finally{try{if(!c&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(h)throw a}}return u}}(t,e)||nv(t,e)||PL()}function ML(t){return function(e){if(Array.isArray(e))return jm(e)}(t)||OL(t)||nv(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function RL(t){if(Array.isArray(t))return t}function OL(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nv(t,e){if(t){if(typeof t=="string")return jm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jm(t,e):void 0}}function jm(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function PL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NL(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=nv(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{a||n.return==null||n.return()}finally{if(o)throw s}}}}var Du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ll(t,e){return t(e={exports:{}},e.exports),e.exports}var yn=Ll(function(t){/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function n(){for(var i=[],r=0;r<arguments.length;r++){var s=arguments[r];if(s){var a=typeof s;if(a==="string"||a==="number")i.push(s);else if(Array.isArray(s)){if(s.length){var o=n.apply(null,s);o&&i.push(o)}}else if(a==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){i.push(s.toString());continue}for(var l in s)e.call(s,l)&&s[l]&&i.push(l)}}}return i.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()}),on={hunkClassName:"",lineClassName:"",gutterClassName:"",codeClassName:"",monotonous:!1,gutterType:"default",viewType:"split",widgets:{},hideGutter:!1,selectedChanges:[],generateAnchorID:function(){},generateLineClassName:function(){},renderGutter:function(t){var e=t.renderDefault;return(0,t.wrapInAnchor)(e())},codeEvents:{},gutterEvents:{}},A2=I.createContext(on),IL=A2.Provider,LL=function(){return I.useContext(A2)},BL=Ll(function(t,e){(function(n){function i(s){var a=s.slice(11),o=null,l=null;switch(a.indexOf('"')){case-1:o=(h=a.split(" "))[0].slice(2),l=h[1].slice(2);break;case 0:var u=a.indexOf('"',2);o=a.slice(3,u);var c=a.indexOf('"',u+1);l=c<0?a.slice(u+4):a.slice(c+3,-1);break;default:var h;o=(h=a.split(" "))[0].slice(2),l=h[1].slice(3,-1)}return{oldPath:o,newPath:l}}var r={parse:function(s){for(var a,o,l,u,c,h=[],d=2,p=s.split(`
`),m=p.length,_=0;_<m;){var f=p[_];if(f.indexOf("diff --git")===0){a={hunks:[],oldEndingNewLine:!0,newEndingNewLine:!0,oldPath:(c=i(f)).oldPath,newPath:c.newPath},h.push(a);var v,g=null;e:for(;v=p[++_];){var y=v.indexOf(" "),b=y>-1?v.slice(0,y):b;switch(b){case"diff":_--;break e;case"deleted":case"new":var w=v.slice(y+1);w.indexOf("file mode")===0&&(a[b==="new"?"newMode":"oldMode"]=w.slice(10));break;case"similarity":a.similarity=parseInt(v.split(" ")[2],10);break;case"index":var x=v.slice(y+1).split(" "),k=x[0].split("..");a.oldRevision=k[0],a.newRevision=k[1],x[1]&&(a.oldMode=a.newMode=x[1]);break;case"copy":case"rename":var S=v.slice(y+1);S.indexOf("from")===0?a.oldPath=S.slice(5):a.newPath=S.slice(3),g=b;break;case"---":var E=v.slice(y+1),A=p[++_].slice(4);E==="/dev/null"?(A=A.slice(2),g="add"):A==="/dev/null"?(E=E.slice(2),g="delete"):(g="modify",E=E.slice(2),A=A.slice(2)),E&&(a.oldPath=E),A&&(a.newPath=A),d=5;break e}}a.type=g||"modify"}else if(f.indexOf("Binary")===0)a.isBinary=!0,a.type=f.indexOf("/dev/null and")>=0?"add":f.indexOf("and /dev/null")>=0?"delete":"modify",d=2,a=null;else if(d===5)if(f.indexOf("@@")===0){var M=/^@@\s+-([0-9]+)(,([0-9]+))?\s+\+([0-9]+)(,([0-9]+))?/.exec(f);o={content:f,oldStart:M[1]-0,newStart:M[4]-0,oldLines:M[3]-0||1,newLines:M[6]-0||1,changes:[]},a.hunks.push(o),l=o.oldStart,u=o.newStart}else{var R=f.slice(0,1),P={content:f.slice(1)};switch(R){case"+":P.type="insert",P.isInsert=!0,P.lineNumber=u,u++;break;case"-":P.type="delete",P.isDelete=!0,P.lineNumber=l,l++;break;case" ":P.type="normal",P.isNormal=!0,P.oldLineNumber=l,P.newLineNumber=u,l++,u++;break;case"\\":var H=o.changes[o.changes.length-1];H.isDelete||(a.newEndingNewLine=!1),H.isInsert||(a.oldEndingNewLine=!1)}P.type&&o.changes.push(P)}_++}return h}};t.exports=r})()});function Bl(t){return t.type==="insert"}function Nr(t){return t.type==="delete"}function vl(t){return t.type==="normal"}function zL(t,e){var n=e.nearbySequences==="zip"?function(i){var r=i.reduce(function(s,a,o){var l=ii(s,3),u=l[0],c=l[1],h=l[2];return c?Bl(a)&&h>=0?(u.splice(h+1,0,a),[u,a,h+2]):(u.push(a),[u,a,Nr(a)&&Nr(c)?h:o]):(u.push(a),[u,a,Nr(a)?o:-1])},[[],null,-1]);return ii(r,1)[0]}(t.changes):t.changes;return ct(ct({},t),{},{isPlain:!1,changes:n})}function FL(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=function(i){if(i.startsWith("diff --git"))return i;var r=i.indexOf(`
`),s=i.indexOf(`
`,r+1),a=i.slice(0,r),o=i.slice(r+1,s),l=a.split(" ").slice(1,-3).join(" "),u=o.split(" ").slice(1,-3).join(" ");return["diff --git a/".concat(l," b/").concat(u),"index 1111111..2222222 100644","--- a/".concat(l),"+++ b/".concat(u),i.slice(s+1)].join(`
`)}(t.trimStart());return BL.parse(n).map(function(i){return function(r,s){var a=r.hunks.map(function(o){return zL(o,s)});return ct(ct({},r),{},{hunks:a})}(i,e)})}function jL(t){return t[0]}function HL(t){return t[t.length-1]}function Hm(t){return["".concat(t,"Start"),"".concat(t,"Lines")]}function _l(t){return t==="old"?function(e){return Bl(e)?-1:vl(e)?e.oldLineNumber:e.lineNumber}:function(e){return Nr(e)?-1:vl(e)?e.newLineNumber:e.lineNumber}}function T2(t,e){return function(n,i){var r=n[t],s=r+n[e];return i>=r&&i<s}}function $L(t,e){return function(n,i,r){var s=n[t]+n[e],a=i[t];return r>=s&&r<a}}function M2(t){var e=_l(t),n=function(i){var r=ii(Hm(i),2),s=T2(r[0],r[1]);return function(a,o){return a.find(function(l){return s(l,o)})}}(t);return function(i,r){var s=n(i,r);if(s)return s.changes.find(function(a){return e(a)===r})}}function iv(t){var e=t==="old"?"new":"old",n=ii(Hm(t),2),i=n[0],r=n[1],s=ii(Hm(e),2),a=s[0],o=s[1],l=_l(t),u=_l(e),c=T2(i,r),h=$L(i,r);return function(d,p){var m=jL(d);if(p<m[i]){var _=m[i]-p;return m[a]-_}var f=HL(d);if(f[i]+f[r]<=p){var v=p-f[i]-f[r];return f[a]+f[o]+v}for(var g=0;g<d.length;g++){var y=d[g],b=d[g+1];if(c(y,p)){var w=y.changes.findIndex(function(M){return l(M)===p}),x=y.changes[w];if(vl(x))return u(x);var k=Nr(x)?w+1:w-1,S=y.changes[k];if(!S)return-1;var E=Bl(x)?"delete":"insert";return S.type===E?u(S):-1}if(h(y,b,p)){var A=p-y[i]-y[r];return y[a]+y[o]+A}}throw new Error("Unexpected line position ".concat(p))}}var WL=function(){this.__data__=[],this.size=0},R2=function(t,e){return t===e||t!=t&&e!=e},kd=function(t,e){for(var n=t.length;n--;)if(R2(t[n][0],e))return n;return-1},VL=Array.prototype.splice,GL=function(t){var e=this.__data__,n=kd(e,t);return!(n<0)&&(n==e.length-1?e.pop():VL.call(e,n,1),--this.size,!0)},UL=function(t){var e=this.__data__,n=kd(e,t);return n<0?void 0:e[n][1]},qL=function(t){return kd(this.__data__,t)>-1},KL=function(t,e){var n=this.__data__,i=kd(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};function Us(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Us.prototype.clear=WL,Us.prototype.delete=GL,Us.prototype.get=UL,Us.prototype.has=qL,Us.prototype.set=KL;var Cd=Us,JL=function(){this.__data__=new Cd,this.size=0},ZL=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},YL=function(t){return this.__data__.get(t)},XL=function(t){return this.__data__.has(t)},O2=typeof Du=="object"&&Du&&Du.Object===Object&&Du,QL=typeof self=="object"&&self&&self.Object===Object&&self,Xi=O2||QL||Function("return this")(),ki=Xi.Symbol,P2=Object.prototype,e8=P2.hasOwnProperty,t8=P2.toString,oa=ki?ki.toStringTag:void 0,n8=function(t){var e=e8.call(t,oa),n=t[oa];try{t[oa]=void 0;var i=!0}catch{}var r=t8.call(t);return i&&(e?t[oa]=n:delete t[oa]),r},i8=Object.prototype.toString,r8=function(t){return i8.call(t)},$y=ki?ki.toStringTag:void 0,Ho=function(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":$y&&$y in Object(t)?n8(t):r8(t)},rv=function(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")},N2=function(t){if(!rv(t))return!1;var e=Ho(t);return e=="[object Function]"||e=="[object GeneratorFunction]"||e=="[object AsyncFunction]"||e=="[object Proxy]"},Ff=Xi["__core-js_shared__"],Wy=function(){var t=/[^.]+$/.exec(Ff&&Ff.keys&&Ff.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),s8=function(t){return!!Wy&&Wy in t},o8=Function.prototype.toString,Ns=function(t){if(t!=null){try{return o8.call(t)}catch{}try{return t+""}catch{}}return""},a8=/^\[object .+?Constructor\]$/,l8=Function.prototype,u8=Object.prototype,c8=l8.toString,h8=u8.hasOwnProperty,d8=RegExp("^"+c8.call(h8).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),f8=function(t){return!(!rv(t)||s8(t))&&(N2(t)?d8:a8).test(Ns(t))},p8=function(t,e){return t==null?void 0:t[e]},Is=function(t,e){var n=p8(t,e);return f8(n)?n:void 0},yl=Is(Xi,"Map"),bl=Is(Object,"create"),m8=function(){this.__data__=bl?bl(null):{},this.size=0},g8=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},v8=Object.prototype.hasOwnProperty,_8=function(t){var e=this.__data__;if(bl){var n=e[t];return n==="__lodash_hash_undefined__"?void 0:n}return v8.call(e,t)?e[t]:void 0},y8=Object.prototype.hasOwnProperty,b8=function(t){var e=this.__data__;return bl?e[t]!==void 0:y8.call(e,t)},w8=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=bl&&e===void 0?"__lodash_hash_undefined__":e,this};function qs(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}qs.prototype.clear=m8,qs.prototype.delete=g8,qs.prototype.get=_8,qs.prototype.has=b8,qs.prototype.set=w8;var Vy=qs,S8=function(){this.size=0,this.__data__={hash:new Vy,map:new(yl||Cd),string:new Vy}},x8=function(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null},Ed=function(t,e){var n=t.__data__;return x8(e)?n[typeof e=="string"?"string":"hash"]:n.map},k8=function(t){var e=Ed(this,t).delete(t);return this.size-=e?1:0,e},C8=function(t){return Ed(this,t).get(t)},E8=function(t){return Ed(this,t).has(t)},D8=function(t,e){var n=Ed(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};function Ks(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Ks.prototype.clear=S8,Ks.prototype.delete=k8,Ks.prototype.get=C8,Ks.prototype.has=E8,Ks.prototype.set=D8;var Dd=Ks,A8=function(t,e){var n=this.__data__;if(n instanceof Cd){var i=n.__data__;if(!yl||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Dd(i)}return n.set(t,e),this.size=n.size,this};function Js(t){var e=this.__data__=new Cd(t);this.size=e.size}Js.prototype.clear=JL,Js.prototype.delete=ZL,Js.prototype.get=YL,Js.prototype.has=XL,Js.prototype.set=A8;var nc=Js,T8=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},M8=function(t){return this.__data__.has(t)};function ic(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Dd;++e<n;)this.add(t[e])}ic.prototype.add=ic.prototype.push=T8,ic.prototype.has=M8;var R8=ic,O8=function(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1},P8=function(t,e){return t.has(e)},I2=function(t,e,n,i,r,s){var a=1&n,o=t.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var u=s.get(t),c=s.get(e);if(u&&c)return u==e&&c==t;var h=-1,d=!0,p=2&n?new R8:void 0;for(s.set(t,e),s.set(e,t);++h<o;){var m=t[h],_=e[h];if(i)var f=a?i(_,m,h,e,t,s):i(m,_,h,t,e,s);if(f!==void 0){if(f)continue;d=!1;break}if(p){if(!O8(e,function(v,g){if(!P8(p,g)&&(m===v||r(m,v,n,i,s)))return p.push(g)})){d=!1;break}}else if(m!==_&&!r(m,_,n,i,s)){d=!1;break}}return s.delete(t),s.delete(e),d},Gy=Xi.Uint8Array,N8=function(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n},I8=function(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n},Uy=ki?ki.prototype:void 0,jf=Uy?Uy.valueOf:void 0,L8=function(t,e,n,i,r,s,a){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new Gy(t),new Gy(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return R2(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var o=N8;case"[object Set]":var l=1&i;if(o||(o=I8),t.size!=e.size&&!l)return!1;var u=a.get(t);if(u)return u==e;i|=2,a.set(t,e);var c=I2(o(t),o(e),i,r,s,a);return a.delete(t),c;case"[object Symbol]":if(jf)return jf.call(t)==jf.call(e)}return!1},B8=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t},Ji=Array.isArray,z8=function(t,e,n){var i=e(t);return Ji(t)?i:B8(i,n(t))},F8=function(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var a=t[n];e(a,n,t)&&(s[r++]=a)}return s},j8=function(){return[]},H8=Object.prototype.propertyIsEnumerable,qy=Object.getOwnPropertySymbols,$8=qy?function(t){return t==null?[]:(t=Object(t),F8(qy(t),function(e){return H8.call(t,e)}))}:j8,W8=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i},No=function(t){return t!=null&&typeof t=="object"},Ky=function(t){return No(t)&&Ho(t)=="[object Arguments]"},L2=Object.prototype,V8=L2.hasOwnProperty,G8=L2.propertyIsEnumerable,B2=Ky(function(){return arguments}())?Ky:function(t){return No(t)&&V8.call(t,"callee")&&!G8.call(t,"callee")},U8=function(){return!1},$m=Ll(function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,r=i&&i.exports===n?Xi.Buffer:void 0,s=(r?r.isBuffer:void 0)||U8;t.exports=s}),q8=/^(?:0|[1-9]\d*)$/,z2=function(t,e){var n=typeof t;return!!(e=e??9007199254740991)&&(n=="number"||n!="symbol"&&q8.test(t))&&t>-1&&t%1==0&&t<e},sv=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991},qe={};qe["[object Float32Array]"]=qe["[object Float64Array]"]=qe["[object Int8Array]"]=qe["[object Int16Array]"]=qe["[object Int32Array]"]=qe["[object Uint8Array]"]=qe["[object Uint8ClampedArray]"]=qe["[object Uint16Array]"]=qe["[object Uint32Array]"]=!0,qe["[object Arguments]"]=qe["[object Array]"]=qe["[object ArrayBuffer]"]=qe["[object Boolean]"]=qe["[object DataView]"]=qe["[object Date]"]=qe["[object Error]"]=qe["[object Function]"]=qe["[object Map]"]=qe["[object Number]"]=qe["[object Object]"]=qe["[object RegExp]"]=qe["[object Set]"]=qe["[object String]"]=qe["[object WeakMap]"]=!1;var K8=function(t){return No(t)&&sv(t.length)&&!!qe[Ho(t)]},J8=function(t){return function(e){return t(e)}},Jy=Ll(function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,r=i&&i.exports===n&&O2.process,s=function(){try{var a=i&&i.require&&i.require("util").types;return a||r&&r.binding&&r.binding("util")}catch{}}();t.exports=s}),Zy=Jy&&Jy.isTypedArray,F2=Zy?J8(Zy):K8,Z8=Object.prototype.hasOwnProperty,Y8=function(t,e){var n=Ji(t),i=!n&&B2(t),r=!n&&!i&&$m(t),s=!n&&!i&&!r&&F2(t),a=n||i||r||s,o=a?W8(t.length,String):[],l=o.length;for(var u in t)!Z8.call(t,u)||a&&(u=="length"||r&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||z2(u,l))||o.push(u);return o},X8=Object.prototype,Q8=function(t){var e=t&&t.constructor;return t===(typeof e=="function"&&e.prototype||X8)},eB=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),tB=Object.prototype.hasOwnProperty,nB=function(t){if(!Q8(t))return eB(t);var e=[];for(var n in Object(t))tB.call(t,n)&&n!="constructor"&&e.push(n);return e},iB=function(t){return t!=null&&sv(t.length)&&!N2(t)},ov=function(t){return iB(t)?Y8(t):nB(t)},Yy=function(t){return z8(t,ov,$8)},rB=Object.prototype.hasOwnProperty,sB=function(t,e,n,i,r,s){var a=1&n,o=Yy(t),l=o.length;if(l!=Yy(e).length&&!a)return!1;for(var u=l;u--;){var c=o[u];if(!(a?c in e:rB.call(e,c)))return!1}var h=s.get(t),d=s.get(e);if(h&&d)return h==e&&d==t;var p=!0;s.set(t,e),s.set(e,t);for(var m=a;++u<l;){var _=t[c=o[u]],f=e[c];if(i)var v=a?i(f,_,c,e,t,s):i(_,f,c,t,e,s);if(!(v===void 0?_===f||r(_,f,n,i,s):v)){p=!1;break}m||(m=c=="constructor")}if(p&&!m){var g=t.constructor,y=e.constructor;g==y||!("constructor"in t)||!("constructor"in e)||typeof g=="function"&&g instanceof g&&typeof y=="function"&&y instanceof y||(p=!1)}return s.delete(t),s.delete(e),p},Wm=Is(Xi,"DataView"),Vm=Is(Xi,"Promise"),Gm=Is(Xi,"Set"),Um=Is(Xi,"WeakMap"),oB=Ns(Wm),aB=Ns(yl),lB=Ns(Vm),uB=Ns(Gm),cB=Ns(Um),Xr=Ho;(Wm&&Xr(new Wm(new ArrayBuffer(1)))!="[object DataView]"||yl&&Xr(new yl)!="[object Map]"||Vm&&Xr(Vm.resolve())!="[object Promise]"||Gm&&Xr(new Gm)!="[object Set]"||Um&&Xr(new Um)!="[object WeakMap]")&&(Xr=function(t){var e=Ho(t),n=e=="[object Object]"?t.constructor:void 0,i=n?Ns(n):"";if(i)switch(i){case oB:return"[object DataView]";case aB:return"[object Map]";case lB:return"[object Promise]";case uB:return"[object Set]";case cB:return"[object WeakMap]"}return e});var Xy=Xr,Au="[object Object]",Qy=Object.prototype.hasOwnProperty,hB=function(t,e,n,i,r,s){var a=Ji(t),o=Ji(e),l=a?"[object Array]":Xy(t),u=o?"[object Array]":Xy(e),c=(l=l=="[object Arguments]"?Au:l)==Au,h=(u=u=="[object Arguments]"?Au:u)==Au,d=l==u;if(d&&$m(t)){if(!$m(e))return!1;a=!0,c=!1}if(d&&!c)return s||(s=new nc),a||F2(t)?I2(t,e,n,i,r,s):L8(t,e,l,n,i,r,s);if(!(1&n)){var p=c&&Qy.call(t,"__wrapped__"),m=h&&Qy.call(e,"__wrapped__");if(p||m){var _=p?t.value():t,f=m?e.value():e;return s||(s=new nc),r(_,f,n,i,s)}}return!!d&&(s||(s=new nc),sB(t,e,n,i,r,s))},j2=function t(e,n,i,r,s){return e===n||(e==null||n==null||!No(e)&&!No(n)?e!=e&&n!=n:hB(e,n,i,r,t,s))},dB=function(t,e,n,i){var r=n.length,s=r;if(t==null)return!s;for(t=Object(t);r--;){var a=n[r];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<s;){var o=(a=n[r])[0],l=t[o],u=a[1];if(a[2]){if(l===void 0&&!(o in t))return!1}else{var c=new nc,h;if(!(h===void 0?j2(u,l,3,i,c):h))return!1}}return!0},H2=function(t){return t==t&&!rv(t)},fB=function(t){for(var e=ov(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,H2(r)]}return e},$2=function(t,e){return function(n){return n!=null&&n[t]===e&&(e!==void 0||t in Object(n))}},pB=function(t){var e=fB(t);return e.length==1&&e[0][2]?$2(e[0][0],e[0][1]):function(n){return n===t||dB(n,t,e)}},av=function(t){return typeof t=="symbol"||No(t)&&Ho(t)=="[object Symbol]"},mB=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gB=/^\w*$/,lv=function(t,e){if(Ji(t))return!1;var n=typeof t;return!(n!="number"&&n!="symbol"&&n!="boolean"&&t!=null&&!av(t))||gB.test(t)||!mB.test(t)||e!=null&&t in Object(e)};function uv(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var a=t.apply(this,i);return n.cache=s.set(r,a)||s,a};return n.cache=new(uv.Cache||Dd),n}uv.Cache=Dd;var vB=uv,_B=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yB=/\\(\\)?/g,bB=function(t){var e=vB(t,function(i){return n.size===500&&n.clear(),i}),n=e.cache;return e}(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(_B,function(n,i,r,s){e.push(r?s.replace(yB,"$1"):i||n)}),e}),wB=function(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r},eb=ki?ki.prototype:void 0,tb=eb?eb.toString:void 0,SB=function t(e){if(typeof e=="string")return e;if(Ji(e))return wB(e,t)+"";if(av(e))return tb?tb.call(e):"";var n=e+"";return n=="0"&&1/e==-1/0?"-0":n},xB=function(t){return t==null?"":SB(t)},W2=function(t,e){return Ji(t)?t:lv(t,e)?[t]:bB(xB(t))},Ad=function(t){if(typeof t=="string"||av(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e},V2=function(t,e){for(var n=0,i=(e=W2(e,t)).length;t!=null&&n<i;)t=t[Ad(e[n++])];return n&&n==i?t:void 0},kB=function(t,e,n){var i=t==null?void 0:V2(t,e);return i===void 0?n:i},CB=function(t,e){return t!=null&&e in Object(t)},EB=function(t,e,n){for(var i=-1,r=(e=W2(e,t)).length,s=!1;++i<r;){var a=Ad(e[i]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++i!=r?s:!!(r=t==null?0:t.length)&&sv(r)&&z2(a,r)&&(Ji(t)||B2(t))},DB=function(t,e){return t!=null&&EB(t,e,CB)},AB=function(t,e){return lv(t)&&H2(e)?$2(Ad(t),e):function(n){var i=kB(n,t);return i===void 0&&i===e?DB(n,t):j2(e,i,3)}},TB=function(t){return t},MB=function(t){return function(e){return e==null?void 0:e[t]}},RB=function(t){return function(e){return V2(e,t)}},OB=function(t){return lv(t)?MB(Ad(t)):RB(t)},PB=function(t){return typeof t=="function"?t:t==null?TB:typeof t=="object"?Ji(t)?AB(t[0],t[1]):pB(t):OB(t)};function Ir(t){if(!t)throw new Error("change is not provided");if(vl(t))return"N".concat(t.oldLineNumber);var e=Bl(t)?"I":"D";return"".concat(e).concat(t.lineNumber)}iv("old");var cv=_l("old"),hv=_l("new");M2("old");M2("new");iv("new");iv("old");var nb=function(){try{var t=Is(Object,"defineProperty");return t({},"",{}),t}catch{}}(),NB=function(t,e,n){e=="__proto__"&&nb?nb(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},IB=function(t){return function(e,n,i){for(var r=-1,s=Object(e),a=i(e),o=a.length;o--;){var l=a[++r];if(n(s[l],l,s)===!1)break}return e}},LB=IB(),BB=function(t,e){return t&&LB(t,e,ov)},G2=function(t,e){var n={};return e=PB(e),BB(t,function(i,r,s){NB(n,r,e(i,r,s))}),n},zB=["changeKey","text","tokens","renderToken"],ib=function t(e,n){var i=e.type,r=e.value,s=e.markType,a=e.properties,o=e.className,l=e.children,u=function(h){return C.jsx("span",{className:h,children:r||l&&l.map(t)},n)};switch(i){case"text":return r;case"mark":return u("diff-code-mark diff-code-mark-".concat(s));case"edit":return u("diff-code-edit");default:var c=a&&a.className;return u(yn(o||c))}};function FB(t){if(!Array.isArray(t))return!0;if(t.length>1)return!1;if(t.length===1){var e=ii(t,1)[0];return e.type==="text"&&!e.value}return!0}function jB(t){var e=t.changeKey,n=t.text,i=t.tokens,r=t.renderToken,s=Po(t,zB),a=r?function(o,l){return r(o,ib,l)}:ib;return C.jsx("td",ct(ct({},s),{},{"data-change-key":e,children:i?FB(i)?" ":i.map(a):n||" "}))}var U2=I.memo(jB);function q2(t,e){return function(){var n=e==="old"?cv(t):hv(t);return n===-1?void 0:n}}function K2(t,e){return function(n){return t&&n?C.jsx("a",{href:e?"#"+e:void 0,children:n}):n}}function Th(t,e){return e?function(n){t(),e(n)}:t}function rb(t,e,n,i){return I.useMemo(function(){var r=G2(t,function(s){return function(a){return s&&s(e,a)}});return r.onMouseEnter=Th(n,r.onMouseEnter),r.onMouseLeave=Th(i,r.onMouseLeave),r},[t,n,i,e])}function sb(t,e,n,i,r,s,a,o,l){var u={change:e,side:i,inHoverState:o,renderDefault:q2(e,i),wrapInAnchor:K2(r,s)};return C.jsx("td",ct(ct({className:t},a),{},{"data-change-key":n,children:l(u)}))}function HB(t){var e,n,i,r=t.change,s=t.selected,a=t.tokens,o=t.className,l=t.generateLineClassName,u=t.gutterClassName,c=t.codeClassName,h=t.gutterEvents,d=t.codeEvents,p=t.hideGutter,m=t.gutterAnchor,_=t.generateAnchorID,f=t.renderToken,v=t.renderGutter,g=r.type,y=r.content,b=Ir(r),w=(e=ii(I.useState(!1),2),n=e[0],i=e[1],[n,I.useCallback(function(){return i(!0)},[]),I.useCallback(function(){return i(!1)},[])]),x=ii(w,3),k=x[0],S=x[1],E=x[2],A=I.useMemo(function(){return{change:r}},[r]),M=rb(h,A,S,E),R=rb(d,A,S,E),P=_(r),H=l({changes:[r],defaultGenerate:function(){return o}}),B=yn("diff-gutter","diff-gutter-".concat(g),u,{"diff-gutter-selected":s}),L=yn("diff-code","diff-code-".concat(g),c,{"diff-code-selected":s});return C.jsxs("tr",{id:P,className:yn("diff-line",H),children:[!p&&sb(B,r,b,"old",m,P,M,k,v),!p&&sb(B,r,b,"new",m,P,M,k,v),C.jsx(U2,ct({className:L,changeKey:b,text:y,tokens:a,renderToken:f},R))]})}var $B=I.memo(HB);function WB(t){var e=t.hideGutter,n=t.element;return C.jsx("tr",{className:"diff-widget",children:C.jsx("td",{colSpan:e?1:3,className:"diff-widget-content",children:n})})}var VB=["hideGutter","selectedChanges","tokens","lineClassName"],GB=["hunk","widgets","className"];function UB(t){var e=t.hunk,n=t.widgets,i=t.className,r=Po(t,GB),s=function(a,o){return a.reduce(function(l,u){var c=Ir(u);l.push(["change",c,u]);var h=o[c];return h&&l.push(["widget",c,h]),l},[])}(e.changes,n);return C.jsx("tbody",{className:yn("diff-hunk",i),children:s.map(function(a){return function(o,l){var u=ii(o,3),c=u[0],h=u[1],d=u[2],p=l.hideGutter,m=l.selectedChanges,_=l.tokens,f=l.lineClassName,v=Po(l,VB);if(c==="change"){var g=Nr(d)?"old":"new",y=Nr(d)?cv(d):hv(d),b=_?_[g][y-1]:null;return C.jsx($B,ct({className:f,change:d,hideGutter:p,selected:m.includes(h),tokens:b},v),"change".concat(h))}return c==="widget"?C.jsx(WB,{hideGutter:p,element:d},"widget".concat(h)):null}(a,r)})})}var J2=0;function Tu(t,e,n,i){var r=I.useCallback(function(){return e(t)},[t,e]),s=I.useCallback(function(){return e("")},[e]);return I.useMemo(function(){var a=G2(i,function(o){return function(l){return o&&o({side:t,change:n},l)}});return a.onMouseEnter=Th(r,a.onMouseEnter),a.onMouseLeave=Th(s,a.onMouseLeave),a},[n,i,r,t,s])}function Hf(t){var e=t.change,n=t.side,i=t.selected,r=t.tokens,s=t.gutterClassName,a=t.codeClassName,o=t.gutterEvents,l=t.codeEvents,u=t.anchorID,c=t.gutterAnchor,h=t.gutterAnchorTarget,d=t.hideGutter,p=t.hover,m=t.renderToken,_=t.renderGutter;if(!e){var f=yn("diff-gutter","diff-gutter-omit",s),v=yn("diff-code","diff-code-omit",a);return[!d&&C.jsx("td",{className:f},"gutter"),C.jsx("td",{className:v},"code")]}var g=e.type,y=e.content,b=Ir(e),w=n===J2?"old":"new",x=ct({id:u||void 0,className:yn("diff-gutter","diff-gutter-".concat(g),Fm({"diff-gutter-selected":i},"diff-line-hover-"+w,p),s),children:_({change:e,side:w,inHoverState:p,renderDefault:q2(e,w),wrapInAnchor:K2(c,h)})},o),k=yn("diff-code","diff-code-".concat(g),Fm({"diff-code-selected":i},"diff-line-hover-"+w,p),a);return[!d&&C.jsx("td",ct(ct({},x),{},{"data-change-key":b}),"gutter"),C.jsx(U2,ct({className:k,changeKey:b,text:y,tokens:r,renderToken:m},l),"code")]}function qB(t){var e=t.className,n=t.oldChange,i=t.newChange,r=t.oldSelected,s=t.newSelected,a=t.oldTokens,o=t.newTokens,l=t.monotonous,u=t.gutterClassName,c=t.codeClassName,h=t.gutterEvents,d=t.codeEvents,p=t.hideGutter,m=t.generateAnchorID,_=t.generateLineClassName,f=t.gutterAnchor,v=t.renderToken,g=t.renderGutter,y=ii(I.useState(""),2),b=y[0],w=y[1],x=Tu("old",w,n,h),k=Tu("new",w,i,h),S=Tu("old",w,n,d),E=Tu("new",w,i,d),A=n&&m(n),M=i&&m(i),R=_({changes:[n,i],defaultGenerate:function(){return e}}),P={monotonous:l,hideGutter:p,gutterClassName:u,codeClassName:c,gutterEvents:h,codeEvents:d,renderToken:v,renderGutter:g},H=ct(ct({},P),{},{change:n,side:J2,selected:r,tokens:a,gutterEvents:x,codeEvents:S,anchorID:A,gutterAnchor:f,gutterAnchorTarget:A,hover:b==="old"}),B=ct(ct({},P),{},{change:i,side:1,selected:s,tokens:o,gutterEvents:k,codeEvents:E,anchorID:n===i?null:M,gutterAnchor:f,gutterAnchorTarget:n===i?A:M,hover:b==="new"});if(l)return C.jsx("tr",{className:yn("diff-line",R),children:Hf(n?H:B)});var L=function(j,D){return j&&!D?"diff-line-old-only":!j&&D?"diff-line-new-only":j===D?"diff-line-normal":"diff-line-compare"}(n,i);return C.jsxs("tr",{className:yn("diff-line",L,R),children:[Hf(H),Hf(B)]})}var KB=I.memo(qB);function JB(t){var e=t.hideGutter,n=t.oldElement,i=t.newElement;return t.monotonous?C.jsx("tr",{className:"diff-widget",children:C.jsx("td",{colSpan:e?1:2,className:"diff-widget-content",children:n||i})}):n===i?C.jsx("tr",{className:"diff-widget",children:C.jsx("td",{colSpan:e?2:4,className:"diff-widget-content",children:n})}):C.jsxs("tr",{className:"diff-widget",children:[C.jsx("td",{colSpan:e?1:2,className:"diff-widget-content",children:n}),C.jsx("td",{colSpan:e?1:2,className:"diff-widget-content",children:i})]})}var ZB=["selectedChanges","monotonous","hideGutter","tokens","lineClassName"],YB=["hunk","widgets","className"];function Mu(t,e){return(t?Ir(t):"00")+(e?Ir(e):"00")}function XB(t){var e=t.hunk,n=t.widgets,i=t.className,r=Po(t,YB),s=function(a,o){for(var l=function(v){if(!v)return null;var g=Ir(v);return o[g]||null},u=[],c=0;c<a.length;c++){var h=a[c];if(vl(h))u.push(["change",Mu(h,h),h,h]);else if(Nr(h)){var d=a[c+1];d&&Bl(d)?(c+=1,u.push(["change",Mu(h,d),h,d])):u.push(["change",Mu(h,null),h,null])}else u.push(["change",Mu(null,h),null,h]);var p=u[u.length-1],m=l(p[2]),_=l(p[3]);if(m||_){var f=p[1];u.push(["widget",f,m,_])}}return u}(e.changes,n);return C.jsx("tbody",{className:yn("diff-hunk",i),children:s.map(function(a){return function(o,l){var u=ii(o,4),c=u[0],h=u[1],d=u[2],p=u[3],m=l.selectedChanges,_=l.monotonous,f=l.hideGutter,v=l.tokens,g=l.lineClassName,y=Po(l,ZB);if(c==="change"){var b=!!d&&m.includes(Ir(d)),w=!!p&&m.includes(Ir(p)),x=d&&v?v.old[cv(d)-1]:null,k=p&&v?v.new[hv(p)-1]:null;return C.jsx(KB,ct({className:g,oldChange:d,newChange:p,monotonous:_,hideGutter:f,oldSelected:b,newSelected:w,oldTokens:x,newTokens:k},y),"change".concat(h))}return c==="widget"?C.jsx(JB,{monotonous:_,hideGutter:f,oldElement:d,newElement:p},"widget".concat(h)):null}(a,r)})})}var QB=["gutterType","hunkClassName"];function Z2(t){var e=t.hunk,n=LL(),i=n.gutterType,r=n.hunkClassName,s=Po(n,QB),a=i==="none",o=i==="anchor",l=s.viewType==="unified"?UB:XB;return C.jsx(l,ct(ct({},s),{},{hunk:e,hideGutter:a,gutterAnchor:o,className:r}))}function ez(){}function ob(t,e){var n=e?"auto":"none";t instanceof HTMLElement&&t.style.userSelect!==n&&(t.style.userSelect=n)}function tz(t){return t.map(function(e){return C.jsx(Z2,{hunk:e},function(n){return"-".concat(n.oldStart,",").concat(n.oldLines," +").concat(n.newStart,",").concat(n.newLines)}(e))})}function nz(t){var e=t.diffType,n=t.hunks,i=t.optimizeSelection,r=t.className,s=t.hunkClassName,a=s===void 0?on.hunkClassName:s,o=t.lineClassName,l=o===void 0?on.lineClassName:o,u=t.generateLineClassName,c=u===void 0?on.generateLineClassName:u,h=t.gutterClassName,d=h===void 0?on.gutterClassName:h,p=t.codeClassName,m=p===void 0?on.codeClassName:p,_=t.gutterType,f=_===void 0?on.gutterType:_,v=t.viewType,g=v===void 0?on.viewType:v,y=t.gutterEvents,b=y===void 0?on.gutterEvents:y,w=t.codeEvents,x=w===void 0?on.codeEvents:w,k=t.generateAnchorID,S=k===void 0?on.generateAnchorID:k,E=t.selectedChanges,A=E===void 0?on.selectedChanges:E,M=t.widgets,R=M===void 0?on.widgets:M,P=t.renderGutter,H=P===void 0?on.renderGutter:P,B=t.tokens,L=t.renderToken,j=t.children,D=j===void 0?tz:j,O=I.useRef(null),N=I.useCallback(function(ce){var T=ce.target;if(ce.button===0){var $=function(ne,oe){for(var ae=ne;ae&&ae!==document.documentElement&&!ae.classList.contains(oe);)ae=ae.parentElement;return ae===document.documentElement?null:ae}(T,"diff-code");if($&&$.parentElement){var Z=window.getSelection();Z&&Z.removeAllRanges();var F=ML($.parentElement.children).indexOf($);if(F===1||F===3){var V,G=NL(O.current?O.current.querySelectorAll(".diff-line"):[]);try{for(G.s();!(V=G.n()).done;){var W=V.value.children;ob(W[1],F===1),ob(W[3],F===3)}}catch(ne){G.e(ne)}finally{G.f()}}}}},[]),z=f==="none",q=e==="add"||e==="delete",te=g==="split"&&!q&&i?N:ez,ee=I.useMemo(function(){return C.jsxs("colgroup",g==="unified"?{children:[!z&&C.jsx("col",{className:"diff-gutter-col"}),!z&&C.jsx("col",{className:"diff-gutter-col"}),C.jsx("col",{})]}:q?{children:[!z&&C.jsx("col",{className:"diff-gutter-col"}),C.jsx("col",{})]}:{children:[!z&&C.jsx("col",{className:"diff-gutter-col"}),C.jsx("col",{}),!z&&C.jsx("col",{className:"diff-gutter-col"}),C.jsx("col",{})]})},[g,q,z]),K=I.useMemo(function(){return{hunkClassName:a,lineClassName:l,generateLineClassName:c,gutterClassName:d,codeClassName:m,monotonous:q,hideGutter:z,viewType:g,gutterType:f,codeEvents:x,gutterEvents:b,generateAnchorID:S,selectedChanges:A,widgets:R,renderGutter:H,tokens:B,renderToken:L}},[m,x,S,d,b,f,z,a,l,c,q,H,L,A,B,g,R]);return C.jsx(IL,{value:K,children:C.jsxs("table",{ref:O,className:yn("diff","diff-".concat(g),r),onMouseDown:te,children:[ee,D(n)]})})}var iz=I.memo(nz);ki&&ki.isConcatSpreadable;var dv=Ll(function(t){var e=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32};e.Diff=function(n,i){return[n,i]},e.prototype.diff_main=function(n,i,r,s){s===void 0&&(s=this.Diff_Timeout<=0?Number.MAX_VALUE:new Date().getTime()+1e3*this.Diff_Timeout);var a=s;if(n==null||i==null)throw new Error("Null input. (diff_main)");if(n==i)return n?[new e.Diff(0,n)]:[];r===void 0&&(r=!0);var o=r,l=this.diff_commonPrefix(n,i),u=n.substring(0,l);n=n.substring(l),i=i.substring(l),l=this.diff_commonSuffix(n,i);var c=n.substring(n.length-l);n=n.substring(0,n.length-l),i=i.substring(0,i.length-l);var h=this.diff_compute_(n,i,o,a);return u&&h.unshift(new e.Diff(0,u)),c&&h.push(new e.Diff(0,c)),this.diff_cleanupMerge(h),h},e.prototype.diff_compute_=function(n,i,r,s){var a;if(!n)return[new e.Diff(1,i)];if(!i)return[new e.Diff(-1,n)];var o=n.length>i.length?n:i,l=n.length>i.length?i:n,u=o.indexOf(l);if(u!=-1)return a=[new e.Diff(1,o.substring(0,u)),new e.Diff(0,l),new e.Diff(1,o.substring(u+l.length))],n.length>i.length&&(a[0][0]=a[2][0]=-1),a;if(l.length==1)return[new e.Diff(-1,n),new e.Diff(1,i)];var c=this.diff_halfMatch_(n,i);if(c){var h=c[0],d=c[1],p=c[2],m=c[3],_=c[4],f=this.diff_main(h,p,r,s),v=this.diff_main(d,m,r,s);return f.concat([new e.Diff(0,_)],v)}return r&&n.length>100&&i.length>100?this.diff_lineMode_(n,i,s):this.diff_bisect_(n,i,s)},e.prototype.diff_lineMode_=function(n,i,r){var s=this.diff_linesToChars_(n,i);n=s.chars1,i=s.chars2;var a=s.lineArray,o=this.diff_main(n,i,!1,r);this.diff_charsToLines_(o,a),this.diff_cleanupSemantic(o),o.push(new e.Diff(0,""));for(var l=0,u=0,c=0,h="",d="";l<o.length;){switch(o[l][0]){case 1:c++,d+=o[l][1];break;case-1:u++,h+=o[l][1];break;case 0:if(u>=1&&c>=1){o.splice(l-u-c,u+c),l=l-u-c;for(var p=this.diff_main(h,d,!1,r),m=p.length-1;m>=0;m--)o.splice(l,0,p[m]);l+=p.length}c=0,u=0,h="",d=""}l++}return o.pop(),o},e.prototype.diff_bisect_=function(n,i,r){for(var s=n.length,a=i.length,o=Math.ceil((s+a)/2),l=o,u=2*o,c=new Array(u),h=new Array(u),d=0;d<u;d++)c[d]=-1,h[d]=-1;c[l+1]=0,h[l+1]=0;for(var p=s-a,m=p%2!=0,_=0,f=0,v=0,g=0,y=0;y<o&&!(new Date().getTime()>r);y++){for(var b=-y+_;b<=y-f;b+=2){for(var w=l+b,x=(M=b==-y||b!=y&&c[w-1]<c[w+1]?c[w+1]:c[w-1]+1)-b;M<s&&x<a&&n.charAt(M)==i.charAt(x);)M++,x++;if(c[w]=M,M>s)f+=2;else if(x>a)_+=2;else if(m&&(E=l+p-b)>=0&&E<u&&h[E]!=-1&&M>=(S=s-h[E]))return this.diff_bisectSplit_(n,i,M,x,r)}for(var k=-y+v;k<=y-g;k+=2){for(var S,E=l+k,A=(S=k==-y||k!=y&&h[E-1]<h[E+1]?h[E+1]:h[E-1]+1)-k;S<s&&A<a&&n.charAt(s-S-1)==i.charAt(a-A-1);)S++,A++;if(h[E]=S,S>s)g+=2;else if(A>a)v+=2;else if(!m&&(w=l+p-k)>=0&&w<u&&c[w]!=-1){var M;if(x=l+(M=c[w])-w,M>=(S=s-S))return this.diff_bisectSplit_(n,i,M,x,r)}}}return[new e.Diff(-1,n),new e.Diff(1,i)]},e.prototype.diff_bisectSplit_=function(n,i,r,s,a){var o=n.substring(0,r),l=i.substring(0,s),u=n.substring(r),c=i.substring(s),h=this.diff_main(o,l,!1,a),d=this.diff_main(u,c,!1,a);return h.concat(d)},e.prototype.diff_linesToChars_=function(n,i){var r=[],s={};function a(u){for(var c="",h=0,d=-1,p=r.length;d<u.length-1;){(d=u.indexOf(`
`,h))==-1&&(d=u.length-1);var m=u.substring(h,d+1);(s.hasOwnProperty?s.hasOwnProperty(m):s[m]!==void 0)?c+=String.fromCharCode(s[m]):(p==o&&(m=u.substring(h),d=u.length),c+=String.fromCharCode(p),s[m]=p,r[p++]=m),h=d+1}return c}r[0]="";var o=4e4,l=a(n);return o=65535,{chars1:l,chars2:a(i),lineArray:r}},e.prototype.diff_charsToLines_=function(n,i){for(var r=0;r<n.length;r++){for(var s=n[r][1],a=[],o=0;o<s.length;o++)a[o]=i[s.charCodeAt(o)];n[r][1]=a.join("")}},e.prototype.diff_commonPrefix=function(n,i){if(!n||!i||n.charAt(0)!=i.charAt(0))return 0;for(var r=0,s=Math.min(n.length,i.length),a=s,o=0;r<a;)n.substring(o,a)==i.substring(o,a)?o=r=a:s=a,a=Math.floor((s-r)/2+r);return a},e.prototype.diff_commonSuffix=function(n,i){if(!n||!i||n.charAt(n.length-1)!=i.charAt(i.length-1))return 0;for(var r=0,s=Math.min(n.length,i.length),a=s,o=0;r<a;)n.substring(n.length-a,n.length-o)==i.substring(i.length-a,i.length-o)?o=r=a:s=a,a=Math.floor((s-r)/2+r);return a},e.prototype.diff_commonOverlap_=function(n,i){var r=n.length,s=i.length;if(r==0||s==0)return 0;r>s?n=n.substring(r-s):r<s&&(i=i.substring(0,r));var a=Math.min(r,s);if(n==i)return a;for(var o=0,l=1;;){var u=n.substring(a-l),c=i.indexOf(u);if(c==-1)return o;l+=c,c!=0&&n.substring(a-l)!=i.substring(0,l)||(o=l,l++)}},e.prototype.diff_halfMatch_=function(n,i){if(this.Diff_Timeout<=0)return null;var r=n.length>i.length?n:i,s=n.length>i.length?i:n;if(r.length<4||2*s.length<r.length)return null;var a=this;function o(_,f,v){for(var g,y,b,w,x=_.substring(v,v+Math.floor(_.length/4)),k=-1,S="";(k=f.indexOf(x,k+1))!=-1;){var E=a.diff_commonPrefix(_.substring(v),f.substring(k)),A=a.diff_commonSuffix(_.substring(0,v),f.substring(0,k));S.length<A+E&&(S=f.substring(k-A,k)+f.substring(k,k+E),g=_.substring(0,v-A),y=_.substring(v+E),b=f.substring(0,k-A),w=f.substring(k+E))}return 2*S.length>=_.length?[g,y,b,w,S]:null}var l,u,c,h,d,p=o(r,s,Math.ceil(r.length/4)),m=o(r,s,Math.ceil(r.length/2));return p||m?(l=m?p&&p[4].length>m[4].length?p:m:p,n.length>i.length?(u=l[0],c=l[1],h=l[2],d=l[3]):(h=l[0],d=l[1],u=l[2],c=l[3]),[u,c,h,d,l[4]]):null},e.prototype.diff_cleanupSemantic=function(n){for(var i=!1,r=[],s=0,a=null,o=0,l=0,u=0,c=0,h=0;o<n.length;)n[o][0]==0?(r[s++]=o,l=c,u=h,c=0,h=0,a=n[o][1]):(n[o][0]==1?c+=n[o][1].length:h+=n[o][1].length,a&&a.length<=Math.max(l,u)&&a.length<=Math.max(c,h)&&(n.splice(r[s-1],0,new e.Diff(-1,a)),n[r[s-1]+1][0]=1,s--,o=--s>0?r[s-1]:-1,l=0,u=0,c=0,h=0,a=null,i=!0)),o++;for(i&&this.diff_cleanupMerge(n),this.diff_cleanupSemanticLossless(n),o=1;o<n.length;){if(n[o-1][0]==-1&&n[o][0]==1){var d=n[o-1][1],p=n[o][1],m=this.diff_commonOverlap_(d,p),_=this.diff_commonOverlap_(p,d);m>=_?(m>=d.length/2||m>=p.length/2)&&(n.splice(o,0,new e.Diff(0,p.substring(0,m))),n[o-1][1]=d.substring(0,d.length-m),n[o+1][1]=p.substring(m),o++):(_>=d.length/2||_>=p.length/2)&&(n.splice(o,0,new e.Diff(0,d.substring(0,_))),n[o-1][0]=1,n[o-1][1]=p.substring(0,p.length-_),n[o+1][0]=-1,n[o+1][1]=d.substring(_),o++),o++}o++}},e.prototype.diff_cleanupSemanticLossless=function(n){function i(_,f){if(!_||!f)return 6;var v=_.charAt(_.length-1),g=f.charAt(0),y=v.match(e.nonAlphaNumericRegex_),b=g.match(e.nonAlphaNumericRegex_),w=y&&v.match(e.whitespaceRegex_),x=b&&g.match(e.whitespaceRegex_),k=w&&v.match(e.linebreakRegex_),S=x&&g.match(e.linebreakRegex_),E=k&&_.match(e.blanklineEndRegex_),A=S&&f.match(e.blanklineStartRegex_);return E||A?5:k||S?4:y&&!w&&x?3:w||x?2:y||b?1:0}for(var r=1;r<n.length-1;){if(n[r-1][0]==0&&n[r+1][0]==0){var s=n[r-1][1],a=n[r][1],o=n[r+1][1],l=this.diff_commonSuffix(s,a);if(l){var u=a.substring(a.length-l);s=s.substring(0,s.length-l),a=u+a.substring(0,a.length-l),o=u+o}for(var c=s,h=a,d=o,p=i(s,a)+i(a,o);a.charAt(0)===o.charAt(0);){s+=a.charAt(0),a=a.substring(1)+o.charAt(0),o=o.substring(1);var m=i(s,a)+i(a,o);m>=p&&(p=m,c=s,h=a,d=o)}n[r-1][1]!=c&&(c?n[r-1][1]=c:(n.splice(r-1,1),r--),n[r][1]=h,d?n[r+1][1]=d:(n.splice(r+1,1),r--))}r++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\s/,e.linebreakRegex_=/[\r\n]/,e.blanklineEndRegex_=/\n\r?\n$/,e.blanklineStartRegex_=/^\r?\n\r?\n/,e.prototype.diff_cleanupEfficiency=function(n){for(var i=!1,r=[],s=0,a=null,o=0,l=!1,u=!1,c=!1,h=!1;o<n.length;)n[o][0]==0?(n[o][1].length<this.Diff_EditCost&&(c||h)?(r[s++]=o,l=c,u=h,a=n[o][1]):(s=0,a=null),c=h=!1):(n[o][0]==-1?h=!0:c=!0,a&&(l&&u&&c&&h||a.length<this.Diff_EditCost/2&&l+u+c+h==3)&&(n.splice(r[s-1],0,new e.Diff(-1,a)),n[r[s-1]+1][0]=1,s--,a=null,l&&u?(c=h=!0,s=0):(o=--s>0?r[s-1]:-1,c=h=!1),i=!0)),o++;i&&this.diff_cleanupMerge(n)},e.prototype.diff_cleanupMerge=function(n){n.push(new e.Diff(0,""));for(var i,r=0,s=0,a=0,o="",l="";r<n.length;)switch(n[r][0]){case 1:a++,l+=n[r][1],r++;break;case-1:s++,o+=n[r][1],r++;break;case 0:s+a>1?(s!==0&&a!==0&&((i=this.diff_commonPrefix(l,o))!==0&&(r-s-a>0&&n[r-s-a-1][0]==0?n[r-s-a-1][1]+=l.substring(0,i):(n.splice(0,0,new e.Diff(0,l.substring(0,i))),r++),l=l.substring(i),o=o.substring(i)),(i=this.diff_commonSuffix(l,o))!==0&&(n[r][1]=l.substring(l.length-i)+n[r][1],l=l.substring(0,l.length-i),o=o.substring(0,o.length-i))),r-=s+a,n.splice(r,s+a),o.length&&(n.splice(r,0,new e.Diff(-1,o)),r++),l.length&&(n.splice(r,0,new e.Diff(1,l)),r++),r++):r!==0&&n[r-1][0]==0?(n[r-1][1]+=n[r][1],n.splice(r,1)):r++,a=0,s=0,o="",l=""}n[n.length-1][1]===""&&n.pop();var u=!1;for(r=1;r<n.length-1;)n[r-1][0]==0&&n[r+1][0]==0&&(n[r][1].substring(n[r][1].length-n[r-1][1].length)==n[r-1][1]?(n[r][1]=n[r-1][1]+n[r][1].substring(0,n[r][1].length-n[r-1][1].length),n[r+1][1]=n[r-1][1]+n[r+1][1],n.splice(r-1,1),u=!0):n[r][1].substring(0,n[r+1][1].length)==n[r+1][1]&&(n[r-1][1]+=n[r+1][1],n[r][1]=n[r][1].substring(n[r+1][1].length)+n[r+1][1],n.splice(r+1,1),u=!0)),r++;u&&this.diff_cleanupMerge(n)},e.prototype.diff_xIndex=function(n,i){var r,s=0,a=0,o=0,l=0;for(r=0;r<n.length&&(n[r][0]!==1&&(s+=n[r][1].length),n[r][0]!==-1&&(a+=n[r][1].length),!(s>i));r++)o=s,l=a;return n.length!=r&&n[r][0]===-1?l:l+(i-o)},e.prototype.diff_prettyHtml=function(n){for(var i=[],r=/&/g,s=/</g,a=/>/g,o=/\n/g,l=0;l<n.length;l++){var u=n[l][0],c=n[l][1].replace(r,"&amp;").replace(s,"&lt;").replace(a,"&gt;").replace(o,"&para;<br>");switch(u){case 1:i[l]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case-1:i[l]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:i[l]="<span>"+c+"</span>"}}return i.join("")},e.prototype.diff_text1=function(n){for(var i=[],r=0;r<n.length;r++)n[r][0]!==1&&(i[r]=n[r][1]);return i.join("")},e.prototype.diff_text2=function(n){for(var i=[],r=0;r<n.length;r++)n[r][0]!==-1&&(i[r]=n[r][1]);return i.join("")},e.prototype.diff_levenshtein=function(n){for(var i=0,r=0,s=0,a=0;a<n.length;a++){var o=n[a][0],l=n[a][1];switch(o){case 1:r+=l.length;break;case-1:s+=l.length;break;case 0:i+=Math.max(r,s),r=0,s=0}}return i+=Math.max(r,s)},e.prototype.diff_toDelta=function(n){for(var i=[],r=0;r<n.length;r++)switch(n[r][0]){case 1:i[r]="+"+encodeURI(n[r][1]);break;case-1:i[r]="-"+n[r][1].length;break;case 0:i[r]="="+n[r][1].length}return i.join("	").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(n,i){for(var r=[],s=0,a=0,o=i.split(/\t/g),l=0;l<o.length;l++){var u=o[l].substring(1);switch(o[l].charAt(0)){case"+":try{r[s++]=new e.Diff(1,decodeURI(u))}catch{throw new Error("Illegal escape in diff_fromDelta: "+u)}break;case"-":case"=":var c=parseInt(u,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+u);var h=n.substring(a,a+=c);o[l].charAt(0)=="="?r[s++]=new e.Diff(0,h):r[s++]=new e.Diff(-1,h);break;default:if(o[l])throw new Error("Invalid diff operation in diff_fromDelta: "+o[l])}}if(a!=n.length)throw new Error("Delta length ("+a+") does not equal source text length ("+n.length+").");return r},e.prototype.match_main=function(n,i,r){if(n==null||i==null||r==null)throw new Error("Null input. (match_main)");return r=Math.max(0,Math.min(r,n.length)),n==i?0:n.length?n.substring(r,r+i.length)==i?r:this.match_bitap_(n,i,r):-1},e.prototype.match_bitap_=function(n,i,r){if(i.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var s=this.match_alphabet_(i),a=this;function o(x,k){var S=x/i.length,E=Math.abs(r-k);return a.Match_Distance?S+E/a.Match_Distance:E?1:S}var l=this.Match_Threshold,u=n.indexOf(i,r);u!=-1&&(l=Math.min(o(0,u),l),(u=n.lastIndexOf(i,r+i.length))!=-1&&(l=Math.min(o(0,u),l)));var c,h,d=1<<i.length-1;u=-1;for(var p,m=i.length+n.length,_=0;_<i.length;_++){for(c=0,h=m;c<h;)o(_,r+h)<=l?c=h:m=h,h=Math.floor((m-c)/2+c);m=h;var f=Math.max(1,r-h+1),v=Math.min(r+h,n.length)+i.length,g=Array(v+2);g[v+1]=(1<<_)-1;for(var y=v;y>=f;y--){var b=s[n.charAt(y-1)];if(g[y]=_===0?(g[y+1]<<1|1)&b:(g[y+1]<<1|1)&b|(p[y+1]|p[y])<<1|1|p[y+1],g[y]&d){var w=o(_,y-1);if(w<=l){if(l=w,!((u=y-1)>r))break;f=Math.max(1,2*r-u)}}}if(o(_+1,r)>l)break;p=g}return u},e.prototype.match_alphabet_=function(n){for(var i={},r=0;r<n.length;r++)i[n.charAt(r)]=0;for(r=0;r<n.length;r++)i[n.charAt(r)]|=1<<n.length-r-1;return i},e.prototype.patch_addContext_=function(n,i){if(i.length!=0){if(n.start2===null)throw Error("patch not initialized");for(var r=i.substring(n.start2,n.start2+n.length1),s=0;i.indexOf(r)!=i.lastIndexOf(r)&&r.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)s+=this.Patch_Margin,r=i.substring(n.start2-s,n.start2+n.length1+s);s+=this.Patch_Margin;var a=i.substring(n.start2-s,n.start2);a&&n.diffs.unshift(new e.Diff(0,a));var o=i.substring(n.start2+n.length1,n.start2+n.length1+s);o&&n.diffs.push(new e.Diff(0,o)),n.start1-=a.length,n.start2-=a.length,n.length1+=a.length+o.length,n.length2+=a.length+o.length}},e.prototype.patch_make=function(n,i,r){var s,a;if(typeof n=="string"&&typeof i=="string"&&r===void 0)s=n,(a=this.diff_main(s,i,!0)).length>2&&(this.diff_cleanupSemantic(a),this.diff_cleanupEfficiency(a));else if(n&&typeof n=="object"&&i===void 0&&r===void 0)a=n,s=this.diff_text1(a);else if(typeof n=="string"&&i&&typeof i=="object"&&r===void 0)s=n,a=i;else{if(typeof n!="string"||typeof i!="string"||!r||typeof r!="object")throw new Error("Unknown call format to patch_make.");s=n,a=r}if(a.length===0)return[];for(var o=[],l=new e.patch_obj,u=0,c=0,h=0,d=s,p=s,m=0;m<a.length;m++){var _=a[m][0],f=a[m][1];switch(u||_===0||(l.start1=c,l.start2=h),_){case 1:l.diffs[u++]=a[m],l.length2+=f.length,p=p.substring(0,h)+f+p.substring(h);break;case-1:l.length1+=f.length,l.diffs[u++]=a[m],p=p.substring(0,h)+p.substring(h+f.length);break;case 0:f.length<=2*this.Patch_Margin&&u&&a.length!=m+1?(l.diffs[u++]=a[m],l.length1+=f.length,l.length2+=f.length):f.length>=2*this.Patch_Margin&&u&&(this.patch_addContext_(l,d),o.push(l),l=new e.patch_obj,u=0,d=p,c=h)}_!==1&&(c+=f.length),_!==-1&&(h+=f.length)}return u&&(this.patch_addContext_(l,d),o.push(l)),o},e.prototype.patch_deepCopy=function(n){for(var i=[],r=0;r<n.length;r++){var s=n[r],a=new e.patch_obj;a.diffs=[];for(var o=0;o<s.diffs.length;o++)a.diffs[o]=new e.Diff(s.diffs[o][0],s.diffs[o][1]);a.start1=s.start1,a.start2=s.start2,a.length1=s.length1,a.length2=s.length2,i[r]=a}return i},e.prototype.patch_apply=function(n,i){if(n.length==0)return[i,[]];n=this.patch_deepCopy(n);var r=this.patch_addPadding(n);i=r+i+r,this.patch_splitMax(n);for(var s=0,a=[],o=0;o<n.length;o++){var l,u,c=n[o].start2+s,h=this.diff_text1(n[o].diffs),d=-1;if(h.length>this.Match_MaxBits?(l=this.match_main(i,h.substring(0,this.Match_MaxBits),c))!=-1&&((d=this.match_main(i,h.substring(h.length-this.Match_MaxBits),c+h.length-this.Match_MaxBits))==-1||l>=d)&&(l=-1):l=this.match_main(i,h,c),l==-1)a[o]=!1,s-=n[o].length2-n[o].length1;else if(a[o]=!0,s=l-c,h==(u=d==-1?i.substring(l,l+h.length):i.substring(l,d+this.Match_MaxBits)))i=i.substring(0,l)+this.diff_text2(n[o].diffs)+i.substring(l+h.length);else{var p=this.diff_main(h,u,!1);if(h.length>this.Match_MaxBits&&this.diff_levenshtein(p)/h.length>this.Patch_DeleteThreshold)a[o]=!1;else{this.diff_cleanupSemanticLossless(p);for(var m,_=0,f=0;f<n[o].diffs.length;f++){var v=n[o].diffs[f];v[0]!==0&&(m=this.diff_xIndex(p,_)),v[0]===1?i=i.substring(0,l+m)+v[1]+i.substring(l+m):v[0]===-1&&(i=i.substring(0,l+m)+i.substring(l+this.diff_xIndex(p,_+v[1].length))),v[0]!==-1&&(_+=v[1].length)}}}}return[i=i.substring(r.length,i.length-r.length),a]},e.prototype.patch_addPadding=function(n){for(var i=this.Patch_Margin,r="",s=1;s<=i;s++)r+=String.fromCharCode(s);for(s=0;s<n.length;s++)n[s].start1+=i,n[s].start2+=i;var a=n[0],o=a.diffs;if(o.length==0||o[0][0]!=0)o.unshift(new e.Diff(0,r)),a.start1-=i,a.start2-=i,a.length1+=i,a.length2+=i;else if(i>o[0][1].length){var l=i-o[0][1].length;o[0][1]=r.substring(o[0][1].length)+o[0][1],a.start1-=l,a.start2-=l,a.length1+=l,a.length2+=l}return(o=(a=n[n.length-1]).diffs).length==0||o[o.length-1][0]!=0?(o.push(new e.Diff(0,r)),a.length1+=i,a.length2+=i):i>o[o.length-1][1].length&&(l=i-o[o.length-1][1].length,o[o.length-1][1]+=r.substring(0,l),a.length1+=l,a.length2+=l),r},e.prototype.patch_splitMax=function(n){for(var i=this.Match_MaxBits,r=0;r<n.length;r++)if(!(n[r].length1<=i)){var s=n[r];n.splice(r--,1);for(var a=s.start1,o=s.start2,l="";s.diffs.length!==0;){var u=new e.patch_obj,c=!0;for(u.start1=a-l.length,u.start2=o-l.length,l!==""&&(u.length1=u.length2=l.length,u.diffs.push(new e.Diff(0,l)));s.diffs.length!==0&&u.length1<i-this.Patch_Margin;){var h=s.diffs[0][0],d=s.diffs[0][1];h===1?(u.length2+=d.length,o+=d.length,u.diffs.push(s.diffs.shift()),c=!1):h===-1&&u.diffs.length==1&&u.diffs[0][0]==0&&d.length>2*i?(u.length1+=d.length,a+=d.length,c=!1,u.diffs.push(new e.Diff(h,d)),s.diffs.shift()):(d=d.substring(0,i-u.length1-this.Patch_Margin),u.length1+=d.length,a+=d.length,h===0?(u.length2+=d.length,o+=d.length):c=!1,u.diffs.push(new e.Diff(h,d)),d==s.diffs[0][1]?s.diffs.shift():s.diffs[0][1]=s.diffs[0][1].substring(d.length))}l=(l=this.diff_text2(u.diffs)).substring(l.length-this.Patch_Margin);var p=this.diff_text1(s.diffs).substring(0,this.Patch_Margin);p!==""&&(u.length1+=p.length,u.length2+=p.length,u.diffs.length!==0&&u.diffs[u.diffs.length-1][0]===0?u.diffs[u.diffs.length-1][1]+=p:u.diffs.push(new e.Diff(0,p))),c||n.splice(++r,0,u)}}},e.prototype.patch_toText=function(n){for(var i=[],r=0;r<n.length;r++)i[r]=n[r];return i.join("")},e.prototype.patch_fromText=function(n){var i=[];if(!n)return i;for(var r=n.split(`
`),s=0,a=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;s<r.length;){var o=r[s].match(a);if(!o)throw new Error("Invalid patch string: "+r[s]);var l=new e.patch_obj;for(i.push(l),l.start1=parseInt(o[1],10),o[2]===""?(l.start1--,l.length1=1):o[2]=="0"?l.length1=0:(l.start1--,l.length1=parseInt(o[2],10)),l.start2=parseInt(o[3],10),o[4]===""?(l.start2--,l.length2=1):o[4]=="0"?l.length2=0:(l.start2--,l.length2=parseInt(o[4],10)),s++;s<r.length;){var u=r[s].charAt(0);try{var c=decodeURI(r[s].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+c)}if(u=="-")l.diffs.push(new e.Diff(-1,c));else if(u=="+")l.diffs.push(new e.Diff(1,c));else if(u==" ")l.diffs.push(new e.Diff(0,c));else{if(u=="@")break;if(u!=="")throw new Error('Invalid patch mode "'+u+'" in: '+c)}s++}}return i},(e.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var n,i=["@@ -"+(this.length1===0?this.start1+",0":this.length1==1?this.start1+1:this.start1+1+","+this.length1)+" +"+(this.length2===0?this.start2+",0":this.length2==1?this.start2+1:this.start2+1+","+this.length2)+` @@
`],r=0;r<this.diffs.length;r++){switch(this.diffs[r][0]){case 1:n="+";break;case-1:n="-";break;case 0:n=" "}i[r+1]=n+encodeURI(this.diffs[r][1])+`
`}return i.join("").replace(/%20/g," ")},t.exports=e,t.exports.diff_match_patch=e,t.exports.DIFF_DELETE=-1,t.exports.DIFF_INSERT=1,t.exports.DIFF_EQUAL=0});dv.DIFF_EQUAL;dv.DIFF_DELETE;dv.DIFF_INSERT;function fv({diff:t,showFileHeader:e=!0,viewType:n="split"}){if(!t)return C.jsx("div",{className:"diff-empty",children:"No git changes for this file."});let i=[];try{i=FL(t)}catch{return C.jsx("div",{className:"diff-empty",children:"Unable to parse diff."})}return i.length?C.jsx("div",{className:"diff-content",children:i.map(r=>C.jsxs("div",{className:"diff-file",children:[e&&C.jsx("div",{className:"diff-file-header",children:r.newPath}),C.jsx(iz,{viewType:n,diffType:r.type,hunks:r.hunks,children:s=>s.map(a=>C.jsx(Z2,{hunk:a},a.content))})]},`${r.oldPath}-${r.newPath}`))}):C.jsx("div",{className:"diff-empty",children:"No changes to display."})}var Y2={},xt=bi&&bi.__assign||function(){return xt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},xt.apply(this,arguments)},rz=bi&&bi.__createBinding||(Object.create?function(t,e,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){i===void 0&&(i=n),t[i]=e[n]}),sz=bi&&bi.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),oz=bi&&bi.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&rz(e,t,n);return sz(e,t),e},az=bi&&bi.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};Object.defineProperty(Y2,"__esModule",{value:!0});var Tn=oz(I),lz=89,Ru=90,uz=77,ab=57,lb=219,ub=222,cb=192,hb=100,cz=3e3,hz=typeof window<"u"&&"navigator"in window&&/Win/i.test(navigator.platform),$f=typeof window<"u"&&"navigator"in window&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),rc="npm__react-simple-code-editor__textarea",dz=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`.concat(rc,`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`).concat(rc,` {
    color: transparent !important;
  }

  .`).concat(rc,`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`),fz=Tn.forwardRef(function(e,n){var i=e.autoFocus,r=e.disabled,s=e.form,a=e.highlight,o=e.ignoreTabKey,l=o===void 0?!1:o,u=e.insertSpaces,c=u===void 0?!0:u,h=e.maxLength,d=e.minLength,p=e.name,m=e.onBlur,_=e.onClick,f=e.onFocus,v=e.onKeyDown,g=e.onKeyUp,y=e.onValueChange,b=e.padding,w=b===void 0?0:b,x=e.placeholder,k=e.preClassName,S=e.readOnly,E=e.required,A=e.style,M=e.tabSize,R=M===void 0?2:M,P=e.textareaClassName,H=e.textareaId,B=e.value,L=az(e,["autoFocus","disabled","form","highlight","ignoreTabKey","insertSpaces","maxLength","minLength","name","onBlur","onClick","onFocus","onKeyDown","onKeyUp","onValueChange","padding","placeholder","preClassName","readOnly","required","style","tabSize","textareaClassName","textareaId","value"]),j=Tn.useRef({stack:[],offset:-1}),D=Tn.useRef(null),O=Tn.useState(!0),N=O[0],z=O[1],q={paddingTop:typeof w=="object"?w.top:w,paddingRight:typeof w=="object"?w.right:w,paddingBottom:typeof w=="object"?w.bottom:w,paddingLeft:typeof w=="object"?w.left:w},te=a(B),ee=function(W,ne){return W.substring(0,ne).split(`
`)},K=Tn.useCallback(function(W,ne){var oe,ae,Y;ne===void 0&&(ne=!1);var le=j.current,_e=le.stack,fe=le.offset;if(_e.length&&fe>-1){j.current.stack=_e.slice(0,fe+1);var xe=j.current.stack.length;if(xe>hb){var De=xe-hb;j.current.stack=_e.slice(De,xe),j.current.offset=Math.max(j.current.offset-De,0)}}var ge=Date.now();if(ne){var ke=j.current.stack[j.current.offset];if(ke&&ge-ke.timestamp<cz){var Pe=/[^a-z0-9]([a-z0-9]+)$/i,Fe=(oe=ee(ke.value,ke.selectionStart).pop())===null||oe===void 0?void 0:oe.match(Pe),vt=(ae=ee(W.value,W.selectionStart).pop())===null||ae===void 0?void 0:ae.match(Pe);if(Fe!=null&&Fe[1]&&(!((Y=vt==null?void 0:vt[1])===null||Y===void 0)&&Y.startsWith(Fe[1]))){j.current.stack[j.current.offset]=xt(xt({},W),{timestamp:ge});return}}}j.current.stack.push(xt(xt({},W),{timestamp:ge})),j.current.offset++},[]),ce=Tn.useCallback(function(){var W=D.current;if(W){var ne=W.value,oe=W.selectionStart,ae=W.selectionEnd;K({value:ne,selectionStart:oe,selectionEnd:ae})}},[K]),T=function(W){var ne=D.current;ne&&(ne.value=W.value,ne.selectionStart=W.selectionStart,ne.selectionEnd=W.selectionEnd,y==null||y(W.value))},$=function(W){var ne=D.current,oe=j.current.stack[j.current.offset];oe&&ne&&(j.current.stack[j.current.offset]=xt(xt({},oe),{selectionStart:ne.selectionStart,selectionEnd:ne.selectionEnd})),K(W),T(W)},Z=function(){var W=j.current,ne=W.stack,oe=W.offset,ae=ne[oe-1];ae&&(T(ae),j.current.offset=Math.max(oe-1,0))},F=function(){var W=j.current,ne=W.stack,oe=W.offset,ae=ne[oe+1];ae&&(T(ae),j.current.offset=Math.min(oe+1,ne.length-1))},V=function(W){if(!(v&&(v(W),W.defaultPrevented))){W.key==="Escape"&&W.currentTarget.blur();var ne=W.currentTarget,oe=ne.value,ae=ne.selectionStart,Y=ne.selectionEnd,le=(c?" ":"	").repeat(R);if(W.key==="Tab"&&!l&&N)if(W.preventDefault(),W.shiftKey){var _e=ee(oe,ae),fe=_e.length-1,xe=ee(oe,Y).length-1,De=oe.split(`
`).map(function(Pt,U){return U>=fe&&U<=xe&&Pt.startsWith(le)?Pt.substring(le.length):Pt}).join(`
`);if(oe!==De){var ge=_e[fe];$({value:De,selectionStart:ge!=null&&ge.startsWith(le)?ae-le.length:ae,selectionEnd:Y-(oe.length-De.length)})}}else if(ae!==Y){var _e=ee(oe,ae),ke=_e.length-1,Pe=ee(oe,Y).length-1,ge=_e[ke];$({value:oe.split(`
`).map(function(Q,me){return me>=ke&&me<=Pe?le+Q:Q}).join(`
`),selectionStart:ge&&/\S/.test(ge)?ae+le.length:ae,selectionEnd:Y+le.length*(Pe-ke+1)})}else{var Fe=ae+le.length;$({value:oe.substring(0,ae)+le+oe.substring(Y),selectionStart:Fe,selectionEnd:Fe})}else if(W.key==="Backspace"){var vt=ae!==Y,Yt=oe.substring(0,ae);if(Yt.endsWith(le)&&!vt){W.preventDefault();var Fe=ae-le.length;$({value:oe.substring(0,ae-le.length)+oe.substring(Y),selectionStart:Fe,selectionEnd:Fe})}}else if(W.key==="Enter"){if(ae===Y){var Dn=ee(oe,ae).pop(),_t=Dn==null?void 0:Dn.match(/^\s+/);if(_t!=null&&_t[0]){W.preventDefault();var St=`
`+_t[0],Fe=ae+St.length;$({value:oe.substring(0,ae)+St+oe.substring(Y),selectionStart:Fe,selectionEnd:Fe})}}}else if(W.keyCode===ab||W.keyCode===lb||W.keyCode===ub||W.keyCode===cb){var Ee=void 0;W.keyCode===ab&&W.shiftKey?Ee=["(",")"]:W.keyCode===lb?W.shiftKey?Ee=["{","}"]:Ee=["[","]"]:W.keyCode===ub?W.shiftKey?Ee=['"','"']:Ee=["'","'"]:W.keyCode===cb&&!W.shiftKey&&(Ee=["`","`"]),ae!==Y&&Ee&&(W.preventDefault(),$({value:oe.substring(0,ae)+Ee[0]+oe.substring(ae,Y)+Ee[1]+oe.substring(Y),selectionStart:ae,selectionEnd:Y+2}))}else($f?W.metaKey&&W.keyCode===Ru:W.ctrlKey&&W.keyCode===Ru)&&!W.shiftKey&&!W.altKey?(W.preventDefault(),Z()):($f?W.metaKey&&W.keyCode===Ru&&W.shiftKey:hz?W.ctrlKey&&W.keyCode===lz:W.ctrlKey&&W.keyCode===Ru&&W.shiftKey)&&!W.altKey?(W.preventDefault(),F()):W.keyCode===uz&&W.ctrlKey&&(!$f||W.shiftKey)&&(W.preventDefault(),z(function(Pt){return!Pt}))}},G=function(W){var ne=W.currentTarget,oe=ne.value,ae=ne.selectionStart,Y=ne.selectionEnd;K({value:oe,selectionStart:ae,selectionEnd:Y},!0),y(oe)};return Tn.useEffect(function(){ce()},[ce]),Tn.useImperativeHandle(n,function(){return{get session(){return{history:j.current}},set session(W){j.current=W.history}}},[]),Tn.createElement("div",xt({},L,{style:xt(xt({},aa.container),A)}),Tn.createElement("pre",xt({className:k,"aria-hidden":"true",style:xt(xt(xt({},aa.editor),aa.highlight),q)},typeof te=="string"?{dangerouslySetInnerHTML:{__html:te+"<br />"}}:{children:te})),Tn.createElement("textarea",{ref:function(W){return D.current=W},style:xt(xt(xt({},aa.editor),aa.textarea),q),className:rc+(P?" ".concat(P):""),id:H,value:B,onChange:G,onKeyDown:V,onClick:_,onKeyUp:g,onFocus:f,onBlur:m,disabled:r,form:s,maxLength:h,minLength:d,name:p,placeholder:x,readOnly:S,required:E,autoFocus:i,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),Tn.createElement("style",{dangerouslySetInnerHTML:{__html:dz}}))}),aa={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}},qm=Y2.default=fz;function X2(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=X2(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function Q2(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=X2(t))&&(i&&(i+=" "),i+=e);return i}var pz=Object.create,Td=Object.defineProperty,mz=Object.defineProperties,gz=Object.getOwnPropertyDescriptor,vz=Object.getOwnPropertyDescriptors,eE=Object.getOwnPropertyNames,Mh=Object.getOwnPropertySymbols,_z=Object.getPrototypeOf,pv=Object.prototype.hasOwnProperty,tE=Object.prototype.propertyIsEnumerable,db=(t,e,n)=>e in t?Td(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yi=(t,e)=>{for(var n in e||(e={}))pv.call(e,n)&&db(t,n,e[n]);if(Mh)for(var n of Mh(e))tE.call(e,n)&&db(t,n,e[n]);return t},Md=(t,e)=>mz(t,vz(e)),nE=(t,e)=>{var n={};for(var i in t)pv.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&Mh)for(var i of Mh(t))e.indexOf(i)<0&&tE.call(t,i)&&(n[i]=t[i]);return n},yz=(t,e)=>function(){return e||(0,t[eE(t)[0]])((e={exports:{}}).exports,e),e.exports},bz=(t,e)=>{for(var n in e)Td(t,n,{get:e[n],enumerable:!0})},wz=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of eE(e))!pv.call(t,r)&&r!==n&&Td(t,r,{get:()=>e[r],enumerable:!(i=gz(e,r))||i.enumerable});return t},Sz=(t,e,n)=>(n=t!=null?pz(_z(t)):{},wz(!t||!t.__esModule?Td(n,"default",{value:t,enumerable:!0}):n,t)),xz=yz({"../../node_modules/.pnpm/prismjs@1.29.0_patch_hash=vrxx3pzkik6jpmgpayxfjunetu/node_modules/prismjs/prism.js"(t,e){var n=function(){var i=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,r=0,s={},a={util:{encode:function m(_){return _ instanceof o?new o(_.type,m(_.content),_.alias):Array.isArray(_)?_.map(m):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(m){return Object.prototype.toString.call(m).slice(8,-1)},objId:function(m){return m.__id||Object.defineProperty(m,"__id",{value:++r}),m.__id},clone:function m(_,f){f=f||{};var v,g;switch(a.util.type(_)){case"Object":if(g=a.util.objId(_),f[g])return f[g];v={},f[g]=v;for(var y in _)_.hasOwnProperty(y)&&(v[y]=m(_[y],f));return v;case"Array":return g=a.util.objId(_),f[g]?f[g]:(v=[],f[g]=v,_.forEach(function(b,w){v[w]=m(b,f)}),v);default:return _}},getLanguage:function(m){for(;m;){var _=i.exec(m.className);if(_)return _[1].toLowerCase();m=m.parentElement}return"none"},setLanguage:function(m,_){m.className=m.className.replace(RegExp(i,"gi"),""),m.classList.add("language-"+_)},isActive:function(m,_,f){for(var v="no-"+_;m;){var g=m.classList;if(g.contains(_))return!0;if(g.contains(v))return!1;m=m.parentElement}return!!f}},languages:{plain:s,plaintext:s,text:s,txt:s,extend:function(m,_){var f=a.util.clone(a.languages[m]);for(var v in _)f[v]=_[v];return f},insertBefore:function(m,_,f,v){v=v||a.languages;var g=v[m],y={};for(var b in g)if(g.hasOwnProperty(b)){if(b==_)for(var w in f)f.hasOwnProperty(w)&&(y[w]=f[w]);f.hasOwnProperty(b)||(y[b]=g[b])}var x=v[m];return v[m]=y,a.languages.DFS(a.languages,function(k,S){S===x&&k!=m&&(this[k]=y)}),y},DFS:function m(_,f,v,g){g=g||{};var y=a.util.objId;for(var b in _)if(_.hasOwnProperty(b)){f.call(_,b,_[b],v||b);var w=_[b],x=a.util.type(w);x==="Object"&&!g[y(w)]?(g[y(w)]=!0,m(w,f,null,g)):x==="Array"&&!g[y(w)]&&(g[y(w)]=!0,m(w,f,b,g))}}},plugins:{},highlight:function(m,_,f){var v={code:m,grammar:_,language:f};if(a.hooks.run("before-tokenize",v),!v.grammar)throw new Error('The language "'+v.language+'" has no grammar.');return v.tokens=a.tokenize(v.code,v.grammar),a.hooks.run("after-tokenize",v),o.stringify(a.util.encode(v.tokens),v.language)},tokenize:function(m,_){var f=_.rest;if(f){for(var v in f)_[v]=f[v];delete _.rest}var g=new c;return h(g,g.head,m),u(m,g,_,g.head,0),p(g)},hooks:{all:{},add:function(m,_){var f=a.hooks.all;f[m]=f[m]||[],f[m].push(_)},run:function(m,_){var f=a.hooks.all[m];if(!(!f||!f.length))for(var v=0,g;g=f[v++];)g(_)}},Token:o};function o(m,_,f,v){this.type=m,this.content=_,this.alias=f,this.length=(v||"").length|0}o.stringify=function m(_,f){if(typeof _=="string")return _;if(Array.isArray(_)){var v="";return _.forEach(function(x){v+=m(x,f)}),v}var g={type:_.type,content:m(_.content,f),tag:"span",classes:["token",_.type],attributes:{},language:f},y=_.alias;y&&(Array.isArray(y)?Array.prototype.push.apply(g.classes,y):g.classes.push(y)),a.hooks.run("wrap",g);var b="";for(var w in g.attributes)b+=" "+w+'="'+(g.attributes[w]||"").replace(/"/g,"&quot;")+'"';return"<"+g.tag+' class="'+g.classes.join(" ")+'"'+b+">"+g.content+"</"+g.tag+">"};function l(m,_,f,v){m.lastIndex=_;var g=m.exec(f);if(g&&v&&g[1]){var y=g[1].length;g.index+=y,g[0]=g[0].slice(y)}return g}function u(m,_,f,v,g,y){for(var b in f)if(!(!f.hasOwnProperty(b)||!f[b])){var w=f[b];w=Array.isArray(w)?w:[w];for(var x=0;x<w.length;++x){if(y&&y.cause==b+","+x)return;var k=w[x],S=k.inside,E=!!k.lookbehind,A=!!k.greedy,M=k.alias;if(A&&!k.pattern.global){var R=k.pattern.toString().match(/[imsuy]*$/)[0];k.pattern=RegExp(k.pattern.source,R+"g")}for(var P=k.pattern||k,H=v.next,B=g;H!==_.tail&&!(y&&B>=y.reach);B+=H.value.length,H=H.next){var L=H.value;if(_.length>m.length)return;if(!(L instanceof o)){var j=1,D;if(A){if(D=l(P,B,m,E),!D||D.index>=m.length)break;var q=D.index,O=D.index+D[0].length,N=B;for(N+=H.value.length;q>=N;)H=H.next,N+=H.value.length;if(N-=H.value.length,B=N,H.value instanceof o)continue;for(var z=H;z!==_.tail&&(N<O||typeof z.value=="string");z=z.next)j++,N+=z.value.length;j--,L=m.slice(B,N),D.index-=B}else if(D=l(P,0,L,E),!D)continue;var q=D.index,te=D[0],ee=L.slice(0,q),K=L.slice(q+te.length),ce=B+L.length;y&&ce>y.reach&&(y.reach=ce);var T=H.prev;ee&&(T=h(_,T,ee),B+=ee.length),d(_,T,j);var $=new o(b,S?a.tokenize(te,S):te,M,te);if(H=h(_,T,$),K&&h(_,H,K),j>1){var Z={cause:b+","+x,reach:ce};u(m,_,f,H.prev,B,Z),y&&Z.reach>y.reach&&(y.reach=Z.reach)}}}}}}function c(){var m={value:null,prev:null,next:null},_={value:null,prev:m,next:null};m.next=_,this.head=m,this.tail=_,this.length=0}function h(m,_,f){var v=_.next,g={value:f,prev:_,next:v};return _.next=g,v.prev=g,m.length++,g}function d(m,_,f){for(var v=_.next,g=0;g<f&&v!==m.tail;g++)v=v.next;_.next=v,v.prev=_,m.length-=g}function p(m){for(var _=[],f=m.head.next;f!==m.tail;)_.push(f.value),f=f.next;return _}return a}();e.exports=n,n.default=n}}),X=Sz(xz());X.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},X.languages.markup.tag.inside["attr-value"].inside.entity=X.languages.markup.entity,X.languages.markup.doctype.inside["internal-subset"].inside=X.languages.markup,X.hooks.add("wrap",function(t){t.type==="entity"&&(t.attributes.title=t.content.replace(/&amp;/,"&"))}),Object.defineProperty(X.languages.markup.tag,"addInlined",{value:function(t,i){var n={},n=(n["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:X.languages[i]},n.cdata=/^<!\[CDATA\[|\]\]>$/i,{"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}}),i=(n["language-"+i]={pattern:/[\s\S]+/,inside:X.languages[i]},{});i[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:n},X.languages.insertBefore("markup","cdata",i)}}),Object.defineProperty(X.languages.markup.tag,"addAttribute",{value:function(t,e){X.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+t+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:X.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),X.languages.html=X.languages.markup,X.languages.mathml=X.languages.markup,X.languages.svg=X.languages.markup,X.languages.xml=X.languages.extend("markup",{}),X.languages.ssml=X.languages.xml,X.languages.atom=X.languages.xml,X.languages.rss=X.languages.xml,function(t){var e={pattern:/\\[\\(){}[\]^$+*?|.]/,alias:"escape"},n=/\\(?:x[\da-fA-F]{2}|u[\da-fA-F]{4}|u\{[\da-fA-F]+\}|0[0-7]{0,2}|[123][0-7]{2}|c[a-zA-Z]|.)/,i="(?:[^\\\\-]|"+n.source+")",i=RegExp(i+"-"+i),r={pattern:/(<|')[^<>']+(?=[>']$)/,lookbehind:!0,alias:"variable"};t.languages.regex={"char-class":{pattern:/((?:^|[^\\])(?:\\\\)*)\[(?:[^\\\]]|\\[\s\S])*\]/,lookbehind:!0,inside:{"char-class-negation":{pattern:/(^\[)\^/,lookbehind:!0,alias:"operator"},"char-class-punctuation":{pattern:/^\[|\]$/,alias:"punctuation"},range:{pattern:i,inside:{escape:n,"range-punctuation":{pattern:/-/,alias:"operator"}}},"special-escape":e,"char-set":{pattern:/\\[wsd]|\\p\{[^{}]+\}/i,alias:"class-name"},escape:n}},"special-escape":e,"char-set":{pattern:/\.|\\[wsd]|\\p\{[^{}]+\}/i,alias:"class-name"},backreference:[{pattern:/\\(?![123][0-7]{2})[1-9]/,alias:"keyword"},{pattern:/\\k<[^<>']+>/,alias:"keyword",inside:{"group-name":r}}],anchor:{pattern:/[$^]|\\[ABbGZz]/,alias:"function"},escape:n,group:[{pattern:/\((?:\?(?:<[^<>']+>|'[^<>']+'|[>:]|<?[=!]|[idmnsuxU]+(?:-[idmnsuxU]+)?:?))?/,alias:"punctuation",inside:{"group-name":r}},{pattern:/\)/,alias:"punctuation"}],quantifier:{pattern:/(?:[+*?]|\{\d+(?:,\d*)?\})[?+]?/,alias:"number"},alternation:{pattern:/\|/,alias:"keyword"}}}(X),X.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},X.languages.javascript=X.languages.extend("clike",{"class-name":[X.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),X.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,X.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:X.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:X.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:X.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:X.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:X.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),X.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:X.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),X.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),X.languages.markup&&(X.languages.markup.tag.addInlined("script","javascript"),X.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),X.languages.js=X.languages.javascript,X.languages.actionscript=X.languages.extend("javascript",{keyword:/\b(?:as|break|case|catch|class|const|default|delete|do|dynamic|each|else|extends|final|finally|for|function|get|if|implements|import|in|include|instanceof|interface|internal|is|namespace|native|new|null|override|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|use|var|void|while|with)\b/,operator:/\+\+|--|(?:[+\-*\/%^]|&&?|\|\|?|<<?|>>?>?|[!=]=?)=?|[~?@]/}),X.languages.actionscript["class-name"].alias="function",delete X.languages.actionscript.parameter,delete X.languages.actionscript["literal-property"],X.languages.markup&&X.languages.insertBefore("actionscript","string",{xml:{pattern:/(^|[^.])<\/?\w+(?:\s+[^\s>\/=]+=("|')(?:\\[\s\S]|(?!\2)[^\\])*\2)*\s*\/?>/,lookbehind:!0,inside:X.languages.markup}}),function(t){var e=/#(?!\{).+/,n={pattern:/#\{[^}]+\}/,alias:"variable"};t.languages.coffeescript=t.languages.extend("javascript",{comment:e,string:[{pattern:/'(?:\\[\s\S]|[^\\'])*'/,greedy:!0},{pattern:/"(?:\\[\s\S]|[^\\"])*"/,greedy:!0,inside:{interpolation:n}}],keyword:/\b(?:and|break|by|catch|class|continue|debugger|delete|do|each|else|extend|extends|false|finally|for|if|in|instanceof|is|isnt|let|loop|namespace|new|no|not|null|of|off|on|or|own|return|super|switch|then|this|throw|true|try|typeof|undefined|unless|until|when|while|window|with|yes|yield)\b/,"class-member":{pattern:/@(?!\d)\w+/,alias:"variable"}}),t.languages.insertBefore("coffeescript","comment",{"multiline-comment":{pattern:/###[\s\S]+?###/,alias:"comment"},"block-regex":{pattern:/\/{3}[\s\S]*?\/{3}/,alias:"regex",inside:{comment:e,interpolation:n}}}),t.languages.insertBefore("coffeescript","string",{"inline-javascript":{pattern:/`(?:\\[\s\S]|[^\\`])*`/,inside:{delimiter:{pattern:/^`|`$/,alias:"punctuation"},script:{pattern:/[\s\S]+/,alias:"language-javascript",inside:t.languages.javascript}}},"multiline-string":[{pattern:/'''[\s\S]*?'''/,greedy:!0,alias:"string"},{pattern:/"""[\s\S]*?"""/,greedy:!0,alias:"string",inside:{interpolation:n}}]}),t.languages.insertBefore("coffeescript","keyword",{property:/(?!\d)\w+(?=\s*:(?!:))/}),delete t.languages.coffeescript["template-string"],t.languages.coffee=t.languages.coffeescript}(X),function(t){var e=t.languages.javadoclike={parameter:{pattern:/(^[\t ]*(?:\/{3}|\*|\/\*\*)\s*@(?:arg|arguments|param)\s+)\w+/m,lookbehind:!0},keyword:{pattern:/(^[\t ]*(?:\/{3}|\*|\/\*\*)\s*|\{)@[a-z][a-zA-Z-]+\b/m,lookbehind:!0},punctuation:/[{}]/};Object.defineProperty(e,"addSupport",{value:function(n,i){(n=typeof n=="string"?[n]:n).forEach(function(r){var s=function(h){h.inside||(h.inside={}),h.inside.rest=i},a="doc-comment";if(o=t.languages[r]){var o,l=o[a];if((l=l||(o=t.languages.insertBefore(r,"comment",{"doc-comment":{pattern:/(^|[^\\])\/\*\*[^/][\s\S]*?(?:\*\/|$)/,lookbehind:!0,alias:"comment"}}))[a])instanceof RegExp&&(l=o[a]={pattern:l}),Array.isArray(l))for(var u=0,c=l.length;u<c;u++)l[u]instanceof RegExp&&(l[u]={pattern:l[u]}),s(l[u]);else s(l)}})}}),e.addSupport(["java","javascript","php"],e)}(X),function(t){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/,e=(t.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},t.languages.css.atrule.inside.rest=t.languages.css,t.languages.markup);e&&(e.tag.addInlined("style","css"),e.tag.addAttribute("style","css"))}(X),function(t){var e=/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,e=(t.languages.css.selector={pattern:t.languages.css.selector.pattern,lookbehind:!0,inside:e={"pseudo-element":/:(?:after|before|first-letter|first-line|selection)|::[-\w]+/,"pseudo-class":/:[-\w]+/,class:/\.[-\w]+/,id:/#[-\w]+/,attribute:{pattern:RegExp(`\\[(?:[^[\\]"']|`+e.source+")*\\]"),greedy:!0,inside:{punctuation:/^\[|\]$/,"case-sensitivity":{pattern:/(\s)[si]$/i,lookbehind:!0,alias:"keyword"},namespace:{pattern:/^(\s*)(?:(?!\s)[-*\w\xA0-\uFFFF])*\|(?!=)/,lookbehind:!0,inside:{punctuation:/\|$/}},"attr-name":{pattern:/^(\s*)(?:(?!\s)[-\w\xA0-\uFFFF])+/,lookbehind:!0},"attr-value":[e,{pattern:/(=\s*)(?:(?!\s)[-\w\xA0-\uFFFF])+(?=\s*$)/,lookbehind:!0}],operator:/[|~*^$]?=/}},"n-th":[{pattern:/(\(\s*)[+-]?\d*[\dn](?:\s*[+-]\s*\d+)?(?=\s*\))/,lookbehind:!0,inside:{number:/[\dn]+/,operator:/[+-]/}},{pattern:/(\(\s*)(?:even|odd)(?=\s*\))/i,lookbehind:!0}],combinator:/>|\+|~|\|\|/,punctuation:/[(),]/}},t.languages.css.atrule.inside["selector-function-argument"].inside=e,t.languages.insertBefore("css","property",{variable:{pattern:/(^|[^-\w\xA0-\uFFFF])--(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*/i,lookbehind:!0}}),{pattern:/(\b\d+)(?:%|[a-z]+(?![\w-]))/,lookbehind:!0}),n={pattern:/(^|[^\w.-])-?(?:\d+(?:\.\d+)?|\.\d+)/,lookbehind:!0};t.languages.insertBefore("css","function",{operator:{pattern:/(\s)[+\-*\/](?=\s)/,lookbehind:!0},hexcode:{pattern:/\B#[\da-f]{3,8}\b/i,alias:"color"},color:[{pattern:/(^|[^\w-])(?:AliceBlue|AntiqueWhite|Aqua|Aquamarine|Azure|Beige|Bisque|Black|BlanchedAlmond|Blue|BlueViolet|Brown|BurlyWood|CadetBlue|Chartreuse|Chocolate|Coral|CornflowerBlue|Cornsilk|Crimson|Cyan|DarkBlue|DarkCyan|DarkGoldenRod|DarkGr[ae]y|DarkGreen|DarkKhaki|DarkMagenta|DarkOliveGreen|DarkOrange|DarkOrchid|DarkRed|DarkSalmon|DarkSeaGreen|DarkSlateBlue|DarkSlateGr[ae]y|DarkTurquoise|DarkViolet|DeepPink|DeepSkyBlue|DimGr[ae]y|DodgerBlue|FireBrick|FloralWhite|ForestGreen|Fuchsia|Gainsboro|GhostWhite|Gold|GoldenRod|Gr[ae]y|Green|GreenYellow|HoneyDew|HotPink|IndianRed|Indigo|Ivory|Khaki|Lavender|LavenderBlush|LawnGreen|LemonChiffon|LightBlue|LightCoral|LightCyan|LightGoldenRodYellow|LightGr[ae]y|LightGreen|LightPink|LightSalmon|LightSeaGreen|LightSkyBlue|LightSlateGr[ae]y|LightSteelBlue|LightYellow|Lime|LimeGreen|Linen|Magenta|Maroon|MediumAquaMarine|MediumBlue|MediumOrchid|MediumPurple|MediumSeaGreen|MediumSlateBlue|MediumSpringGreen|MediumTurquoise|MediumVioletRed|MidnightBlue|MintCream|MistyRose|Moccasin|NavajoWhite|Navy|OldLace|Olive|OliveDrab|Orange|OrangeRed|Orchid|PaleGoldenRod|PaleGreen|PaleTurquoise|PaleVioletRed|PapayaWhip|PeachPuff|Peru|Pink|Plum|PowderBlue|Purple|RebeccaPurple|Red|RosyBrown|RoyalBlue|SaddleBrown|Salmon|SandyBrown|SeaGreen|SeaShell|Sienna|Silver|SkyBlue|SlateBlue|SlateGr[ae]y|Snow|SpringGreen|SteelBlue|Tan|Teal|Thistle|Tomato|Transparent|Turquoise|Violet|Wheat|White|WhiteSmoke|Yellow|YellowGreen)(?![\w-])/i,lookbehind:!0},{pattern:/\b(?:hsl|rgb)\(\s*\d{1,3}\s*,\s*\d{1,3}%?\s*,\s*\d{1,3}%?\s*\)\B|\b(?:hsl|rgb)a\(\s*\d{1,3}\s*,\s*\d{1,3}%?\s*,\s*\d{1,3}%?\s*,\s*(?:0|0?\.\d+|1)\s*\)\B/i,inside:{unit:e,number:n,function:/[\w-]+(?=\()/,punctuation:/[(),]/}}],entity:/\\[\da-f]{1,8}/i,unit:e,number:n})}(X),function(t){var e=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,i="(?:"+n.source+"(?:[ 	]+"+e.source+")?|"+e.source+"(?:[ 	]+"+n.source+")?)",r=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),s=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var u=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return i}).replace(/<<value>>/g,function(){return o});return RegExp(u,l)}t.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return i})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return i}).replace(/<<key>>/g,function(){return"(?:"+r+"|"+s+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(s),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:e,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},t.languages.yml=t.languages.yaml}(X),function(t){var e=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return e}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var i=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,r=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return i}),s=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source,a=(t.languages.markdown=t.languages.extend("markup",{}),t.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:t.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+r+s+"(?:"+r+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+r+s+")(?:"+r+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(i),inside:t.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+r+")"+s+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+r+"$"),inside:{"table-header":{pattern:RegExp(i),alias:"important",inside:t.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(c){u!==c&&(t.languages.markdown[u].inside.content.inside[c]=t.languages.markdown[c])})}),t.hooks.add("after-tokenize",function(u){u.language!=="markdown"&&u.language!=="md"||function c(h){if(h&&typeof h!="string")for(var d=0,p=h.length;d<p;d++){var m,_=h[d];_.type!=="code"?c(_.content):(m=_.content[1],_=_.content[3],m&&_&&m.type==="code-language"&&_.type==="code-block"&&typeof m.content=="string"&&(m=m.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp"),m="language-"+(m=(/[a-z][\w-]*/i.exec(m)||[""])[0].toLowerCase()),_.alias?typeof _.alias=="string"?_.alias=[_.alias,m]:_.alias.push(m):_.alias=[m]))}}(u.tokens)}),t.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var c="",h=0,d=u.classes.length;h<d;h++){var p=u.classes[h],p=/language-(.+)/.exec(p);if(p){c=p[1];break}}var m,_=t.languages[c];_?u.content=t.highlight(function(f){return f=f.replace(a,""),f=f.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(v,g){var y;return(g=g.toLowerCase())[0]==="#"?(y=g[1]==="x"?parseInt(g.slice(2),16):Number(g.slice(1)),l(y)):o[g]||v})}(u.content),_,c):c&&c!=="none"&&t.plugins.autoloader&&(m="md-"+new Date().valueOf()+"-"+Math.floor(1e16*Math.random()),u.attributes.id=m,t.plugins.autoloader.loadLanguages(c,function(){var f=document.getElementById(m);f&&(f.innerHTML=t.highlight(f.textContent,t.languages[c],c))}))}}),RegExp(t.languages.markup.tag.pattern.source,"gi")),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;t.languages.md=t.languages.markdown}(X),X.languages.graphql={comment:/#.*/,description:{pattern:/(?:"""(?:[^"]|(?!""")")*"""|"(?:\\.|[^\\"\r\n])*")(?=\s*[a-z_])/i,greedy:!0,alias:"string",inside:{"language-markdown":{pattern:/(^"(?:"")?)(?!\1)[\s\S]+(?=\1$)/,lookbehind:!0,inside:X.languages.markdown}}},string:{pattern:/"""(?:[^"]|(?!""")")*"""|"(?:\\.|[^\\"\r\n])*"/,greedy:!0},number:/(?:\B-|\b)\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,boolean:/\b(?:false|true)\b/,variable:/\$[a-z_]\w*/i,directive:{pattern:/@[a-z_]\w*/i,alias:"function"},"attr-name":{pattern:/\b[a-z_]\w*(?=\s*(?:\((?:[^()"]|"(?:\\.|[^\\"\r\n])*")*\))?:)/i,greedy:!0},"atom-input":{pattern:/\b[A-Z]\w*Input\b/,alias:"class-name"},scalar:/\b(?:Boolean|Float|ID|Int|String)\b/,constant:/\b[A-Z][A-Z_\d]*\b/,"class-name":{pattern:/(\b(?:enum|implements|interface|on|scalar|type|union)\s+|&\s*|:\s*|\[)[A-Z_]\w*/,lookbehind:!0},fragment:{pattern:/(\bfragment\s+|\.{3}\s*(?!on\b))[a-zA-Z_]\w*/,lookbehind:!0,alias:"function"},"definition-mutation":{pattern:/(\bmutation\s+)[a-zA-Z_]\w*/,lookbehind:!0,alias:"function"},"definition-query":{pattern:/(\bquery\s+)[a-zA-Z_]\w*/,lookbehind:!0,alias:"function"},keyword:/\b(?:directive|enum|extend|fragment|implements|input|interface|mutation|on|query|repeatable|scalar|schema|subscription|type|union)\b/,operator:/[!=|&]|\.{3}/,"property-query":/\w+(?=\s*\()/,object:/\w+(?=\s*\{)/,punctuation:/[!(){}\[\]:=,]/,property:/\w+/},X.hooks.add("after-tokenize",function(t){if(t.language==="graphql")for(var e=t.tokens.filter(function(m){return typeof m!="string"&&m.type!=="comment"&&m.type!=="scalar"}),n=0;n<e.length;){var i=e[n++];if(i.type==="keyword"&&i.content==="mutation"){var r=[];if(h(["definition-mutation","punctuation"])&&c(1).content==="("){n+=2;var s=d(/^\($/,/^\)$/);if(s===-1)continue;for(;n<s;n++){var a=c(0);a.type==="variable"&&(p(a,"variable-input"),r.push(a.content))}n=s+1}if(h(["punctuation","property-query"])&&c(0).content==="{"&&(n++,p(c(0),"property-mutation"),0<r.length)){var o=d(/^\{$/,/^\}$/);if(o!==-1)for(var l=n;l<o;l++){var u=e[l];u.type==="variable"&&0<=r.indexOf(u.content)&&p(u,"variable-input")}}}}function c(m){return e[n+m]}function h(m,_){_=_||0;for(var f=0;f<m.length;f++){var v=c(f+_);if(!v||v.type!==m[f])return}return 1}function d(m,_){for(var f=1,v=n;v<e.length;v++){var g=e[v],y=g.content;if(g.type==="punctuation"&&typeof y=="string"){if(m.test(y))f++;else if(_.test(y)&&--f===0)return v}}return-1}function p(m,_){var f=m.alias;f?Array.isArray(f)||(m.alias=f=[f]):m.alias=f=[],f.push(_)}}),X.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/},function(t){var e=t.languages.javascript["template-string"],n=e.pattern.source,i=e.inside.interpolation,r=i.inside["interpolation-punctuation"],s=i.pattern.source;function a(h,d){if(t.languages[h])return{pattern:RegExp("((?:"+d+")\\s*)"+n),lookbehind:!0,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},"embedded-code":{pattern:/[\s\S]+/,alias:h}}}}function o(h,d,p){return h={code:h,grammar:d,language:p},t.hooks.run("before-tokenize",h),h.tokens=t.tokenize(h.code,h.grammar),t.hooks.run("after-tokenize",h),h.tokens}function l(h,d,p){var f=t.tokenize(h,{interpolation:{pattern:RegExp(s),lookbehind:!0}}),m=0,_={},f=o(f.map(function(g){if(typeof g=="string")return g;for(var y,b,g=g.content;h.indexOf((b=m++,y="___"+p.toUpperCase()+"_"+b+"___"))!==-1;);return _[y]=g,y}).join(""),d,p),v=Object.keys(_);return m=0,function g(y){for(var b=0;b<y.length;b++){if(m>=v.length)return;var w,x,k,S,E,A,M,R=y[b];typeof R=="string"||typeof R.content=="string"?(w=v[m],(M=(A=typeof R=="string"?R:R.content).indexOf(w))!==-1&&(++m,x=A.substring(0,M),E=_[w],k=void 0,(S={})["interpolation-punctuation"]=r,(S=t.tokenize(E,S)).length===3&&((k=[1,1]).push.apply(k,o(S[1],t.languages.javascript,"javascript")),S.splice.apply(S,k)),k=new t.Token("interpolation",S,i.alias,E),S=A.substring(M+w.length),E=[],x&&E.push(x),E.push(k),S&&(g(A=[S]),E.push.apply(E,A)),typeof R=="string"?(y.splice.apply(y,[b,1].concat(E)),b+=E.length-1):R.content=E)):(M=R.content,Array.isArray(M)?g(M):g([M]))}}(f),new t.Token(p,f,"language-"+p,h)}t.languages.javascript["template-string"]=[a("css",/\b(?:styled(?:\([^)]*\))?(?:\s*\.\s*\w+(?:\([^)]*\))*)*|css(?:\s*\.\s*(?:global|resolve))?|createGlobalStyle|keyframes)/.source),a("html",/\bhtml|\.\s*(?:inner|outer)HTML\s*\+?=/.source),a("svg",/\bsvg/.source),a("markdown",/\b(?:markdown|md)/.source),a("graphql",/\b(?:gql|graphql(?:\s*\.\s*experimental)?)/.source),a("sql",/\bsql/.source),e].filter(Boolean);var u={javascript:!0,js:!0,typescript:!0,ts:!0,jsx:!0,tsx:!0};function c(h){return typeof h=="string"?h:Array.isArray(h)?h.map(c).join(""):c(h.content)}t.hooks.add("after-tokenize",function(h){h.language in u&&function d(p){for(var m=0,_=p.length;m<_;m++){var f,v,g,y=p[m];typeof y!="string"&&(f=y.content,Array.isArray(f)?y.type==="template-string"?(y=f[1],f.length===3&&typeof y!="string"&&y.type==="embedded-code"&&(v=c(y),y=y.alias,y=Array.isArray(y)?y[0]:y,g=t.languages[y])&&(f[1]=l(v,g,y))):d(f):typeof f!="string"&&d([f]))}}(h.tokens)})}(X),function(t){t.languages.typescript=t.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),t.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete t.languages.typescript.parameter,delete t.languages.typescript["literal-property"];var e=t.languages.extend("typescript",{});delete e["class-name"],t.languages.typescript["class-name"].inside=e,t.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),t.languages.ts=t.languages.typescript}(X),function(t){var e=t.languages.javascript,n=/\{(?:[^{}]|\{(?:[^{}]|\{[^{}]*\})*\})+\}/.source,i="(@(?:arg|argument|param|property)\\s+(?:"+n+"\\s+)?)";t.languages.jsdoc=t.languages.extend("javadoclike",{parameter:{pattern:RegExp(i+/(?:(?!\s)[$\w\xA0-\uFFFF.])+(?=\s|$)/.source),lookbehind:!0,inside:{punctuation:/\./}}}),t.languages.insertBefore("jsdoc","keyword",{"optional-parameter":{pattern:RegExp(i+/\[(?:(?!\s)[$\w\xA0-\uFFFF.])+(?:=[^[\]]+)?\](?=\s|$)/.source),lookbehind:!0,inside:{parameter:{pattern:/(^\[)[$\w\xA0-\uFFFF\.]+/,lookbehind:!0,inside:{punctuation:/\./}},code:{pattern:/(=)[\s\S]*(?=\]$)/,lookbehind:!0,inside:e,alias:"language-javascript"},punctuation:/[=[\]]/}},"class-name":[{pattern:RegExp(/(@(?:augments|class|extends|interface|memberof!?|template|this|typedef)\s+(?:<TYPE>\s+)?)[A-Z]\w*(?:\.[A-Z]\w*)*/.source.replace(/<TYPE>/g,function(){return n})),lookbehind:!0,inside:{punctuation:/\./}},{pattern:RegExp("(@[a-z]+\\s+)"+n),lookbehind:!0,inside:{string:e.string,number:e.number,boolean:e.boolean,keyword:t.languages.typescript.keyword,operator:/=>|\.\.\.|[&|?:*]/,punctuation:/[.,;=<>{}()[\]]/}}],example:{pattern:/(@example\s+(?!\s))(?:[^@\s]|\s+(?!\s))+?(?=\s*(?:\*\s*)?(?:@\w|\*\/))/,lookbehind:!0,inside:{code:{pattern:/^([\t ]*(?:\*\s*)?)\S.*$/m,lookbehind:!0,inside:e,alias:"language-javascript"}}}}),t.languages.javadoclike.addSupport("javascript",t.languages.jsdoc)}(X),function(t){t.languages.flow=t.languages.extend("javascript",{}),t.languages.insertBefore("flow","keyword",{type:[{pattern:/\b(?:[Bb]oolean|Function|[Nn]umber|[Ss]tring|[Ss]ymbol|any|mixed|null|void)\b/,alias:"class-name"}]}),t.languages.flow["function-variable"].pattern=/(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=\s*(?:function\b|(?:\([^()]*\)(?:\s*:\s*\w+)?|(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/i,delete t.languages.flow.parameter,t.languages.insertBefore("flow","operator",{"flow-punctuation":{pattern:/\{\||\|\}/,alias:"punctuation"}}),Array.isArray(t.languages.flow.keyword)||(t.languages.flow.keyword=[t.languages.flow.keyword]),t.languages.flow.keyword.unshift({pattern:/(^|[^$]\b)(?:Class|declare|opaque|type)\b(?!\$)/,lookbehind:!0},{pattern:/(^|[^$]\B)\$(?:Diff|Enum|Exact|Keys|ObjMap|PropertyType|Record|Shape|Subtype|Supertype|await)\b(?!\$)/,lookbehind:!0})}(X),X.languages.n4js=X.languages.extend("javascript",{keyword:/\b(?:Array|any|boolean|break|case|catch|class|const|constructor|continue|debugger|declare|default|delete|do|else|enum|export|extends|false|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|module|new|null|number|package|private|protected|public|return|set|static|string|super|switch|this|throw|true|try|typeof|var|void|while|with|yield)\b/}),X.languages.insertBefore("n4js","constant",{annotation:{pattern:/@+\w+/,alias:"operator"}}),X.languages.n4jsd=X.languages.n4js,function(t){function e(a,o){return RegExp(a.replace(/<ID>/g,function(){return/(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/.source}),o)}t.languages.insertBefore("javascript","function-variable",{"method-variable":{pattern:RegExp("(\\.\\s*)"+t.languages.javascript["function-variable"].pattern.source),lookbehind:!0,alias:["function-variable","method","function","property-access"]}}),t.languages.insertBefore("javascript","function",{method:{pattern:RegExp("(\\.\\s*)"+t.languages.javascript.function.source),lookbehind:!0,alias:["function","property-access"]}}),t.languages.insertBefore("javascript","constant",{"known-class-name":[{pattern:/\b(?:(?:Float(?:32|64)|(?:Int|Uint)(?:8|16|32)|Uint8Clamped)?Array|ArrayBuffer|BigInt|Boolean|DataView|Date|Error|Function|Intl|JSON|(?:Weak)?(?:Map|Set)|Math|Number|Object|Promise|Proxy|Reflect|RegExp|String|Symbol|WebAssembly)\b/,alias:"class-name"},{pattern:/\b(?:[A-Z]\w*)Error\b/,alias:"class-name"}]}),t.languages.insertBefore("javascript","keyword",{imports:{pattern:e(/(\bimport\b\s*)(?:<ID>(?:\s*,\s*(?:\*\s*as\s+<ID>|\{[^{}]*\}))?|\*\s*as\s+<ID>|\{[^{}]*\})(?=\s*\bfrom\b)/.source),lookbehind:!0,inside:t.languages.javascript},exports:{pattern:e(/(\bexport\b\s*)(?:\*(?:\s*as\s+<ID>)?(?=\s*\bfrom\b)|\{[^{}]*\})/.source),lookbehind:!0,inside:t.languages.javascript}}),t.languages.javascript.keyword.unshift({pattern:/\b(?:as|default|export|from|import)\b/,alias:"module"},{pattern:/\b(?:await|break|catch|continue|do|else|finally|for|if|return|switch|throw|try|while|yield)\b/,alias:"control-flow"},{pattern:/\bnull\b/,alias:["null","nil"]},{pattern:/\bundefined\b/,alias:"nil"}),t.languages.insertBefore("javascript","operator",{spread:{pattern:/\.{3}/,alias:"operator"},arrow:{pattern:/=>/,alias:"operator"}}),t.languages.insertBefore("javascript","punctuation",{"property-access":{pattern:e(/(\.\s*)#?<ID>/.source),lookbehind:!0},"maybe-class-name":{pattern:/(^|[^$\w\xA0-\uFFFF])[A-Z][$\w\xA0-\uFFFF]+/,lookbehind:!0},dom:{pattern:/\b(?:document|(?:local|session)Storage|location|navigator|performance|window)\b/,alias:"variable"},console:{pattern:/\bconsole(?=\s*\.)/,alias:"class-name"}});for(var n=["function","function-variable","method","method-variable","property-access"],i=0;i<n.length;i++){var s=n[i],r=t.languages.javascript[s],s=(r=t.util.type(r)==="RegExp"?t.languages.javascript[s]={pattern:r}:r).inside||{};(r.inside=s)["maybe-class-name"]=/^[A-Z][\s\S]*/}}(X),function(t){var e=t.util.clone(t.languages.javascript),n=/(?:\s|\/\/.*(?!.)|\/\*(?:[^*]|\*(?!\/))\*\/)/.source,i=/(?:\{(?:\{(?:\{[^{}]*\}|[^{}])*\}|[^{}])*\})/.source,r=/(?:\{<S>*\.{3}(?:[^{}]|<BRACES>)*\})/.source;function s(l,u){return l=l.replace(/<S>/g,function(){return n}).replace(/<BRACES>/g,function(){return i}).replace(/<SPREAD>/g,function(){return r}),RegExp(l,u)}r=s(r).source,t.languages.jsx=t.languages.extend("markup",e),t.languages.jsx.tag.pattern=s(/<\/?(?:[\w.:-]+(?:<S>+(?:[\w.:$-]+(?:=(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s{'"/>=]+|<BRACES>))?|<SPREAD>))*<S>*\/?)?>/.source),t.languages.jsx.tag.inside.tag.pattern=/^<\/?[^\s>\/]*/,t.languages.jsx.tag.inside["attr-value"].pattern=/=(?!\{)(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s'">]+)/,t.languages.jsx.tag.inside.tag.inside["class-name"]=/^[A-Z]\w*(?:\.[A-Z]\w*)*$/,t.languages.jsx.tag.inside.comment=e.comment,t.languages.insertBefore("inside","attr-name",{spread:{pattern:s(/<SPREAD>/.source),inside:t.languages.jsx}},t.languages.jsx.tag),t.languages.insertBefore("inside","special-attr",{script:{pattern:s(/=<BRACES>/.source),alias:"language-javascript",inside:{"script-punctuation":{pattern:/^=(?=\{)/,alias:"punctuation"},rest:t.languages.jsx}}},t.languages.jsx.tag);function a(l){for(var u=[],c=0;c<l.length;c++){var h=l[c],d=!1;typeof h!="string"&&(h.type==="tag"&&h.content[0]&&h.content[0].type==="tag"?h.content[0].content[0].content==="</"?0<u.length&&u[u.length-1].tagName===o(h.content[0].content[1])&&u.pop():h.content[h.content.length-1].content!=="/>"&&u.push({tagName:o(h.content[0].content[1]),openedBraces:0}):0<u.length&&h.type==="punctuation"&&h.content==="{"?u[u.length-1].openedBraces++:0<u.length&&0<u[u.length-1].openedBraces&&h.type==="punctuation"&&h.content==="}"?u[u.length-1].openedBraces--:d=!0),(d||typeof h=="string")&&0<u.length&&u[u.length-1].openedBraces===0&&(d=o(h),c<l.length-1&&(typeof l[c+1]=="string"||l[c+1].type==="plain-text")&&(d+=o(l[c+1]),l.splice(c+1,1)),0<c&&(typeof l[c-1]=="string"||l[c-1].type==="plain-text")&&(d=o(l[c-1])+d,l.splice(c-1,1),c--),l[c]=new t.Token("plain-text",d,null,d)),h.content&&typeof h.content!="string"&&a(h.content)}}var o=function(l){return l?typeof l=="string"?l:typeof l.content=="string"?l.content:l.content.map(o).join(""):""};t.hooks.add("after-tokenize",function(l){l.language!=="jsx"&&l.language!=="tsx"||a(l.tokens)})}(X),function(t){var e=t.util.clone(t.languages.typescript),e=(t.languages.tsx=t.languages.extend("jsx",e),delete t.languages.tsx.parameter,delete t.languages.tsx["literal-property"],t.languages.tsx.tag);e.pattern=RegExp(/(^|[^\w$]|(?=<\/))/.source+"(?:"+e.pattern.source+")",e.pattern.flags),e.lookbehind=!0}(X),X.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/},X.languages.swift["string-literal"].forEach(function(t){t.inside.interpolation.inside=X.languages.swift}),function(t){t.languages.kotlin=t.languages.extend("clike",{keyword:{pattern:/(^|[^.])\b(?:abstract|actual|annotation|as|break|by|catch|class|companion|const|constructor|continue|crossinline|data|do|dynamic|else|enum|expect|external|final|finally|for|fun|get|if|import|in|infix|init|inline|inner|interface|internal|is|lateinit|noinline|null|object|open|operator|out|override|package|private|protected|public|reified|return|sealed|set|super|suspend|tailrec|this|throw|to|try|typealias|val|var|vararg|when|where|while)\b/,lookbehind:!0},function:[{pattern:/(?:`[^\r\n`]+`|\b\w+)(?=\s*\()/,greedy:!0},{pattern:/(\.)(?:`[^\r\n`]+`|\w+)(?=\s*\{)/,lookbehind:!0,greedy:!0}],number:/\b(?:0[xX][\da-fA-F]+(?:_[\da-fA-F]+)*|0[bB][01]+(?:_[01]+)*|\d+(?:_\d+)*(?:\.\d+(?:_\d+)*)?(?:[eE][+-]?\d+(?:_\d+)*)?[fFL]?)\b/,operator:/\+[+=]?|-[-=>]?|==?=?|!(?:!|==?)?|[\/*%<>]=?|[?:]:?|\.\.|&&|\|\||\b(?:and|inv|or|shl|shr|ushr|xor)\b/}),delete t.languages.kotlin["class-name"];var e={"interpolation-punctuation":{pattern:/^\$\{?|\}$/,alias:"punctuation"},expression:{pattern:/[\s\S]+/,inside:t.languages.kotlin}};t.languages.insertBefore("kotlin","string",{"string-literal":[{pattern:/"""(?:[^$]|\$(?:(?!\{)|\{[^{}]*\}))*?"""/,alias:"multiline",inside:{interpolation:{pattern:/\$(?:[a-z_]\w*|\{[^{}]*\})/i,inside:e},string:/[\s\S]+/}},{pattern:/"(?:[^"\\\r\n$]|\\.|\$(?:(?!\{)|\{[^{}]*\}))*"/,alias:"singleline",inside:{interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$(?:[a-z_]\w*|\{[^{}]*\})/i,lookbehind:!0,inside:e},string:/[\s\S]+/}}],char:{pattern:/'(?:[^'\\\r\n]|\\(?:.|u[a-fA-F0-9]{0,4}))'/,greedy:!0}}),delete t.languages.kotlin.string,t.languages.insertBefore("kotlin","keyword",{annotation:{pattern:/\B@(?:\w+:)?(?:[A-Z]\w*|\[[^\]]+\])/,alias:"builtin"}}),t.languages.insertBefore("kotlin","function",{label:{pattern:/\b\w+@|@\w+\b/,alias:"symbol"}}),t.languages.kt=t.languages.kotlin,t.languages.kts=t.languages.kotlin}(X),X.languages.c=X.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/}),X.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}}),X.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},X.languages.c.string],char:X.languages.c.char,comment:X.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:X.languages.c}}}}),X.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/}),delete X.languages.c.boolean,X.languages.objectivec=X.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/}),delete X.languages.objectivec["class-name"],X.languages.objc=X.languages.objectivec,X.languages.reason=X.languages.extend("clike",{string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^\\\r\n"])*"/,greedy:!0},"class-name":/\b[A-Z]\w*/,keyword:/\b(?:and|as|assert|begin|class|constraint|do|done|downto|else|end|exception|external|for|fun|function|functor|if|in|include|inherit|initializer|lazy|let|method|module|mutable|new|nonrec|object|of|open|or|private|rec|sig|struct|switch|then|to|try|type|val|virtual|when|while|with)\b/,operator:/\.{3}|:[:=]|\|>|->|=(?:==?|>)?|<=?|>=?|[|^?'#!~`]|[+\-*\/]\.?|\b(?:asr|land|lor|lsl|lsr|lxor|mod)\b/}),X.languages.insertBefore("reason","class-name",{char:{pattern:/'(?:\\x[\da-f]{2}|\\o[0-3][0-7][0-7]|\\\d{3}|\\.|[^'\\\r\n])'/,greedy:!0},constructor:/\b[A-Z]\w*\b(?!\s*\.)/,label:{pattern:/\b[a-z]\w*(?=::)/,alias:"symbol"}}),delete X.languages.reason.function,function(t){for(var e=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)e=e.replace(/<self>/g,function(){return e});e=e.replace(/<self>/g,function(){return/[^\s\S]/.source}),t.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+e),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},t.languages.rust["closure-params"].inside.rest=t.languages.rust,t.languages.rust.attribute.inside.string=t.languages.rust.string}(X),X.languages.go=X.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/}),X.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}}),delete X.languages.go["class-name"],function(t){var e=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,n=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return e.source});t.languages.cpp=t.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:e,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),t.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return n})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),t.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t.languages.cpp}}}}),t.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),t.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:t.languages.extend("cpp",{})}}),t.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},t.languages.cpp["base-clause"])}(X),X.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},X.languages.python["string-interpolation"].inside.interpolation.inside.rest=X.languages.python,X.languages.py=X.languages.python,X.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}},X.languages.webmanifest=X.languages.json;var Rh={};bz(Rh,{dracula:()=>Cz,duotoneDark:()=>Dz,duotoneLight:()=>Tz,github:()=>Rz,gruvboxMaterialDark:()=>oF,gruvboxMaterialLight:()=>lF,jettwaveDark:()=>Xz,jettwaveLight:()=>eF,nightOwl:()=>Pz,nightOwlLight:()=>Iz,oceanicNext:()=>Bz,okaidia:()=>Fz,oneDark:()=>nF,oneLight:()=>rF,palenight:()=>Hz,shadesOfPurple:()=>Wz,synthwave84:()=>Gz,ultramin:()=>qz,vsDark:()=>iE,vsLight:()=>Zz});var kz={plain:{color:"#F8F8F2",backgroundColor:"#282A36"},styles:[{types:["prolog","constant","builtin"],style:{color:"rgb(189, 147, 249)"}},{types:["inserted","function"],style:{color:"rgb(80, 250, 123)"}},{types:["deleted"],style:{color:"rgb(255, 85, 85)"}},{types:["changed"],style:{color:"rgb(255, 184, 108)"}},{types:["punctuation","symbol"],style:{color:"rgb(248, 248, 242)"}},{types:["string","char","tag","selector"],style:{color:"rgb(255, 121, 198)"}},{types:["keyword","variable"],style:{color:"rgb(189, 147, 249)",fontStyle:"italic"}},{types:["comment"],style:{color:"rgb(98, 114, 164)"}},{types:["attr-name"],style:{color:"rgb(241, 250, 140)"}}]},Cz=kz,Ez={plain:{backgroundColor:"#2a2734",color:"#9a86fd"},styles:[{types:["comment","prolog","doctype","cdata","punctuation"],style:{color:"#6c6783"}},{types:["namespace"],style:{opacity:.7}},{types:["tag","operator","number"],style:{color:"#e09142"}},{types:["property","function"],style:{color:"#9a86fd"}},{types:["tag-id","selector","atrule-id"],style:{color:"#eeebff"}},{types:["attr-name"],style:{color:"#c4b9fe"}},{types:["boolean","string","entity","url","attr-value","keyword","control","directive","unit","statement","regex","atrule","placeholder","variable"],style:{color:"#ffcc99"}},{types:["deleted"],style:{textDecorationLine:"line-through"}},{types:["inserted"],style:{textDecorationLine:"underline"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["important","bold"],style:{fontWeight:"bold"}},{types:["important"],style:{color:"#c4b9fe"}}]},Dz=Ez,Az={plain:{backgroundColor:"#faf8f5",color:"#728fcb"},styles:[{types:["comment","prolog","doctype","cdata","punctuation"],style:{color:"#b6ad9a"}},{types:["namespace"],style:{opacity:.7}},{types:["tag","operator","number"],style:{color:"#063289"}},{types:["property","function"],style:{color:"#b29762"}},{types:["tag-id","selector","atrule-id"],style:{color:"#2d2006"}},{types:["attr-name"],style:{color:"#896724"}},{types:["boolean","string","entity","url","attr-value","keyword","control","directive","unit","statement","regex","atrule"],style:{color:"#728fcb"}},{types:["placeholder","variable"],style:{color:"#93abdc"}},{types:["deleted"],style:{textDecorationLine:"line-through"}},{types:["inserted"],style:{textDecorationLine:"underline"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["important","bold"],style:{fontWeight:"bold"}},{types:["important"],style:{color:"#896724"}}]},Tz=Az,Mz={plain:{color:"#393A34",backgroundColor:"#f6f8fa"},styles:[{types:["comment","prolog","doctype","cdata"],style:{color:"#999988",fontStyle:"italic"}},{types:["namespace"],style:{opacity:.7}},{types:["string","attr-value"],style:{color:"#e3116c"}},{types:["punctuation","operator"],style:{color:"#393A34"}},{types:["entity","url","symbol","number","boolean","variable","constant","property","regex","inserted"],style:{color:"#36acaa"}},{types:["atrule","keyword","attr-name","selector"],style:{color:"#00a4db"}},{types:["function","deleted","tag"],style:{color:"#d73a49"}},{types:["function-variable"],style:{color:"#6f42c1"}},{types:["tag","selector","keyword"],style:{color:"#00009f"}}]},Rz=Mz,Oz={plain:{color:"#d6deeb",backgroundColor:"#011627"},styles:[{types:["changed"],style:{color:"rgb(162, 191, 252)",fontStyle:"italic"}},{types:["deleted"],style:{color:"rgba(239, 83, 80, 0.56)",fontStyle:"italic"}},{types:["inserted","attr-name"],style:{color:"rgb(173, 219, 103)",fontStyle:"italic"}},{types:["comment"],style:{color:"rgb(99, 119, 119)",fontStyle:"italic"}},{types:["string","url"],style:{color:"rgb(173, 219, 103)"}},{types:["variable"],style:{color:"rgb(214, 222, 235)"}},{types:["number"],style:{color:"rgb(247, 140, 108)"}},{types:["builtin","char","constant","function"],style:{color:"rgb(130, 170, 255)"}},{types:["punctuation"],style:{color:"rgb(199, 146, 234)"}},{types:["selector","doctype"],style:{color:"rgb(199, 146, 234)",fontStyle:"italic"}},{types:["class-name"],style:{color:"rgb(255, 203, 139)"}},{types:["tag","operator","keyword"],style:{color:"rgb(127, 219, 202)"}},{types:["boolean"],style:{color:"rgb(255, 88, 116)"}},{types:["property"],style:{color:"rgb(128, 203, 196)"}},{types:["namespace"],style:{color:"rgb(178, 204, 214)"}}]},Pz=Oz,Nz={plain:{color:"#403f53",backgroundColor:"#FBFBFB"},styles:[{types:["changed"],style:{color:"rgb(162, 191, 252)",fontStyle:"italic"}},{types:["deleted"],style:{color:"rgba(239, 83, 80, 0.56)",fontStyle:"italic"}},{types:["inserted","attr-name"],style:{color:"rgb(72, 118, 214)",fontStyle:"italic"}},{types:["comment"],style:{color:"rgb(152, 159, 177)",fontStyle:"italic"}},{types:["string","builtin","char","constant","url"],style:{color:"rgb(72, 118, 214)"}},{types:["variable"],style:{color:"rgb(201, 103, 101)"}},{types:["number"],style:{color:"rgb(170, 9, 130)"}},{types:["punctuation"],style:{color:"rgb(153, 76, 195)"}},{types:["function","selector","doctype"],style:{color:"rgb(153, 76, 195)",fontStyle:"italic"}},{types:["class-name"],style:{color:"rgb(17, 17, 17)"}},{types:["tag"],style:{color:"rgb(153, 76, 195)"}},{types:["operator","property","keyword","namespace"],style:{color:"rgb(12, 150, 155)"}},{types:["boolean"],style:{color:"rgb(188, 84, 84)"}}]},Iz=Nz,mn={char:"#D8DEE9",comment:"#999999",keyword:"#c5a5c5",primitive:"#5a9bcf",string:"#8dc891",variable:"#d7deea",boolean:"#ff8b50",tag:"#fc929e",function:"#79b6f2",className:"#FAC863"},Lz={plain:{backgroundColor:"#282c34",color:"#ffffff"},styles:[{types:["attr-name"],style:{color:mn.keyword}},{types:["attr-value"],style:{color:mn.string}},{types:["comment","block-comment","prolog","doctype","cdata","shebang"],style:{color:mn.comment}},{types:["property","number","function-name","constant","symbol","deleted"],style:{color:mn.primitive}},{types:["boolean"],style:{color:mn.boolean}},{types:["tag"],style:{color:mn.tag}},{types:["string"],style:{color:mn.string}},{types:["punctuation"],style:{color:mn.string}},{types:["selector","char","builtin","inserted"],style:{color:mn.char}},{types:["function"],style:{color:mn.function}},{types:["operator","entity","url","variable"],style:{color:mn.variable}},{types:["keyword"],style:{color:mn.keyword}},{types:["atrule","class-name"],style:{color:mn.className}},{types:["important"],style:{fontWeight:"400"}},{types:["bold"],style:{fontWeight:"bold"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["namespace"],style:{opacity:.7}}]},Bz=Lz,zz={plain:{color:"#f8f8f2",backgroundColor:"#272822"},styles:[{types:["changed"],style:{color:"rgb(162, 191, 252)",fontStyle:"italic"}},{types:["deleted"],style:{color:"#f92672",fontStyle:"italic"}},{types:["inserted"],style:{color:"rgb(173, 219, 103)",fontStyle:"italic"}},{types:["comment"],style:{color:"#8292a2",fontStyle:"italic"}},{types:["string","url"],style:{color:"#a6e22e"}},{types:["variable"],style:{color:"#f8f8f2"}},{types:["number"],style:{color:"#ae81ff"}},{types:["builtin","char","constant","function","class-name"],style:{color:"#e6db74"}},{types:["punctuation"],style:{color:"#f8f8f2"}},{types:["selector","doctype"],style:{color:"#a6e22e",fontStyle:"italic"}},{types:["tag","operator","keyword"],style:{color:"#66d9ef"}},{types:["boolean"],style:{color:"#ae81ff"}},{types:["namespace"],style:{color:"rgb(178, 204, 214)",opacity:.7}},{types:["tag","property"],style:{color:"#f92672"}},{types:["attr-name"],style:{color:"#a6e22e !important"}},{types:["doctype"],style:{color:"#8292a2"}},{types:["rule"],style:{color:"#e6db74"}}]},Fz=zz,jz={plain:{color:"#bfc7d5",backgroundColor:"#292d3e"},styles:[{types:["comment"],style:{color:"rgb(105, 112, 152)",fontStyle:"italic"}},{types:["string","inserted"],style:{color:"rgb(195, 232, 141)"}},{types:["number"],style:{color:"rgb(247, 140, 108)"}},{types:["builtin","char","constant","function"],style:{color:"rgb(130, 170, 255)"}},{types:["punctuation","selector"],style:{color:"rgb(199, 146, 234)"}},{types:["variable"],style:{color:"rgb(191, 199, 213)"}},{types:["class-name","attr-name"],style:{color:"rgb(255, 203, 107)"}},{types:["tag","deleted"],style:{color:"rgb(255, 85, 114)"}},{types:["operator"],style:{color:"rgb(137, 221, 255)"}},{types:["boolean"],style:{color:"rgb(255, 88, 116)"}},{types:["keyword"],style:{fontStyle:"italic"}},{types:["doctype"],style:{color:"rgb(199, 146, 234)",fontStyle:"italic"}},{types:["namespace"],style:{color:"rgb(178, 204, 214)"}},{types:["url"],style:{color:"rgb(221, 221, 221)"}}]},Hz=jz,$z={plain:{color:"#9EFEFF",backgroundColor:"#2D2A55"},styles:[{types:["changed"],style:{color:"rgb(255, 238, 128)"}},{types:["deleted"],style:{color:"rgba(239, 83, 80, 0.56)"}},{types:["inserted"],style:{color:"rgb(173, 219, 103)"}},{types:["comment"],style:{color:"rgb(179, 98, 255)",fontStyle:"italic"}},{types:["punctuation"],style:{color:"rgb(255, 255, 255)"}},{types:["constant"],style:{color:"rgb(255, 98, 140)"}},{types:["string","url"],style:{color:"rgb(165, 255, 144)"}},{types:["variable"],style:{color:"rgb(255, 238, 128)"}},{types:["number","boolean"],style:{color:"rgb(255, 98, 140)"}},{types:["attr-name"],style:{color:"rgb(255, 180, 84)"}},{types:["keyword","operator","property","namespace","tag","selector","doctype"],style:{color:"rgb(255, 157, 0)"}},{types:["builtin","char","constant","function","class-name"],style:{color:"rgb(250, 208, 0)"}}]},Wz=$z,Vz={plain:{backgroundColor:"linear-gradient(to bottom, #2a2139 75%, #34294f)",backgroundImage:"#34294f",color:"#f92aad",textShadow:"0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3"},styles:[{types:["comment","block-comment","prolog","doctype","cdata"],style:{color:"#495495",fontStyle:"italic"}},{types:["punctuation"],style:{color:"#ccc"}},{types:["tag","attr-name","namespace","number","unit","hexcode","deleted"],style:{color:"#e2777a"}},{types:["property","selector"],style:{color:"#72f1b8",textShadow:"0 0 2px #100c0f, 0 0 10px #257c5575, 0 0 35px #21272475"}},{types:["function-name"],style:{color:"#6196cc"}},{types:["boolean","selector-id","function"],style:{color:"#fdfdfd",textShadow:"0 0 2px #001716, 0 0 3px #03edf975, 0 0 5px #03edf975, 0 0 8px #03edf975"}},{types:["class-name","maybe-class-name","builtin"],style:{color:"#fff5f6",textShadow:"0 0 2px #000, 0 0 10px #fc1f2c75, 0 0 5px #fc1f2c75, 0 0 25px #fc1f2c75"}},{types:["constant","symbol"],style:{color:"#f92aad",textShadow:"0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3"}},{types:["important","atrule","keyword","selector-class"],style:{color:"#f4eee4",textShadow:"0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575"}},{types:["string","char","attr-value","regex","variable"],style:{color:"#f87c32"}},{types:["parameter"],style:{fontStyle:"italic"}},{types:["entity","url"],style:{color:"#67cdcc"}},{types:["operator"],style:{color:"ffffffee"}},{types:["important","bold"],style:{fontWeight:"bold"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["entity"],style:{cursor:"help"}},{types:["inserted"],style:{color:"green"}}]},Gz=Vz,Uz={plain:{color:"#282a2e",backgroundColor:"#ffffff"},styles:[{types:["comment"],style:{color:"rgb(197, 200, 198)"}},{types:["string","number","builtin","variable"],style:{color:"rgb(150, 152, 150)"}},{types:["class-name","function","tag","attr-name"],style:{color:"rgb(40, 42, 46)"}}]},qz=Uz,Kz={plain:{color:"#9CDCFE",backgroundColor:"#1E1E1E"},styles:[{types:["prolog"],style:{color:"rgb(0, 0, 128)"}},{types:["comment"],style:{color:"rgb(106, 153, 85)"}},{types:["builtin","changed","keyword","interpolation-punctuation"],style:{color:"rgb(86, 156, 214)"}},{types:["number","inserted"],style:{color:"rgb(181, 206, 168)"}},{types:["constant"],style:{color:"rgb(100, 102, 149)"}},{types:["attr-name","variable"],style:{color:"rgb(156, 220, 254)"}},{types:["deleted","string","attr-value","template-punctuation"],style:{color:"rgb(206, 145, 120)"}},{types:["selector"],style:{color:"rgb(215, 186, 125)"}},{types:["tag"],style:{color:"rgb(78, 201, 176)"}},{types:["tag"],languages:["markup"],style:{color:"rgb(86, 156, 214)"}},{types:["punctuation","operator"],style:{color:"rgb(212, 212, 212)"}},{types:["punctuation"],languages:["markup"],style:{color:"#808080"}},{types:["function"],style:{color:"rgb(220, 220, 170)"}},{types:["class-name"],style:{color:"rgb(78, 201, 176)"}},{types:["char"],style:{color:"rgb(209, 105, 105)"}}]},iE=Kz,Jz={plain:{color:"#000000",backgroundColor:"#ffffff"},styles:[{types:["comment"],style:{color:"rgb(0, 128, 0)"}},{types:["builtin"],style:{color:"rgb(0, 112, 193)"}},{types:["number","variable","inserted"],style:{color:"rgb(9, 134, 88)"}},{types:["operator"],style:{color:"rgb(0, 0, 0)"}},{types:["constant","char"],style:{color:"rgb(129, 31, 63)"}},{types:["tag"],style:{color:"rgb(128, 0, 0)"}},{types:["attr-name"],style:{color:"rgb(255, 0, 0)"}},{types:["deleted","string"],style:{color:"rgb(163, 21, 21)"}},{types:["changed","punctuation"],style:{color:"rgb(4, 81, 165)"}},{types:["function","keyword"],style:{color:"rgb(0, 0, 255)"}},{types:["class-name"],style:{color:"rgb(38, 127, 153)"}}]},Zz=Jz,Yz={plain:{color:"#f8fafc",backgroundColor:"#011627"},styles:[{types:["prolog"],style:{color:"#000080"}},{types:["comment"],style:{color:"#6A9955"}},{types:["builtin","changed","keyword","interpolation-punctuation"],style:{color:"#569CD6"}},{types:["number","inserted"],style:{color:"#B5CEA8"}},{types:["constant"],style:{color:"#f8fafc"}},{types:["attr-name","variable"],style:{color:"#9CDCFE"}},{types:["deleted","string","attr-value","template-punctuation"],style:{color:"#cbd5e1"}},{types:["selector"],style:{color:"#D7BA7D"}},{types:["tag"],style:{color:"#0ea5e9"}},{types:["tag"],languages:["markup"],style:{color:"#0ea5e9"}},{types:["punctuation","operator"],style:{color:"#D4D4D4"}},{types:["punctuation"],languages:["markup"],style:{color:"#808080"}},{types:["function"],style:{color:"#7dd3fc"}},{types:["class-name"],style:{color:"#0ea5e9"}},{types:["char"],style:{color:"#D16969"}}]},Xz=Yz,Qz={plain:{color:"#0f172a",backgroundColor:"#f1f5f9"},styles:[{types:["prolog"],style:{color:"#000080"}},{types:["comment"],style:{color:"#6A9955"}},{types:["builtin","changed","keyword","interpolation-punctuation"],style:{color:"#0c4a6e"}},{types:["number","inserted"],style:{color:"#B5CEA8"}},{types:["constant"],style:{color:"#0f172a"}},{types:["attr-name","variable"],style:{color:"#0c4a6e"}},{types:["deleted","string","attr-value","template-punctuation"],style:{color:"#64748b"}},{types:["selector"],style:{color:"#D7BA7D"}},{types:["tag"],style:{color:"#0ea5e9"}},{types:["tag"],languages:["markup"],style:{color:"#0ea5e9"}},{types:["punctuation","operator"],style:{color:"#475569"}},{types:["punctuation"],languages:["markup"],style:{color:"#808080"}},{types:["function"],style:{color:"#0e7490"}},{types:["class-name"],style:{color:"#0ea5e9"}},{types:["char"],style:{color:"#D16969"}}]},eF=Qz,tF={plain:{backgroundColor:"hsl(220, 13%, 18%)",color:"hsl(220, 14%, 71%)",textShadow:"0 1px rgba(0, 0, 0, 0.3)"},styles:[{types:["comment","prolog","cdata"],style:{color:"hsl(220, 10%, 40%)"}},{types:["doctype","punctuation","entity"],style:{color:"hsl(220, 14%, 71%)"}},{types:["attr-name","class-name","maybe-class-name","boolean","constant","number","atrule"],style:{color:"hsl(29, 54%, 61%)"}},{types:["keyword"],style:{color:"hsl(286, 60%, 67%)"}},{types:["property","tag","symbol","deleted","important"],style:{color:"hsl(355, 65%, 65%)"}},{types:["selector","string","char","builtin","inserted","regex","attr-value"],style:{color:"hsl(95, 38%, 62%)"}},{types:["variable","operator","function"],style:{color:"hsl(207, 82%, 66%)"}},{types:["url"],style:{color:"hsl(187, 47%, 55%)"}},{types:["deleted"],style:{textDecorationLine:"line-through"}},{types:["inserted"],style:{textDecorationLine:"underline"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["important","bold"],style:{fontWeight:"bold"}},{types:["important"],style:{color:"hsl(220, 14%, 71%)"}}]},nF=tF,iF={plain:{backgroundColor:"hsl(230, 1%, 98%)",color:"hsl(230, 8%, 24%)"},styles:[{types:["comment","prolog","cdata"],style:{color:"hsl(230, 4%, 64%)"}},{types:["doctype","punctuation","entity"],style:{color:"hsl(230, 8%, 24%)"}},{types:["attr-name","class-name","boolean","constant","number","atrule"],style:{color:"hsl(35, 99%, 36%)"}},{types:["keyword"],style:{color:"hsl(301, 63%, 40%)"}},{types:["property","tag","symbol","deleted","important"],style:{color:"hsl(5, 74%, 59%)"}},{types:["selector","string","char","builtin","inserted","regex","attr-value","punctuation"],style:{color:"hsl(119, 34%, 47%)"}},{types:["variable","operator","function"],style:{color:"hsl(221, 87%, 60%)"}},{types:["url"],style:{color:"hsl(198, 99%, 37%)"}},{types:["deleted"],style:{textDecorationLine:"line-through"}},{types:["inserted"],style:{textDecorationLine:"underline"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["important","bold"],style:{fontWeight:"bold"}},{types:["important"],style:{color:"hsl(230, 8%, 24%)"}}]},rF=iF,sF={plain:{color:"#ebdbb2",backgroundColor:"#292828"},styles:[{types:["imports","class-name","maybe-class-name","constant","doctype","builtin","function"],style:{color:"#d8a657"}},{types:["property-access"],style:{color:"#7daea3"}},{types:["tag"],style:{color:"#e78a4e"}},{types:["attr-name","char","url","regex"],style:{color:"#a9b665"}},{types:["attr-value","string"],style:{color:"#89b482"}},{types:["comment","prolog","cdata","operator","inserted"],style:{color:"#a89984"}},{types:["delimiter","boolean","keyword","selector","important","atrule","property","variable","deleted"],style:{color:"#ea6962"}},{types:["entity","number","symbol"],style:{color:"#d3869b"}}]},oF=sF,aF={plain:{color:"#654735",backgroundColor:"#f9f5d7"},styles:[{types:["delimiter","boolean","keyword","selector","important","atrule","property","variable","deleted"],style:{color:"#af2528"}},{types:["imports","class-name","maybe-class-name","constant","doctype","builtin"],style:{color:"#b4730e"}},{types:["string","attr-value"],style:{color:"#477a5b"}},{types:["property-access"],style:{color:"#266b79"}},{types:["function","attr-name","char","url"],style:{color:"#72761e"}},{types:["tag"],style:{color:"#b94c07"}},{types:["comment","prolog","cdata","operator","inserted"],style:{color:"#a89984"}},{types:["entity","number","symbol"],style:{color:"#924f79"}}]},lF=aF,uF=t=>I.useCallback(e=>{var n=e,{className:i,style:r,line:s}=n,a=nE(n,["className","style","line"]);const o=Md(yi({},a),{className:Q2("token-line",i)});return typeof t=="object"&&"plain"in t&&(o.style=t.plain),typeof r=="object"&&(o.style=yi(yi({},o.style||{}),r)),o},[t]),cF=t=>{const e=I.useCallback(({types:n,empty:i})=>{if(t!=null){{if(n.length===1&&n[0]==="plain")return i!=null?{display:"inline-block"}:void 0;if(n.length===1&&i!=null)return t[n[0]]}return Object.assign(i!=null?{display:"inline-block"}:{},...n.map(r=>t[r]))}},[t]);return I.useCallback(n=>{var i=n,{token:r,className:s,style:a}=i,o=nE(i,["token","className","style"]);const l=Md(yi({},o),{className:Q2("token",...r.types,s),children:r.content,style:e(r)});return a!=null&&(l.style=yi(yi({},l.style||{}),a)),l},[e])},hF=/\r\n|\r|\n/,fb=t=>{t.length===0?t.push({types:["plain"],content:`
`,empty:!0}):t.length===1&&t[0].content===""&&(t[0].content=`
`,t[0].empty=!0)},pb=(t,e)=>{const n=t.length;return n>0&&t[n-1]===e?t:t.concat(e)},dF=t=>{const e=[[]],n=[t],i=[0],r=[t.length];let s=0,a=0,o=[];const l=[o];for(;a>-1;){for(;(s=i[a]++)<r[a];){let u,c=e[a];const d=n[a][s];if(typeof d=="string"?(c=a>0?c:["plain"],u=d):(c=pb(c,d.type),d.alias&&(c=pb(c,d.alias)),u=d.content),typeof u!="string"){a++,e.push(c),n.push(u),i.push(0),r.push(u.length);continue}const p=u.split(hF),m=p.length;o.push({types:c,content:p[0]});for(let _=1;_<m;_++)fb(o),l.push(o=[]),o.push({types:c,content:p[_]})}a--,e.pop(),n.pop(),i.pop(),r.pop()}return fb(o),l},mb=dF,fF=({prism:t,code:e,grammar:n,language:i})=>I.useMemo(()=>{if(n==null)return mb([e]);const r={code:e,grammar:n,language:i,tokens:[]};return t.hooks.run("before-tokenize",r),r.tokens=t.tokenize(e,n),t.hooks.run("after-tokenize",r),mb(r.tokens)},[e,n,i,t]),pF=(t,e)=>{const{plain:n}=t,i=t.styles.reduce((r,s)=>{const{languages:a,style:o}=s;return a&&!a.includes(e)||s.types.forEach(l=>{const u=yi(yi({},r[l]),o);r[l]=u}),r},{});return i.root=n,i.plain=Md(yi({},n),{backgroundColor:void 0}),i},mF=pF,gF=({children:t,language:e,code:n,theme:i,prism:r})=>{const s=e.toLowerCase(),a=mF(i,s),o=uF(a),l=cF(a),u=r.languages[s],c=fF({prism:r,language:s,code:n,grammar:u});return t({tokens:c,className:`prism-code language-${s}`,style:a!=null?a.root:{},getLineProps:o,getTokenProps:l})},Km=t=>I.createElement(gF,Md(yi({},t),{prism:t.prism||X,theme:t.theme||iE,code:t.code,language:t.language}));/*! Bundled license information:

prismjs/prism.js:
  (**
   * Prism: Lightweight, robust, elegant syntax highlighting
   *
   * @license MIT <https://opensource.org/licenses/MIT>
   * @author Lea Verou <https://lea.verou.me>
   * @namespace
   * @public
   *)
*/function Ou(t){if(!t)return{frontmatter:"",body:t||""};const e=t.match(/^---\r?\n([\s\S]*?)\r?\n---\r?\n?/);return e?{frontmatter:e[1],body:t.slice(e[0].length)}:{frontmatter:"",body:t}}function Pu(t,e){return!t||t.trim()===""?e:`---
${t}
---
${e}`}function vF({frontmatter:t,onChange:e,isCollapsed:n,onToggleCollapse:i,isDiffMode:r=!1,originalFrontmatter:s=null}){const[a,o]=I.useState(t||""),[l,u]=I.useState(!1),c=I.useRef(null),h=r&&s!==null&&s!==t;I.useEffect(()=>{o(t||"")},[t]);const d=I.useCallback(g=>{if(!g.trim())return!0;const y=g.split(`
`);for(const b of y){if(b.includes("	"))return!1;b.match(/^\s+[^\s:]+:\s*$/)&&b.match(/^(\s{2})+/)}return!0},[]),p=I.useCallback(g=>{o(g);const y=d(g);u(!y),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{e==null||e(g)},300)},[e,d]);I.useEffect(()=>()=>{c.current&&clearTimeout(c.current)},[]);const m=I.useCallback(g=>C.jsx(Km,{theme:Rh.vsDark,code:g,language:"yaml",children:({tokens:y,getLineProps:b,getTokenProps:w})=>C.jsx(C.Fragment,{children:y.map((x,k)=>C.jsxs("div",{...b({line:x}),style:{display:"table-row"},children:[C.jsx("span",{className:"frontmatter-line-number",children:k+1}),C.jsx("span",{style:{display:"table-cell"},children:x.map((S,E)=>C.jsx("span",{...w({token:S})},E))})]},k))})}),[]),_=I.useCallback(g=>C.jsx(Km,{theme:Rh.vsDark,code:g||"",language:"yaml",children:({tokens:y,getLineProps:b,getTokenProps:w})=>C.jsx("pre",{className:"frontmatter-diff-pre",children:y.map((x,k)=>C.jsxs("div",{...b({line:x}),style:{display:"table-row"},children:[C.jsx("span",{className:"frontmatter-line-number",children:k+1}),C.jsx("span",{style:{display:"table-cell"},children:x.map((S,E)=>C.jsx("span",{...w({token:S})},E))})]},k))})}),[]),f=t&&t.trim()!=="",v=s&&s.trim()!=="";return C.jsxs("div",{className:`frontmatter-editor ${n?"collapsed":""} ${l?"has-error":""}`,children:[C.jsxs("div",{className:"frontmatter-header",onClick:i,children:[C.jsx("button",{type:"button",className:"frontmatter-toggle","aria-label":n?"Expand":"Collapse",children:C.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{transform:n?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.15s"},children:C.jsx("polyline",{points:"6 9 12 15 18 9"})})}),C.jsx("span",{className:"frontmatter-label",children:"Metadata"}),f&&C.jsx("span",{className:"frontmatter-badge",children:"YAML"}),h&&C.jsx("span",{className:"frontmatter-changed-badge",children:"Changed"}),l&&C.jsx("span",{className:"frontmatter-error-badge",children:"Invalid"}),!f&&!n&&C.jsx("span",{className:"frontmatter-hint",children:"Add title, date, tags..."})]}),!n&&C.jsx("div",{className:"frontmatter-content",children:r&&s!==null?C.jsxs("div",{className:"frontmatter-diff-container",children:[C.jsxs("div",{className:"frontmatter-diff-side frontmatter-diff-original",children:[C.jsx("div",{className:"frontmatter-diff-label",children:"Original"}),C.jsx("div",{className:"frontmatter-diff-content",children:v?_(s):C.jsx("div",{className:"frontmatter-diff-empty",children:"No metadata"})})]}),C.jsxs("div",{className:"frontmatter-diff-side frontmatter-diff-current",children:[C.jsxs("div",{className:"frontmatter-diff-label",children:["Current",h?" (modified)":""]}),C.jsx("div",{className:"frontmatter-diff-content",children:C.jsxs("div",{className:"frontmatter-editor-wrapper",children:[!a&&C.jsxs("div",{className:"frontmatter-placeholder",children:["title: My Document",`
`,"date: 2024-01-01",`
`,"tags: [tag1, tag2]"]}),C.jsx(qm,{value:a,onValueChange:p,highlight:m,padding:12,className:"frontmatter-input",textareaClassName:"frontmatter-textarea",style:{fontFamily:"'IBM Plex Mono', Monaco, 'Courier New', monospace",fontSize:12,lineHeight:1.5,backgroundColor:"#1e1e1e",color:"#d4d4d4",minHeight:"60px"}})]})})]})]}):C.jsxs("div",{className:"frontmatter-editor-wrapper",children:[!a&&C.jsxs("div",{className:"frontmatter-placeholder",children:["title: My Document",`
`,"date: 2024-01-01",`
`,"tags: [tag1, tag2]"]}),C.jsx(qm,{value:a,onValueChange:p,highlight:m,padding:12,className:"frontmatter-input",textareaClassName:"frontmatter-textarea",style:{fontFamily:"'IBM Plex Mono', Monaco, 'Courier New', monospace",fontSize:12,lineHeight:1.5,backgroundColor:"#1e1e1e",color:"#d4d4d4",minHeight:"60px"}})]})})]})}function _F(t,e){if(t===e)return{deletedLines:[],addedLineNumbers:new Set,wordDiffs:new Map};if(!t){const u=e?e.split(`
`):[],c=new Set;for(let h=1;h<=u.length;h++)c.add(h);return{deletedLines:[],addedLineNumbers:c,wordDiffs:new Map}}const n=tv(t,e),i=[],r=new Set,s=new Map;let a=0,o=[],l=[];return n.forEach(u=>{const c=u.value.split(`
`);c[c.length-1]===""&&c.pop(),u.removed?c.forEach(h=>{o.push(h),l.push(h)}):u.added?c.forEach((h,d)=>{if(a++,r.add(a),d<l.length){const p=l[d],m=Ah(p,h);s.set(a,m)}if(d===0&&o.length>0){const p=o.map((m,_)=>_<c.length?{text:m,wordChanges:Ah(m,c[_])}:{text:m,wordChanges:null});i.push({beforeLine:a,texts:o,wordDiffs:p}),o=[],l=[]}}):(o.length>0&&(i.push({beforeLine:a+1,texts:[...o],wordDiffs:o.map(h=>({text:h,wordChanges:null}))}),o=[],l=[]),c.forEach(()=>{a++}))}),o.length>0&&i.push({beforeLine:a+1,texts:[...o],wordDiffs:o.map(u=>({text:u,wordChanges:null}))}),{deletedLines:i,addedLineNumbers:r,wordDiffs:s}}function yF(t){return Xe.create({name:"diffDecorations",addProseMirrorPlugins(){return[new Ye({key:new dt("diffDecorations"),props:{decorations(e){const{enabled:n,originalContent:i,getEditorMarkdown:r}=t.current||{};if(!n)return We.empty;const s=e.doc,a=r?r():"",o=_F(i||"",a),{deletedLines:l,addedLineNumbers:u,wordDiffs:c}=o,h=[],d=a.split(`
`);let p=0;s.descendants((f,v)=>{if(!f.isBlock)return!1;if(f.type.name==="doc")return!0;let g=1;for(;p<d.length&&d[p]==="";)p++;let y=!1;const b=[];for(let k=0;k<g&&p+k<d.length;k++){const S=p+k+1;if(u.has(S)){y=!0;const E=c.get(S);E&&b.push(...E)}}if(y&&(h.push(nt.node(v,v+f.nodeSize,{class:"diff-line-added"})),b.length>0&&f.isTextblock)){let k=0;const S=v+1;b.forEach(E=>{if(E.added){const A=S+k,M=A+E.value.length;M<=v+f.nodeSize-1&&h.push(nt.inline(A,M,{class:"diff-word-added"})),k+=E.value.length}else E.removed||(k+=E.value.length)})}const w=p+1,x=l.find(k=>k.beforeLine===w);if(x){const k=document.createElement("div");k.className="diff-deleted-block",k.contentEditable="false";const S=[];x.wordDiffs?x.wordDiffs.forEach(({text:A,wordChanges:M})=>{const R=document.createElement("div");R.className="diff-deleted-line",S.push(A),M?M.forEach(P=>{const H=document.createElement("span");P.removed?(H.className="diff-word-removed",H.textContent=P.value,R.appendChild(H)):P.added||(H.textContent=P.value,R.appendChild(H))}):R.textContent=A||"",k.appendChild(R)}):x.texts.forEach(A=>{const M=document.createElement("div");M.className="diff-deleted-line",M.textContent=A||"",S.push(A),k.appendChild(M)});const E=document.createElement("button");E.className="diff-copy-btn",E.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg><span>Copy</span>',E.title="Copy deleted text",E.onclick=A=>{A.preventDefault(),A.stopPropagation(),navigator.clipboard.writeText(S.join(`
`)),E.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg><span>Copied</span>',setTimeout(()=>{E.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg><span>Copy</span>'},1500)},k.appendChild(E),h.push(nt.widget(v,k,{side:-1}))}return p+=g,!1});const m=d.length+1,_=l.find(f=>f.beforeLine>=m);if(_){const f=document.createElement("div");f.className="diff-deleted-block",_.texts.forEach(v=>{const g=document.createElement("div");g.className="diff-deleted-line",g.textContent=v||"",f.appendChild(g)}),h.push(nt.widget(s.content.size,f,{side:1}))}return We.create(s,h)}}})]}})}function bF({editor:t}){const e=I.useCallback(()=>{if(!t)return;const n=t.getAttributes("link").href,i=window.prompt("URL",n);if(i!==null){if(i===""){t.chain().focus().extendMarkRange("link").unsetLink().run();return}t.chain().focus().extendMarkRange("link").setLink({href:i}).run()}},[t]);return t?C.jsxs("div",{className:"editor-menu",children:[C.jsxs("div",{className:"menu-group",children:[C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleBold().run(),className:t.isActive("bold")?"is-active":"",title:"Bold (Ctrl+B)",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[C.jsx("path",{d:"M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"}),C.jsx("path",{d:"M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"})]})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleItalic().run(),className:t.isActive("italic")?"is-active":"",title:"Italic (Ctrl+I)",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("line",{x1:"19",y1:"4",x2:"10",y2:"4"}),C.jsx("line",{x1:"14",y1:"20",x2:"5",y2:"20"}),C.jsx("line",{x1:"15",y1:"4",x2:"9",y2:"20"})]})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleUnderline().run(),className:t.isActive("underline")?"is-active":"",title:"Underline (Ctrl+U)",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("path",{d:"M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"}),C.jsx("line",{x1:"4",y1:"21",x2:"20",y2:"21"})]})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleStrike().run(),className:t.isActive("strike")?"is-active":"",title:"Strikethrough",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),C.jsx("path",{d:"M17.5 7.5c-.6-1.4-2.2-2.5-4.5-2.5-3 0-5 1.5-5 4 0 1.8 1 3 4 3.5"}),C.jsx("path",{d:"M10 16.5c0 1.5 1.5 2.5 4 2.5 2.5 0 4-1.2 4-3"})]})})]}),C.jsx("div",{className:"menu-separator"}),C.jsxs("div",{className:"menu-group",children:[C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),className:t.isActive("heading",{level:1})?"is-active":"",title:"Heading 1",children:C.jsx("span",{className:"text-btn",children:"H1"})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),className:t.isActive("heading",{level:2})?"is-active":"",title:"Heading 2",children:C.jsx("span",{className:"text-btn",children:"H2"})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleHeading({level:3}).run(),className:t.isActive("heading",{level:3})?"is-active":"",title:"Heading 3",children:C.jsx("span",{className:"text-btn",children:"H3"})})]}),C.jsx("div",{className:"menu-separator"}),C.jsxs("div",{className:"menu-group",children:[C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleBulletList().run(),className:t.isActive("bulletList")?"is-active":"",title:"Bullet List",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("line",{x1:"9",y1:"6",x2:"20",y2:"6"}),C.jsx("line",{x1:"9",y1:"12",x2:"20",y2:"12"}),C.jsx("line",{x1:"9",y1:"18",x2:"20",y2:"18"}),C.jsx("circle",{cx:"4",cy:"6",r:"1.5",fill:"currentColor"}),C.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),C.jsx("circle",{cx:"4",cy:"18",r:"1.5",fill:"currentColor"})]})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleOrderedList().run(),className:t.isActive("orderedList")?"is-active":"",title:"Numbered List",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("line",{x1:"10",y1:"6",x2:"21",y2:"6"}),C.jsx("line",{x1:"10",y1:"12",x2:"21",y2:"12"}),C.jsx("line",{x1:"10",y1:"18",x2:"21",y2:"18"}),C.jsx("text",{x:"3",y:"8",fontSize:"7",fill:"currentColor",stroke:"none",children:"1"}),C.jsx("text",{x:"3",y:"14",fontSize:"7",fill:"currentColor",stroke:"none",children:"2"}),C.jsx("text",{x:"3",y:"20",fontSize:"7",fill:"currentColor",stroke:"none",children:"3"})]})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleTaskList().run(),className:t.isActive("taskList")?"is-active":"",title:"Task List",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("rect",{x:"3",y:"5",width:"6",height:"6",rx:"1"}),C.jsx("path",{d:"M5 8l1.5 1.5 3-3"}),C.jsx("line",{x1:"12",y1:"8",x2:"21",y2:"8"}),C.jsx("rect",{x:"3",y:"13",width:"6",height:"6",rx:"1"}),C.jsx("line",{x1:"12",y1:"16",x2:"21",y2:"16"})]})})]}),C.jsx("div",{className:"menu-separator"}),C.jsxs("div",{className:"menu-group",children:[C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleBlockquote().run(),className:t.isActive("blockquote")?"is-active":"",title:"Quote",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:C.jsx("path",{d:"M6 17h3l2-4V7H5v6h3l-2 4zm8 0h3l2-4V7h-6v6h3l-2 4z"})})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleCodeBlock().run(),className:t.isActive("codeBlock")?"is-active":"",title:"Code Block",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("polyline",{points:"16 18 22 12 16 6"}),C.jsx("polyline",{points:"8 6 2 12 8 18"})]})}),C.jsx("button",{type:"button",onClick:e,className:t.isActive("link")?"is-active":"",title:"Add Link",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),C.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}),C.jsx("button",{type:"button",onClick:()=>t.chain().focus().setHorizontalRule().run(),title:"Horizontal Rule",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:C.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"})})})]}),C.jsx("div",{className:"menu-separator"}),C.jsx("div",{className:"menu-group",children:C.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleHighlight().run(),className:t.isActive("highlight")?"is-active":"",title:"Highlight",children:C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("path",{d:"M12 20h9"}),C.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"})]})})})]}):null}function wF({isDirty:t,isSaving:e}){return e?C.jsx("div",{className:"save-status save-status-saving",title:"Saving...",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:C.jsx("circle",{cx:"12",cy:"12",r:"10",strokeDasharray:"31.4",strokeDashoffset:"10",children:C.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 12 12",to:"360 12 12",dur:"1s",repeatCount:"indefinite"})})})}):t?C.jsx("div",{className:"save-status save-status-dirty",title:"Unsaved changes",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:C.jsx("circle",{cx:"12",cy:"12",r:"5"})})}):C.jsx("div",{className:"save-status save-status-saved",title:"All changes saved",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:C.jsx("polyline",{points:"20 6 9 17 4 12"})})})}function SF({content:t,contentVersion:e,isDirty:n,isSaving:i,onChange:r,onAutoSave:s,autoSaveDelay:a=800,showDiffToggle:o=!1,diffText:l="",diffError:u="",editorMode:c="rendered",originalContent:h=null,onModeChange:d}){const p=I.useRef(null),m=I.useRef({enabled:!1,originalContent:null}),_=I.useMemo(()=>Ou(t||""),[]),[f,v]=I.useState(!_.frontmatter||_.frontmatter.trim()===""),[g,y]=I.useState(_.frontmatter),[b,w]=I.useState(_.body),x=I.useRef(e),k=I.useRef(_.frontmatter);k.current=g,I.useEffect(()=>{if(e===x.current)return;x.current=e;const{frontmatter:L,body:j}=Ou(t||"");y(L),w(j),v(!L||L.trim()==="")},[t,e]);const S=I.useMemo(()=>[m2,QN,BN.configure({openOnClick:!1,HTMLAttributes:{class:"editor-link"}}),kI.configure({placeholder:"Start writing..."}),CI,EI.configure({nested:!0}),AI.configure({types:["heading","paragraph"]}),OI,SL.configure({markedOptions:{breaks:!0,gfm:!0}})],[]),E=I.useMemo(()=>yF(m),[]),A=I.useCallback(L=>{y(L);const j=Pu(L,b);r&&r(j),s&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{const D=Pu(L,b);s(D)},a))},[b,r,s,a]),M=jC({extensions:[...S,E],content:_.body||"",contentType:"markdown",onUpdate:({editor:L})=>{const j=L.getMarkdown();w(j);const D=Pu(k.current,j);r&&r(D),s&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{const O=L.getMarkdown(),N=Pu(k.current,O);s(N)},a))}});I.useEffect(()=>{const L=m.current.enabled,j=c==="diff"&&h!==null;m.current={enabled:j,originalContent:h,getEditorMarkdown:()=>(M==null?void 0:M.getMarkdown())||""},M&&(L!==j||j)&&M.view.dispatch(M.state.tr)},[c,h,M]),I.useEffect(()=>{if(!M||e===void 0)return;const{body:L}=Ou(t||"");M.commands.setContent(L||"",{contentType:"markdown"})},[e,M]),I.useEffect(()=>()=>{p.current&&clearTimeout(p.current)},[]);const R=I.useCallback(L=>{const j=L.dataTransfer.getData("application/x-kurt-file");if(j&&M){L.preventDefault();try{const D=JSON.parse(j);if(D.path){const O=D.name||D.path.split("/").pop();M.chain().focus().insertContent(`[${O}](${D.path})`).run()}}catch{}}},[M]),P=I.useCallback(L=>{L.dataTransfer.types.includes("application/x-kurt-file")&&(L.preventDefault(),L.stopPropagation())},[]),H=()=>o?C.jsxs("div",{className:"editor-mode-selector",children:[C.jsx("button",{type:"button",className:`mode-btn${c==="rendered"?" active":""}`,onClick:()=>d==null?void 0:d("rendered"),title:"Edit rendered content",children:"Edit"}),C.jsx("button",{type:"button",className:`mode-btn${c==="diff"?" active":""}`,onClick:()=>d==null?void 0:d("diff"),title:"Edit with inline diff highlighting",children:"Diff"}),C.jsx("button",{type:"button",className:`mode-btn${c==="git-diff"?" active":""}`,onClick:()=>d==null?void 0:d("git-diff"),title:"View git diff (read-only)",children:"Raw"})]}):null,B=()=>c==="git-diff"?C.jsxs(C.Fragment,{children:[u&&C.jsx("div",{className:"diff-error",children:u}),C.jsx(fv,{diff:l,showFileHeader:!1})]}):c==="diff"&&u?C.jsx("div",{className:"diff-error",children:u}):c==="diff"&&h===null?C.jsx("div",{className:"diff-loading",children:"Loading original content..."}):C.jsx(zC,{editor:M});return C.jsxs("div",{className:"editor-wrapper",children:[C.jsxs("div",{className:"editor-toolbar",children:[C.jsx(bF,{editor:M}),C.jsxs("div",{className:"editor-toolbar-right",children:[c!=="git-diff"&&C.jsx(wF,{isDirty:n,isSaving:i}),H()]})]}),c!=="git-diff"&&C.jsx(vF,{frontmatter:g,onChange:A,isCollapsed:f,onToggleCollapse:()=>v(!f),isDiffMode:c==="diff",originalFrontmatter:h?Ou(h).frontmatter:null}),C.jsx("div",{className:"editor-content",onDrop:R,onDragOver:P,children:B()})]})}const xF=t=>{var i;if(!t)return"text";const e=(i=t.split(".").pop())==null?void 0:i.toLowerCase();return{js:"javascript",jsx:"jsx",ts:"typescript",tsx:"tsx",py:"python",rb:"ruby",rs:"rust",go:"go",java:"java",c:"c",cpp:"cpp",h:"c",hpp:"cpp",cs:"csharp",php:"php",swift:"swift",kt:"kotlin",scala:"scala",sh:"bash",bash:"bash",zsh:"bash",fish:"bash",ps1:"powershell",sql:"sql",graphql:"graphql",gql:"graphql",json:"json",yaml:"yaml",yml:"yaml",toml:"toml",xml:"markup",html:"markup",htm:"markup",svg:"markup",css:"css",scss:"scss",sass:"sass",less:"less",dockerfile:"docker",makefile:"makefile",cmake:"cmake",diff:"diff",patch:"diff",gitignore:"git",env:"bash",ini:"ini",conf:"ini",cfg:"ini"}[e]||"text"};function kF({content:t,contentVersion:e,filename:n,isDirty:i,isSaving:r,onChange:s,onAutoSave:a,className:o=""}){const l=I.useMemo(()=>xF(n),[n]),[u,c]=I.useState(t||""),h=I.useRef(null);I.useEffect(()=>{c(t||"")},[t,e]);const d=I.useCallback(m=>{c(m),s==null||s(m),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{a==null||a(m)},1e3)},[s,a]);I.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]);const p=I.useCallback(m=>C.jsx(Km,{theme:Rh.vsDark,code:m,language:l,children:({tokens:_,getLineProps:f,getTokenProps:v})=>C.jsx(C.Fragment,{children:_.map((g,y)=>C.jsxs("div",{...f({line:g}),style:{display:"table-row"},children:[C.jsx("span",{className:"code-editor-line-number",children:y+1}),C.jsx("span",{style:{display:"table-cell"},children:g.map((b,w)=>C.jsx("span",{...v({token:b})},w))})]},y))})}),[l]);return C.jsxs("div",{className:`code-editor ${o}`,children:[C.jsxs("div",{className:"code-editor-toolbar",children:[C.jsx("span",{className:"code-editor-language",children:l}),C.jsx("div",{className:"code-editor-status",children:r?C.jsx("span",{className:"save-status-saving",children:C.jsx("svg",{className:"save-spinner",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:C.jsx("path",{d:"M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"})})}):i?C.jsx("span",{className:"save-status-dirty",title:"Unsaved changes",children:C.jsx("span",{className:"save-dot"})}):C.jsx("span",{className:"save-status-saved",title:"Saved",children:C.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:C.jsx("polyline",{points:"20 6 9 17 4 12"})})})})]}),C.jsx("div",{className:"code-editor-container",children:C.jsx(qm,{value:u,onValueChange:d,highlight:p,padding:16,className:"code-editor-input",textareaClassName:"code-editor-textarea",preClassName:"code-editor-pre",style:{fontFamily:"'IBM Plex Mono', Monaco, 'Courier New', monospace",fontSize:13,lineHeight:1.5,backgroundColor:"#1e1e1e",color:"#d4d4d4",minHeight:"100%"}})})]})}const CF="",la=t=>`${CF}${t}`,EF=t=>{var n;if(!t)return!1;const e=(n=t.split(".").pop())==null?void 0:n.toLowerCase();return["md","markdown","mdx"].includes(e)};function DF({params:t,api:e}){const[n,i]=I.useState(t||{});I.useEffect(()=>{if(!e)return;const K=e.onDidParametersChange(ce=>{ce.params&&i(T=>({...T,...ce.params}))});return()=>K.dispose()},[e]);const{path:r,initialContent:s,contentVersion:a,onContentChange:o,onDirtyChange:l,initialMode:u}=n||{},[c,h]=I.useState(s||""),[d,p]=I.useState(a||1),[m,_]=I.useState(!1),[f,v]=I.useState(!1),[g,y]=I.useState(!1),[b,w]=I.useState(u||"rendered"),[x,k]=I.useState(""),[S,E]=I.useState(""),[A,M]=I.useState(null),[R,P]=I.useState(!1),H=I.useCallback(async()=>{if(r){E("");try{const K=await fetch(la(`/api/git/diff?path=${encodeURIComponent(r)}`));if(!K.ok){const T=await K.json().catch(()=>({}));throw new Error(T.detail||"Failed to load git diff")}const ce=await K.json();k(ce.diff||"")}catch(K){E((K==null?void 0:K.message)||"Failed to load git diff"),k("")}}},[r]),B=I.useCallback(async()=>{if(r)try{const K=await fetch(la(`/api/git/show?path=${encodeURIComponent(r)}`));if(!K.ok){const T=await K.json().catch(()=>({}));throw new Error(T.detail||"Failed to load original content")}const ce=await K.json();M(ce.is_new?"":ce.content||"")}catch(K){M(null),E((K==null?void 0:K.message)||"Failed to load original content")}},[r]);I.useEffect(()=>{u&&!R&&(w(u),P(!0),u==="git-diff"?H():u==="diff"&&B())},[u,R,H,B]),I.useEffect(()=>{s!==void 0&&s!==c&&!m&&(h(s),p(K=>K+1))},[s]),I.useEffect(()=>{if(!r)return;let K=!0;const ce=setInterval(()=>{!K||f||m||fetch(la(`/api/file?path=${encodeURIComponent(r)}`)).then(T=>T.json()).then(T=>{if(!K||f||m)return;const $=T.content||"";$!==c&&(h($),p(Z=>Z+1),y(!1))}).catch(()=>{})},2e3);return()=>{K=!1,clearInterval(ce)}},[r,c,m,f]);const L=async K=>{if(r){h(K),v(!0);try{await fetch(la(`/api/file?path=${encodeURIComponent(r)}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:K})}),_(!1),o==null||o(r,K),l==null||l(r,!1),b==="git-diff"?H():b==="diff"&&B()}finally{v(!1)}}},j=K=>{const ce=K!==c;_(ce),l==null||l(r,ce)},D=K=>{K!==c&&L(K)},O=K=>{w(K),E(""),K==="git-diff"?H():K==="diff"&&B()},N=()=>{r&&fetch(la(`/api/file?path=${encodeURIComponent(r)}`)).then(K=>K.json()).then(K=>{h(K.content||""),_(!1),y(!1),p(ce=>ce+1)}).catch(()=>{})},z=r?r.split("/").filter(Boolean):[],q=z.slice(0,-1),te=z[z.length-1]||"",ee=I.useMemo(()=>EF(r),[r]);return C.jsxs("div",{className:"panel-content editor-panel-content",children:[g&&C.jsxs("div",{className:"notice",children:["File changed on disk.",C.jsx("button",{type:"button",onClick:N,children:"Reload"})]}),q.length>0&&C.jsx("div",{className:"editor-breadcrumbs",children:q.map((K,ce)=>{const T=ce===q.length-1;return C.jsxs("span",{className:`crumb${T?" crumb-current":""}`,children:[K,!T&&C.jsx("span",{className:"crumb-sep",children:""})]},`${K}-${ce}`)})}),ee?C.jsx(SF,{content:c,contentVersion:d,isDirty:m,isSaving:f,onChange:j,onAutoSave:D,showDiffToggle:!!r,editorMode:b,diffText:x,diffError:S,originalContent:A,onModeChange:O}):C.jsxs("div",{className:"code-viewer-container",children:[C.jsx("div",{className:"code-viewer-toolbar",children:C.jsxs("div",{className:"editor-mode-selector",children:[C.jsx("button",{type:"button",className:`mode-btn ${b==="rendered"?"active":""}`,onClick:()=>O("rendered"),children:"Code"}),C.jsx("button",{type:"button",className:`mode-btn ${b==="git-diff"?"active":""}`,onClick:()=>O("git-diff"),children:"Diff"})]})}),b==="git-diff"?C.jsxs("div",{className:"code-diff-view",children:[S&&C.jsx("div",{className:"diff-error",children:S}),C.jsx(fv,{diff:x,showFileHeader:!1})]}):C.jsx(kF,{content:c,contentVersion:d,filename:te,isDirty:m,isSaving:f,onChange:j,onAutoSave:D,className:"editor-code-editor"})]})]})}var rE={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(self,()=>(()=>{var n={4567:function(a,o,l){var u=this&&this.__decorate||function(y,b,w,x){var k,S=arguments.length,E=S<3?b:x===null?x=Object.getOwnPropertyDescriptor(b,w):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(y,b,w,x);else for(var A=y.length-1;A>=0;A--)(k=y[A])&&(E=(S<3?k(E):S>3?k(b,w,E):k(b,w))||E);return S>3&&E&&Object.defineProperty(b,w,E),E},c=this&&this.__param||function(y,b){return function(w,x){b(w,x,y)}};Object.defineProperty(o,"__esModule",{value:!0}),o.AccessibilityManager=void 0;const h=l(9042),d=l(6114),p=l(9924),m=l(844),_=l(5596),f=l(4725),v=l(3656);let g=o.AccessibilityManager=class extends m.Disposable{constructor(y,b){super(),this._terminal=y,this._renderService=b,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let w=0;w<this._terminal.rows;w++)this._rowElements[w]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[w]);if(this._topBoundaryFocusListener=w=>this._handleBoundaryFocus(w,0),this._bottomBoundaryFocusListener=w=>this._handleBoundaryFocus(w,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new p.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(w=>this._handleResize(w.rows))),this.register(this._terminal.onRender(w=>this._refreshRows(w.start,w.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(w=>this._handleChar(w))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(w=>this._handleTab(w))),this.register(this._terminal.onKey(w=>this._handleKey(w.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new _.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,v.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,m.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(y){for(let b=0;b<y;b++)this._handleChar(" ")}_handleChar(y){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==y&&(this._charsToAnnounce+=y):this._charsToAnnounce+=y,y===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=h.tooMuchOutput)),d.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,d.isMac&&this._liveRegion.remove()}_handleKey(y){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(y)||this._charsToConsume.push(y)}_refreshRows(y,b){this._liveRegionDebouncer.refresh(y,b,this._terminal.rows)}_renderRows(y,b){const w=this._terminal.buffer,x=w.lines.length.toString();for(let k=y;k<=b;k++){const S=w.translateBufferLineToString(w.ydisp+k,!0),E=(w.ydisp+k+1).toString(),A=this._rowElements[k];A&&(S.length===0?A.innerText="":A.textContent=S,A.setAttribute("aria-posinset",E),A.setAttribute("aria-setsize",x))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(y,b){const w=y.target,x=this._rowElements[b===0?1:this._rowElements.length-2];if(w.getAttribute("aria-posinset")===(b===0?"1":`${this._terminal.buffer.lines.length}`)||y.relatedTarget!==x)return;let k,S;if(b===0?(k=w,S=this._rowElements.pop(),this._rowContainer.removeChild(S)):(k=this._rowElements.shift(),S=w,this._rowContainer.removeChild(k)),k.removeEventListener("focus",this._topBoundaryFocusListener),S.removeEventListener("focus",this._bottomBoundaryFocusListener),b===0){const E=this._createAccessibilityTreeNode();this._rowElements.unshift(E),this._rowContainer.insertAdjacentElement("afterbegin",E)}else{const E=this._createAccessibilityTreeNode();this._rowElements.push(E),this._rowContainer.appendChild(E)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(b===0?-1:1),this._rowElements[b===0?1:this._rowElements.length-2].focus(),y.preventDefault(),y.stopImmediatePropagation()}_handleResize(y){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let b=this._rowContainer.children.length;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);for(;this._rowElements.length>y;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const y=document.createElement("div");return y.setAttribute("role","listitem"),y.tabIndex=-1,this._refreshRowDimensions(y),y}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let y=0;y<this._terminal.rows;y++)this._refreshRowDimensions(this._rowElements[y])}}_refreshRowDimensions(y){y.style.height=`${this._renderService.dimensions.css.cell.height}px`}};o.AccessibilityManager=g=u([c(1,f.IRenderService)],g)},3614:(a,o)=>{function l(d){return d.replace(/\r?\n/g,"\r")}function u(d,p){return p?"\x1B[200~"+d+"\x1B[201~":d}function c(d,p,m,_){d=u(d=l(d),m.decPrivateModes.bracketedPasteMode&&_.rawOptions.ignoreBracketedPasteMode!==!0),m.triggerDataEvent(d,!0),p.value=""}function h(d,p,m){const _=m.getBoundingClientRect(),f=d.clientX-_.left-10,v=d.clientY-_.top-10;p.style.width="20px",p.style.height="20px",p.style.left=`${f}px`,p.style.top=`${v}px`,p.style.zIndex="1000",p.focus()}Object.defineProperty(o,"__esModule",{value:!0}),o.rightClickHandler=o.moveTextAreaUnderMouseCursor=o.paste=o.handlePasteEvent=o.copyHandler=o.bracketTextForPaste=o.prepareTextForTerminal=void 0,o.prepareTextForTerminal=l,o.bracketTextForPaste=u,o.copyHandler=function(d,p){d.clipboardData&&d.clipboardData.setData("text/plain",p.selectionText),d.preventDefault()},o.handlePasteEvent=function(d,p,m,_){d.stopPropagation(),d.clipboardData&&c(d.clipboardData.getData("text/plain"),p,m,_)},o.paste=c,o.moveTextAreaUnderMouseCursor=h,o.rightClickHandler=function(d,p,m,_,f){h(d,p,m),f&&_.rightClickSelect(d),p.value=_.selectionText,p.select()}},7239:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorContrastCache=void 0;const u=l(1505);o.ColorContrastCache=class{constructor(){this._color=new u.TwoKeyMap,this._css=new u.TwoKeyMap}setCss(c,h,d){this._css.set(c,h,d)}getCss(c,h){return this._css.get(c,h)}setColor(c,h,d){this._color.set(c,h,d)}getColor(c,h){return this._color.get(c,h)}clear(){this._color.clear(),this._css.clear()}}},3656:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.addDisposableDomListener=void 0,o.addDisposableDomListener=function(l,u,c,h){l.addEventListener(u,c,h);let d=!1;return{dispose:()=>{d||(d=!0,l.removeEventListener(u,c,h))}}}},6465:function(a,o,l){var u=this&&this.__decorate||function(f,v,g,y){var b,w=arguments.length,x=w<3?v:y===null?y=Object.getOwnPropertyDescriptor(v,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(f,v,g,y);else for(var k=f.length-1;k>=0;k--)(b=f[k])&&(x=(w<3?b(x):w>3?b(v,g,x):b(v,g))||x);return w>3&&x&&Object.defineProperty(v,g,x),x},c=this&&this.__param||function(f,v){return function(g,y){v(g,y,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Linkifier2=void 0;const h=l(3656),d=l(8460),p=l(844),m=l(2585);let _=o.Linkifier2=class extends p.Disposable{get currentLink(){return this._currentLink}constructor(f){super(),this._bufferService=f,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new d.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new d.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,p.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,p.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(f){return this._linkProviders.push(f),{dispose:()=>{const v=this._linkProviders.indexOf(f);v!==-1&&this._linkProviders.splice(v,1)}}}attachToDom(f,v,g){this._element=f,this._mouseService=v,this._renderService=g,this.register((0,h.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,h.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(f){if(this._lastMouseEvent=f,!this._element||!this._mouseService)return;const v=this._positionFromMouseEvent(f,this._element,this._mouseService);if(!v)return;this._isMouseOut=!1;const g=f.composedPath();for(let y=0;y<g.length;y++){const b=g[y];if(b.classList.contains("xterm"))break;if(b.classList.contains("xterm-hover"))return}this._lastBufferCell&&v.x===this._lastBufferCell.x&&v.y===this._lastBufferCell.y||(this._handleHover(v),this._lastBufferCell=v)}_handleHover(f){if(this._activeLine!==f.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(f,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,f)||(this._clearCurrentLink(),this._askForLink(f,!0))}_askForLink(f,v){var g,y;this._activeProviderReplies&&v||((g=this._activeProviderReplies)===null||g===void 0||g.forEach(w=>{w==null||w.forEach(x=>{x.link.dispose&&x.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=f.y);let b=!1;for(const[w,x]of this._linkProviders.entries())v?!((y=this._activeProviderReplies)===null||y===void 0)&&y.get(w)&&(b=this._checkLinkProviderResult(w,f,b)):x.provideLinks(f.y,k=>{var S,E;if(this._isMouseOut)return;const A=k==null?void 0:k.map(M=>({link:M}));(S=this._activeProviderReplies)===null||S===void 0||S.set(w,A),b=this._checkLinkProviderResult(w,f,b),((E=this._activeProviderReplies)===null||E===void 0?void 0:E.size)===this._linkProviders.length&&this._removeIntersectingLinks(f.y,this._activeProviderReplies)})}_removeIntersectingLinks(f,v){const g=new Set;for(let y=0;y<v.size;y++){const b=v.get(y);if(b)for(let w=0;w<b.length;w++){const x=b[w],k=x.link.range.start.y<f?0:x.link.range.start.x,S=x.link.range.end.y>f?this._bufferService.cols:x.link.range.end.x;for(let E=k;E<=S;E++){if(g.has(E)){b.splice(w--,1);break}g.add(E)}}}}_checkLinkProviderResult(f,v,g){var y;if(!this._activeProviderReplies)return g;const b=this._activeProviderReplies.get(f);let w=!1;for(let x=0;x<f;x++)this._activeProviderReplies.has(x)&&!this._activeProviderReplies.get(x)||(w=!0);if(!w&&b){const x=b.find(k=>this._linkAtPosition(k.link,v));x&&(g=!0,this._handleNewLink(x))}if(this._activeProviderReplies.size===this._linkProviders.length&&!g)for(let x=0;x<this._activeProviderReplies.size;x++){const k=(y=this._activeProviderReplies.get(x))===null||y===void 0?void 0:y.find(S=>this._linkAtPosition(S.link,v));if(k){g=!0,this._handleNewLink(k);break}}return g}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(f){if(!this._element||!this._mouseService||!this._currentLink)return;const v=this._positionFromMouseEvent(f,this._element,this._mouseService);v&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,v)&&this._currentLink.link.activate(f,this._currentLink.link.text)}_clearCurrentLink(f,v){this._element&&this._currentLink&&this._lastMouseEvent&&(!f||!v||this._currentLink.link.range.start.y>=f&&this._currentLink.link.range.end.y<=v)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,p.disposeArray)(this._linkCacheDisposables))}_handleNewLink(f){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const v=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);v&&this._linkAtPosition(f.link,v)&&(this._currentLink=f,this._currentLink.state={decorations:{underline:f.link.decorations===void 0||f.link.decorations.underline,pointerCursor:f.link.decorations===void 0||f.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,f.link,this._lastMouseEvent),f.link.decorations={},Object.defineProperties(f.link.decorations,{pointerCursor:{get:()=>{var g,y;return(y=(g=this._currentLink)===null||g===void 0?void 0:g.state)===null||y===void 0?void 0:y.decorations.pointerCursor},set:g=>{var y,b;!((y=this._currentLink)===null||y===void 0)&&y.state&&this._currentLink.state.decorations.pointerCursor!==g&&(this._currentLink.state.decorations.pointerCursor=g,this._currentLink.state.isHovered&&((b=this._element)===null||b===void 0||b.classList.toggle("xterm-cursor-pointer",g)))}},underline:{get:()=>{var g,y;return(y=(g=this._currentLink)===null||g===void 0?void 0:g.state)===null||y===void 0?void 0:y.decorations.underline},set:g=>{var y,b,w;!((y=this._currentLink)===null||y===void 0)&&y.state&&((w=(b=this._currentLink)===null||b===void 0?void 0:b.state)===null||w===void 0?void 0:w.decorations.underline)!==g&&(this._currentLink.state.decorations.underline=g,this._currentLink.state.isHovered&&this._fireUnderlineEvent(f.link,g))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(g=>{if(!this._currentLink)return;const y=g.start===0?0:g.start+1+this._bufferService.buffer.ydisp,b=this._bufferService.buffer.ydisp+1+g.end;if(this._currentLink.link.range.start.y>=y&&this._currentLink.link.range.end.y<=b&&(this._clearCurrentLink(y,b),this._lastMouseEvent&&this._element)){const w=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);w&&this._askForLink(w,!1)}})))}_linkHover(f,v,g){var y;!((y=this._currentLink)===null||y===void 0)&&y.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(v,!0),this._currentLink.state.decorations.pointerCursor&&f.classList.add("xterm-cursor-pointer")),v.hover&&v.hover(g,v.text)}_fireUnderlineEvent(f,v){const g=f.range,y=this._bufferService.buffer.ydisp,b=this._createLinkUnderlineEvent(g.start.x-1,g.start.y-y-1,g.end.x,g.end.y-y-1,void 0);(v?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(b)}_linkLeave(f,v,g){var y;!((y=this._currentLink)===null||y===void 0)&&y.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(v,!1),this._currentLink.state.decorations.pointerCursor&&f.classList.remove("xterm-cursor-pointer")),v.leave&&v.leave(g,v.text)}_linkAtPosition(f,v){const g=f.range.start.y*this._bufferService.cols+f.range.start.x,y=f.range.end.y*this._bufferService.cols+f.range.end.x,b=v.y*this._bufferService.cols+v.x;return g<=b&&b<=y}_positionFromMouseEvent(f,v,g){const y=g.getCoords(f,v,this._bufferService.cols,this._bufferService.rows);if(y)return{x:y[0],y:y[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(f,v,g,y,b){return{x1:f,y1:v,x2:g,y2:y,cols:this._bufferService.cols,fg:b}}};o.Linkifier2=_=u([c(0,m.IBufferService)],_)},9042:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.tooMuchOutput=o.promptLabel=void 0,o.promptLabel="Terminal input",o.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(a,o,l){var u=this&&this.__decorate||function(_,f,v,g){var y,b=arguments.length,w=b<3?f:g===null?g=Object.getOwnPropertyDescriptor(f,v):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(_,f,v,g);else for(var x=_.length-1;x>=0;x--)(y=_[x])&&(w=(b<3?y(w):b>3?y(f,v,w):y(f,v))||w);return b>3&&w&&Object.defineProperty(f,v,w),w},c=this&&this.__param||function(_,f){return function(v,g){f(v,g,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkProvider=void 0;const h=l(511),d=l(2585);let p=o.OscLinkProvider=class{constructor(_,f,v){this._bufferService=_,this._optionsService=f,this._oscLinkService=v}provideLinks(_,f){var v;const g=this._bufferService.buffer.lines.get(_-1);if(!g)return void f(void 0);const y=[],b=this._optionsService.rawOptions.linkHandler,w=new h.CellData,x=g.getTrimmedLength();let k=-1,S=-1,E=!1;for(let A=0;A<x;A++)if(S!==-1||g.hasContent(A)){if(g.loadCell(A,w),w.hasExtendedAttrs()&&w.extended.urlId){if(S===-1){S=A,k=w.extended.urlId;continue}E=w.extended.urlId!==k}else S!==-1&&(E=!0);if(E||S!==-1&&A===x-1){const M=(v=this._oscLinkService.getLinkData(k))===null||v===void 0?void 0:v.uri;if(M){const R={start:{x:S+1,y:_},end:{x:A+(E||A!==x-1?0:1),y:_}};let P=!1;if(!(b!=null&&b.allowNonHttpProtocols))try{const H=new URL(M);["http:","https:"].includes(H.protocol)||(P=!0)}catch{P=!0}P||y.push({text:M,range:R,activate:(H,B)=>b?b.activate(H,B,R):m(0,B),hover:(H,B)=>{var L;return(L=b==null?void 0:b.hover)===null||L===void 0?void 0:L.call(b,H,B,R)},leave:(H,B)=>{var L;return(L=b==null?void 0:b.leave)===null||L===void 0?void 0:L.call(b,H,B,R)}})}E=!1,w.hasExtendedAttrs()&&w.extended.urlId?(S=A,k=w.extended.urlId):(S=-1,k=-1)}}f(y)}};function m(_,f){if(confirm(`Do you want to navigate to ${f}?

WARNING: This link could potentially be dangerous`)){const v=window.open();if(v){try{v.opener=null}catch{}v.location.href=f}else console.warn("Opening link blocked as opener could not be cleared")}}o.OscLinkProvider=p=u([c(0,d.IBufferService),c(1,d.IOptionsService),c(2,d.IOscLinkService)],p)},6193:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.RenderDebouncer=void 0,o.RenderDebouncer=class{constructor(l,u){this._parentWindow=l,this._renderCallback=u,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,u,c){this._rowCount=c,l=l!==void 0?l:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,u),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},5596:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ScreenDprMonitor=void 0;const u=l(844);class c extends u.Disposable{constructor(d){super(),this._parentWindow=d,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,u.toDisposable)(()=>{this.clearListener()}))}setListener(d){this._listener&&this.clearListener(),this._listener=d,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var d;this._outerListener&&((d=this._resolutionMediaMatchList)===null||d===void 0||d.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}o.ScreenDprMonitor=c},3236:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;const u=l(3614),c=l(3656),h=l(6465),d=l(9042),p=l(3730),m=l(1680),_=l(3107),f=l(5744),v=l(2950),g=l(1296),y=l(428),b=l(4269),w=l(5114),x=l(8934),k=l(3230),S=l(9312),E=l(4725),A=l(6731),M=l(8055),R=l(8969),P=l(8460),H=l(844),B=l(6114),L=l(8437),j=l(2584),D=l(7399),O=l(5941),N=l(9074),z=l(2585),q=l(5435),te=l(4567),ee=typeof window<"u"?window.document:null;class K extends R.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(T={}){super(T),this.browser=B,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new H.MutableDisposable),this._onCursorMove=this.register(new P.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new P.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new P.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new P.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new P.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new P.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new P.EventEmitter),this._onBlur=this.register(new P.EventEmitter),this._onA11yCharEmitter=this.register(new P.EventEmitter),this._onA11yTabEmitter=this.register(new P.EventEmitter),this._onWillOpen=this.register(new P.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(h.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(p.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(N.DecorationService),this._instantiationService.setService(z.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows(($,Z)=>this.refresh($,Z))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport($=>this._reportWindowsOptions($))),this.register(this._inputHandler.onColor($=>this._handleColorEvent($))),this.register((0,P.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,P.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize($=>this._afterResize($.cols,$.rows))),this.register((0,H.toDisposable)(()=>{var $,Z;this._customKeyEventHandler=void 0,(Z=($=this.element)===null||$===void 0?void 0:$.parentNode)===null||Z===void 0||Z.removeChild(this.element)}))}_handleColorEvent(T){if(this._themeService)for(const $ of T){let Z,F="";switch($.index){case 256:Z="foreground",F="10";break;case 257:Z="background",F="11";break;case 258:Z="cursor",F="12";break;default:Z="ansi",F="4;"+$.index}switch($.type){case 0:const V=M.color.toColorRGB(Z==="ansi"?this._themeService.colors.ansi[$.index]:this._themeService.colors[Z]);this.coreService.triggerDataEvent(`${j.C0.ESC}]${F};${(0,O.toRgbString)(V)}${j.C1_ESCAPED.ST}`);break;case 1:if(Z==="ansi")this._themeService.modifyColors(G=>G.ansi[$.index]=M.rgba.toColor(...$.color));else{const G=Z;this._themeService.modifyColors(W=>W[G]=M.rgba.toColor(...$.color))}break;case 2:this._themeService.restoreColor($.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(T){T?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(te.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(T){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(j.C0.ESC+"[I"),this.updateCursorStyle(T),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var T;return(T=this.textarea)===null||T===void 0?void 0:T.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(j.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const T=this.buffer.ybase+this.buffer.y,$=this.buffer.lines.get(T);if(!$)return;const Z=Math.min(this.buffer.x,this.cols-1),F=this._renderService.dimensions.css.cell.height,V=$.getWidth(Z),G=this._renderService.dimensions.css.cell.width*V,W=this.buffer.y*this._renderService.dimensions.css.cell.height,ne=Z*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ne+"px",this.textarea.style.top=W+"px",this.textarea.style.width=G+"px",this.textarea.style.height=F+"px",this.textarea.style.lineHeight=F+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,c.addDisposableDomListener)(this.element,"copy",$=>{this.hasSelection()&&(0,u.copyHandler)($,this._selectionService)}));const T=$=>(0,u.handlePasteEvent)($,this.textarea,this.coreService,this.optionsService);this.register((0,c.addDisposableDomListener)(this.textarea,"paste",T)),this.register((0,c.addDisposableDomListener)(this.element,"paste",T)),B.isFirefox?this.register((0,c.addDisposableDomListener)(this.element,"mousedown",$=>{$.button===2&&(0,u.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,c.addDisposableDomListener)(this.element,"contextmenu",$=>{(0,u.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),B.isLinux&&this.register((0,c.addDisposableDomListener)(this.element,"auxclick",$=>{$.button===1&&(0,u.moveTextAreaUnderMouseCursor)($,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,c.addDisposableDomListener)(this.textarea,"keyup",T=>this._keyUp(T),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"keydown",T=>this._keyDown(T),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"keypress",T=>this._keyPress(T),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionupdate",T=>this._compositionHelper.compositionupdate(T))),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,c.addDisposableDomListener)(this.textarea,"input",T=>this._inputEvent(T),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(T){var $;if(!T)throw new Error("Terminal requires a parent element.");T.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=T.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),T.appendChild(this.element);const Z=ee.createDocumentFragment();this._viewportElement=ee.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),Z.appendChild(this._viewportElement),this._viewportScrollArea=ee.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=ee.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=ee.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),Z.appendChild(this.screenElement),this.textarea=ee.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",d.promptLabel),B.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(w.CoreBrowserService,this.textarea,($=this._document.defaultView)!==null&&$!==void 0?$:window),this._instantiationService.setService(E.ICoreBrowserService,this._coreBrowserService),this.register((0,c.addDisposableDomListener)(this.textarea,"focus",F=>this._handleTextAreaFocus(F))),this.register((0,c.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(y.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(E.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(A.ThemeService),this._instantiationService.setService(E.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(b.CharacterJoinerService),this._instantiationService.setService(E.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(k.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(E.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(F=>this._onRender.fire(F))),this.onResize(F=>this._renderService.resize(F.cols,F.rows)),this._compositionView=ee.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(v.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(Z);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(x.MouseService),this._instantiationService.setService(E.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(m.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(F=>this.scrollLines(F.amount,F.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(S.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(E.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(F=>this.scrollLines(F.amount,F.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(F=>this._renderService.handleSelectionChanged(F.start,F.end,F.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(F=>{this.textarea.value=F,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(F=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(_.BufferDecorationRenderer,this.screenElement)),this.register((0,c.addDisposableDomListener)(this.element,"mousedown",F=>this._selectionService.handleMouseDown(F))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(te.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",F=>this._handleScreenReaderModeOptionChange(F))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(f.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",F=>{!this._overviewRulerRenderer&&F&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(f.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(g.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const T=this,$=this.element;function Z(G){const W=T._mouseService.getMouseReportCoords(G,T.screenElement);if(!W)return!1;let ne,oe;switch(G.overrideType||G.type){case"mousemove":oe=32,G.buttons===void 0?(ne=3,G.button!==void 0&&(ne=G.button<3?G.button:3)):ne=1&G.buttons?0:4&G.buttons?1:2&G.buttons?2:3;break;case"mouseup":oe=0,ne=G.button<3?G.button:3;break;case"mousedown":oe=1,ne=G.button<3?G.button:3;break;case"wheel":if(T.viewport.getLinesScrolled(G)===0)return!1;oe=G.deltaY<0?0:1,ne=4;break;default:return!1}return!(oe===void 0||ne===void 0||ne>4)&&T.coreMouseService.triggerMouseEvent({col:W.col,row:W.row,x:W.x,y:W.y,button:ne,action:oe,ctrl:G.ctrlKey,alt:G.altKey,shift:G.shiftKey})}const F={mouseup:null,wheel:null,mousedrag:null,mousemove:null},V={mouseup:G=>(Z(G),G.buttons||(this._document.removeEventListener("mouseup",F.mouseup),F.mousedrag&&this._document.removeEventListener("mousemove",F.mousedrag)),this.cancel(G)),wheel:G=>(Z(G),this.cancel(G,!0)),mousedrag:G=>{G.buttons&&Z(G)},mousemove:G=>{G.buttons||Z(G)}};this.register(this.coreMouseService.onProtocolChange(G=>{G?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(G)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&G?F.mousemove||($.addEventListener("mousemove",V.mousemove),F.mousemove=V.mousemove):($.removeEventListener("mousemove",F.mousemove),F.mousemove=null),16&G?F.wheel||($.addEventListener("wheel",V.wheel,{passive:!1}),F.wheel=V.wheel):($.removeEventListener("wheel",F.wheel),F.wheel=null),2&G?F.mouseup||($.addEventListener("mouseup",V.mouseup),F.mouseup=V.mouseup):(this._document.removeEventListener("mouseup",F.mouseup),$.removeEventListener("mouseup",F.mouseup),F.mouseup=null),4&G?F.mousedrag||(F.mousedrag=V.mousedrag):(this._document.removeEventListener("mousemove",F.mousedrag),F.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,c.addDisposableDomListener)($,"mousedown",G=>{if(G.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(G))return Z(G),F.mouseup&&this._document.addEventListener("mouseup",F.mouseup),F.mousedrag&&this._document.addEventListener("mousemove",F.mousedrag),this.cancel(G)})),this.register((0,c.addDisposableDomListener)($,"wheel",G=>{if(!F.wheel){if(!this.buffer.hasScrollback){const W=this.viewport.getLinesScrolled(G);if(W===0)return;const ne=j.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(G.deltaY<0?"A":"B");let oe="";for(let ae=0;ae<Math.abs(W);ae++)oe+=ne;return this.coreService.triggerDataEvent(oe,!0),this.cancel(G,!0)}return this.viewport.handleWheel(G)?this.cancel(G):void 0}},{passive:!1})),this.register((0,c.addDisposableDomListener)($,"touchstart",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(G),this.cancel(G)},{passive:!0})),this.register((0,c.addDisposableDomListener)($,"touchmove",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(G)?void 0:this.cancel(G)},{passive:!1}))}refresh(T,$){var Z;(Z=this._renderService)===null||Z===void 0||Z.refreshRows(T,$)}updateCursorStyle(T){var $;!(($=this._selectionService)===null||$===void 0)&&$.shouldColumnSelect(T)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(T,$,Z=0){var F;Z===1?(super.scrollLines(T,$,Z),this.refresh(0,this.rows-1)):(F=this.viewport)===null||F===void 0||F.scrollLines(T)}paste(T){(0,u.paste)(T,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(T){this._customKeyEventHandler=T}registerLinkProvider(T){return this.linkifier2.registerLinkProvider(T)}registerCharacterJoiner(T){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const $=this._characterJoinerService.register(T);return this.refresh(0,this.rows-1),$}deregisterCharacterJoiner(T){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(T)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(T){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+T)}registerDecoration(T){return this._decorationService.registerDecoration(T)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(T,$,Z){this._selectionService.setSelection(T,$,Z)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var T;(T=this._selectionService)===null||T===void 0||T.clearSelection()}selectAll(){var T;(T=this._selectionService)===null||T===void 0||T.selectAll()}selectLines(T,$){var Z;(Z=this._selectionService)===null||Z===void 0||Z.selectLines(T,$)}_keyDown(T){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(T)===!1)return!1;const $=this.browser.isMac&&this.options.macOptionIsMeta&&T.altKey;if(!$&&!this._compositionHelper.keydown(T))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;$||T.key!=="Dead"&&T.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const Z=(0,D.evaluateKeyboardEvent)(T,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(T),Z.type===3||Z.type===2){const F=this.rows-1;return this.scrollLines(Z.type===2?-F:F),this.cancel(T,!0)}return Z.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,T)||(Z.cancel&&this.cancel(T,!0),!Z.key||!!(T.key&&!T.ctrlKey&&!T.altKey&&!T.metaKey&&T.key.length===1&&T.key.charCodeAt(0)>=65&&T.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(Z.key!==j.C0.ETX&&Z.key!==j.C0.CR||(this.textarea.value=""),this._onKey.fire({key:Z.key,domEvent:T}),this._showCursor(),this.coreService.triggerDataEvent(Z.key,!0),!this.optionsService.rawOptions.screenReaderMode||T.altKey||T.ctrlKey?this.cancel(T,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(T,$){const Z=T.isMac&&!this.options.macOptionIsMeta&&$.altKey&&!$.ctrlKey&&!$.metaKey||T.isWindows&&$.altKey&&$.ctrlKey&&!$.metaKey||T.isWindows&&$.getModifierState("AltGraph");return $.type==="keypress"?Z:Z&&(!$.keyCode||$.keyCode>47)}_keyUp(T){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(T)===!1||(function($){return $.keyCode===16||$.keyCode===17||$.keyCode===18}(T)||this.focus(),this.updateCursorStyle(T),this._keyPressHandled=!1)}_keyPress(T){let $;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(T)===!1)return!1;if(this.cancel(T),T.charCode)$=T.charCode;else if(T.which===null||T.which===void 0)$=T.keyCode;else{if(T.which===0||T.charCode===0)return!1;$=T.which}return!(!$||(T.altKey||T.ctrlKey||T.metaKey)&&!this._isThirdLevelShift(this.browser,T)||($=String.fromCharCode($),this._onKey.fire({key:$,domEvent:T}),this._showCursor(),this.coreService.triggerDataEvent($,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(T){if(T.data&&T.inputType==="insertText"&&(!T.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const $=T.data;return this.coreService.triggerDataEvent($,!0),this.cancel(T),!0}return!1}resize(T,$){T!==this.cols||$!==this.rows?super.resize(T,$):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(T,$){var Z,F;(Z=this._charSizeService)===null||Z===void 0||Z.measure(),(F=this.viewport)===null||F===void 0||F.syncScrollArea(!0)}clear(){var T;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let $=1;$<this.rows;$++)this.buffer.lines.push(this.buffer.getBlankLine(L.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(T=this.viewport)===null||T===void 0||T.reset(),this.refresh(0,this.rows-1)}}reset(){var T,$;this.options.rows=this.rows,this.options.cols=this.cols;const Z=this._customKeyEventHandler;this._setup(),super.reset(),(T=this._selectionService)===null||T===void 0||T.reset(),this._decorationService.reset(),($=this.viewport)===null||$===void 0||$.reset(),this._customKeyEventHandler=Z,this.refresh(0,this.rows-1)}clearTextureAtlas(){var T;(T=this._renderService)===null||T===void 0||T.clearTextureAtlas()}_reportFocus(){var T;!((T=this.element)===null||T===void 0)&&T.classList.contains("focus")?this.coreService.triggerDataEvent(j.C0.ESC+"[I"):this.coreService.triggerDataEvent(j.C0.ESC+"[O")}_reportWindowsOptions(T){if(this._renderService)switch(T){case q.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const $=this._renderService.dimensions.css.canvas.width.toFixed(0),Z=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${j.C0.ESC}[4;${Z};${$}t`);break;case q.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const F=this._renderService.dimensions.css.cell.width.toFixed(0),V=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${j.C0.ESC}[6;${V};${F}t`)}}cancel(T,$){if(this.options.cancelEvents||$)return T.preventDefault(),T.stopPropagation(),!1}}o.Terminal=K},9924:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TimeBasedDebouncer=void 0,o.TimeBasedDebouncer=class{constructor(l,u=1e3){this._renderCallback=l,this._debounceThresholdMS=u,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,u,c){this._rowCount=c,l=l!==void 0?l:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u;const h=Date.now();if(h-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=h,this._innerRefresh();else if(!this._additionalRefreshRequested){const d=h-this._lastRefreshMs,p=this._debounceThresholdMS-d;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},p)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,u)}}},1680:function(a,o,l){var u=this&&this.__decorate||function(v,g,y,b){var w,x=arguments.length,k=x<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,y):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(v,g,y,b);else for(var S=v.length-1;S>=0;S--)(w=v[S])&&(k=(x<3?w(k):x>3?w(g,y,k):w(g,y))||k);return x>3&&k&&Object.defineProperty(g,y,k),k},c=this&&this.__param||function(v,g){return function(y,b){g(y,b,v)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Viewport=void 0;const h=l(3656),d=l(4725),p=l(8460),m=l(844),_=l(2585);let f=o.Viewport=class extends m.Disposable{constructor(v,g,y,b,w,x,k,S){super(),this._viewportElement=v,this._scrollArea=g,this._bufferService=y,this._optionsService=b,this._charSizeService=w,this._renderService=x,this._coreBrowserService=k,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new p.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,h.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(E=>this._activeBuffer=E.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(E=>this._renderDimensions=E)),this._handleThemeChange(S.colors),this.register(S.onChangeColors(E=>this._handleThemeChange(E))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(v){this._viewportElement.style.backgroundColor=v.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(v){if(v)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const g=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==g&&(this._lastRecordedBufferHeight=g,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const v=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==v&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=v),this._refreshAnimationFrame=null}syncScrollArea(v=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(v);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(v)}_handleScroll(v){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const g=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:g,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const v=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(v*(this._smoothScrollState.target-this._smoothScrollState.origin)),v<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(v,g){const y=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(g<0&&this._viewportElement.scrollTop!==0||g>0&&y<this._lastRecordedBufferHeight)||(v.cancelable&&v.preventDefault(),!1)}handleWheel(v){const g=this._getPixelsScrolled(v);return g!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+g:this._smoothScrollState.target+=g,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=g,this._bubbleScroll(v,g))}scrollLines(v){if(v!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const g=v*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+g,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:v,suppressScrollEvent:!1})}_getPixelsScrolled(v){if(v.deltaY===0||v.shiftKey)return 0;let g=this._applyScrollModifier(v.deltaY,v);return v.deltaMode===WheelEvent.DOM_DELTA_LINE?g*=this._currentRowHeight:v.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(g*=this._currentRowHeight*this._bufferService.rows),g}getBufferElements(v,g){var y;let b,w="";const x=[],k=g??this._bufferService.buffer.lines.length,S=this._bufferService.buffer.lines;for(let E=v;E<k;E++){const A=S.get(E);if(!A)continue;const M=(y=S.get(E+1))===null||y===void 0?void 0:y.isWrapped;if(w+=A.translateToString(!M),!M||E===S.length-1){const R=document.createElement("div");R.textContent=w,x.push(R),w.length>0&&(b=R),w=""}}return{bufferElements:x,cursorElement:b}}getLinesScrolled(v){if(v.deltaY===0||v.shiftKey)return 0;let g=this._applyScrollModifier(v.deltaY,v);return v.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(g/=this._currentRowHeight+0,this._wheelPartialScroll+=g,g=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):v.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(g*=this._bufferService.rows),g}_applyScrollModifier(v,g){const y=this._optionsService.rawOptions.fastScrollModifier;return y==="alt"&&g.altKey||y==="ctrl"&&g.ctrlKey||y==="shift"&&g.shiftKey?v*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:v*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(v){this._lastTouchY=v.touches[0].pageY}handleTouchMove(v){const g=this._lastTouchY-v.touches[0].pageY;return this._lastTouchY=v.touches[0].pageY,g!==0&&(this._viewportElement.scrollTop+=g,this._bubbleScroll(v,g))}};o.Viewport=f=u([c(2,_.IBufferService),c(3,_.IOptionsService),c(4,d.ICharSizeService),c(5,d.IRenderService),c(6,d.ICoreBrowserService),c(7,d.IThemeService)],f)},3107:function(a,o,l){var u=this&&this.__decorate||function(f,v,g,y){var b,w=arguments.length,x=w<3?v:y===null?y=Object.getOwnPropertyDescriptor(v,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(f,v,g,y);else for(var k=f.length-1;k>=0;k--)(b=f[k])&&(x=(w<3?b(x):w>3?b(v,g,x):b(v,g))||x);return w>3&&x&&Object.defineProperty(v,g,x),x},c=this&&this.__param||function(f,v){return function(g,y){v(g,y,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferDecorationRenderer=void 0;const h=l(3656),d=l(4725),p=l(844),m=l(2585);let _=o.BufferDecorationRenderer=class extends p.Disposable{constructor(f,v,g,y){super(),this._screenElement=f,this._bufferService=v,this._decorationService=g,this._renderService=y,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,h.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(b=>this._removeDecoration(b))),this.register((0,p.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const f of this._decorationService.decorations)this._renderDecoration(f);this._dimensionsChanged=!1}_renderDecoration(f){this._refreshStyle(f),this._dimensionsChanged&&this._refreshXPosition(f)}_createElement(f){var v,g;const y=document.createElement("div");y.classList.add("xterm-decoration"),y.classList.toggle("xterm-decoration-top-layer",((v=f==null?void 0:f.options)===null||v===void 0?void 0:v.layer)==="top"),y.style.width=`${Math.round((f.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,y.style.height=(f.options.height||1)*this._renderService.dimensions.css.cell.height+"px",y.style.top=(f.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",y.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const b=(g=f.options.x)!==null&&g!==void 0?g:0;return b&&b>this._bufferService.cols&&(y.style.display="none"),this._refreshXPosition(f,y),y}_refreshStyle(f){const v=f.marker.line-this._bufferService.buffers.active.ydisp;if(v<0||v>=this._bufferService.rows)f.element&&(f.element.style.display="none",f.onRenderEmitter.fire(f.element));else{let g=this._decorationElements.get(f);g||(g=this._createElement(f),f.element=g,this._decorationElements.set(f,g),this._container.appendChild(g),f.onDispose(()=>{this._decorationElements.delete(f),g.remove()})),g.style.top=v*this._renderService.dimensions.css.cell.height+"px",g.style.display=this._altBufferIsActive?"none":"block",f.onRenderEmitter.fire(g)}}_refreshXPosition(f,v=f.element){var g;if(!v)return;const y=(g=f.options.x)!==null&&g!==void 0?g:0;(f.options.anchor||"left")==="right"?v.style.right=y?y*this._renderService.dimensions.css.cell.width+"px":"":v.style.left=y?y*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(f){var v;(v=this._decorationElements.get(f))===null||v===void 0||v.remove(),this._decorationElements.delete(f),f.dispose()}};o.BufferDecorationRenderer=_=u([c(1,m.IBufferService),c(2,m.IDecorationService),c(3,d.IRenderService)],_)},5871:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorZoneStore=void 0,o.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const u of this._zones)if(u.color===l.options.overviewRulerOptions.color&&u.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(u,l.marker.line))return;if(this._lineAdjacentToZone(u,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(u,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,u){return u>=l.startBufferLine&&u<=l.endBufferLine}_lineAdjacentToZone(l,u,c){return u>=l.startBufferLine-this._linePadding[c||"full"]&&u<=l.endBufferLine+this._linePadding[c||"full"]}_addLineToZone(l,u){l.startBufferLine=Math.min(l.startBufferLine,u),l.endBufferLine=Math.max(l.endBufferLine,u)}}},5744:function(a,o,l){var u=this&&this.__decorate||function(b,w,x,k){var S,E=arguments.length,A=E<3?w:k===null?k=Object.getOwnPropertyDescriptor(w,x):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(b,w,x,k);else for(var M=b.length-1;M>=0;M--)(S=b[M])&&(A=(E<3?S(A):E>3?S(w,x,A):S(w,x))||A);return E>3&&A&&Object.defineProperty(w,x,A),A},c=this&&this.__param||function(b,w){return function(x,k){w(x,k,b)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OverviewRulerRenderer=void 0;const h=l(5871),d=l(3656),p=l(4725),m=l(844),_=l(2585),f={full:0,left:0,center:0,right:0},v={full:0,left:0,center:0,right:0},g={full:0,left:0,center:0,right:0};let y=o.OverviewRulerRenderer=class extends m.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(b,w,x,k,S,E,A){var M;super(),this._viewportElement=b,this._screenElement=w,this._bufferService=x,this._decorationService=k,this._renderService=S,this._optionsService=E,this._coreBrowseService=A,this._colorZoneStore=new h.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(M=this._viewportElement.parentElement)===null||M===void 0||M.insertBefore(this._canvas,this._viewportElement);const R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,m.toDisposable)(()=>{var P;(P=this._canvas)===null||P===void 0||P.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,d.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const b=Math.floor(this._canvas.width/3),w=Math.ceil(this._canvas.width/3);v.full=this._canvas.width,v.left=b,v.center=w,v.right=b,this._refreshDrawHeightConstants(),g.full=0,g.left=0,g.center=v.left,g.right=v.left+v.center}_refreshDrawHeightConstants(){f.full=Math.round(2*this._coreBrowseService.dpr);const b=this._canvas.height/this._bufferService.buffer.lines.length,w=Math.round(Math.max(Math.min(b,12),6)*this._coreBrowseService.dpr);f.left=w,f.center=w,f.right=w}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const w of this._decorationService.decorations)this._colorZoneStore.addDecoration(w);this._ctx.lineWidth=1;const b=this._colorZoneStore.zones;for(const w of b)w.position!=="full"&&this._renderColorZone(w);for(const w of b)w.position==="full"&&this._renderColorZone(w);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(b){this._ctx.fillStyle=b.color,this._ctx.fillRect(g[b.position||"full"],Math.round((this._canvas.height-1)*(b.startBufferLine/this._bufferService.buffers.active.lines.length)-f[b.position||"full"]/2),v[b.position||"full"],Math.round((this._canvas.height-1)*((b.endBufferLine-b.startBufferLine)/this._bufferService.buffers.active.lines.length)+f[b.position||"full"]))}_queueRefresh(b,w){this._shouldUpdateDimensions=b||this._shouldUpdateDimensions,this._shouldUpdateAnchor=w||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};o.OverviewRulerRenderer=y=u([c(2,_.IBufferService),c(3,_.IDecorationService),c(4,p.IRenderService),c(5,_.IOptionsService),c(6,p.ICoreBrowserService)],y)},2950:function(a,o,l){var u=this&&this.__decorate||function(_,f,v,g){var y,b=arguments.length,w=b<3?f:g===null?g=Object.getOwnPropertyDescriptor(f,v):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(_,f,v,g);else for(var x=_.length-1;x>=0;x--)(y=_[x])&&(w=(b<3?y(w):b>3?y(f,v,w):y(f,v))||w);return b>3&&w&&Object.defineProperty(f,v,w),w},c=this&&this.__param||function(_,f){return function(v,g){f(v,g,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CompositionHelper=void 0;const h=l(4725),d=l(2585),p=l(2584);let m=o.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(_,f,v,g,y,b){this._textarea=_,this._compositionView=f,this._bufferService=v,this._optionsService=g,this._coreService=y,this._renderService=b,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(_){this._compositionView.textContent=_.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(_){if(this._isComposing||this._isSendingComposition){if(_.keyCode===229||_.keyCode===16||_.keyCode===17||_.keyCode===18)return!1;this._finalizeComposition(!1)}return _.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(_){if(this._compositionView.classList.remove("active"),this._isComposing=!1,_){const f={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let v;this._isSendingComposition=!1,f.start+=this._dataAlreadySent.length,v=this._isComposing?this._textarea.value.substring(f.start,f.end):this._textarea.value.substring(f.start),v.length>0&&this._coreService.triggerDataEvent(v,!0)}},0)}else{this._isSendingComposition=!1;const f=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(f,!0)}}_handleAnyTextareaChanges(){const _=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const f=this._textarea.value,v=f.replace(_,"");this._dataAlreadySent=v,f.length>_.length?this._coreService.triggerDataEvent(v,!0):f.length<_.length?this._coreService.triggerDataEvent(`${p.C0.DEL}`,!0):f.length===_.length&&f!==_&&this._coreService.triggerDataEvent(f,!0)}},0)}updateCompositionElements(_){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const f=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),v=this._renderService.dimensions.css.cell.height,g=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,y=f*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=y+"px",this._compositionView.style.top=g+"px",this._compositionView.style.height=v+"px",this._compositionView.style.lineHeight=v+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const b=this._compositionView.getBoundingClientRect();this._textarea.style.left=y+"px",this._textarea.style.top=g+"px",this._textarea.style.width=Math.max(b.width,1)+"px",this._textarea.style.height=Math.max(b.height,1)+"px",this._textarea.style.lineHeight=b.height+"px"}_||setTimeout(()=>this.updateCompositionElements(!0),0)}}};o.CompositionHelper=m=u([c(2,d.IBufferService),c(3,d.IOptionsService),c(4,d.ICoreService),c(5,h.IRenderService)],m)},9806:(a,o)=>{function l(u,c,h){const d=h.getBoundingClientRect(),p=u.getComputedStyle(h),m=parseInt(p.getPropertyValue("padding-left")),_=parseInt(p.getPropertyValue("padding-top"));return[c.clientX-d.left-m,c.clientY-d.top-_]}Object.defineProperty(o,"__esModule",{value:!0}),o.getCoords=o.getCoordsRelativeToElement=void 0,o.getCoordsRelativeToElement=l,o.getCoords=function(u,c,h,d,p,m,_,f,v){if(!m)return;const g=l(u,c,h);return g?(g[0]=Math.ceil((g[0]+(v?_/2:0))/_),g[1]=Math.ceil(g[1]/f),g[0]=Math.min(Math.max(g[0],1),d+(v?1:0)),g[1]=Math.min(Math.max(g[1],1),p),g):void 0}},9504:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.moveToCellSequence=void 0;const u=l(2584);function c(f,v,g,y){const b=f-h(f,g),w=v-h(v,g),x=Math.abs(b-w)-function(k,S,E){let A=0;const M=k-h(k,E),R=S-h(S,E);for(let P=0;P<Math.abs(M-R);P++){const H=d(k,S)==="A"?-1:1,B=E.buffer.lines.get(M+H*P);B!=null&&B.isWrapped&&A++}return A}(f,v,g);return _(x,m(d(f,v),y))}function h(f,v){let g=0,y=v.buffer.lines.get(f),b=y==null?void 0:y.isWrapped;for(;b&&f>=0&&f<v.rows;)g++,y=v.buffer.lines.get(--f),b=y==null?void 0:y.isWrapped;return g}function d(f,v){return f>v?"A":"B"}function p(f,v,g,y,b,w){let x=f,k=v,S="";for(;x!==g||k!==y;)x+=b?1:-1,b&&x>w.cols-1?(S+=w.buffer.translateBufferLineToString(k,!1,f,x),x=0,f=0,k++):!b&&x<0&&(S+=w.buffer.translateBufferLineToString(k,!1,0,f+1),x=w.cols-1,f=x,k--);return S+w.buffer.translateBufferLineToString(k,!1,f,x)}function m(f,v){const g=v?"O":"[";return u.C0.ESC+g+f}function _(f,v){f=Math.floor(f);let g="";for(let y=0;y<f;y++)g+=v;return g}o.moveToCellSequence=function(f,v,g,y){const b=g.buffer.x,w=g.buffer.y;if(!g.buffer.hasScrollback)return function(S,E,A,M,R,P){return c(E,M,R,P).length===0?"":_(p(S,E,S,E-h(E,R),!1,R).length,m("D",P))}(b,w,0,v,g,y)+c(w,v,g,y)+function(S,E,A,M,R,P){let H;H=c(E,M,R,P).length>0?M-h(M,R):E;const B=M,L=function(j,D,O,N,z,q){let te;return te=c(O,N,z,q).length>0?N-h(N,z):D,j<O&&te<=N||j>=O&&te<N?"C":"D"}(S,E,A,M,R,P);return _(p(S,H,A,B,L==="C",R).length,m(L,P))}(b,w,f,v,g,y);let x;if(w===v)return x=b>f?"D":"C",_(Math.abs(b-f),m(x,y));x=w>v?"D":"C";const k=Math.abs(w-v);return _(function(S,E){return E.cols-S}(w>v?f:b,g)+(k-1)*g.cols+1+((w>v?b:f)-1),m(x,y))}},1296:function(a,o,l){var u=this&&this.__decorate||function(R,P,H,B){var L,j=arguments.length,D=j<3?P:B===null?B=Object.getOwnPropertyDescriptor(P,H):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(R,P,H,B);else for(var O=R.length-1;O>=0;O--)(L=R[O])&&(D=(j<3?L(D):j>3?L(P,H,D):L(P,H))||D);return j>3&&D&&Object.defineProperty(P,H,D),D},c=this&&this.__param||function(R,P){return function(H,B){P(H,B,R)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRenderer=void 0;const h=l(3787),d=l(2550),p=l(2223),m=l(6171),_=l(4725),f=l(8055),v=l(8460),g=l(844),y=l(2585),b="xterm-dom-renderer-owner-",w="xterm-rows",x="xterm-fg-",k="xterm-bg-",S="xterm-focus",E="xterm-selection";let A=1,M=o.DomRenderer=class extends g.Disposable{constructor(R,P,H,B,L,j,D,O,N,z){super(),this._element=R,this._screenElement=P,this._viewportElement=H,this._linkifier2=B,this._charSizeService=j,this._optionsService=D,this._bufferService=O,this._coreBrowserService=N,this._themeService=z,this._terminalClass=A++,this._rowElements=[],this.onRequestRedraw=this.register(new v.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(w),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(E),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,m.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(q=>this._injectCss(q))),this._injectCss(this._themeService.colors),this._rowFactory=L.createInstance(h.DomRendererRowFactory,document),this._element.classList.add(b+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(q=>this._handleLinkHover(q))),this.register(this._linkifier2.onHideLinkUnderline(q=>this._handleLinkLeave(q))),this.register((0,g.toDisposable)(()=>{this._element.classList.remove(b+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new d.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const R=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*R,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*R),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/R),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/R),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const H of this._rowElements)H.style.width=`${this.dimensions.css.canvas.width}px`,H.style.height=`${this.dimensions.css.cell.height}px`,H.style.lineHeight=`${this.dimensions.css.cell.height}px`,H.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const P=`${this._terminalSelector} .${w} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=P,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(R){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let P=`${this._terminalSelector} .${w} { color: ${R.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;P+=`${this._terminalSelector} .${w} .xterm-dim { color: ${f.color.multiplyOpacity(R.foreground,.5).css};}`,P+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,P+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",P+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${R.cursor.css};  color: ${R.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${R.cursor.css}; }}`,P+=`${this._terminalSelector} .${w}.${S} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${w}.${S} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-block { background-color: ${R.cursor.css}; color: ${R.cursorAccent.css};}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${R.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${R.cursor.css} inset;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${R.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,P+=`${this._terminalSelector} .${E} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${E} div { position: absolute; background-color: ${R.selectionBackgroundOpaque.css};}${this._terminalSelector} .${E} div { position: absolute; background-color: ${R.selectionInactiveBackgroundOpaque.css};}`;for(const[H,B]of R.ansi.entries())P+=`${this._terminalSelector} .${x}${H} { color: ${B.css}; }${this._terminalSelector} .${x}${H}.xterm-dim { color: ${f.color.multiplyOpacity(B,.5).css}; }${this._terminalSelector} .${k}${H} { background-color: ${B.css}; }`;P+=`${this._terminalSelector} .${x}${p.INVERTED_DEFAULT_COLOR} { color: ${f.color.opaque(R.background).css}; }${this._terminalSelector} .${x}${p.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${f.color.multiplyOpacity(f.color.opaque(R.background),.5).css}; }${this._terminalSelector} .${k}${p.INVERTED_DEFAULT_COLOR} { background-color: ${R.foreground.css}; }`,this._themeStyleElement.textContent=P}_setDefaultSpacing(){const R=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${R}px`,this._rowFactory.defaultSpacing=R}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(R,P){for(let H=this._rowElements.length;H<=P;H++){const B=document.createElement("div");this._rowContainer.appendChild(B),this._rowElements.push(B)}for(;this._rowElements.length>P;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(R,P){this._refreshRowElements(R,P),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(S)}handleFocus(){this._rowContainer.classList.add(S),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(R,P,H){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(R,P,H),this.renderRows(0,this._bufferService.rows-1),!R||!P)return;const B=R[1]-this._bufferService.buffer.ydisp,L=P[1]-this._bufferService.buffer.ydisp,j=Math.max(B,0),D=Math.min(L,this._bufferService.rows-1);if(j>=this._bufferService.rows||D<0)return;const O=document.createDocumentFragment();if(H){const N=R[0]>P[0];O.appendChild(this._createSelectionElement(j,N?P[0]:R[0],N?R[0]:P[0],D-j+1))}else{const N=B===j?R[0]:0,z=j===L?P[0]:this._bufferService.cols;O.appendChild(this._createSelectionElement(j,N,z));const q=D-j-1;if(O.appendChild(this._createSelectionElement(j+1,0,this._bufferService.cols,q)),j!==D){const te=L===D?P[0]:this._bufferService.cols;O.appendChild(this._createSelectionElement(D,0,te))}}this._selectionContainer.appendChild(O)}_createSelectionElement(R,P,H,B=1){const L=document.createElement("div");return L.style.height=B*this.dimensions.css.cell.height+"px",L.style.top=R*this.dimensions.css.cell.height+"px",L.style.left=P*this.dimensions.css.cell.width+"px",L.style.width=this.dimensions.css.cell.width*(H-P)+"px",L}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const R of this._rowElements)R.replaceChildren()}renderRows(R,P){const H=this._bufferService.buffer,B=H.ybase+H.y,L=Math.min(H.x,this._bufferService.cols-1),j=this._optionsService.rawOptions.cursorBlink,D=this._optionsService.rawOptions.cursorStyle,O=this._optionsService.rawOptions.cursorInactiveStyle;for(let N=R;N<=P;N++){const z=N+H.ydisp,q=this._rowElements[N],te=H.lines.get(z);if(!q||!te)break;q.replaceChildren(...this._rowFactory.createRow(te,z,z===B,D,O,L,j,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${b}${this._terminalClass}`}_handleLinkHover(R){this._setCellUnderline(R.x1,R.x2,R.y1,R.y2,R.cols,!0)}_handleLinkLeave(R){this._setCellUnderline(R.x1,R.x2,R.y1,R.y2,R.cols,!1)}_setCellUnderline(R,P,H,B,L,j){H<0&&(R=0),B<0&&(P=0);const D=this._bufferService.rows-1;H=Math.max(Math.min(H,D),0),B=Math.max(Math.min(B,D),0),L=Math.min(L,this._bufferService.cols);const O=this._bufferService.buffer,N=O.ybase+O.y,z=Math.min(O.x,L-1),q=this._optionsService.rawOptions.cursorBlink,te=this._optionsService.rawOptions.cursorStyle,ee=this._optionsService.rawOptions.cursorInactiveStyle;for(let K=H;K<=B;++K){const ce=K+O.ydisp,T=this._rowElements[K],$=O.lines.get(ce);if(!T||!$)break;T.replaceChildren(...this._rowFactory.createRow($,ce,ce===N,te,ee,z,q,this.dimensions.css.cell.width,this._widthCache,j?K===H?R:0:-1,j?(K===B?P:L)-1:-1))}}};o.DomRenderer=M=u([c(4,y.IInstantiationService),c(5,_.ICharSizeService),c(6,y.IOptionsService),c(7,y.IBufferService),c(8,_.ICoreBrowserService),c(9,_.IThemeService)],M)},3787:function(a,o,l){var u=this&&this.__decorate||function(x,k,S,E){var A,M=arguments.length,R=M<3?k:E===null?E=Object.getOwnPropertyDescriptor(k,S):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(x,k,S,E);else for(var P=x.length-1;P>=0;P--)(A=x[P])&&(R=(M<3?A(R):M>3?A(k,S,R):A(k,S))||R);return M>3&&R&&Object.defineProperty(k,S,R),R},c=this&&this.__param||function(x,k){return function(S,E){k(S,E,x)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRendererRowFactory=void 0;const h=l(2223),d=l(643),p=l(511),m=l(2585),_=l(8055),f=l(4725),v=l(4269),g=l(6171),y=l(3734);let b=o.DomRendererRowFactory=class{constructor(x,k,S,E,A,M,R){this._document=x,this._characterJoinerService=k,this._optionsService=S,this._coreBrowserService=E,this._coreService=A,this._decorationService=M,this._themeService=R,this._workCell=new p.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(x,k,S){this._selectionStart=x,this._selectionEnd=k,this._columnSelectMode=S}createRow(x,k,S,E,A,M,R,P,H,B,L){const j=[],D=this._characterJoinerService.getJoinedCharacters(k),O=this._themeService.colors;let N,z=x.getNoBgTrimmedLength();S&&z<M+1&&(z=M+1);let q=0,te="",ee=0,K=0,ce=0,T=!1,$=0,Z=!1,F=0;const V=[],G=B!==-1&&L!==-1;for(let W=0;W<z;W++){x.loadCell(W,this._workCell);let ne=this._workCell.getWidth();if(ne===0)continue;let oe=!1,ae=W,Y=this._workCell;if(D.length>0&&W===D[0][0]){oe=!0;const Ee=D.shift();Y=new v.JoinedCellData(this._workCell,x.translateToString(!0,Ee[0],Ee[1]),Ee[1]-Ee[0]),ae=Ee[1]-1,ne=Y.getWidth()}const le=this._isCellInSelection(W,k),_e=S&&W===M,fe=G&&W>=B&&W<=L;let xe=!1;this._decorationService.forEachDecorationAtCell(W,k,void 0,Ee=>{xe=!0});let De=Y.getChars()||d.WHITESPACE_CELL_CHAR;if(De===" "&&(Y.isUnderline()||Y.isOverline())&&(De=""),F=ne*P-H.get(De,Y.isBold(),Y.isItalic()),N){if(q&&(le&&Z||!le&&!Z&&Y.bg===ee)&&(le&&Z&&O.selectionForeground||Y.fg===K)&&Y.extended.ext===ce&&fe===T&&F===$&&!_e&&!oe&&!xe){te+=De,q++;continue}q&&(N.textContent=te),N=this._document.createElement("span"),q=0,te=""}else N=this._document.createElement("span");if(ee=Y.bg,K=Y.fg,ce=Y.extended.ext,T=fe,$=F,Z=le,oe&&M>=W&&M<=ae&&(M=W),!this._coreService.isCursorHidden&&_e){if(V.push("xterm-cursor"),this._coreBrowserService.isFocused)R&&V.push("xterm-cursor-blink"),V.push(E==="bar"?"xterm-cursor-bar":E==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(A)switch(A){case"outline":V.push("xterm-cursor-outline");break;case"block":V.push("xterm-cursor-block");break;case"bar":V.push("xterm-cursor-bar");break;case"underline":V.push("xterm-cursor-underline")}}if(Y.isBold()&&V.push("xterm-bold"),Y.isItalic()&&V.push("xterm-italic"),Y.isDim()&&V.push("xterm-dim"),te=Y.isInvisible()?d.WHITESPACE_CELL_CHAR:Y.getChars()||d.WHITESPACE_CELL_CHAR,Y.isUnderline()&&(V.push(`xterm-underline-${Y.extended.underlineStyle}`),te===" "&&(te=""),!Y.isUnderlineColorDefault()))if(Y.isUnderlineColorRGB())N.style.textDecorationColor=`rgb(${y.AttributeData.toColorRGB(Y.getUnderlineColor()).join(",")})`;else{let Ee=Y.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Y.isBold()&&Ee<8&&(Ee+=8),N.style.textDecorationColor=O.ansi[Ee].css}Y.isOverline()&&(V.push("xterm-overline"),te===" "&&(te="")),Y.isStrikethrough()&&V.push("xterm-strikethrough"),fe&&(N.style.textDecoration="underline");let ge=Y.getFgColor(),ke=Y.getFgColorMode(),Pe=Y.getBgColor(),Fe=Y.getBgColorMode();const vt=!!Y.isInverse();if(vt){const Ee=ge;ge=Pe,Pe=Ee;const Pt=ke;ke=Fe,Fe=Pt}let Yt,Dn,_t,St=!1;switch(this._decorationService.forEachDecorationAtCell(W,k,void 0,Ee=>{Ee.options.layer!=="top"&&St||(Ee.backgroundColorRGB&&(Fe=50331648,Pe=Ee.backgroundColorRGB.rgba>>8&16777215,Yt=Ee.backgroundColorRGB),Ee.foregroundColorRGB&&(ke=50331648,ge=Ee.foregroundColorRGB.rgba>>8&16777215,Dn=Ee.foregroundColorRGB),St=Ee.options.layer==="top")}),!St&&le&&(Yt=this._coreBrowserService.isFocused?O.selectionBackgroundOpaque:O.selectionInactiveBackgroundOpaque,Pe=Yt.rgba>>8&16777215,Fe=50331648,St=!0,O.selectionForeground&&(ke=50331648,ge=O.selectionForeground.rgba>>8&16777215,Dn=O.selectionForeground)),St&&V.push("xterm-decoration-top"),Fe){case 16777216:case 33554432:_t=O.ansi[Pe],V.push(`xterm-bg-${Pe}`);break;case 50331648:_t=_.rgba.toColor(Pe>>16,Pe>>8&255,255&Pe),this._addStyle(N,`background-color:#${w((Pe>>>0).toString(16),"0",6)}`);break;default:vt?(_t=O.foreground,V.push(`xterm-bg-${h.INVERTED_DEFAULT_COLOR}`)):_t=O.background}switch(Yt||Y.isDim()&&(Yt=_.color.multiplyOpacity(_t,.5)),ke){case 16777216:case 33554432:Y.isBold()&&ge<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ge+=8),this._applyMinimumContrast(N,_t,O.ansi[ge],Y,Yt,void 0)||V.push(`xterm-fg-${ge}`);break;case 50331648:const Ee=_.rgba.toColor(ge>>16&255,ge>>8&255,255&ge);this._applyMinimumContrast(N,_t,Ee,Y,Yt,Dn)||this._addStyle(N,`color:#${w(ge.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(N,_t,O.foreground,Y,Yt,void 0)||vt&&V.push(`xterm-fg-${h.INVERTED_DEFAULT_COLOR}`)}V.length&&(N.className=V.join(" "),V.length=0),_e||oe||xe?N.textContent=te:q++,F!==this.defaultSpacing&&(N.style.letterSpacing=`${F}px`),j.push(N),W=ae}return N&&q&&(N.textContent=te),j}_applyMinimumContrast(x,k,S,E,A,M){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,g.excludeFromContrastRatioDemands)(E.getCode()))return!1;const R=this._getContrastCache(E);let P;if(A||M||(P=R.getColor(k.rgba,S.rgba)),P===void 0){const H=this._optionsService.rawOptions.minimumContrastRatio/(E.isDim()?2:1);P=_.color.ensureContrastRatio(A||k,M||S,H),R.setColor((A||k).rgba,(M||S).rgba,P??null)}return!!P&&(this._addStyle(x,`color:${P.css}`),!0)}_getContrastCache(x){return x.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(x,k){x.setAttribute("style",`${x.getAttribute("style")||""}${k};`)}_isCellInSelection(x,k){const S=this._selectionStart,E=this._selectionEnd;return!(!S||!E)&&(this._columnSelectMode?S[0]<=E[0]?x>=S[0]&&k>=S[1]&&x<E[0]&&k<=E[1]:x<S[0]&&k>=S[1]&&x>=E[0]&&k<=E[1]:k>S[1]&&k<E[1]||S[1]===E[1]&&k===S[1]&&x>=S[0]&&x<E[0]||S[1]<E[1]&&k===E[1]&&x<E[0]||S[1]<E[1]&&k===S[1]&&x>=S[0])}};function w(x,k,S){for(;x.length<S;)x=k+x;return x}o.DomRendererRowFactory=b=u([c(1,f.ICharacterJoinerService),c(2,m.IOptionsService),c(3,f.ICoreBrowserService),c(4,m.ICoreService),c(5,m.IDecorationService),c(6,f.IThemeService)],b)},2550:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WidthCache=void 0,o.WidthCache=class{constructor(l){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=l.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const u=l.createElement("span"),c=l.createElement("span");c.style.fontWeight="bold";const h=l.createElement("span");h.style.fontStyle="italic";const d=l.createElement("span");d.style.fontWeight="bold",d.style.fontStyle="italic",this._measureElements=[u,c,h,d],this._container.appendChild(u),this._container.appendChild(c),this._container.appendChild(h),this._container.appendChild(d),l.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(l,u,c,h){l===this._font&&u===this._fontSize&&c===this._weight&&h===this._weightBold||(this._font=l,this._fontSize=u,this._weight=c,this._weightBold=h,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${c}`,this._measureElements[1].style.fontWeight=`${h}`,this._measureElements[2].style.fontWeight=`${c}`,this._measureElements[3].style.fontWeight=`${h}`,this.clear())}get(l,u,c){let h=0;if(!u&&!c&&l.length===1&&(h=l.charCodeAt(0))<256)return this._flat[h]!==-9999?this._flat[h]:this._flat[h]=this._measure(l,0);let d=l;u&&(d+="B"),c&&(d+="I");let p=this._holey.get(d);if(p===void 0){let m=0;u&&(m|=1),c&&(m|=2),p=this._measure(l,m),this._holey.set(d,p)}return p}_measure(l,u){const c=this._measureElements[u];return c.textContent=l.repeat(32),c.offsetWidth/32}}},2223:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TEXT_BASELINE=o.DIM_OPACITY=o.INVERTED_DEFAULT_COLOR=void 0;const u=l(6114);o.INVERTED_DEFAULT_COLOR=257,o.DIM_OPACITY=.5,o.TEXT_BASELINE=u.isFirefox||u.isLegacyEdge?"bottom":"ideographic"},6171:(a,o)=>{function l(u){return 57508<=u&&u<=57558}Object.defineProperty(o,"__esModule",{value:!0}),o.createRenderDimensions=o.excludeFromContrastRatioDemands=o.isRestrictedPowerlineGlyph=o.isPowerlineGlyph=o.throwIfFalsy=void 0,o.throwIfFalsy=function(u){if(!u)throw new Error("value must not be falsy");return u},o.isPowerlineGlyph=l,o.isRestrictedPowerlineGlyph=function(u){return 57520<=u&&u<=57527},o.excludeFromContrastRatioDemands=function(u){return l(u)||function(c){return 9472<=c&&c<=9631}(u)},o.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionModel=void 0,o.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,u=this.selectionEnd;return!(!l||!u)&&(l[1]>u[1]||l[1]===u[1]&&l[0]>u[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(a,o,l){var u=this&&this.__decorate||function(f,v,g,y){var b,w=arguments.length,x=w<3?v:y===null?y=Object.getOwnPropertyDescriptor(v,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(f,v,g,y);else for(var k=f.length-1;k>=0;k--)(b=f[k])&&(x=(w<3?b(x):w>3?b(v,g,x):b(v,g))||x);return w>3&&x&&Object.defineProperty(v,g,x),x},c=this&&this.__param||function(f,v){return function(g,y){v(g,y,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharSizeService=void 0;const h=l(2585),d=l(8460),p=l(844);let m=o.CharSizeService=class extends p.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(f,v,g){super(),this._optionsService=g,this.width=0,this.height=0,this._onCharSizeChange=this.register(new d.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new _(f,v,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const f=this._measureStrategy.measure();f.width===this.width&&f.height===this.height||(this.width=f.width,this.height=f.height,this._onCharSizeChange.fire())}};o.CharSizeService=m=u([c(2,h.IOptionsService)],m);class _{constructor(v,g,y){this._document=v,this._parentElement=g,this._optionsService=y,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const v={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return v.width!==0&&v.height!==0&&(this._result.width=v.width/32,this._result.height=Math.ceil(v.height)),this._result}}},4269:function(a,o,l){var u=this&&this.__decorate||function(v,g,y,b){var w,x=arguments.length,k=x<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,y):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(v,g,y,b);else for(var S=v.length-1;S>=0;S--)(w=v[S])&&(k=(x<3?w(k):x>3?w(g,y,k):w(g,y))||k);return x>3&&k&&Object.defineProperty(g,y,k),k},c=this&&this.__param||function(v,g){return function(y,b){g(y,b,v)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharacterJoinerService=o.JoinedCellData=void 0;const h=l(3734),d=l(643),p=l(511),m=l(2585);class _ extends h.AttributeData{constructor(g,y,b){super(),this.content=0,this.combinedData="",this.fg=g.fg,this.bg=g.bg,this.combinedData=y,this._width=b}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(g){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.JoinedCellData=_;let f=o.CharacterJoinerService=class sE{constructor(g){this._bufferService=g,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new p.CellData}register(g){const y={id:this._nextCharacterJoinerId++,handler:g};return this._characterJoiners.push(y),y.id}deregister(g){for(let y=0;y<this._characterJoiners.length;y++)if(this._characterJoiners[y].id===g)return this._characterJoiners.splice(y,1),!0;return!1}getJoinedCharacters(g){if(this._characterJoiners.length===0)return[];const y=this._bufferService.buffer.lines.get(g);if(!y||y.length===0)return[];const b=[],w=y.translateToString(!0);let x=0,k=0,S=0,E=y.getFg(0),A=y.getBg(0);for(let M=0;M<y.getTrimmedLength();M++)if(y.loadCell(M,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==E||this._workCell.bg!==A){if(M-x>1){const R=this._getJoinedRanges(w,S,k,y,x);for(let P=0;P<R.length;P++)b.push(R[P])}x=M,S=k,E=this._workCell.fg,A=this._workCell.bg}k+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-x>1){const M=this._getJoinedRanges(w,S,k,y,x);for(let R=0;R<M.length;R++)b.push(M[R])}return b}_getJoinedRanges(g,y,b,w,x){const k=g.substring(y,b);let S=[];try{S=this._characterJoiners[0].handler(k)}catch(E){console.error(E)}for(let E=1;E<this._characterJoiners.length;E++)try{const A=this._characterJoiners[E].handler(k);for(let M=0;M<A.length;M++)sE._mergeRanges(S,A[M])}catch(A){console.error(A)}return this._stringRangesToCellRanges(S,w,x),S}_stringRangesToCellRanges(g,y,b){let w=0,x=!1,k=0,S=g[w];if(S){for(let E=b;E<this._bufferService.cols;E++){const A=y.getWidth(E),M=y.getString(E).length||d.WHITESPACE_CELL_CHAR.length;if(A!==0){if(!x&&S[0]<=k&&(S[0]=E,x=!0),S[1]<=k){if(S[1]=E,S=g[++w],!S)break;S[0]<=k?(S[0]=E,x=!0):x=!1}k+=M}}S&&(S[1]=this._bufferService.cols)}}static _mergeRanges(g,y){let b=!1;for(let w=0;w<g.length;w++){const x=g[w];if(b){if(y[1]<=x[0])return g[w-1][1]=y[1],g;if(y[1]<=x[1])return g[w-1][1]=Math.max(y[1],x[1]),g.splice(w,1),g;g.splice(w,1),w--}else{if(y[1]<=x[0])return g.splice(w,0,y),g;if(y[1]<=x[1])return x[0]=Math.min(y[0],x[0]),g;y[0]<x[1]&&(x[0]=Math.min(y[0],x[0]),b=!0)}}return b?g[g.length-1][1]=y[1]:g.push(y),g}};o.CharacterJoinerService=f=u([c(0,m.IBufferService)],f)},5114:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreBrowserService=void 0,o.CoreBrowserService=class{constructor(l,u){this._textarea=l,this.window=u,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(a,o,l){var u=this&&this.__decorate||function(m,_,f,v){var g,y=arguments.length,b=y<3?_:v===null?v=Object.getOwnPropertyDescriptor(_,f):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(m,_,f,v);else for(var w=m.length-1;w>=0;w--)(g=m[w])&&(b=(y<3?g(b):y>3?g(_,f,b):g(_,f))||b);return y>3&&b&&Object.defineProperty(_,f,b),b},c=this&&this.__param||function(m,_){return function(f,v){_(f,v,m)}};Object.defineProperty(o,"__esModule",{value:!0}),o.MouseService=void 0;const h=l(4725),d=l(9806);let p=o.MouseService=class{constructor(m,_){this._renderService=m,this._charSizeService=_}getCoords(m,_,f,v,g){return(0,d.getCoords)(window,m,_,f,v,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,g)}getMouseReportCoords(m,_){const f=(0,d.getCoordsRelativeToElement)(window,m,_);if(this._charSizeService.hasValidSize)return f[0]=Math.min(Math.max(f[0],0),this._renderService.dimensions.css.canvas.width-1),f[1]=Math.min(Math.max(f[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(f[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(f[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(f[0]),y:Math.floor(f[1])}}};o.MouseService=p=u([c(0,h.IRenderService),c(1,h.ICharSizeService)],p)},3230:function(a,o,l){var u=this&&this.__decorate||function(b,w,x,k){var S,E=arguments.length,A=E<3?w:k===null?k=Object.getOwnPropertyDescriptor(w,x):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(b,w,x,k);else for(var M=b.length-1;M>=0;M--)(S=b[M])&&(A=(E<3?S(A):E>3?S(w,x,A):S(w,x))||A);return E>3&&A&&Object.defineProperty(w,x,A),A},c=this&&this.__param||function(b,w){return function(x,k){w(x,k,b)}};Object.defineProperty(o,"__esModule",{value:!0}),o.RenderService=void 0;const h=l(3656),d=l(6193),p=l(5596),m=l(4725),_=l(8460),f=l(844),v=l(7226),g=l(2585);let y=o.RenderService=class extends f.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(b,w,x,k,S,E,A,M){if(super(),this._rowCount=b,this._charSizeService=k,this._renderer=this.register(new f.MutableDisposable),this._pausedResizeTask=new v.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new _.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new _.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new _.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new _.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new d.RenderDebouncer(A.window,(R,P)=>this._renderRows(R,P)),this.register(this._renderDebouncer),this._screenDprMonitor=new p.ScreenDprMonitor(A.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(E.onResize(()=>this._fullRefresh())),this.register(E.buffers.onBufferActivate(()=>{var R;return(R=this._renderer.value)===null||R===void 0?void 0:R.clear()})),this.register(x.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(x.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(E.cols,E.rows),this._fullRefresh()})),this.register(x.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(E.buffer.y,E.buffer.y,!0))),this.register((0,h.addDisposableDomListener)(A.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(M.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in A.window){const R=new A.window.IntersectionObserver(P=>this._handleIntersectionChange(P[P.length-1]),{threshold:0});R.observe(w),this.register({dispose:()=>R.disconnect()})}}_handleIntersectionChange(b){this._isPaused=b.isIntersecting===void 0?b.intersectionRatio===0:!b.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(b,w,x=!1){this._isPaused?this._needsFullRefresh=!0:(x||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(b,w,this._rowCount))}_renderRows(b,w){this._renderer.value&&(b=Math.min(b,this._rowCount-1),w=Math.min(w,this._rowCount-1),this._renderer.value.renderRows(b,w),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:b,end:w}),this._onRender.fire({start:b,end:w}),this._isNextRenderRedrawOnly=!0)}resize(b,w){this._rowCount=w,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(b){this._renderer.value=b,this._renderer.value.onRequestRedraw(w=>this.refreshRows(w.start,w.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(b){return this._renderDebouncer.addRefreshCallback(b)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var b,w;this._renderer.value&&((w=(b=this._renderer.value).clearTextureAtlas)===null||w===void 0||w.call(b),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(b,w){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(b,w)):this._renderer.value.handleResize(b,w),this._fullRefresh())}handleCharSizeChanged(){var b;(b=this._renderer.value)===null||b===void 0||b.handleCharSizeChanged()}handleBlur(){var b;(b=this._renderer.value)===null||b===void 0||b.handleBlur()}handleFocus(){var b;(b=this._renderer.value)===null||b===void 0||b.handleFocus()}handleSelectionChanged(b,w,x){var k;this._selectionState.start=b,this._selectionState.end=w,this._selectionState.columnSelectMode=x,(k=this._renderer.value)===null||k===void 0||k.handleSelectionChanged(b,w,x)}handleCursorMove(){var b;(b=this._renderer.value)===null||b===void 0||b.handleCursorMove()}clear(){var b;(b=this._renderer.value)===null||b===void 0||b.clear()}};o.RenderService=y=u([c(2,g.IOptionsService),c(3,m.ICharSizeService),c(4,g.IDecorationService),c(5,g.IBufferService),c(6,m.ICoreBrowserService),c(7,m.IThemeService)],y)},9312:function(a,o,l){var u=this&&this.__decorate||function(S,E,A,M){var R,P=arguments.length,H=P<3?E:M===null?M=Object.getOwnPropertyDescriptor(E,A):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(S,E,A,M);else for(var B=S.length-1;B>=0;B--)(R=S[B])&&(H=(P<3?R(H):P>3?R(E,A,H):R(E,A))||H);return P>3&&H&&Object.defineProperty(E,A,H),H},c=this&&this.__param||function(S,E){return function(A,M){E(A,M,S)}};Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionService=void 0;const h=l(9806),d=l(9504),p=l(456),m=l(4725),_=l(8460),f=l(844),v=l(6114),g=l(4841),y=l(511),b=l(2585),w="",x=new RegExp(w,"g");let k=o.SelectionService=class extends f.Disposable{constructor(S,E,A,M,R,P,H,B,L){super(),this._element=S,this._screenElement=E,this._linkifier=A,this._bufferService=M,this._coreService=R,this._mouseService=P,this._optionsService=H,this._renderService=B,this._coreBrowserService=L,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new y.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=j=>this._handleMouseMove(j),this._mouseUpListener=j=>this._handleMouseUp(j),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(j=>this._handleTrim(j)),this.register(this._bufferService.buffers.onBufferActivate(j=>this._handleBufferActivate(j))),this.enable(),this._model=new p.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,f.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const S=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;return!(!S||!E||S[0]===E[0]&&S[1]===E[1])}get selectionText(){const S=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;if(!S||!E)return"";const A=this._bufferService.buffer,M=[];if(this._activeSelectionMode===3){if(S[0]===E[0])return"";const R=S[0]<E[0]?S[0]:E[0],P=S[0]<E[0]?E[0]:S[0];for(let H=S[1];H<=E[1];H++){const B=A.translateBufferLineToString(H,!0,R,P);M.push(B)}}else{const R=S[1]===E[1]?E[0]:void 0;M.push(A.translateBufferLineToString(S[1],!0,S[0],R));for(let P=S[1]+1;P<=E[1]-1;P++){const H=A.lines.get(P),B=A.translateBufferLineToString(P,!0);H!=null&&H.isWrapped?M[M.length-1]+=B:M.push(B)}if(S[1]!==E[1]){const P=A.lines.get(E[1]),H=A.translateBufferLineToString(E[1],!0,0,E[0]);P&&P.isWrapped?M[M.length-1]+=H:M.push(H)}}return M.map(R=>R.replace(x," ")).join(v.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(S){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),v.isLinux&&S&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(S){const E=this._getMouseBufferCoords(S),A=this._model.finalSelectionStart,M=this._model.finalSelectionEnd;return!!(A&&M&&E)&&this._areCoordsInSelection(E,A,M)}isCellInSelection(S,E){const A=this._model.finalSelectionStart,M=this._model.finalSelectionEnd;return!(!A||!M)&&this._areCoordsInSelection([S,E],A,M)}_areCoordsInSelection(S,E,A){return S[1]>E[1]&&S[1]<A[1]||E[1]===A[1]&&S[1]===E[1]&&S[0]>=E[0]&&S[0]<A[0]||E[1]<A[1]&&S[1]===A[1]&&S[0]<A[0]||E[1]<A[1]&&S[1]===E[1]&&S[0]>=E[0]}_selectWordAtCursor(S,E){var A,M;const R=(M=(A=this._linkifier.currentLink)===null||A===void 0?void 0:A.link)===null||M===void 0?void 0:M.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,g.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const P=this._getMouseBufferCoords(S);return!!P&&(this._selectWordAt(P,E),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(S,E){this._model.clearSelection(),S=Math.max(S,0),E=Math.min(E,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,S],this._model.selectionEnd=[this._bufferService.cols,E],this.refresh(),this._onSelectionChange.fire()}_handleTrim(S){this._model.handleTrim(S)&&this.refresh()}_getMouseBufferCoords(S){const E=this._mouseService.getCoords(S,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(E)return E[0]--,E[1]--,E[1]+=this._bufferService.buffer.ydisp,E}_getMouseEventScrollAmount(S){let E=(0,h.getCoordsRelativeToElement)(this._coreBrowserService.window,S,this._screenElement)[1];const A=this._renderService.dimensions.css.canvas.height;return E>=0&&E<=A?0:(E>A&&(E-=A),E=Math.min(Math.max(E,-50),50),E/=50,E/Math.abs(E)+Math.round(14*E))}shouldForceSelection(S){return v.isMac?S.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:S.shiftKey}handleMouseDown(S){if(this._mouseDownTimeStamp=S.timeStamp,(S.button!==2||!this.hasSelection)&&S.button===0){if(!this._enabled){if(!this.shouldForceSelection(S))return;S.stopPropagation()}S.preventDefault(),this._dragScrollAmount=0,this._enabled&&S.shiftKey?this._handleIncrementalClick(S):S.detail===1?this._handleSingleClick(S):S.detail===2?this._handleDoubleClick(S):S.detail===3&&this._handleTripleClick(S),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(S){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(S))}_handleSingleClick(S){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(S)?3:0,this._model.selectionStart=this._getMouseBufferCoords(S),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const E=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);E&&E.length!==this._model.selectionStart[0]&&E.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(S){this._selectWordAtCursor(S,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(S){const E=this._getMouseBufferCoords(S);E&&(this._activeSelectionMode=2,this._selectLineAt(E[1]))}shouldColumnSelect(S){return S.altKey&&!(v.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(S){if(S.stopImmediatePropagation(),!this._model.selectionStart)return;const E=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(S),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(S),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const A=this._bufferService.buffer;if(this._model.selectionEnd[1]<A.lines.length){const M=A.lines.get(this._model.selectionEnd[1]);M&&M.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}E&&E[0]===this._model.selectionEnd[0]&&E[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const S=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(S.ydisp+this._bufferService.rows,S.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=S.ydisp),this.refresh()}}_handleMouseUp(S){const E=S.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&E<500&&S.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const A=this._mouseService.getCoords(S,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(A&&A[0]!==void 0&&A[1]!==void 0){const M=(0,d.moveToCellSequence)(A[0]-1,A[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(M,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const S=this._model.finalSelectionStart,E=this._model.finalSelectionEnd,A=!(!S||!E||S[0]===E[0]&&S[1]===E[1]);A?S&&E&&(this._oldSelectionStart&&this._oldSelectionEnd&&S[0]===this._oldSelectionStart[0]&&S[1]===this._oldSelectionStart[1]&&E[0]===this._oldSelectionEnd[0]&&E[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(S,E,A)):this._oldHasSelection&&this._fireOnSelectionChange(S,E,A)}_fireOnSelectionChange(S,E,A){this._oldSelectionStart=S,this._oldSelectionEnd=E,this._oldHasSelection=A,this._onSelectionChange.fire()}_handleBufferActivate(S){this.clearSelection(),this._trimListener.dispose(),this._trimListener=S.activeBuffer.lines.onTrim(E=>this._handleTrim(E))}_convertViewportColToCharacterIndex(S,E){let A=E;for(let M=0;E>=M;M++){const R=S.loadCell(M,this._workCell).getChars().length;this._workCell.getWidth()===0?A--:R>1&&E!==M&&(A+=R-1)}return A}setSelection(S,E,A){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[S,E],this._model.selectionStartLength=A,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(S){this._isClickInSelection(S)||(this._selectWordAtCursor(S,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(S,E,A=!0,M=!0){if(S[0]>=this._bufferService.cols)return;const R=this._bufferService.buffer,P=R.lines.get(S[1]);if(!P)return;const H=R.translateBufferLineToString(S[1],!1);let B=this._convertViewportColToCharacterIndex(P,S[0]),L=B;const j=S[0]-B;let D=0,O=0,N=0,z=0;if(H.charAt(B)===" "){for(;B>0&&H.charAt(B-1)===" ";)B--;for(;L<H.length&&H.charAt(L+1)===" ";)L++}else{let ee=S[0],K=S[0];P.getWidth(ee)===0&&(D++,ee--),P.getWidth(K)===2&&(O++,K++);const ce=P.getString(K).length;for(ce>1&&(z+=ce-1,L+=ce-1);ee>0&&B>0&&!this._isCharWordSeparator(P.loadCell(ee-1,this._workCell));){P.loadCell(ee-1,this._workCell);const T=this._workCell.getChars().length;this._workCell.getWidth()===0?(D++,ee--):T>1&&(N+=T-1,B-=T-1),B--,ee--}for(;K<P.length&&L+1<H.length&&!this._isCharWordSeparator(P.loadCell(K+1,this._workCell));){P.loadCell(K+1,this._workCell);const T=this._workCell.getChars().length;this._workCell.getWidth()===2?(O++,K++):T>1&&(z+=T-1,L+=T-1),L++,K++}}L++;let q=B+j-D+N,te=Math.min(this._bufferService.cols,L-B+D+O-N-z);if(E||H.slice(B,L).trim()!==""){if(A&&q===0&&P.getCodePoint(0)!==32){const ee=R.lines.get(S[1]-1);if(ee&&P.isWrapped&&ee.getCodePoint(this._bufferService.cols-1)!==32){const K=this._getWordAt([this._bufferService.cols-1,S[1]-1],!1,!0,!1);if(K){const ce=this._bufferService.cols-K.start;q-=ce,te+=ce}}}if(M&&q+te===this._bufferService.cols&&P.getCodePoint(this._bufferService.cols-1)!==32){const ee=R.lines.get(S[1]+1);if(ee!=null&&ee.isWrapped&&ee.getCodePoint(0)!==32){const K=this._getWordAt([0,S[1]+1],!1,!1,!0);K&&(te+=K.length)}}return{start:q,length:te}}}_selectWordAt(S,E){const A=this._getWordAt(S,E);if(A){for(;A.start<0;)A.start+=this._bufferService.cols,S[1]--;this._model.selectionStart=[A.start,S[1]],this._model.selectionStartLength=A.length}}_selectToWordAt(S){const E=this._getWordAt(S,!0);if(E){let A=S[1];for(;E.start<0;)E.start+=this._bufferService.cols,A--;if(!this._model.areSelectionValuesReversed())for(;E.start+E.length>this._bufferService.cols;)E.length-=this._bufferService.cols,A++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?E.start:E.start+E.length,A]}}_isCharWordSeparator(S){return S.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(S.getChars())>=0}_selectLineAt(S){const E=this._bufferService.buffer.getWrappedRangeForLine(S),A={start:{x:0,y:E.first},end:{x:this._bufferService.cols-1,y:E.last}};this._model.selectionStart=[0,E.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,g.getRangeLength)(A,this._bufferService.cols)}};o.SelectionService=k=u([c(3,b.IBufferService),c(4,b.ICoreService),c(5,m.IMouseService),c(6,b.IOptionsService),c(7,m.IRenderService),c(8,m.ICoreBrowserService)],k)},4725:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.IThemeService=o.ICharacterJoinerService=o.ISelectionService=o.IRenderService=o.IMouseService=o.ICoreBrowserService=o.ICharSizeService=void 0;const u=l(8343);o.ICharSizeService=(0,u.createDecorator)("CharSizeService"),o.ICoreBrowserService=(0,u.createDecorator)("CoreBrowserService"),o.IMouseService=(0,u.createDecorator)("MouseService"),o.IRenderService=(0,u.createDecorator)("RenderService"),o.ISelectionService=(0,u.createDecorator)("SelectionService"),o.ICharacterJoinerService=(0,u.createDecorator)("CharacterJoinerService"),o.IThemeService=(0,u.createDecorator)("ThemeService")},6731:function(a,o,l){var u=this&&this.__decorate||function(k,S,E,A){var M,R=arguments.length,P=R<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,E):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(k,S,E,A);else for(var H=k.length-1;H>=0;H--)(M=k[H])&&(P=(R<3?M(P):R>3?M(S,E,P):M(S,E))||P);return R>3&&P&&Object.defineProperty(S,E,P),P},c=this&&this.__param||function(k,S){return function(E,A){S(E,A,k)}};Object.defineProperty(o,"__esModule",{value:!0}),o.ThemeService=o.DEFAULT_ANSI_COLORS=void 0;const h=l(7239),d=l(8055),p=l(8460),m=l(844),_=l(2585),f=d.css.toColor("#ffffff"),v=d.css.toColor("#000000"),g=d.css.toColor("#ffffff"),y=d.css.toColor("#000000"),b={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};o.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const k=[d.css.toColor("#2e3436"),d.css.toColor("#cc0000"),d.css.toColor("#4e9a06"),d.css.toColor("#c4a000"),d.css.toColor("#3465a4"),d.css.toColor("#75507b"),d.css.toColor("#06989a"),d.css.toColor("#d3d7cf"),d.css.toColor("#555753"),d.css.toColor("#ef2929"),d.css.toColor("#8ae234"),d.css.toColor("#fce94f"),d.css.toColor("#729fcf"),d.css.toColor("#ad7fa8"),d.css.toColor("#34e2e2"),d.css.toColor("#eeeeec")],S=[0,95,135,175,215,255];for(let E=0;E<216;E++){const A=S[E/36%6|0],M=S[E/6%6|0],R=S[E%6];k.push({css:d.channels.toCss(A,M,R),rgba:d.channels.toRgba(A,M,R)})}for(let E=0;E<24;E++){const A=8+10*E;k.push({css:d.channels.toCss(A,A,A),rgba:d.channels.toRgba(A,A,A)})}return k})());let w=o.ThemeService=class extends m.Disposable{get colors(){return this._colors}constructor(k){super(),this._optionsService=k,this._contrastCache=new h.ColorContrastCache,this._halfContrastCache=new h.ColorContrastCache,this._onChangeColors=this.register(new p.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:f,background:v,cursor:g,cursorAccent:y,selectionForeground:void 0,selectionBackgroundTransparent:b,selectionBackgroundOpaque:d.color.blend(v,b),selectionInactiveBackgroundTransparent:b,selectionInactiveBackgroundOpaque:d.color.blend(v,b),ansi:o.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(k={}){const S=this._colors;if(S.foreground=x(k.foreground,f),S.background=x(k.background,v),S.cursor=x(k.cursor,g),S.cursorAccent=x(k.cursorAccent,y),S.selectionBackgroundTransparent=x(k.selectionBackground,b),S.selectionBackgroundOpaque=d.color.blend(S.background,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundTransparent=x(k.selectionInactiveBackground,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundOpaque=d.color.blend(S.background,S.selectionInactiveBackgroundTransparent),S.selectionForeground=k.selectionForeground?x(k.selectionForeground,d.NULL_COLOR):void 0,S.selectionForeground===d.NULL_COLOR&&(S.selectionForeground=void 0),d.color.isOpaque(S.selectionBackgroundTransparent)&&(S.selectionBackgroundTransparent=d.color.opacity(S.selectionBackgroundTransparent,.3)),d.color.isOpaque(S.selectionInactiveBackgroundTransparent)&&(S.selectionInactiveBackgroundTransparent=d.color.opacity(S.selectionInactiveBackgroundTransparent,.3)),S.ansi=o.DEFAULT_ANSI_COLORS.slice(),S.ansi[0]=x(k.black,o.DEFAULT_ANSI_COLORS[0]),S.ansi[1]=x(k.red,o.DEFAULT_ANSI_COLORS[1]),S.ansi[2]=x(k.green,o.DEFAULT_ANSI_COLORS[2]),S.ansi[3]=x(k.yellow,o.DEFAULT_ANSI_COLORS[3]),S.ansi[4]=x(k.blue,o.DEFAULT_ANSI_COLORS[4]),S.ansi[5]=x(k.magenta,o.DEFAULT_ANSI_COLORS[5]),S.ansi[6]=x(k.cyan,o.DEFAULT_ANSI_COLORS[6]),S.ansi[7]=x(k.white,o.DEFAULT_ANSI_COLORS[7]),S.ansi[8]=x(k.brightBlack,o.DEFAULT_ANSI_COLORS[8]),S.ansi[9]=x(k.brightRed,o.DEFAULT_ANSI_COLORS[9]),S.ansi[10]=x(k.brightGreen,o.DEFAULT_ANSI_COLORS[10]),S.ansi[11]=x(k.brightYellow,o.DEFAULT_ANSI_COLORS[11]),S.ansi[12]=x(k.brightBlue,o.DEFAULT_ANSI_COLORS[12]),S.ansi[13]=x(k.brightMagenta,o.DEFAULT_ANSI_COLORS[13]),S.ansi[14]=x(k.brightCyan,o.DEFAULT_ANSI_COLORS[14]),S.ansi[15]=x(k.brightWhite,o.DEFAULT_ANSI_COLORS[15]),k.extendedAnsi){const E=Math.min(S.ansi.length-16,k.extendedAnsi.length);for(let A=0;A<E;A++)S.ansi[A+16]=x(k.extendedAnsi[A],o.DEFAULT_ANSI_COLORS[A+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(k){this._restoreColor(k),this._onChangeColors.fire(this.colors)}_restoreColor(k){if(k!==void 0)switch(k){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[k]=this._restoreColors.ansi[k]}else for(let S=0;S<this._restoreColors.ansi.length;++S)this._colors.ansi[S]=this._restoreColors.ansi[S]}modifyColors(k){k(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function x(k,S){if(k!==void 0)try{return d.css.toColor(k)}catch{}return S}o.ThemeService=w=u([c(0,_.IOptionsService)],w)},6349:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CircularList=void 0;const u=l(8460),c=l(844);class h extends c.Disposable{constructor(p){super(),this._maxLength=p,this.onDeleteEmitter=this.register(new u.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new u.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new u.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(p){if(this._maxLength===p)return;const m=new Array(p);for(let _=0;_<Math.min(p,this.length);_++)m[_]=this._array[this._getCyclicIndex(_)];this._array=m,this._maxLength=p,this._startIndex=0}get length(){return this._length}set length(p){if(p>this._length)for(let m=this._length;m<p;m++)this._array[m]=void 0;this._length=p}get(p){return this._array[this._getCyclicIndex(p)]}set(p,m){this._array[this._getCyclicIndex(p)]=m}push(p){this._array[this._getCyclicIndex(this._length)]=p,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(p,m,..._){if(m){for(let f=p;f<this._length-m;f++)this._array[this._getCyclicIndex(f)]=this._array[this._getCyclicIndex(f+m)];this._length-=m,this.onDeleteEmitter.fire({index:p,amount:m})}for(let f=this._length-1;f>=p;f--)this._array[this._getCyclicIndex(f+_.length)]=this._array[this._getCyclicIndex(f)];for(let f=0;f<_.length;f++)this._array[this._getCyclicIndex(p+f)]=_[f];if(_.length&&this.onInsertEmitter.fire({index:p,amount:_.length}),this._length+_.length>this._maxLength){const f=this._length+_.length-this._maxLength;this._startIndex+=f,this._length=this._maxLength,this.onTrimEmitter.fire(f)}else this._length+=_.length}trimStart(p){p>this._length&&(p=this._length),this._startIndex+=p,this._length-=p,this.onTrimEmitter.fire(p)}shiftElements(p,m,_){if(!(m<=0)){if(p<0||p>=this._length)throw new Error("start argument out of range");if(p+_<0)throw new Error("Cannot shift elements in list beyond index 0");if(_>0){for(let v=m-1;v>=0;v--)this.set(p+v+_,this.get(p+v));const f=p+m+_-this._length;if(f>0)for(this._length+=f;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let f=0;f<m;f++)this.set(p+f+_,this.get(p+f))}}_getCyclicIndex(p){return(this._startIndex+p)%this._maxLength}}o.CircularList=h},1439:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.clone=void 0,o.clone=function l(u,c=5){if(typeof u!="object")return u;const h=Array.isArray(u)?[]:{};for(const d in u)h[d]=c<=1?u[d]:u[d]&&l(u[d],c-1);return h}},8055:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.contrastRatio=o.toPaddedHex=o.rgba=o.rgb=o.css=o.color=o.channels=o.NULL_COLOR=void 0;const u=l(6114);let c=0,h=0,d=0,p=0;var m,_,f,v,g;function y(w){const x=w.toString(16);return x.length<2?"0"+x:x}function b(w,x){return w<x?(x+.05)/(w+.05):(w+.05)/(x+.05)}o.NULL_COLOR={css:"#00000000",rgba:0},function(w){w.toCss=function(x,k,S,E){return E!==void 0?`#${y(x)}${y(k)}${y(S)}${y(E)}`:`#${y(x)}${y(k)}${y(S)}`},w.toRgba=function(x,k,S,E=255){return(x<<24|k<<16|S<<8|E)>>>0}}(m||(o.channels=m={})),function(w){function x(k,S){return p=Math.round(255*S),[c,h,d]=g.toChannels(k.rgba),{css:m.toCss(c,h,d,p),rgba:m.toRgba(c,h,d,p)}}w.blend=function(k,S){if(p=(255&S.rgba)/255,p===1)return{css:S.css,rgba:S.rgba};const E=S.rgba>>24&255,A=S.rgba>>16&255,M=S.rgba>>8&255,R=k.rgba>>24&255,P=k.rgba>>16&255,H=k.rgba>>8&255;return c=R+Math.round((E-R)*p),h=P+Math.round((A-P)*p),d=H+Math.round((M-H)*p),{css:m.toCss(c,h,d),rgba:m.toRgba(c,h,d)}},w.isOpaque=function(k){return(255&k.rgba)==255},w.ensureContrastRatio=function(k,S,E){const A=g.ensureContrastRatio(k.rgba,S.rgba,E);if(A)return g.toColor(A>>24&255,A>>16&255,A>>8&255)},w.opaque=function(k){const S=(255|k.rgba)>>>0;return[c,h,d]=g.toChannels(S),{css:m.toCss(c,h,d),rgba:S}},w.opacity=x,w.multiplyOpacity=function(k,S){return p=255&k.rgba,x(k,p*S/255)},w.toColorRGB=function(k){return[k.rgba>>24&255,k.rgba>>16&255,k.rgba>>8&255]}}(_||(o.color=_={})),function(w){let x,k;if(!u.isNode){const S=document.createElement("canvas");S.width=1,S.height=1;const E=S.getContext("2d",{willReadFrequently:!0});E&&(x=E,x.globalCompositeOperation="copy",k=x.createLinearGradient(0,0,1,1))}w.toColor=function(S){if(S.match(/#[\da-f]{3,8}/i))switch(S.length){case 4:return c=parseInt(S.slice(1,2).repeat(2),16),h=parseInt(S.slice(2,3).repeat(2),16),d=parseInt(S.slice(3,4).repeat(2),16),g.toColor(c,h,d);case 5:return c=parseInt(S.slice(1,2).repeat(2),16),h=parseInt(S.slice(2,3).repeat(2),16),d=parseInt(S.slice(3,4).repeat(2),16),p=parseInt(S.slice(4,5).repeat(2),16),g.toColor(c,h,d,p);case 7:return{css:S,rgba:(parseInt(S.slice(1),16)<<8|255)>>>0};case 9:return{css:S,rgba:parseInt(S.slice(1),16)>>>0}}const E=S.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(E)return c=parseInt(E[1]),h=parseInt(E[2]),d=parseInt(E[3]),p=Math.round(255*(E[5]===void 0?1:parseFloat(E[5]))),g.toColor(c,h,d,p);if(!x||!k)throw new Error("css.toColor: Unsupported css format");if(x.fillStyle=k,x.fillStyle=S,typeof x.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(x.fillRect(0,0,1,1),[c,h,d,p]=x.getImageData(0,0,1,1).data,p!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:m.toRgba(c,h,d,p),css:S}}}(f||(o.css=f={})),function(w){function x(k,S,E){const A=k/255,M=S/255,R=E/255;return .2126*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))+.7152*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.0722*(R<=.03928?R/12.92:Math.pow((R+.055)/1.055,2.4))}w.relativeLuminance=function(k){return x(k>>16&255,k>>8&255,255&k)},w.relativeLuminance2=x}(v||(o.rgb=v={})),function(w){function x(S,E,A){const M=S>>24&255,R=S>>16&255,P=S>>8&255;let H=E>>24&255,B=E>>16&255,L=E>>8&255,j=b(v.relativeLuminance2(H,B,L),v.relativeLuminance2(M,R,P));for(;j<A&&(H>0||B>0||L>0);)H-=Math.max(0,Math.ceil(.1*H)),B-=Math.max(0,Math.ceil(.1*B)),L-=Math.max(0,Math.ceil(.1*L)),j=b(v.relativeLuminance2(H,B,L),v.relativeLuminance2(M,R,P));return(H<<24|B<<16|L<<8|255)>>>0}function k(S,E,A){const M=S>>24&255,R=S>>16&255,P=S>>8&255;let H=E>>24&255,B=E>>16&255,L=E>>8&255,j=b(v.relativeLuminance2(H,B,L),v.relativeLuminance2(M,R,P));for(;j<A&&(H<255||B<255||L<255);)H=Math.min(255,H+Math.ceil(.1*(255-H))),B=Math.min(255,B+Math.ceil(.1*(255-B))),L=Math.min(255,L+Math.ceil(.1*(255-L))),j=b(v.relativeLuminance2(H,B,L),v.relativeLuminance2(M,R,P));return(H<<24|B<<16|L<<8|255)>>>0}w.ensureContrastRatio=function(S,E,A){const M=v.relativeLuminance(S>>8),R=v.relativeLuminance(E>>8);if(b(M,R)<A){if(R<M){const B=x(S,E,A),L=b(M,v.relativeLuminance(B>>8));if(L<A){const j=k(S,E,A);return L>b(M,v.relativeLuminance(j>>8))?B:j}return B}const P=k(S,E,A),H=b(M,v.relativeLuminance(P>>8));if(H<A){const B=x(S,E,A);return H>b(M,v.relativeLuminance(B>>8))?P:B}return P}},w.reduceLuminance=x,w.increaseLuminance=k,w.toChannels=function(S){return[S>>24&255,S>>16&255,S>>8&255,255&S]},w.toColor=function(S,E,A,M){return{css:m.toCss(S,E,A,M),rgba:m.toRgba(S,E,A,M)}}}(g||(o.rgba=g={})),o.toPaddedHex=y,o.contrastRatio=b},8969:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreTerminal=void 0;const u=l(844),c=l(2585),h=l(4348),d=l(7866),p=l(744),m=l(7302),_=l(6975),f=l(8460),v=l(1753),g=l(1480),y=l(7994),b=l(9282),w=l(5435),x=l(5981),k=l(2660);let S=!1;class E extends u.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new f.EventEmitter),this._onScroll.event(M=>{var R;(R=this._onScrollApi)===null||R===void 0||R.fire(M.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(M){for(const R in M)this.optionsService.options[R]=M[R]}constructor(M){super(),this._windowsWrappingHeuristics=this.register(new u.MutableDisposable),this._onBinary=this.register(new f.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new f.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new f.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new f.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new f.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new f.EventEmitter),this._instantiationService=new h.InstantiationService,this.optionsService=this.register(new m.OptionsService(M)),this._instantiationService.setService(c.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(p.BufferService)),this._instantiationService.setService(c.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(d.LogService)),this._instantiationService.setService(c.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(_.CoreService)),this._instantiationService.setService(c.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(v.CoreMouseService)),this._instantiationService.setService(c.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(g.UnicodeService)),this._instantiationService.setService(c.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(y.CharsetService),this._instantiationService.setService(c.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(k.OscLinkService),this._instantiationService.setService(c.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new w.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,f.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,f.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,f.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,f.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new x.WriteBuffer((R,P)=>this._inputHandler.parse(R,P))),this.register((0,f.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(M,R){this._writeBuffer.write(M,R)}writeSync(M,R){this._logService.logLevel<=c.LogLevelEnum.WARN&&!S&&(this._logService.warn("writeSync is unreliable and will be removed soon."),S=!0),this._writeBuffer.writeSync(M,R)}resize(M,R){isNaN(M)||isNaN(R)||(M=Math.max(M,p.MINIMUM_COLS),R=Math.max(R,p.MINIMUM_ROWS),this._bufferService.resize(M,R))}scroll(M,R=!1){this._bufferService.scroll(M,R)}scrollLines(M,R,P){this._bufferService.scrollLines(M,R,P)}scrollPages(M){this.scrollLines(M*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(M){const R=M-this._bufferService.buffer.ydisp;R!==0&&this.scrollLines(R)}registerEscHandler(M,R){return this._inputHandler.registerEscHandler(M,R)}registerDcsHandler(M,R){return this._inputHandler.registerDcsHandler(M,R)}registerCsiHandler(M,R){return this._inputHandler.registerCsiHandler(M,R)}registerOscHandler(M,R){return this._inputHandler.registerOscHandler(M,R)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let M=!1;const R=this.optionsService.rawOptions.windowsPty;R&&R.buildNumber!==void 0&&R.buildNumber!==void 0?M=R.backend==="conpty"&&R.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(M=!0),M?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const M=[];M.push(this.onLineFeed(b.updateWindowsModeWrappedState.bind(null,this._bufferService))),M.push(this.registerCsiHandler({final:"H"},()=>((0,b.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,u.toDisposable)(()=>{for(const R of M)R.dispose()})}}}o.CoreTerminal=E},8460:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.forwardEvent=o.EventEmitter=void 0,o.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let u=0;u<this._listeners.length;u++)if(this._listeners[u]===l)return void this._listeners.splice(u,1)}}})),this._event}fire(l,u){const c=[];for(let h=0;h<this._listeners.length;h++)c.push(this._listeners[h]);for(let h=0;h<c.length;h++)c[h].call(void 0,l,u)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},o.forwardEvent=function(l,u){return l(c=>u.fire(c))}},5435:function(a,o,l){var u=this&&this.__decorate||function(j,D,O,N){var z,q=arguments.length,te=q<3?D:N===null?N=Object.getOwnPropertyDescriptor(D,O):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")te=Reflect.decorate(j,D,O,N);else for(var ee=j.length-1;ee>=0;ee--)(z=j[ee])&&(te=(q<3?z(te):q>3?z(D,O,te):z(D,O))||te);return q>3&&te&&Object.defineProperty(D,O,te),te},c=this&&this.__param||function(j,D){return function(O,N){D(O,N,j)}};Object.defineProperty(o,"__esModule",{value:!0}),o.InputHandler=o.WindowsOptionsReportType=void 0;const h=l(2584),d=l(7116),p=l(2015),m=l(844),_=l(482),f=l(8437),v=l(8460),g=l(643),y=l(511),b=l(3734),w=l(2585),x=l(6242),k=l(6351),S=l(5941),E={"(":0,")":1,"*":2,"+":3,"-":1,".":2},A=131072;function M(j,D){if(j>24)return D.setWinLines||!1;switch(j){case 1:return!!D.restoreWin;case 2:return!!D.minimizeWin;case 3:return!!D.setWinPosition;case 4:return!!D.setWinSizePixels;case 5:return!!D.raiseWin;case 6:return!!D.lowerWin;case 7:return!!D.refreshWin;case 8:return!!D.setWinSizeChars;case 9:return!!D.maximizeWin;case 10:return!!D.fullscreenWin;case 11:return!!D.getWinState;case 13:return!!D.getWinPosition;case 14:return!!D.getWinSizePixels;case 15:return!!D.getScreenSizePixels;case 16:return!!D.getCellSizePixels;case 18:return!!D.getWinSizeChars;case 19:return!!D.getScreenSizeChars;case 20:return!!D.getIconTitle;case 21:return!!D.getWinTitle;case 22:return!!D.pushTitle;case 23:return!!D.popTitle;case 24:return!!D.setWinLines}return!1}var R;(function(j){j[j.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",j[j.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(R||(o.WindowsOptionsReportType=R={}));let P=0;class H extends m.Disposable{getAttrData(){return this._curAttrData}constructor(D,O,N,z,q,te,ee,K,ce=new p.EscapeSequenceParser){super(),this._bufferService=D,this._charsetService=O,this._coreService=N,this._logService=z,this._optionsService=q,this._oscLinkService=te,this._coreMouseService=ee,this._unicodeService=K,this._parser=ce,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new _.StringToUtf32,this._utf8Decoder=new _.Utf8ToUtf32,this._workCell=new y.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new v.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new v.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new v.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new v.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new v.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new v.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new v.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new v.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new v.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new v.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new v.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new v.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new v.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new B(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(T=>this._activeBuffer=T.activeBuffer)),this._parser.setCsiHandlerFallback((T,$)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(T),params:$.toArray()})}),this._parser.setEscHandlerFallback(T=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(T)})}),this._parser.setExecuteHandlerFallback(T=>{this._logService.debug("Unknown EXECUTE code: ",{code:T})}),this._parser.setOscHandlerFallback((T,$,Z)=>{this._logService.debug("Unknown OSC code: ",{identifier:T,action:$,data:Z})}),this._parser.setDcsHandlerFallback((T,$,Z)=>{$==="HOOK"&&(Z=Z.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(T),action:$,payload:Z})}),this._parser.setPrintHandler((T,$,Z)=>this.print(T,$,Z)),this._parser.registerCsiHandler({final:"@"},T=>this.insertChars(T)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},T=>this.scrollLeft(T)),this._parser.registerCsiHandler({final:"A"},T=>this.cursorUp(T)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},T=>this.scrollRight(T)),this._parser.registerCsiHandler({final:"B"},T=>this.cursorDown(T)),this._parser.registerCsiHandler({final:"C"},T=>this.cursorForward(T)),this._parser.registerCsiHandler({final:"D"},T=>this.cursorBackward(T)),this._parser.registerCsiHandler({final:"E"},T=>this.cursorNextLine(T)),this._parser.registerCsiHandler({final:"F"},T=>this.cursorPrecedingLine(T)),this._parser.registerCsiHandler({final:"G"},T=>this.cursorCharAbsolute(T)),this._parser.registerCsiHandler({final:"H"},T=>this.cursorPosition(T)),this._parser.registerCsiHandler({final:"I"},T=>this.cursorForwardTab(T)),this._parser.registerCsiHandler({final:"J"},T=>this.eraseInDisplay(T,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},T=>this.eraseInDisplay(T,!0)),this._parser.registerCsiHandler({final:"K"},T=>this.eraseInLine(T,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},T=>this.eraseInLine(T,!0)),this._parser.registerCsiHandler({final:"L"},T=>this.insertLines(T)),this._parser.registerCsiHandler({final:"M"},T=>this.deleteLines(T)),this._parser.registerCsiHandler({final:"P"},T=>this.deleteChars(T)),this._parser.registerCsiHandler({final:"S"},T=>this.scrollUp(T)),this._parser.registerCsiHandler({final:"T"},T=>this.scrollDown(T)),this._parser.registerCsiHandler({final:"X"},T=>this.eraseChars(T)),this._parser.registerCsiHandler({final:"Z"},T=>this.cursorBackwardTab(T)),this._parser.registerCsiHandler({final:"`"},T=>this.charPosAbsolute(T)),this._parser.registerCsiHandler({final:"a"},T=>this.hPositionRelative(T)),this._parser.registerCsiHandler({final:"b"},T=>this.repeatPrecedingCharacter(T)),this._parser.registerCsiHandler({final:"c"},T=>this.sendDeviceAttributesPrimary(T)),this._parser.registerCsiHandler({prefix:">",final:"c"},T=>this.sendDeviceAttributesSecondary(T)),this._parser.registerCsiHandler({final:"d"},T=>this.linePosAbsolute(T)),this._parser.registerCsiHandler({final:"e"},T=>this.vPositionRelative(T)),this._parser.registerCsiHandler({final:"f"},T=>this.hVPosition(T)),this._parser.registerCsiHandler({final:"g"},T=>this.tabClear(T)),this._parser.registerCsiHandler({final:"h"},T=>this.setMode(T)),this._parser.registerCsiHandler({prefix:"?",final:"h"},T=>this.setModePrivate(T)),this._parser.registerCsiHandler({final:"l"},T=>this.resetMode(T)),this._parser.registerCsiHandler({prefix:"?",final:"l"},T=>this.resetModePrivate(T)),this._parser.registerCsiHandler({final:"m"},T=>this.charAttributes(T)),this._parser.registerCsiHandler({final:"n"},T=>this.deviceStatus(T)),this._parser.registerCsiHandler({prefix:"?",final:"n"},T=>this.deviceStatusPrivate(T)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},T=>this.softReset(T)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},T=>this.setCursorStyle(T)),this._parser.registerCsiHandler({final:"r"},T=>this.setScrollRegion(T)),this._parser.registerCsiHandler({final:"s"},T=>this.saveCursor(T)),this._parser.registerCsiHandler({final:"t"},T=>this.windowOptions(T)),this._parser.registerCsiHandler({final:"u"},T=>this.restoreCursor(T)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},T=>this.insertColumns(T)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},T=>this.deleteColumns(T)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},T=>this.selectProtected(T)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},T=>this.requestMode(T,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},T=>this.requestMode(T,!1)),this._parser.setExecuteHandler(h.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(h.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(h.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(h.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(h.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(h.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(h.C1.IND,()=>this.index()),this._parser.setExecuteHandler(h.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(h.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new x.OscHandler(T=>(this.setTitle(T),this.setIconName(T),!0))),this._parser.registerOscHandler(1,new x.OscHandler(T=>this.setIconName(T))),this._parser.registerOscHandler(2,new x.OscHandler(T=>this.setTitle(T))),this._parser.registerOscHandler(4,new x.OscHandler(T=>this.setOrReportIndexedColor(T))),this._parser.registerOscHandler(8,new x.OscHandler(T=>this.setHyperlink(T))),this._parser.registerOscHandler(10,new x.OscHandler(T=>this.setOrReportFgColor(T))),this._parser.registerOscHandler(11,new x.OscHandler(T=>this.setOrReportBgColor(T))),this._parser.registerOscHandler(12,new x.OscHandler(T=>this.setOrReportCursorColor(T))),this._parser.registerOscHandler(104,new x.OscHandler(T=>this.restoreIndexedColor(T))),this._parser.registerOscHandler(110,new x.OscHandler(T=>this.restoreFgColor(T))),this._parser.registerOscHandler(111,new x.OscHandler(T=>this.restoreBgColor(T))),this._parser.registerOscHandler(112,new x.OscHandler(T=>this.restoreCursorColor(T))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const T in d.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:T},()=>this.selectCharset("("+T)),this._parser.registerEscHandler({intermediates:")",final:T},()=>this.selectCharset(")"+T)),this._parser.registerEscHandler({intermediates:"*",final:T},()=>this.selectCharset("*"+T)),this._parser.registerEscHandler({intermediates:"+",final:T},()=>this.selectCharset("+"+T)),this._parser.registerEscHandler({intermediates:"-",final:T},()=>this.selectCharset("-"+T)),this._parser.registerEscHandler({intermediates:".",final:T},()=>this.selectCharset("."+T)),this._parser.registerEscHandler({intermediates:"/",final:T},()=>this.selectCharset("/"+T));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(T=>(this._logService.error("Parsing error: ",T),T)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new k.DcsHandler((T,$)=>this.requestStatusString(T,$)))}_preserveStack(D,O,N,z){this._parseStack.paused=!0,this._parseStack.cursorStartX=D,this._parseStack.cursorStartY=O,this._parseStack.decodedLength=N,this._parseStack.position=z}_logSlowResolvingAsync(D){this._logService.logLevel<=w.LogLevelEnum.WARN&&Promise.race([D,new Promise((O,N)=>setTimeout(()=>N("#SLOW_TIMEOUT"),5e3))]).catch(O=>{if(O!=="#SLOW_TIMEOUT")throw O;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(D,O){let N,z=this._activeBuffer.x,q=this._activeBuffer.y,te=0;const ee=this._parseStack.paused;if(ee){if(N=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,O))return this._logSlowResolvingAsync(N),N;z=this._parseStack.cursorStartX,q=this._parseStack.cursorStartY,this._parseStack.paused=!1,D.length>A&&(te=this._parseStack.position+A)}if(this._logService.logLevel<=w.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof D=="string"?` "${D}"`:` "${Array.prototype.map.call(D,K=>String.fromCharCode(K)).join("")}"`),typeof D=="string"?D.split("").map(K=>K.charCodeAt(0)):D),this._parseBuffer.length<D.length&&this._parseBuffer.length<A&&(this._parseBuffer=new Uint32Array(Math.min(D.length,A))),ee||this._dirtyRowTracker.clearRange(),D.length>A)for(let K=te;K<D.length;K+=A){const ce=K+A<D.length?K+A:D.length,T=typeof D=="string"?this._stringDecoder.decode(D.substring(K,ce),this._parseBuffer):this._utf8Decoder.decode(D.subarray(K,ce),this._parseBuffer);if(N=this._parser.parse(this._parseBuffer,T))return this._preserveStack(z,q,T,K),this._logSlowResolvingAsync(N),N}else if(!ee){const K=typeof D=="string"?this._stringDecoder.decode(D,this._parseBuffer):this._utf8Decoder.decode(D,this._parseBuffer);if(N=this._parser.parse(this._parseBuffer,K))return this._preserveStack(z,q,K,0),this._logSlowResolvingAsync(N),N}this._activeBuffer.x===z&&this._activeBuffer.y===q||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(D,O,N){let z,q;const te=this._charsetService.charset,ee=this._optionsService.rawOptions.screenReaderMode,K=this._bufferService.cols,ce=this._coreService.decPrivateModes.wraparound,T=this._coreService.modes.insertMode,$=this._curAttrData;let Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&N-O>0&&Z.getWidth(this._activeBuffer.x-1)===2&&Z.setCellFromCodePoint(this._activeBuffer.x-1,0,1,$.fg,$.bg,$.extended);for(let F=O;F<N;++F){if(z=D[F],q=this._unicodeService.wcwidth(z),z<127&&te){const V=te[String.fromCharCode(z)];V&&(z=V.charCodeAt(0))}if(ee&&this._onA11yChar.fire((0,_.stringFromCodePoint)(z)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),q||!this._activeBuffer.x){if(this._activeBuffer.x+q-1>=K){if(ce){for(;this._activeBuffer.x<K;)Z.setCellFromCodePoint(this._activeBuffer.x++,0,1,$.fg,$.bg,$.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=K-1,q===2)continue}if(T&&(Z.insertCells(this._activeBuffer.x,q,this._activeBuffer.getNullCell($),$),Z.getWidth(K-1)===2&&Z.setCellFromCodePoint(K-1,g.NULL_CELL_CODE,g.NULL_CELL_WIDTH,$.fg,$.bg,$.extended)),Z.setCellFromCodePoint(this._activeBuffer.x++,z,q,$.fg,$.bg,$.extended),q>0)for(;--q;)Z.setCellFromCodePoint(this._activeBuffer.x++,0,0,$.fg,$.bg,$.extended)}else Z.getWidth(this._activeBuffer.x-1)?Z.addCodepointToCell(this._activeBuffer.x-1,z):Z.addCodepointToCell(this._activeBuffer.x-2,z)}N-O>0&&(Z.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<K&&N-O>0&&Z.getWidth(this._activeBuffer.x)===0&&!Z.hasContent(this._activeBuffer.x)&&Z.setCellFromCodePoint(this._activeBuffer.x,0,1,$.fg,$.bg,$.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(D,O){return D.final!=="t"||D.prefix||D.intermediates?this._parser.registerCsiHandler(D,O):this._parser.registerCsiHandler(D,N=>!M(N.params[0],this._optionsService.rawOptions.windowOptions)||O(N))}registerDcsHandler(D,O){return this._parser.registerDcsHandler(D,new k.DcsHandler(O))}registerEscHandler(D,O){return this._parser.registerEscHandler(D,O)}registerOscHandler(D,O){return this._parser.registerOscHandler(D,new x.OscHandler(O))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var D;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||D===void 0)&&D.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);O.hasWidth(this._activeBuffer.x)&&!O.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const D=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-D),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(D=this._bufferService.cols-1){this._activeBuffer.x=Math.min(D,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(D,O){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=D,this._activeBuffer.y=this._activeBuffer.scrollTop+O):(this._activeBuffer.x=D,this._activeBuffer.y=O),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(D,O){this._restrictCursor(),this._setCursor(this._activeBuffer.x+D,this._activeBuffer.y+O)}cursorUp(D){const O=this._activeBuffer.y-this._activeBuffer.scrollTop;return O>=0?this._moveCursor(0,-Math.min(O,D.params[0]||1)):this._moveCursor(0,-(D.params[0]||1)),!0}cursorDown(D){const O=this._activeBuffer.scrollBottom-this._activeBuffer.y;return O>=0?this._moveCursor(0,Math.min(O,D.params[0]||1)):this._moveCursor(0,D.params[0]||1),!0}cursorForward(D){return this._moveCursor(D.params[0]||1,0),!0}cursorBackward(D){return this._moveCursor(-(D.params[0]||1),0),!0}cursorNextLine(D){return this.cursorDown(D),this._activeBuffer.x=0,!0}cursorPrecedingLine(D){return this.cursorUp(D),this._activeBuffer.x=0,!0}cursorCharAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(D){return this._setCursor(D.length>=2?(D.params[1]||1)-1:0,(D.params[0]||1)-1),!0}charPosAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(D){return this._moveCursor(D.params[0]||1,0),!0}linePosAbsolute(D){return this._setCursor(this._activeBuffer.x,(D.params[0]||1)-1),!0}vPositionRelative(D){return this._moveCursor(0,D.params[0]||1),!0}hVPosition(D){return this.cursorPosition(D),!0}tabClear(D){const O=D.params[0];return O===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:O===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=D.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=D.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(D){const O=D.params[0];return O===1&&(this._curAttrData.bg|=536870912),O!==2&&O!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(D,O,N,z=!1,q=!1){const te=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);te.replaceCells(O,N,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),q),z&&(te.isWrapped=!1)}_resetBufferLine(D,O=!1){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);N&&(N.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),O),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+D),N.isWrapped=!1)}eraseInDisplay(D,O=!1){let N;switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:for(N=this._activeBuffer.y,this._dirtyRowTracker.markDirty(N),this._eraseInBufferLine(N++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);N<this._bufferService.rows;N++)this._resetBufferLine(N,O);this._dirtyRowTracker.markDirty(N);break;case 1:for(N=this._activeBuffer.y,this._dirtyRowTracker.markDirty(N),this._eraseInBufferLine(N,0,this._activeBuffer.x+1,!0,O),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(N+1).isWrapped=!1);N--;)this._resetBufferLine(N,O);this._dirtyRowTracker.markDirty(0);break;case 2:for(N=this._bufferService.rows,this._dirtyRowTracker.markDirty(N-1);N--;)this._resetBufferLine(N,O);this._dirtyRowTracker.markDirty(0);break;case 3:const z=this._activeBuffer.lines.length-this._bufferService.rows;z>0&&(this._activeBuffer.lines.trimStart(z),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-z,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-z,0),this._onScroll.fire(0))}return!0}eraseInLine(D,O=!1){switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,O);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,O)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(D){this._restrictCursor();let O=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const N=this._activeBuffer.ybase+this._activeBuffer.y,z=this._bufferService.rows-1-this._activeBuffer.scrollBottom,q=this._bufferService.rows-1+this._activeBuffer.ybase-z+1;for(;O--;)this._activeBuffer.lines.splice(q-1,1),this._activeBuffer.lines.splice(N,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(D){this._restrictCursor();let O=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const N=this._activeBuffer.ybase+this._activeBuffer.y;let z;for(z=this._bufferService.rows-1-this._activeBuffer.scrollBottom,z=this._bufferService.rows-1+this._activeBuffer.ybase-z;O--;)this._activeBuffer.lines.splice(N,1),this._activeBuffer.lines.splice(z,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(D){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.insertCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(D){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.deleteCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(D){let O=D.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(D){let O=D.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(f.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);z.deleteCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);z.insertCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);z.insertCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);z.deleteCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(D){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(D.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(D){if(!this._parser.precedingCodepoint)return!0;const O=D.params[0]||1,N=new Uint32Array(O);for(let z=0;z<O;++z)N[z]=this._parser.precedingCodepoint;return this.print(N,0,N.length),!0}sendDeviceAttributesPrimary(D){return D.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(h.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(h.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(D){return D.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(h.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(h.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(D.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(h.C0.ESC+"[>83;40003;0c")),!0}_is(D){return(this._optionsService.rawOptions.termName+"").indexOf(D)===0}setMode(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),this._charsetService.setgCharset(1,d.DEFAULT_CHARSET),this._charsetService.setgCharset(2,d.DEFAULT_CHARSET),this._charsetService.setgCharset(3,d.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),D.params[O]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(D,O){const N=this._coreService.decPrivateModes,{activeProtocol:z,activeEncoding:q}=this._coreMouseService,te=this._coreService,{buffers:ee,cols:K}=this._bufferService,{active:ce,alt:T}=ee,$=this._optionsService.rawOptions,Z=W=>W?1:2,F=D.params[0];return V=F,G=O?F===2?4:F===4?Z(te.modes.insertMode):F===12?3:F===20?Z($.convertEol):0:F===1?Z(N.applicationCursorKeys):F===3?$.windowOptions.setWinLines?K===80?2:K===132?1:0:0:F===6?Z(N.origin):F===7?Z(N.wraparound):F===8?3:F===9?Z(z==="X10"):F===12?Z($.cursorBlink):F===25?Z(!te.isCursorHidden):F===45?Z(N.reverseWraparound):F===66?Z(N.applicationKeypad):F===67?4:F===1e3?Z(z==="VT200"):F===1002?Z(z==="DRAG"):F===1003?Z(z==="ANY"):F===1004?Z(N.sendFocus):F===1005?4:F===1006?Z(q==="SGR"):F===1015?4:F===1016?Z(q==="SGR_PIXELS"):F===1048?1:F===47||F===1047||F===1049?Z(ce===T):F===2004?Z(N.bracketedPasteMode):0,te.triggerDataEvent(`${h.C0.ESC}[${O?"":"?"}${V};${G}$y`),!0;var V,G}_updateAttrColor(D,O,N,z,q){return O===2?(D|=50331648,D&=-16777216,D|=b.AttributeData.fromColorRGB([N,z,q])):O===5&&(D&=-50331904,D|=33554432|255&N),D}_extractColor(D,O,N){const z=[0,0,-1,0,0,0];let q=0,te=0;do{if(z[te+q]=D.params[O+te],D.hasSubParams(O+te)){const ee=D.getSubParams(O+te);let K=0;do z[1]===5&&(q=1),z[te+K+1+q]=ee[K];while(++K<ee.length&&K+te+1+q<z.length);break}if(z[1]===5&&te+q>=2||z[1]===2&&te+q>=5)break;z[1]&&(q=1)}while(++te+O<D.length&&te+q<z.length);for(let ee=2;ee<z.length;++ee)z[ee]===-1&&(z[ee]=0);switch(z[0]){case 38:N.fg=this._updateAttrColor(N.fg,z[1],z[3],z[4],z[5]);break;case 48:N.bg=this._updateAttrColor(N.bg,z[1],z[3],z[4],z[5]);break;case 58:N.extended=N.extended.clone(),N.extended.underlineColor=this._updateAttrColor(N.extended.underlineColor,z[1],z[3],z[4],z[5])}return te}_processUnderline(D,O){O.extended=O.extended.clone(),(!~D||D>5)&&(D=1),O.extended.underlineStyle=D,O.fg|=268435456,D===0&&(O.fg&=-268435457),O.updateExtended()}_processSGR0(D){D.fg=f.DEFAULT_ATTR_DATA.fg,D.bg=f.DEFAULT_ATTR_DATA.bg,D.extended=D.extended.clone(),D.extended.underlineStyle=0,D.extended.underlineColor&=-67108864,D.updateExtended()}charAttributes(D){if(D.length===1&&D.params[0]===0)return this._processSGR0(this._curAttrData),!0;const O=D.length;let N;const z=this._curAttrData;for(let q=0;q<O;q++)N=D.params[q],N>=30&&N<=37?(z.fg&=-50331904,z.fg|=16777216|N-30):N>=40&&N<=47?(z.bg&=-50331904,z.bg|=16777216|N-40):N>=90&&N<=97?(z.fg&=-50331904,z.fg|=16777224|N-90):N>=100&&N<=107?(z.bg&=-50331904,z.bg|=16777224|N-100):N===0?this._processSGR0(z):N===1?z.fg|=134217728:N===3?z.bg|=67108864:N===4?(z.fg|=268435456,this._processUnderline(D.hasSubParams(q)?D.getSubParams(q)[0]:1,z)):N===5?z.fg|=536870912:N===7?z.fg|=67108864:N===8?z.fg|=1073741824:N===9?z.fg|=2147483648:N===2?z.bg|=134217728:N===21?this._processUnderline(2,z):N===22?(z.fg&=-134217729,z.bg&=-134217729):N===23?z.bg&=-67108865:N===24?(z.fg&=-268435457,this._processUnderline(0,z)):N===25?z.fg&=-536870913:N===27?z.fg&=-67108865:N===28?z.fg&=-1073741825:N===29?z.fg&=2147483647:N===39?(z.fg&=-67108864,z.fg|=16777215&f.DEFAULT_ATTR_DATA.fg):N===49?(z.bg&=-67108864,z.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):N===38||N===48||N===58?q+=this._extractColor(D,q,z):N===53?z.bg|=1073741824:N===55?z.bg&=-1073741825:N===59?(z.extended=z.extended.clone(),z.extended.underlineColor=-1,z.updateExtended()):N===100?(z.fg&=-67108864,z.fg|=16777215&f.DEFAULT_ATTR_DATA.fg,z.bg&=-67108864,z.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",N);return!0}deviceStatus(D){switch(D.params[0]){case 5:this._coreService.triggerDataEvent(`${h.C0.ESC}[0n`);break;case 6:const O=this._activeBuffer.y+1,N=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[${O};${N}R`)}return!0}deviceStatusPrivate(D){if(D.params[0]===6){const O=this._activeBuffer.y+1,N=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[?${O};${N}R`)}return!0}softReset(D){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(D){const O=D.params[0]||1;switch(O){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const N=O%2==1;return this._optionsService.options.cursorBlink=N,!0}setScrollRegion(D){const O=D.params[0]||1;let N;return(D.length<2||(N=D.params[1])>this._bufferService.rows||N===0)&&(N=this._bufferService.rows),N>O&&(this._activeBuffer.scrollTop=O-1,this._activeBuffer.scrollBottom=N-1,this._setCursor(0,0)),!0}windowOptions(D){if(!M(D.params[0],this._optionsService.rawOptions.windowOptions))return!0;const O=D.length>1?D.params[1]:0;switch(D.params[0]){case 14:O!==2&&this._onRequestWindowsOptionsReport.fire(R.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(R.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${h.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:O!==0&&O!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),O!==0&&O!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:O!==0&&O!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),O!==0&&O!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(D){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(D){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(D){return this._windowTitle=D,this._onTitleChange.fire(D),!0}setIconName(D){return this._iconName=D,!0}setOrReportIndexedColor(D){const O=[],N=D.split(";");for(;N.length>1;){const z=N.shift(),q=N.shift();if(/^\d+$/.exec(z)){const te=parseInt(z);if(L(te))if(q==="?")O.push({type:0,index:te});else{const ee=(0,S.parseColor)(q);ee&&O.push({type:1,index:te,color:ee})}}}return O.length&&this._onColor.fire(O),!0}setHyperlink(D){const O=D.split(";");return!(O.length<2)&&(O[1]?this._createHyperlink(O[0],O[1]):!O[0]&&this._finishHyperlink())}_createHyperlink(D,O){this._getCurrentLinkId()&&this._finishHyperlink();const N=D.split(":");let z;const q=N.findIndex(te=>te.startsWith("id="));return q!==-1&&(z=N[q].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:z,uri:O}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(D,O){const N=D.split(";");for(let z=0;z<N.length&&!(O>=this._specialColors.length);++z,++O)if(N[z]==="?")this._onColor.fire([{type:0,index:this._specialColors[O]}]);else{const q=(0,S.parseColor)(N[z]);q&&this._onColor.fire([{type:1,index:this._specialColors[O],color:q}])}return!0}setOrReportFgColor(D){return this._setOrReportSpecialColor(D,0)}setOrReportBgColor(D){return this._setOrReportSpecialColor(D,1)}setOrReportCursorColor(D){return this._setOrReportSpecialColor(D,2)}restoreIndexedColor(D){if(!D)return this._onColor.fire([{type:2}]),!0;const O=[],N=D.split(";");for(let z=0;z<N.length;++z)if(/^\d+$/.exec(N[z])){const q=parseInt(N[z]);L(q)&&O.push({type:2,index:q})}return O.length&&this._onColor.fire(O),!0}restoreFgColor(D){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(D){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(D){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),!0}selectCharset(D){return D.length!==2?(this.selectDefaultCharset(),!0):(D[0]==="/"||this._charsetService.setgCharset(E[D[0]],d.CHARSETS[D[1]]||d.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const D=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,D,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(D){return this._charsetService.setgLevel(D),!0}screenAlignmentPattern(){const D=new y.CellData;D.content=4194373,D.fg=this._curAttrData.fg,D.bg=this._curAttrData.bg,this._setCursor(0,0);for(let O=0;O<this._bufferService.rows;++O){const N=this._activeBuffer.ybase+this._activeBuffer.y+O,z=this._activeBuffer.lines.get(N);z&&(z.fill(D),z.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(D,O){const N=this._bufferService.buffer,z=this._optionsService.rawOptions;return(q=>(this._coreService.triggerDataEvent(`${h.C0.ESC}${q}${h.C0.ESC}\\`),!0))(D==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:D==='"p'?'P1$r61;1"p':D==="r"?`P1$r${N.scrollTop+1};${N.scrollBottom+1}r`:D==="m"?"P1$r0m":D===" q"?`P1$r${{block:2,underline:4,bar:6}[z.cursorStyle]-(z.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(D,O){this._dirtyRowTracker.markRangeDirty(D,O)}}o.InputHandler=H;let B=class{constructor(j){this._bufferService=j,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(j){j<this.start?this.start=j:j>this.end&&(this.end=j)}markRangeDirty(j,D){j>D&&(P=j,j=D,D=P),j<this.start&&(this.start=j),D>this.end&&(this.end=D)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function L(j){return 0<=j&&j<256}B=u([c(0,w.IBufferService)],B)},844:(a,o)=>{function l(u){for(const c of u)c.dispose();u.length=0}Object.defineProperty(o,"__esModule",{value:!0}),o.getDisposeArrayDisposable=o.disposeArray=o.toDisposable=o.MutableDisposable=o.Disposable=void 0,o.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const u of this._disposables)u.dispose();this._disposables.length=0}register(u){return this._disposables.push(u),u}unregister(u){const c=this._disposables.indexOf(u);c!==-1&&this._disposables.splice(c,1)}},o.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(u){var c;this._isDisposed||u===this._value||((c=this._value)===null||c===void 0||c.dispose(),this._value=u)}clear(){this.value=void 0}dispose(){var u;this._isDisposed=!0,(u=this._value)===null||u===void 0||u.dispose(),this._value=void 0}},o.toDisposable=function(u){return{dispose:u}},o.disposeArray=l,o.getDisposeArrayDisposable=function(u){return{dispose:()=>l(u)}}},1505:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FourKeyMap=o.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(c,h,d){this._data[c]||(this._data[c]={}),this._data[c][h]=d}get(c,h){return this._data[c]?this._data[c][h]:void 0}clear(){this._data={}}}o.TwoKeyMap=l,o.FourKeyMap=class{constructor(){this._data=new l}set(u,c,h,d,p){this._data.get(u,c)||this._data.set(u,c,new l),this._data.get(u,c).set(h,d,p)}get(u,c,h,d){var p;return(p=this._data.get(u,c))===null||p===void 0?void 0:p.get(h,d)}clear(){this._data.clear()}}},6114:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isChromeOS=o.isLinux=o.isWindows=o.isIphone=o.isIpad=o.isMac=o.getSafariVersion=o.isSafari=o.isLegacyEdge=o.isFirefox=o.isNode=void 0,o.isNode=typeof navigator>"u";const l=o.isNode?"node":navigator.userAgent,u=o.isNode?"node":navigator.platform;o.isFirefox=l.includes("Firefox"),o.isLegacyEdge=l.includes("Edge"),o.isSafari=/^((?!chrome|android).)*safari/i.test(l),o.getSafariVersion=function(){if(!o.isSafari)return 0;const c=l.match(/Version\/(\d+)/);return c===null||c.length<2?0:parseInt(c[1])},o.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(u),o.isIpad=u==="iPad",o.isIphone=u==="iPhone",o.isWindows=["Windows","Win16","Win32","WinCE"].includes(u),o.isLinux=u.indexOf("Linux")>=0,o.isChromeOS=/\bCrOS\b/.test(l)},6106:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SortedList=void 0;let l=0;o.SortedList=class{constructor(u){this._getKey=u,this._array=[]}clear(){this._array.length=0}insert(u){this._array.length!==0?(l=this._search(this._getKey(u)),this._array.splice(l,0,u)):this._array.push(u)}delete(u){if(this._array.length===0)return!1;const c=this._getKey(u);if(c===void 0||(l=this._search(c),l===-1)||this._getKey(this._array[l])!==c)return!1;do if(this._array[l]===u)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===c);return!1}*getKeyIterator(u){if(this._array.length!==0&&(l=this._search(u),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===u))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===u)}forEachByKey(u,c){if(this._array.length!==0&&(l=this._search(u),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===u))do c(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===u)}values(){return[...this._array].values()}_search(u){let c=0,h=this._array.length-1;for(;h>=c;){let d=c+h>>1;const p=this._getKey(this._array[d]);if(p>u)h=d-1;else{if(!(p<u)){for(;d>0&&this._getKey(this._array[d-1])===u;)d--;return d}c=d+1}}return c}}},7226:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DebouncedIdleTask=o.IdleTaskQueue=o.PriorityTaskQueue=void 0;const u=l(6114);class c{constructor(){this._tasks=[],this._i=0}enqueue(p){this._tasks.push(p),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(p){this._idleCallback=void 0;let m=0,_=0,f=p.timeRemaining(),v=0;for(;this._i<this._tasks.length;){if(m=Date.now(),this._tasks[this._i]()||this._i++,m=Math.max(1,Date.now()-m),_=Math.max(m,_),v=p.timeRemaining(),1.5*_>v)return f-m<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(f-m))}ms`),void this._start();f=v}this.clear()}}class h extends c{_requestCallback(p){return setTimeout(()=>p(this._createDeadline(16)))}_cancelCallback(p){clearTimeout(p)}_createDeadline(p){const m=Date.now()+p;return{timeRemaining:()=>Math.max(0,m-Date.now())}}}o.PriorityTaskQueue=h,o.IdleTaskQueue=!u.isNode&&"requestIdleCallback"in window?class extends c{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:h,o.DebouncedIdleTask=class{constructor(){this._queue=new o.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},9282:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.updateWindowsModeWrappedState=void 0;const u=l(643);o.updateWindowsModeWrappedState=function(c){const h=c.buffer.lines.get(c.buffer.ybase+c.buffer.y-1),d=h==null?void 0:h.get(c.cols-1),p=c.buffer.lines.get(c.buffer.ybase+c.buffer.y);p&&d&&(p.isWrapped=d[u.CHAR_DATA_CODE_INDEX]!==u.NULL_CELL_CODE&&d[u.CHAR_DATA_CODE_INDEX]!==u.WHITESPACE_CELL_CODE)}},3734:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ExtendedAttrs=o.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new u}static toColorRGB(h){return[h>>>16&255,h>>>8&255,255&h]}static fromColorRGB(h){return(255&h[0])<<16|(255&h[1])<<8|255&h[2]}clone(){const h=new l;return h.fg=this.fg,h.bg=this.bg,h.extended=this.extended.clone(),h}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}o.AttributeData=l;class u{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(h){this._ext=h}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(h){this._ext&=-469762049,this._ext|=h<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(h){this._ext&=-67108864,this._ext|=67108863&h}get urlId(){return this._urlId}set urlId(h){this._urlId=h}constructor(h=0,d=0){this._ext=0,this._urlId=0,this._ext=h,this._urlId=d}clone(){return new u(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}o.ExtendedAttrs=u},9092:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Buffer=o.MAX_BUFFER_SIZE=void 0;const u=l(6349),c=l(7226),h=l(3734),d=l(8437),p=l(4634),m=l(511),_=l(643),f=l(4863),v=l(7116);o.MAX_BUFFER_SIZE=4294967295,o.Buffer=class{constructor(g,y,b){this._hasScrollback=g,this._optionsService=y,this._bufferService=b,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=d.DEFAULT_ATTR_DATA.clone(),this.savedCharset=v.DEFAULT_CHARSET,this.markers=[],this._nullCell=m.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=m.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new c.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(g){return g?(this._nullCell.fg=g.fg,this._nullCell.bg=g.bg,this._nullCell.extended=g.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new h.ExtendedAttrs),this._nullCell}getWhitespaceCell(g){return g?(this._whitespaceCell.fg=g.fg,this._whitespaceCell.bg=g.bg,this._whitespaceCell.extended=g.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new h.ExtendedAttrs),this._whitespaceCell}getBlankLine(g,y){return new d.BufferLine(this._bufferService.cols,this.getNullCell(g),y)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const g=this.ybase+this.y-this.ydisp;return g>=0&&g<this._rows}_getCorrectBufferLength(g){if(!this._hasScrollback)return g;const y=g+this._optionsService.rawOptions.scrollback;return y>o.MAX_BUFFER_SIZE?o.MAX_BUFFER_SIZE:y}fillViewportRows(g){if(this.lines.length===0){g===void 0&&(g=d.DEFAULT_ATTR_DATA);let y=this._rows;for(;y--;)this.lines.push(this.getBlankLine(g))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(g,y){const b=this.getNullCell(d.DEFAULT_ATTR_DATA);let w=0;const x=this._getCorrectBufferLength(y);if(x>this.lines.maxLength&&(this.lines.maxLength=x),this.lines.length>0){if(this._cols<g)for(let S=0;S<this.lines.length;S++)w+=+this.lines.get(S).resize(g,b);let k=0;if(this._rows<y)for(let S=this._rows;S<y;S++)this.lines.length<y+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new d.BufferLine(g,b)):this.ybase>0&&this.lines.length<=this.ybase+this.y+k+1?(this.ybase--,k++,this.ydisp>0&&this.ydisp--):this.lines.push(new d.BufferLine(g,b)));else for(let S=this._rows;S>y;S--)this.lines.length>y+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(x<this.lines.maxLength){const S=this.lines.length-x;S>0&&(this.lines.trimStart(S),this.ybase=Math.max(this.ybase-S,0),this.ydisp=Math.max(this.ydisp-S,0),this.savedY=Math.max(this.savedY-S,0)),this.lines.maxLength=x}this.x=Math.min(this.x,g-1),this.y=Math.min(this.y,y-1),k&&(this.y+=k),this.savedX=Math.min(this.savedX,g-1),this.scrollTop=0}if(this.scrollBottom=y-1,this._isReflowEnabled&&(this._reflow(g,y),this._cols>g))for(let k=0;k<this.lines.length;k++)w+=+this.lines.get(k).resize(g,b);this._cols=g,this._rows=y,this._memoryCleanupQueue.clear(),w>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let g=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,g=!1);let y=0;for(;this._memoryCleanupPosition<this.lines.length;)if(y+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),y>100)return!0;return g}get _isReflowEnabled(){const g=this._optionsService.rawOptions.windowsPty;return g&&g.buildNumber?this._hasScrollback&&g.backend==="conpty"&&g.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(g,y){this._cols!==g&&(g>this._cols?this._reflowLarger(g,y):this._reflowSmaller(g,y))}_reflowLarger(g,y){const b=(0,p.reflowLargerGetLinesToRemove)(this.lines,this._cols,g,this.ybase+this.y,this.getNullCell(d.DEFAULT_ATTR_DATA));if(b.length>0){const w=(0,p.reflowLargerCreateNewLayout)(this.lines,b);(0,p.reflowLargerApplyNewLayout)(this.lines,w.layout),this._reflowLargerAdjustViewport(g,y,w.countRemoved)}}_reflowLargerAdjustViewport(g,y,b){const w=this.getNullCell(d.DEFAULT_ATTR_DATA);let x=b;for(;x-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<y&&this.lines.push(new d.BufferLine(g,w))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-b,0)}_reflowSmaller(g,y){const b=this.getNullCell(d.DEFAULT_ATTR_DATA),w=[];let x=0;for(let k=this.lines.length-1;k>=0;k--){let S=this.lines.get(k);if(!S||!S.isWrapped&&S.getTrimmedLength()<=g)continue;const E=[S];for(;S.isWrapped&&k>0;)S=this.lines.get(--k),E.unshift(S);const A=this.ybase+this.y;if(A>=k&&A<k+E.length)continue;const M=E[E.length-1].getTrimmedLength(),R=(0,p.reflowSmallerGetNewLineLengths)(E,this._cols,g),P=R.length-E.length;let H;H=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+P):Math.max(0,this.lines.length-this.lines.maxLength+P);const B=[];for(let z=0;z<P;z++){const q=this.getBlankLine(d.DEFAULT_ATTR_DATA,!0);B.push(q)}B.length>0&&(w.push({start:k+E.length+x,newLines:B}),x+=B.length),E.push(...B);let L=R.length-1,j=R[L];j===0&&(L--,j=R[L]);let D=E.length-P-1,O=M;for(;D>=0;){const z=Math.min(O,j);if(E[L]===void 0)break;if(E[L].copyCellsFrom(E[D],O-z,j-z,z,!0),j-=z,j===0&&(L--,j=R[L]),O-=z,O===0){D--;const q=Math.max(D,0);O=(0,p.getWrappedLineTrimmedLength)(E,q,this._cols)}}for(let z=0;z<E.length;z++)R[z]<g&&E[z].setCell(R[z],b);let N=P-H;for(;N-- >0;)this.ybase===0?this.y<y-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+x)-y&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+P,this.ybase+y-1)}if(w.length>0){const k=[],S=[];for(let L=0;L<this.lines.length;L++)S.push(this.lines.get(L));const E=this.lines.length;let A=E-1,M=0,R=w[M];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+x);let P=0;for(let L=Math.min(this.lines.maxLength-1,E+x-1);L>=0;L--)if(R&&R.start>A+P){for(let j=R.newLines.length-1;j>=0;j--)this.lines.set(L--,R.newLines[j]);L++,k.push({index:A+1,amount:R.newLines.length}),P+=R.newLines.length,R=w[++M]}else this.lines.set(L,S[A--]);let H=0;for(let L=k.length-1;L>=0;L--)k[L].index+=H,this.lines.onInsertEmitter.fire(k[L]),H+=k[L].amount;const B=Math.max(0,E+x-this.lines.maxLength);B>0&&this.lines.onTrimEmitter.fire(B)}}translateBufferLineToString(g,y,b=0,w){const x=this.lines.get(g);return x?x.translateToString(y,b,w):""}getWrappedRangeForLine(g){let y=g,b=g;for(;y>0&&this.lines.get(y).isWrapped;)y--;for(;b+1<this.lines.length&&this.lines.get(b+1).isWrapped;)b++;return{first:y,last:b}}setupTabStops(g){for(g!=null?this.tabs[g]||(g=this.prevStop(g)):(this.tabs={},g=0);g<this._cols;g+=this._optionsService.rawOptions.tabStopWidth)this.tabs[g]=!0}prevStop(g){for(g==null&&(g=this.x);!this.tabs[--g]&&g>0;);return g>=this._cols?this._cols-1:g<0?0:g}nextStop(g){for(g==null&&(g=this.x);!this.tabs[++g]&&g<this._cols;);return g>=this._cols?this._cols-1:g<0?0:g}clearMarkers(g){this._isClearing=!0;for(let y=0;y<this.markers.length;y++)this.markers[y].line===g&&(this.markers[y].dispose(),this.markers.splice(y--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let g=0;g<this.markers.length;g++)this.markers[g].dispose(),this.markers.splice(g--,1);this._isClearing=!1}addMarker(g){const y=new f.Marker(g);return this.markers.push(y),y.register(this.lines.onTrim(b=>{y.line-=b,y.line<0&&y.dispose()})),y.register(this.lines.onInsert(b=>{y.line>=b.index&&(y.line+=b.amount)})),y.register(this.lines.onDelete(b=>{y.line>=b.index&&y.line<b.index+b.amount&&y.dispose(),y.line>b.index&&(y.line-=b.amount)})),y.register(y.onDispose(()=>this._removeMarker(y))),y}_removeMarker(g){this._isClearing||this.markers.splice(this.markers.indexOf(g),1)}}},8437:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLine=o.DEFAULT_ATTR_DATA=void 0;const u=l(3734),c=l(511),h=l(643),d=l(482);o.DEFAULT_ATTR_DATA=Object.freeze(new u.AttributeData);let p=0;class m{constructor(f,v,g=!1){this.isWrapped=g,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*f);const y=v||c.CellData.fromCharData([0,h.NULL_CELL_CHAR,h.NULL_CELL_WIDTH,h.NULL_CELL_CODE]);for(let b=0;b<f;++b)this.setCell(b,y);this.length=f}get(f){const v=this._data[3*f+0],g=2097151&v;return[this._data[3*f+1],2097152&v?this._combined[f]:g?(0,d.stringFromCodePoint)(g):"",v>>22,2097152&v?this._combined[f].charCodeAt(this._combined[f].length-1):g]}set(f,v){this._data[3*f+1]=v[h.CHAR_DATA_ATTR_INDEX],v[h.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[f]=v[1],this._data[3*f+0]=2097152|f|v[h.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*f+0]=v[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[h.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(f){return this._data[3*f+0]>>22}hasWidth(f){return 12582912&this._data[3*f+0]}getFg(f){return this._data[3*f+1]}getBg(f){return this._data[3*f+2]}hasContent(f){return 4194303&this._data[3*f+0]}getCodePoint(f){const v=this._data[3*f+0];return 2097152&v?this._combined[f].charCodeAt(this._combined[f].length-1):2097151&v}isCombined(f){return 2097152&this._data[3*f+0]}getString(f){const v=this._data[3*f+0];return 2097152&v?this._combined[f]:2097151&v?(0,d.stringFromCodePoint)(2097151&v):""}isProtected(f){return 536870912&this._data[3*f+2]}loadCell(f,v){return p=3*f,v.content=this._data[p+0],v.fg=this._data[p+1],v.bg=this._data[p+2],2097152&v.content&&(v.combinedData=this._combined[f]),268435456&v.bg&&(v.extended=this._extendedAttrs[f]),v}setCell(f,v){2097152&v.content&&(this._combined[f]=v.combinedData),268435456&v.bg&&(this._extendedAttrs[f]=v.extended),this._data[3*f+0]=v.content,this._data[3*f+1]=v.fg,this._data[3*f+2]=v.bg}setCellFromCodePoint(f,v,g,y,b,w){268435456&b&&(this._extendedAttrs[f]=w),this._data[3*f+0]=v|g<<22,this._data[3*f+1]=y,this._data[3*f+2]=b}addCodepointToCell(f,v){let g=this._data[3*f+0];2097152&g?this._combined[f]+=(0,d.stringFromCodePoint)(v):(2097151&g?(this._combined[f]=(0,d.stringFromCodePoint)(2097151&g)+(0,d.stringFromCodePoint)(v),g&=-2097152,g|=2097152):g=v|4194304,this._data[3*f+0]=g)}insertCells(f,v,g,y){if((f%=this.length)&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f-1,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs),v<this.length-f){const b=new c.CellData;for(let w=this.length-f-v-1;w>=0;--w)this.setCell(f+v+w,this.loadCell(f+w,b));for(let w=0;w<v;++w)this.setCell(f+w,g)}else for(let b=f;b<this.length;++b)this.setCell(b,g);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs)}deleteCells(f,v,g,y){if(f%=this.length,v<this.length-f){const b=new c.CellData;for(let w=0;w<this.length-f-v;++w)this.setCell(f+w,this.loadCell(f+v+w,b));for(let w=this.length-v;w<this.length;++w)this.setCell(w,g)}else for(let b=f;b<this.length;++b)this.setCell(b,g);f&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f-1,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs),this.getWidth(f)!==0||this.hasContent(f)||this.setCellFromCodePoint(f,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs)}replaceCells(f,v,g,y,b=!1){if(b)for(f&&this.getWidth(f-1)===2&&!this.isProtected(f-1)&&this.setCellFromCodePoint(f-1,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs),v<this.length&&this.getWidth(v-1)===2&&!this.isProtected(v)&&this.setCellFromCodePoint(v,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs);f<v&&f<this.length;)this.isProtected(f)||this.setCell(f,g),f++;else for(f&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f-1,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs),v<this.length&&this.getWidth(v-1)===2&&this.setCellFromCodePoint(v,0,1,(y==null?void 0:y.fg)||0,(y==null?void 0:y.bg)||0,(y==null?void 0:y.extended)||new u.ExtendedAttrs);f<v&&f<this.length;)this.setCell(f++,g)}resize(f,v){if(f===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const g=3*f;if(f>this.length){if(this._data.buffer.byteLength>=4*g)this._data=new Uint32Array(this._data.buffer,0,g);else{const y=new Uint32Array(g);y.set(this._data),this._data=y}for(let y=this.length;y<f;++y)this.setCell(y,v)}else{this._data=this._data.subarray(0,g);const y=Object.keys(this._combined);for(let w=0;w<y.length;w++){const x=parseInt(y[w],10);x>=f&&delete this._combined[x]}const b=Object.keys(this._extendedAttrs);for(let w=0;w<b.length;w++){const x=parseInt(b[w],10);x>=f&&delete this._extendedAttrs[x]}}return this.length=f,4*g*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const f=new Uint32Array(this._data.length);return f.set(this._data),this._data=f,1}return 0}fill(f,v=!1){if(v)for(let g=0;g<this.length;++g)this.isProtected(g)||this.setCell(g,f);else{this._combined={},this._extendedAttrs={};for(let g=0;g<this.length;++g)this.setCell(g,f)}}copyFrom(f){this.length!==f.length?this._data=new Uint32Array(f._data):this._data.set(f._data),this.length=f.length,this._combined={};for(const v in f._combined)this._combined[v]=f._combined[v];this._extendedAttrs={};for(const v in f._extendedAttrs)this._extendedAttrs[v]=f._extendedAttrs[v];this.isWrapped=f.isWrapped}clone(){const f=new m(0);f._data=new Uint32Array(this._data),f.length=this.length;for(const v in this._combined)f._combined[v]=this._combined[v];for(const v in this._extendedAttrs)f._extendedAttrs[v]=this._extendedAttrs[v];return f.isWrapped=this.isWrapped,f}getTrimmedLength(){for(let f=this.length-1;f>=0;--f)if(4194303&this._data[3*f+0])return f+(this._data[3*f+0]>>22);return 0}getNoBgTrimmedLength(){for(let f=this.length-1;f>=0;--f)if(4194303&this._data[3*f+0]||50331648&this._data[3*f+2])return f+(this._data[3*f+0]>>22);return 0}copyCellsFrom(f,v,g,y,b){const w=f._data;if(b)for(let k=y-1;k>=0;k--){for(let S=0;S<3;S++)this._data[3*(g+k)+S]=w[3*(v+k)+S];268435456&w[3*(v+k)+2]&&(this._extendedAttrs[g+k]=f._extendedAttrs[v+k])}else for(let k=0;k<y;k++){for(let S=0;S<3;S++)this._data[3*(g+k)+S]=w[3*(v+k)+S];268435456&w[3*(v+k)+2]&&(this._extendedAttrs[g+k]=f._extendedAttrs[v+k])}const x=Object.keys(f._combined);for(let k=0;k<x.length;k++){const S=parseInt(x[k],10);S>=v&&(this._combined[S-v+g]=f._combined[S])}}translateToString(f=!1,v=0,g=this.length){f&&(g=Math.min(g,this.getTrimmedLength()));let y="";for(;v<g;){const b=this._data[3*v+0],w=2097151&b;y+=2097152&b?this._combined[v]:w?(0,d.stringFromCodePoint)(w):h.WHITESPACE_CELL_CHAR,v+=b>>22||1}return y}}o.BufferLine=m},4841:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getRangeLength=void 0,o.getRangeLength=function(l,u){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return u*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(a,o)=>{function l(u,c,h){if(c===u.length-1)return u[c].getTrimmedLength();const d=!u[c].hasContent(h-1)&&u[c].getWidth(h-1)===1,p=u[c+1].getWidth(0)===2;return d&&p?h-1:h}Object.defineProperty(o,"__esModule",{value:!0}),o.getWrappedLineTrimmedLength=o.reflowSmallerGetNewLineLengths=o.reflowLargerApplyNewLayout=o.reflowLargerCreateNewLayout=o.reflowLargerGetLinesToRemove=void 0,o.reflowLargerGetLinesToRemove=function(u,c,h,d,p){const m=[];for(let _=0;_<u.length-1;_++){let f=_,v=u.get(++f);if(!v.isWrapped)continue;const g=[u.get(_)];for(;f<u.length&&v.isWrapped;)g.push(v),v=u.get(++f);if(d>=_&&d<f){_+=g.length-1;continue}let y=0,b=l(g,y,c),w=1,x=0;for(;w<g.length;){const S=l(g,w,c),E=S-x,A=h-b,M=Math.min(E,A);g[y].copyCellsFrom(g[w],x,b,M,!1),b+=M,b===h&&(y++,b=0),x+=M,x===S&&(w++,x=0),b===0&&y!==0&&g[y-1].getWidth(h-1)===2&&(g[y].copyCellsFrom(g[y-1],h-1,b++,1,!1),g[y-1].setCell(h-1,p))}g[y].replaceCells(b,h,p);let k=0;for(let S=g.length-1;S>0&&(S>y||g[S].getTrimmedLength()===0);S--)k++;k>0&&(m.push(_+g.length-k),m.push(k)),_+=g.length-1}return m},o.reflowLargerCreateNewLayout=function(u,c){const h=[];let d=0,p=c[d],m=0;for(let _=0;_<u.length;_++)if(p===_){const f=c[++d];u.onDeleteEmitter.fire({index:_-m,amount:f}),_+=f-1,m+=f,p=c[++d]}else h.push(_);return{layout:h,countRemoved:m}},o.reflowLargerApplyNewLayout=function(u,c){const h=[];for(let d=0;d<c.length;d++)h.push(u.get(c[d]));for(let d=0;d<h.length;d++)u.set(d,h[d]);u.length=c.length},o.reflowSmallerGetNewLineLengths=function(u,c,h){const d=[],p=u.map((v,g)=>l(u,g,c)).reduce((v,g)=>v+g);let m=0,_=0,f=0;for(;f<p;){if(p-f<h){d.push(p-f);break}m+=h;const v=l(u,_,c);m>v&&(m-=v,_++);const g=u[_].getWidth(m-1)===2;g&&m--;const y=g?h-1:h;d.push(y),f+=y}return d},o.getWrappedLineTrimmedLength=l},5295:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferSet=void 0;const u=l(8460),c=l(844),h=l(9092);class d extends c.Disposable{constructor(m,_){super(),this._optionsService=m,this._bufferService=_,this._onBufferActivate=this.register(new u.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new h.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new h.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(m){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(m),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(m,_){this._normal.resize(m,_),this._alt.resize(m,_),this.setupTabStops(m)}setupTabStops(m){this._normal.setupTabStops(m),this._alt.setupTabStops(m)}}o.BufferSet=d},511:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CellData=void 0;const u=l(482),c=l(643),h=l(3734);class d extends h.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new h.ExtendedAttrs,this.combinedData=""}static fromCharData(m){const _=new d;return _.setFromCharData(m),_}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,u.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(m){this.fg=m[c.CHAR_DATA_ATTR_INDEX],this.bg=0;let _=!1;if(m[c.CHAR_DATA_CHAR_INDEX].length>2)_=!0;else if(m[c.CHAR_DATA_CHAR_INDEX].length===2){const f=m[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=f&&f<=56319){const v=m[c.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=v&&v<=57343?this.content=1024*(f-55296)+v-56320+65536|m[c.CHAR_DATA_WIDTH_INDEX]<<22:_=!0}else _=!0}else this.content=m[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|m[c.CHAR_DATA_WIDTH_INDEX]<<22;_&&(this.combinedData=m[c.CHAR_DATA_CHAR_INDEX],this.content=2097152|m[c.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.CellData=d},643:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WHITESPACE_CELL_CODE=o.WHITESPACE_CELL_WIDTH=o.WHITESPACE_CELL_CHAR=o.NULL_CELL_CODE=o.NULL_CELL_WIDTH=o.NULL_CELL_CHAR=o.CHAR_DATA_CODE_INDEX=o.CHAR_DATA_WIDTH_INDEX=o.CHAR_DATA_CHAR_INDEX=o.CHAR_DATA_ATTR_INDEX=o.DEFAULT_EXT=o.DEFAULT_ATTR=o.DEFAULT_COLOR=void 0,o.DEFAULT_COLOR=0,o.DEFAULT_ATTR=256|o.DEFAULT_COLOR<<9,o.DEFAULT_EXT=0,o.CHAR_DATA_ATTR_INDEX=0,o.CHAR_DATA_CHAR_INDEX=1,o.CHAR_DATA_WIDTH_INDEX=2,o.CHAR_DATA_CODE_INDEX=3,o.NULL_CELL_CHAR="",o.NULL_CELL_WIDTH=1,o.NULL_CELL_CODE=0,o.WHITESPACE_CELL_CHAR=" ",o.WHITESPACE_CELL_WIDTH=1,o.WHITESPACE_CELL_CODE=32},4863:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Marker=void 0;const u=l(8460),c=l(844);class h{get id(){return this._id}constructor(p){this.line=p,this.isDisposed=!1,this._disposables=[],this._id=h._nextId++,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,c.disposeArray)(this._disposables),this._disposables.length=0)}register(p){return this._disposables.push(p),p}}o.Marker=h,h._nextId=1},7116:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DEFAULT_CHARSET=o.CHARSETS=void 0,o.CHARSETS={},o.DEFAULT_CHARSET=o.CHARSETS.B,o.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},o.CHARSETS.A={"#":""},o.CHARSETS.B=void 0,o.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},o.CHARSETS.C=o.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},o.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},o.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.E=o.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},o.CHARSETS.H=o.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(a,o)=>{var l,u,c;Object.defineProperty(o,"__esModule",{value:!0}),o.C1_ESCAPED=o.C1=o.C0=void 0,function(h){h.NUL="\0",h.SOH="",h.STX="",h.ETX="",h.EOT="",h.ENQ="",h.ACK="",h.BEL="\x07",h.BS="\b",h.HT="	",h.LF=`
`,h.VT="\v",h.FF="\f",h.CR="\r",h.SO="",h.SI="",h.DLE="",h.DC1="",h.DC2="",h.DC3="",h.DC4="",h.NAK="",h.SYN="",h.ETB="",h.CAN="",h.EM="",h.SUB="",h.ESC="\x1B",h.FS="",h.GS="",h.RS="",h.US="",h.SP=" ",h.DEL=""}(l||(o.C0=l={})),function(h){h.PAD="",h.HOP="",h.BPH="",h.NBH="",h.IND="",h.NEL="",h.SSA="",h.ESA="",h.HTS="",h.HTJ="",h.VTS="",h.PLD="",h.PLU="",h.RI="",h.SS2="",h.SS3="",h.DCS="",h.PU1="",h.PU2="",h.STS="",h.CCH="",h.MW="",h.SPA="",h.EPA="",h.SOS="",h.SGCI="",h.SCI="",h.CSI="",h.ST="",h.OSC="",h.PM="",h.APC=""}(u||(o.C1=u={})),function(h){h.ST=`${l.ESC}\\`}(c||(o.C1_ESCAPED=c={}))},7399:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.evaluateKeyboardEvent=void 0;const u=l(2584),c={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};o.evaluateKeyboardEvent=function(h,d,p,m){const _={type:0,cancel:!1,key:void 0},f=(h.shiftKey?1:0)|(h.altKey?2:0)|(h.ctrlKey?4:0)|(h.metaKey?8:0);switch(h.keyCode){case 0:h.key==="UIKeyInputUpArrow"?_.key=d?u.C0.ESC+"OA":u.C0.ESC+"[A":h.key==="UIKeyInputLeftArrow"?_.key=d?u.C0.ESC+"OD":u.C0.ESC+"[D":h.key==="UIKeyInputRightArrow"?_.key=d?u.C0.ESC+"OC":u.C0.ESC+"[C":h.key==="UIKeyInputDownArrow"&&(_.key=d?u.C0.ESC+"OB":u.C0.ESC+"[B");break;case 8:if(h.altKey){_.key=u.C0.ESC+u.C0.DEL;break}_.key=u.C0.DEL;break;case 9:if(h.shiftKey){_.key=u.C0.ESC+"[Z";break}_.key=u.C0.HT,_.cancel=!0;break;case 13:_.key=h.altKey?u.C0.ESC+u.C0.CR:u.C0.CR,_.cancel=!0;break;case 27:_.key=u.C0.ESC,h.altKey&&(_.key=u.C0.ESC+u.C0.ESC),_.cancel=!0;break;case 37:if(h.metaKey)break;f?(_.key=u.C0.ESC+"[1;"+(f+1)+"D",_.key===u.C0.ESC+"[1;3D"&&(_.key=u.C0.ESC+(p?"b":"[1;5D"))):_.key=d?u.C0.ESC+"OD":u.C0.ESC+"[D";break;case 39:if(h.metaKey)break;f?(_.key=u.C0.ESC+"[1;"+(f+1)+"C",_.key===u.C0.ESC+"[1;3C"&&(_.key=u.C0.ESC+(p?"f":"[1;5C"))):_.key=d?u.C0.ESC+"OC":u.C0.ESC+"[C";break;case 38:if(h.metaKey)break;f?(_.key=u.C0.ESC+"[1;"+(f+1)+"A",p||_.key!==u.C0.ESC+"[1;3A"||(_.key=u.C0.ESC+"[1;5A")):_.key=d?u.C0.ESC+"OA":u.C0.ESC+"[A";break;case 40:if(h.metaKey)break;f?(_.key=u.C0.ESC+"[1;"+(f+1)+"B",p||_.key!==u.C0.ESC+"[1;3B"||(_.key=u.C0.ESC+"[1;5B")):_.key=d?u.C0.ESC+"OB":u.C0.ESC+"[B";break;case 45:h.shiftKey||h.ctrlKey||(_.key=u.C0.ESC+"[2~");break;case 46:_.key=f?u.C0.ESC+"[3;"+(f+1)+"~":u.C0.ESC+"[3~";break;case 36:_.key=f?u.C0.ESC+"[1;"+(f+1)+"H":d?u.C0.ESC+"OH":u.C0.ESC+"[H";break;case 35:_.key=f?u.C0.ESC+"[1;"+(f+1)+"F":d?u.C0.ESC+"OF":u.C0.ESC+"[F";break;case 33:h.shiftKey?_.type=2:h.ctrlKey?_.key=u.C0.ESC+"[5;"+(f+1)+"~":_.key=u.C0.ESC+"[5~";break;case 34:h.shiftKey?_.type=3:h.ctrlKey?_.key=u.C0.ESC+"[6;"+(f+1)+"~":_.key=u.C0.ESC+"[6~";break;case 112:_.key=f?u.C0.ESC+"[1;"+(f+1)+"P":u.C0.ESC+"OP";break;case 113:_.key=f?u.C0.ESC+"[1;"+(f+1)+"Q":u.C0.ESC+"OQ";break;case 114:_.key=f?u.C0.ESC+"[1;"+(f+1)+"R":u.C0.ESC+"OR";break;case 115:_.key=f?u.C0.ESC+"[1;"+(f+1)+"S":u.C0.ESC+"OS";break;case 116:_.key=f?u.C0.ESC+"[15;"+(f+1)+"~":u.C0.ESC+"[15~";break;case 117:_.key=f?u.C0.ESC+"[17;"+(f+1)+"~":u.C0.ESC+"[17~";break;case 118:_.key=f?u.C0.ESC+"[18;"+(f+1)+"~":u.C0.ESC+"[18~";break;case 119:_.key=f?u.C0.ESC+"[19;"+(f+1)+"~":u.C0.ESC+"[19~";break;case 120:_.key=f?u.C0.ESC+"[20;"+(f+1)+"~":u.C0.ESC+"[20~";break;case 121:_.key=f?u.C0.ESC+"[21;"+(f+1)+"~":u.C0.ESC+"[21~";break;case 122:_.key=f?u.C0.ESC+"[23;"+(f+1)+"~":u.C0.ESC+"[23~";break;case 123:_.key=f?u.C0.ESC+"[24;"+(f+1)+"~":u.C0.ESC+"[24~";break;default:if(!h.ctrlKey||h.shiftKey||h.altKey||h.metaKey)if(p&&!m||!h.altKey||h.metaKey)!p||h.altKey||h.ctrlKey||h.shiftKey||!h.metaKey?h.key&&!h.ctrlKey&&!h.altKey&&!h.metaKey&&h.keyCode>=48&&h.key.length===1?_.key=h.key:h.key&&h.ctrlKey&&(h.key==="_"&&(_.key=u.C0.US),h.key==="@"&&(_.key=u.C0.NUL)):h.keyCode===65&&(_.type=1);else{const v=c[h.keyCode],g=v==null?void 0:v[h.shiftKey?1:0];if(g)_.key=u.C0.ESC+g;else if(h.keyCode>=65&&h.keyCode<=90){const y=h.ctrlKey?h.keyCode-64:h.keyCode+32;let b=String.fromCharCode(y);h.shiftKey&&(b=b.toUpperCase()),_.key=u.C0.ESC+b}else if(h.keyCode===32)_.key=u.C0.ESC+(h.ctrlKey?u.C0.NUL:" ");else if(h.key==="Dead"&&h.code.startsWith("Key")){let y=h.code.slice(3,4);h.shiftKey||(y=y.toLowerCase()),_.key=u.C0.ESC+y,_.cancel=!0}}else h.keyCode>=65&&h.keyCode<=90?_.key=String.fromCharCode(h.keyCode-64):h.keyCode===32?_.key=u.C0.NUL:h.keyCode>=51&&h.keyCode<=55?_.key=String.fromCharCode(h.keyCode-51+27):h.keyCode===56?_.key=u.C0.DEL:h.keyCode===219?_.key=u.C0.ESC:h.keyCode===220?_.key=u.C0.FS:h.keyCode===221&&(_.key=u.C0.GS)}return _}},482:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Utf8ToUtf32=o.StringToUtf32=o.utf32ToString=o.stringFromCodePoint=void 0,o.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},o.utf32ToString=function(l,u=0,c=l.length){let h="";for(let d=u;d<c;++d){let p=l[d];p>65535?(p-=65536,h+=String.fromCharCode(55296+(p>>10))+String.fromCharCode(p%1024+56320)):h+=String.fromCharCode(p)}return h},o.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,u){const c=l.length;if(!c)return 0;let h=0,d=0;if(this._interim){const p=l.charCodeAt(d++);56320<=p&&p<=57343?u[h++]=1024*(this._interim-55296)+p-56320+65536:(u[h++]=this._interim,u[h++]=p),this._interim=0}for(let p=d;p<c;++p){const m=l.charCodeAt(p);if(55296<=m&&m<=56319){if(++p>=c)return this._interim=m,h;const _=l.charCodeAt(p);56320<=_&&_<=57343?u[h++]=1024*(m-55296)+_-56320+65536:(u[h++]=m,u[h++]=_)}else m!==65279&&(u[h++]=m)}return h}},o.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,u){const c=l.length;if(!c)return 0;let h,d,p,m,_=0,f=0,v=0;if(this.interim[0]){let b=!1,w=this.interim[0];w&=(224&w)==192?31:(240&w)==224?15:7;let x,k=0;for(;(x=63&this.interim[++k])&&k<4;)w<<=6,w|=x;const S=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=S-k;for(;v<E;){if(v>=c)return 0;if(x=l[v++],(192&x)!=128){v--,b=!0;break}this.interim[k++]=x,w<<=6,w|=63&x}b||(S===2?w<128?v--:u[_++]=w:S===3?w<2048||w>=55296&&w<=57343||w===65279||(u[_++]=w):w<65536||w>1114111||(u[_++]=w)),this.interim.fill(0)}const g=c-4;let y=v;for(;y<c;){for(;!(!(y<g)||128&(h=l[y])||128&(d=l[y+1])||128&(p=l[y+2])||128&(m=l[y+3]));)u[_++]=h,u[_++]=d,u[_++]=p,u[_++]=m,y+=4;if(h=l[y++],h<128)u[_++]=h;else if((224&h)==192){if(y>=c)return this.interim[0]=h,_;if(d=l[y++],(192&d)!=128){y--;continue}if(f=(31&h)<<6|63&d,f<128){y--;continue}u[_++]=f}else if((240&h)==224){if(y>=c)return this.interim[0]=h,_;if(d=l[y++],(192&d)!=128){y--;continue}if(y>=c)return this.interim[0]=h,this.interim[1]=d,_;if(p=l[y++],(192&p)!=128){y--;continue}if(f=(15&h)<<12|(63&d)<<6|63&p,f<2048||f>=55296&&f<=57343||f===65279)continue;u[_++]=f}else if((248&h)==240){if(y>=c)return this.interim[0]=h,_;if(d=l[y++],(192&d)!=128){y--;continue}if(y>=c)return this.interim[0]=h,this.interim[1]=d,_;if(p=l[y++],(192&p)!=128){y--;continue}if(y>=c)return this.interim[0]=h,this.interim[1]=d,this.interim[2]=p,_;if(m=l[y++],(192&m)!=128){y--;continue}if(f=(7&h)<<18|(63&d)<<12|(63&p)<<6|63&m,f<65536||f>1114111)continue;u[_++]=f}}return _}}},225:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeV6=void 0;const l=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],u=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let c;o.UnicodeV6=class{constructor(){if(this.version="6",!c){c=new Uint8Array(65536),c.fill(1),c[0]=0,c.fill(0,1,32),c.fill(0,127,160),c.fill(2,4352,4448),c[9001]=2,c[9002]=2,c.fill(2,11904,42192),c[12351]=1,c.fill(2,44032,55204),c.fill(2,63744,64256),c.fill(2,65040,65050),c.fill(2,65072,65136),c.fill(2,65280,65377),c.fill(2,65504,65511);for(let h=0;h<l.length;++h)c.fill(0,l[h][0],l[h][1]+1)}}wcwidth(h){return h<32?0:h<127?1:h<65536?c[h]:function(d,p){let m,_=0,f=p.length-1;if(d<p[0][0]||d>p[f][1])return!1;for(;f>=_;)if(m=_+f>>1,d>p[m][1])_=m+1;else{if(!(d<p[m][0]))return!0;f=m-1}return!1}(h,u)?0:h>=131072&&h<=196605||h>=196608&&h<=262141?2:1}}},5981:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WriteBuffer=void 0;const u=l(8460),c=l(844);class h extends c.Disposable{constructor(p){super(),this._action=p,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new u.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(p,m){if(m!==void 0&&this._syncCalls>m)return void(this._syncCalls=0);if(this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let _;for(this._isSyncWriting=!0;_=this._writeBuffer.shift();){this._action(_);const f=this._callbacks.shift();f&&f()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(p,m){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(m),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=p.length,this._writeBuffer.push(p),this._callbacks.push(m)}_innerWrite(p=0,m=!0){const _=p||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const f=this._writeBuffer[this._bufferOffset],v=this._action(f,m);if(v){const y=b=>Date.now()-_>=12?setTimeout(()=>this._innerWrite(0,b)):this._innerWrite(_,b);return void v.catch(b=>(queueMicrotask(()=>{throw b}),Promise.resolve(!1))).then(y)}const g=this._callbacks[this._bufferOffset];if(g&&g(),this._bufferOffset++,this._pendingData-=f.length,Date.now()-_>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}o.WriteBuffer=h},5941:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toRgbString=o.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,u=/^[\da-f]+$/;function c(h,d){const p=h.toString(16),m=p.length<2?"0"+p:p;switch(d){case 4:return p[0];case 8:return m;case 12:return(m+m).slice(0,3);default:return m+m}}o.parseColor=function(h){if(!h)return;let d=h.toLowerCase();if(d.indexOf("rgb:")===0){d=d.slice(4);const p=l.exec(d);if(p){const m=p[1]?15:p[4]?255:p[7]?4095:65535;return[Math.round(parseInt(p[1]||p[4]||p[7]||p[10],16)/m*255),Math.round(parseInt(p[2]||p[5]||p[8]||p[11],16)/m*255),Math.round(parseInt(p[3]||p[6]||p[9]||p[12],16)/m*255)]}}else if(d.indexOf("#")===0&&(d=d.slice(1),u.exec(d)&&[3,6,9,12].includes(d.length))){const p=d.length/3,m=[0,0,0];for(let _=0;_<3;++_){const f=parseInt(d.slice(p*_,p*_+p),16);m[_]=p===1?f<<4:p===2?f:p===3?f>>4:f>>8}return m}},o.toRgbString=function(h,d=16){const[p,m,_]=h;return`rgb:${c(p,d)}/${c(m,d)}/${c(_,d)}`}},5770:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PAYLOAD_LIMIT=void 0,o.PAYLOAD_LIMIT=1e7},6351:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DcsHandler=o.DcsParser=void 0;const u=l(482),c=l(8742),h=l(5770),d=[];o.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=d,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}registerHandler(m,_){this._handlers[m]===void 0&&(this._handlers[m]=[]);const f=this._handlers[m];return f.push(_),{dispose:()=>{const v=f.indexOf(_);v!==-1&&f.splice(v,1)}}}clearHandler(m){this._handlers[m]&&delete this._handlers[m]}setHandlerFallback(m){this._handlerFb=m}reset(){if(this._active.length)for(let m=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;m>=0;--m)this._active[m].unhook(!1);this._stack.paused=!1,this._active=d,this._ident=0}hook(m,_){if(this.reset(),this._ident=m,this._active=this._handlers[m]||d,this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].hook(_);else this._handlerFb(this._ident,"HOOK",_)}put(m,_,f){if(this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].put(m,_,f);else this._handlerFb(this._ident,"PUT",(0,u.utf32ToString)(m,_,f))}unhook(m,_=!0){if(this._active.length){let f=!1,v=this._active.length-1,g=!1;if(this._stack.paused&&(v=this._stack.loopPosition-1,f=_,g=this._stack.fallThrough,this._stack.paused=!1),!g&&f===!1){for(;v>=0&&(f=this._active[v].unhook(m),f!==!0);v--)if(f instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=v,this._stack.fallThrough=!1,f;v--}for(;v>=0;v--)if(f=this._active[v].unhook(!1),f instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=v,this._stack.fallThrough=!0,f}else this._handlerFb(this._ident,"UNHOOK",m);this._active=d,this._ident=0}};const p=new c.Params;p.addParam(0),o.DcsHandler=class{constructor(m){this._handler=m,this._data="",this._params=p,this._hitLimit=!1}hook(m){this._params=m.length>1||m.params[0]?m.clone():p,this._data="",this._hitLimit=!1}put(m,_,f){this._hitLimit||(this._data+=(0,u.utf32ToString)(m,_,f),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(m){let _=!1;if(this._hitLimit)_=!1;else if(m&&(_=this._handler(this._data,this._params),_ instanceof Promise))return _.then(f=>(this._params=p,this._data="",this._hitLimit=!1,f));return this._params=p,this._data="",this._hitLimit=!1,_}}},2015:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.EscapeSequenceParser=o.VT500_TRANSITION_TABLE=o.TransitionTable=void 0;const u=l(844),c=l(8742),h=l(6242),d=l(6351);class p{constructor(v){this.table=new Uint8Array(v)}setDefault(v,g){this.table.fill(v<<4|g)}add(v,g,y,b){this.table[g<<8|v]=y<<4|b}addMany(v,g,y,b){for(let w=0;w<v.length;w++)this.table[g<<8|v[w]]=y<<4|b}}o.TransitionTable=p;const m=160;o.VT500_TRANSITION_TABLE=function(){const f=new p(4095),v=Array.apply(null,Array(256)).map((k,S)=>S),g=(k,S)=>v.slice(k,S),y=g(32,127),b=g(0,24);b.push(25),b.push.apply(b,g(28,32));const w=g(0,14);let x;for(x in f.setDefault(1,0),f.addMany(y,0,2,0),w)f.addMany([24,26,153,154],x,3,0),f.addMany(g(128,144),x,3,0),f.addMany(g(144,152),x,3,0),f.add(156,x,0,0),f.add(27,x,11,1),f.add(157,x,4,8),f.addMany([152,158,159],x,0,7),f.add(155,x,11,3),f.add(144,x,11,9);return f.addMany(b,0,3,0),f.addMany(b,1,3,1),f.add(127,1,0,1),f.addMany(b,8,0,8),f.addMany(b,3,3,3),f.add(127,3,0,3),f.addMany(b,4,3,4),f.add(127,4,0,4),f.addMany(b,6,3,6),f.addMany(b,5,3,5),f.add(127,5,0,5),f.addMany(b,2,3,2),f.add(127,2,0,2),f.add(93,1,4,8),f.addMany(y,8,5,8),f.add(127,8,5,8),f.addMany([156,27,24,26,7],8,6,0),f.addMany(g(28,32),8,0,8),f.addMany([88,94,95],1,0,7),f.addMany(y,7,0,7),f.addMany(b,7,0,7),f.add(156,7,0,0),f.add(127,7,0,7),f.add(91,1,11,3),f.addMany(g(64,127),3,7,0),f.addMany(g(48,60),3,8,4),f.addMany([60,61,62,63],3,9,4),f.addMany(g(48,60),4,8,4),f.addMany(g(64,127),4,7,0),f.addMany([60,61,62,63],4,0,6),f.addMany(g(32,64),6,0,6),f.add(127,6,0,6),f.addMany(g(64,127),6,0,0),f.addMany(g(32,48),3,9,5),f.addMany(g(32,48),5,9,5),f.addMany(g(48,64),5,0,6),f.addMany(g(64,127),5,7,0),f.addMany(g(32,48),4,9,5),f.addMany(g(32,48),1,9,2),f.addMany(g(32,48),2,9,2),f.addMany(g(48,127),2,10,0),f.addMany(g(48,80),1,10,0),f.addMany(g(81,88),1,10,0),f.addMany([89,90,92],1,10,0),f.addMany(g(96,127),1,10,0),f.add(80,1,11,9),f.addMany(b,9,0,9),f.add(127,9,0,9),f.addMany(g(28,32),9,0,9),f.addMany(g(32,48),9,9,12),f.addMany(g(48,60),9,8,10),f.addMany([60,61,62,63],9,9,10),f.addMany(b,11,0,11),f.addMany(g(32,128),11,0,11),f.addMany(g(28,32),11,0,11),f.addMany(b,10,0,10),f.add(127,10,0,10),f.addMany(g(28,32),10,0,10),f.addMany(g(48,60),10,8,10),f.addMany([60,61,62,63],10,0,11),f.addMany(g(32,48),10,9,12),f.addMany(b,12,0,12),f.add(127,12,0,12),f.addMany(g(28,32),12,0,12),f.addMany(g(32,48),12,9,12),f.addMany(g(48,64),12,0,11),f.addMany(g(64,127),12,12,13),f.addMany(g(64,127),10,12,13),f.addMany(g(64,127),9,12,13),f.addMany(b,13,13,13),f.addMany(y,13,13,13),f.add(127,13,0,13),f.addMany([27,156,24,26],13,14,0),f.add(m,0,2,0),f.add(m,8,5,8),f.add(m,6,0,6),f.add(m,11,0,11),f.add(m,13,13,13),f}();class _ extends u.Disposable{constructor(v=o.VT500_TRANSITION_TABLE){super(),this._transitions=v,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new c.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(g,y,b)=>{},this._executeHandlerFb=g=>{},this._csiHandlerFb=(g,y)=>{},this._escHandlerFb=g=>{},this._errorHandlerFb=g=>g,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,u.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new h.OscParser),this._dcsParser=this.register(new d.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(v,g=[64,126]){let y=0;if(v.prefix){if(v.prefix.length>1)throw new Error("only one byte as prefix supported");if(y=v.prefix.charCodeAt(0),y&&60>y||y>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(v.intermediates){if(v.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let w=0;w<v.intermediates.length;++w){const x=v.intermediates.charCodeAt(w);if(32>x||x>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");y<<=8,y|=x}}if(v.final.length!==1)throw new Error("final must be a single byte");const b=v.final.charCodeAt(0);if(g[0]>b||b>g[1])throw new Error(`final must be in range ${g[0]} .. ${g[1]}`);return y<<=8,y|=b,y}identToString(v){const g=[];for(;v;)g.push(String.fromCharCode(255&v)),v>>=8;return g.reverse().join("")}setPrintHandler(v){this._printHandler=v}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(v,g){const y=this._identifier(v,[48,126]);this._escHandlers[y]===void 0&&(this._escHandlers[y]=[]);const b=this._escHandlers[y];return b.push(g),{dispose:()=>{const w=b.indexOf(g);w!==-1&&b.splice(w,1)}}}clearEscHandler(v){this._escHandlers[this._identifier(v,[48,126])]&&delete this._escHandlers[this._identifier(v,[48,126])]}setEscHandlerFallback(v){this._escHandlerFb=v}setExecuteHandler(v,g){this._executeHandlers[v.charCodeAt(0)]=g}clearExecuteHandler(v){this._executeHandlers[v.charCodeAt(0)]&&delete this._executeHandlers[v.charCodeAt(0)]}setExecuteHandlerFallback(v){this._executeHandlerFb=v}registerCsiHandler(v,g){const y=this._identifier(v);this._csiHandlers[y]===void 0&&(this._csiHandlers[y]=[]);const b=this._csiHandlers[y];return b.push(g),{dispose:()=>{const w=b.indexOf(g);w!==-1&&b.splice(w,1)}}}clearCsiHandler(v){this._csiHandlers[this._identifier(v)]&&delete this._csiHandlers[this._identifier(v)]}setCsiHandlerFallback(v){this._csiHandlerFb=v}registerDcsHandler(v,g){return this._dcsParser.registerHandler(this._identifier(v),g)}clearDcsHandler(v){this._dcsParser.clearHandler(this._identifier(v))}setDcsHandlerFallback(v){this._dcsParser.setHandlerFallback(v)}registerOscHandler(v,g){return this._oscParser.registerHandler(v,g)}clearOscHandler(v){this._oscParser.clearHandler(v)}setOscHandlerFallback(v){this._oscParser.setHandlerFallback(v)}setErrorHandler(v){this._errorHandler=v}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(v,g,y,b,w){this._parseStack.state=v,this._parseStack.handlers=g,this._parseStack.handlerPos=y,this._parseStack.transition=b,this._parseStack.chunkPos=w}parse(v,g,y){let b,w=0,x=0,k=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,k=this._parseStack.chunkPos+1;else{if(y===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const S=this._parseStack.handlers;let E=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(y===!1&&E>-1){for(;E>=0&&(b=S[E](this._params),b!==!0);E--)if(b instanceof Promise)return this._parseStack.handlerPos=E,b}this._parseStack.handlers=[];break;case 4:if(y===!1&&E>-1){for(;E>=0&&(b=S[E](),b!==!0);E--)if(b instanceof Promise)return this._parseStack.handlerPos=E,b}this._parseStack.handlers=[];break;case 6:if(w=v[this._parseStack.chunkPos],b=this._dcsParser.unhook(w!==24&&w!==26,y),b)return b;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(w=v[this._parseStack.chunkPos],b=this._oscParser.end(w!==24&&w!==26,y),b)return b;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,k=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let S=k;S<g;++S){switch(w=v[S],x=this._transitions.table[this.currentState<<8|(w<160?w:m)],x>>4){case 2:for(let P=S+1;;++P){if(P>=g||(w=v[P])<32||w>126&&w<m){this._printHandler(v,S,P),S=P-1;break}if(++P>=g||(w=v[P])<32||w>126&&w<m){this._printHandler(v,S,P),S=P-1;break}if(++P>=g||(w=v[P])<32||w>126&&w<m){this._printHandler(v,S,P),S=P-1;break}if(++P>=g||(w=v[P])<32||w>126&&w<m){this._printHandler(v,S,P),S=P-1;break}}break;case 3:this._executeHandlers[w]?this._executeHandlers[w]():this._executeHandlerFb(w),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:S,code:w,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const E=this._csiHandlers[this._collect<<8|w];let A=E?E.length-1:-1;for(;A>=0&&(b=E[A](this._params),b!==!0);A--)if(b instanceof Promise)return this._preserveStack(3,E,A,x,S),b;A<0&&this._csiHandlerFb(this._collect<<8|w,this._params),this.precedingCodepoint=0;break;case 8:do switch(w){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(w-48)}while(++S<g&&(w=v[S])>47&&w<60);S--;break;case 9:this._collect<<=8,this._collect|=w;break;case 10:const M=this._escHandlers[this._collect<<8|w];let R=M?M.length-1:-1;for(;R>=0&&(b=M[R](),b!==!0);R--)if(b instanceof Promise)return this._preserveStack(4,M,R,x,S),b;R<0&&this._escHandlerFb(this._collect<<8|w),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|w,this._params);break;case 13:for(let P=S+1;;++P)if(P>=g||(w=v[P])===24||w===26||w===27||w>127&&w<m){this._dcsParser.put(v,S,P),S=P-1;break}break;case 14:if(b=this._dcsParser.unhook(w!==24&&w!==26),b)return this._preserveStack(6,[],0,x,S),b;w===27&&(x|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let P=S+1;;P++)if(P>=g||(w=v[P])<32||w>127&&w<m){this._oscParser.put(v,S,P),S=P-1;break}break;case 6:if(b=this._oscParser.end(w!==24&&w!==26),b)return this._preserveStack(5,[],0,x,S),b;w===27&&(x|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&x}}}o.EscapeSequenceParser=_},6242:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OscHandler=o.OscParser=void 0;const u=l(5770),c=l(482),h=[];o.OscParser=class{constructor(){this._state=0,this._active=h,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(d,p){this._handlers[d]===void 0&&(this._handlers[d]=[]);const m=this._handlers[d];return m.push(p),{dispose:()=>{const _=m.indexOf(p);_!==-1&&m.splice(_,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}reset(){if(this._state===2)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].end(!1);this._stack.paused=!1,this._active=h,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||h,this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].start();else this._handlerFb(this._id,"START")}_put(d,p,m){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(d,p,m);else this._handlerFb(this._id,"PUT",(0,c.utf32ToString)(d,p,m))}start(){this.reset(),this._state=1}put(d,p,m){if(this._state!==3){if(this._state===1)for(;p<m;){const _=d[p++];if(_===59){this._state=2,this._start();break}if(_<48||57<_)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+_-48}this._state===2&&m-p>0&&this._put(d,p,m)}}end(d,p=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let m=!1,_=this._active.length-1,f=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,m=p,f=this._stack.fallThrough,this._stack.paused=!1),!f&&m===!1){for(;_>=0&&(m=this._active[_].end(d),m!==!0);_--)if(m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,m;_--}for(;_>=0;_--)if(m=this._active[_].end(!1),m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,m}else this._handlerFb(this._id,"END",d);this._active=h,this._id=-1,this._state=0}}},o.OscHandler=class{constructor(d){this._handler=d,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(d,p,m){this._hitLimit||(this._data+=(0,c.utf32ToString)(d,p,m),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(d){let p=!1;if(this._hitLimit)p=!1;else if(d&&(p=this._handler(this._data),p instanceof Promise))return p.then(m=>(this._data="",this._hitLimit=!1,m));return this._data="",this._hitLimit=!1,p}}},8742:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Params=void 0;const l=2147483647;class u{static fromArray(h){const d=new u;if(!h.length)return d;for(let p=Array.isArray(h[0])?1:0;p<h.length;++p){const m=h[p];if(Array.isArray(m))for(let _=0;_<m.length;++_)d.addSubParam(m[_]);else d.addParam(m)}return d}constructor(h=32,d=32){if(this.maxLength=h,this.maxSubParamsLength=d,d>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(h),this.length=0,this._subParams=new Int32Array(d),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(h),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const h=new u(this.maxLength,this.maxSubParamsLength);return h.params.set(this.params),h.length=this.length,h._subParams.set(this._subParams),h._subParamsLength=this._subParamsLength,h._subParamsIdx.set(this._subParamsIdx),h._rejectDigits=this._rejectDigits,h._rejectSubDigits=this._rejectSubDigits,h._digitIsSub=this._digitIsSub,h}toArray(){const h=[];for(let d=0;d<this.length;++d){h.push(this.params[d]);const p=this._subParamsIdx[d]>>8,m=255&this._subParamsIdx[d];m-p>0&&h.push(Array.prototype.slice.call(this._subParams,p,m))}return h}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(h){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=h>l?l:h}}addSubParam(h){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=h>l?l:h,this._subParamsIdx[this.length-1]++}}hasSubParams(h){return(255&this._subParamsIdx[h])-(this._subParamsIdx[h]>>8)>0}getSubParams(h){const d=this._subParamsIdx[h]>>8,p=255&this._subParamsIdx[h];return p-d>0?this._subParams.subarray(d,p):null}getSubParamsAll(){const h={};for(let d=0;d<this.length;++d){const p=this._subParamsIdx[d]>>8,m=255&this._subParamsIdx[d];m-p>0&&(h[d]=this._subParams.slice(p,m))}return h}addDigit(h){let d;if(this._rejectDigits||!(d=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const p=this._digitIsSub?this._subParams:this.params,m=p[d-1];p[d-1]=~m?Math.min(10*m+h,l):h}}o.Params=u},5741:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AddonManager=void 0,o.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,u){const c={instance:u,dispose:u.dispose,isDisposed:!1};this._addons.push(c),u.dispose=()=>this._wrappedAddonDispose(c),u.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let u=-1;for(let c=0;c<this._addons.length;c++)if(this._addons[c]===l){u=c;break}if(u===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(u,1)}}},8771:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferApiView=void 0;const u=l(3785),c=l(511);o.BufferApiView=class{constructor(h,d){this._buffer=h,this.type=d}init(h){return this._buffer=h,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(h){const d=this._buffer.lines.get(h);if(d)return new u.BufferLineApiView(d)}getNullCell(){return new c.CellData}}},3785:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLineApiView=void 0;const u=l(511);o.BufferLineApiView=class{constructor(c){this._line=c}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(c,h){if(!(c<0||c>=this._line.length))return h?(this._line.loadCell(c,h),h):this._line.loadCell(c,new u.CellData)}translateToString(c,h,d){return this._line.translateToString(c,h,d)}}},8285:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferNamespaceApi=void 0;const u=l(8771),c=l(8460),h=l(844);class d extends h.Disposable{constructor(m){super(),this._core=m,this._onBufferChange=this.register(new c.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new u.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new u.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}o.BufferNamespaceApi=d},7975:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ParserApi=void 0,o.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,u){return this._core.registerCsiHandler(l,c=>u(c.toArray()))}addCsiHandler(l,u){return this.registerCsiHandler(l,u)}registerDcsHandler(l,u){return this._core.registerDcsHandler(l,(c,h)=>u(c,h.toArray()))}addDcsHandler(l,u){return this.registerDcsHandler(l,u)}registerEscHandler(l,u){return this._core.registerEscHandler(l,u)}addEscHandler(l,u){return this.registerEscHandler(l,u)}registerOscHandler(l,u){return this._core.registerOscHandler(l,u)}addOscHandler(l,u){return this.registerOscHandler(l,u)}}},7090:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeApi=void 0,o.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(a,o,l){var u=this&&this.__decorate||function(f,v,g,y){var b,w=arguments.length,x=w<3?v:y===null?y=Object.getOwnPropertyDescriptor(v,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(f,v,g,y);else for(var k=f.length-1;k>=0;k--)(b=f[k])&&(x=(w<3?b(x):w>3?b(v,g,x):b(v,g))||x);return w>3&&x&&Object.defineProperty(v,g,x),x},c=this&&this.__param||function(f,v){return function(g,y){v(g,y,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferService=o.MINIMUM_ROWS=o.MINIMUM_COLS=void 0;const h=l(8460),d=l(844),p=l(5295),m=l(2585);o.MINIMUM_COLS=2,o.MINIMUM_ROWS=1;let _=o.BufferService=class extends d.Disposable{get buffer(){return this.buffers.active}constructor(f){super(),this.isUserScrolling=!1,this._onResize=this.register(new h.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(f.rawOptions.cols||0,o.MINIMUM_COLS),this.rows=Math.max(f.rawOptions.rows||0,o.MINIMUM_ROWS),this.buffers=this.register(new p.BufferSet(f,this))}resize(f,v){this.cols=f,this.rows=v,this.buffers.resize(f,v),this._onResize.fire({cols:f,rows:v})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(f,v=!1){const g=this.buffer;let y;y=this._cachedBlankLine,y&&y.length===this.cols&&y.getFg(0)===f.fg&&y.getBg(0)===f.bg||(y=g.getBlankLine(f,v),this._cachedBlankLine=y),y.isWrapped=v;const b=g.ybase+g.scrollTop,w=g.ybase+g.scrollBottom;if(g.scrollTop===0){const x=g.lines.isFull;w===g.lines.length-1?x?g.lines.recycle().copyFrom(y):g.lines.push(y.clone()):g.lines.splice(w+1,0,y.clone()),x?this.isUserScrolling&&(g.ydisp=Math.max(g.ydisp-1,0)):(g.ybase++,this.isUserScrolling||g.ydisp++)}else{const x=w-b+1;g.lines.shiftElements(b+1,x-1,-1),g.lines.set(w,y.clone())}this.isUserScrolling||(g.ydisp=g.ybase),this._onScroll.fire(g.ydisp)}scrollLines(f,v,g){const y=this.buffer;if(f<0){if(y.ydisp===0)return;this.isUserScrolling=!0}else f+y.ydisp>=y.ybase&&(this.isUserScrolling=!1);const b=y.ydisp;y.ydisp=Math.max(Math.min(y.ydisp+f,y.ybase),0),b!==y.ydisp&&(v||this._onScroll.fire(y.ydisp))}};o.BufferService=_=u([c(0,m.IOptionsService)],_)},7994:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CharsetService=void 0,o.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,u){this._charsets[l]=u,this.glevel===l&&(this.charset=u)}}},1753:function(a,o,l){var u=this&&this.__decorate||function(y,b,w,x){var k,S=arguments.length,E=S<3?b:x===null?x=Object.getOwnPropertyDescriptor(b,w):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(y,b,w,x);else for(var A=y.length-1;A>=0;A--)(k=y[A])&&(E=(S<3?k(E):S>3?k(b,w,E):k(b,w))||E);return S>3&&E&&Object.defineProperty(b,w,E),E},c=this&&this.__param||function(y,b){return function(w,x){b(w,x,y)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreMouseService=void 0;const h=l(2585),d=l(8460),p=l(844),m={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:y=>y.button!==4&&y.action===1&&(y.ctrl=!1,y.alt=!1,y.shift=!1,!0)},VT200:{events:19,restrict:y=>y.action!==32},DRAG:{events:23,restrict:y=>y.action!==32||y.button!==3},ANY:{events:31,restrict:y=>!0}};function _(y,b){let w=(y.ctrl?16:0)|(y.shift?4:0)|(y.alt?8:0);return y.button===4?(w|=64,w|=y.action):(w|=3&y.button,4&y.button&&(w|=64),8&y.button&&(w|=128),y.action===32?w|=32:y.action!==0||b||(w|=3)),w}const f=String.fromCharCode,v={DEFAULT:y=>{const b=[_(y,!1)+32,y.col+32,y.row+32];return b[0]>255||b[1]>255||b[2]>255?"":`\x1B[M${f(b[0])}${f(b[1])}${f(b[2])}`},SGR:y=>{const b=y.action===0&&y.button!==4?"m":"M";return`\x1B[<${_(y,!0)};${y.col};${y.row}${b}`},SGR_PIXELS:y=>{const b=y.action===0&&y.button!==4?"m":"M";return`\x1B[<${_(y,!0)};${y.x};${y.y}${b}`}};let g=o.CoreMouseService=class extends p.Disposable{constructor(y,b){super(),this._bufferService=y,this._coreService=b,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new d.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const w of Object.keys(m))this.addProtocol(w,m[w]);for(const w of Object.keys(v))this.addEncoding(w,v[w]);this.reset()}addProtocol(y,b){this._protocols[y]=b}addEncoding(y,b){this._encodings[y]=b}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(y){if(!this._protocols[y])throw new Error(`unknown protocol "${y}"`);this._activeProtocol=y,this._onProtocolChange.fire(this._protocols[y].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(y){if(!this._encodings[y])throw new Error(`unknown encoding "${y}"`);this._activeEncoding=y}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(y){if(y.col<0||y.col>=this._bufferService.cols||y.row<0||y.row>=this._bufferService.rows||y.button===4&&y.action===32||y.button===3&&y.action!==32||y.button!==4&&(y.action===2||y.action===3)||(y.col++,y.row++,y.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,y,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(y))return!1;const b=this._encodings[this._activeEncoding](y);return b&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(b):this._coreService.triggerDataEvent(b,!0)),this._lastEvent=y,!0}explainEvents(y){return{down:!!(1&y),up:!!(2&y),drag:!!(4&y),move:!!(8&y),wheel:!!(16&y)}}_equalEvents(y,b,w){if(w){if(y.x!==b.x||y.y!==b.y)return!1}else if(y.col!==b.col||y.row!==b.row)return!1;return y.button===b.button&&y.action===b.action&&y.ctrl===b.ctrl&&y.alt===b.alt&&y.shift===b.shift}};o.CoreMouseService=g=u([c(0,h.IBufferService),c(1,h.ICoreService)],g)},6975:function(a,o,l){var u=this&&this.__decorate||function(g,y,b,w){var x,k=arguments.length,S=k<3?y:w===null?w=Object.getOwnPropertyDescriptor(y,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(g,y,b,w);else for(var E=g.length-1;E>=0;E--)(x=g[E])&&(S=(k<3?x(S):k>3?x(y,b,S):x(y,b))||S);return k>3&&S&&Object.defineProperty(y,b,S),S},c=this&&this.__param||function(g,y){return function(b,w){y(b,w,g)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreService=void 0;const h=l(1439),d=l(8460),p=l(844),m=l(2585),_=Object.freeze({insertMode:!1}),f=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let v=o.CoreService=class extends p.Disposable{constructor(g,y,b){super(),this._bufferService=g,this._logService=y,this._optionsService=b,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new d.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new d.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new d.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new d.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,h.clone)(_),this.decPrivateModes=(0,h.clone)(f)}reset(){this.modes=(0,h.clone)(_),this.decPrivateModes=(0,h.clone)(f)}triggerDataEvent(g,y=!1){if(this._optionsService.rawOptions.disableStdin)return;const b=this._bufferService.buffer;y&&this._optionsService.rawOptions.scrollOnUserInput&&b.ybase!==b.ydisp&&this._onRequestScrollToBottom.fire(),y&&this._onUserInput.fire(),this._logService.debug(`sending data "${g}"`,()=>g.split("").map(w=>w.charCodeAt(0))),this._onData.fire(g)}triggerBinaryEvent(g){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${g}"`,()=>g.split("").map(y=>y.charCodeAt(0))),this._onBinary.fire(g))}};o.CoreService=v=u([c(0,m.IBufferService),c(1,m.ILogService),c(2,m.IOptionsService)],v)},9074:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DecorationService=void 0;const u=l(8055),c=l(8460),h=l(844),d=l(6106);let p=0,m=0;class _ extends h.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new d.SortedList(g=>g==null?void 0:g.marker.line),this._onDecorationRegistered=this.register(new c.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new c.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,h.toDisposable)(()=>this.reset()))}registerDecoration(g){if(g.marker.isDisposed)return;const y=new f(g);if(y){const b=y.marker.onDispose(()=>y.dispose());y.onDispose(()=>{y&&(this._decorations.delete(y)&&this._onDecorationRemoved.fire(y),b.dispose())}),this._decorations.insert(y),this._onDecorationRegistered.fire(y)}return y}reset(){for(const g of this._decorations.values())g.dispose();this._decorations.clear()}*getDecorationsAtCell(g,y,b){var w,x,k;let S=0,E=0;for(const A of this._decorations.getKeyIterator(y))S=(w=A.options.x)!==null&&w!==void 0?w:0,E=S+((x=A.options.width)!==null&&x!==void 0?x:1),g>=S&&g<E&&(!b||((k=A.options.layer)!==null&&k!==void 0?k:"bottom")===b)&&(yield A)}forEachDecorationAtCell(g,y,b,w){this._decorations.forEachByKey(y,x=>{var k,S,E;p=(k=x.options.x)!==null&&k!==void 0?k:0,m=p+((S=x.options.width)!==null&&S!==void 0?S:1),g>=p&&g<m&&(!b||((E=x.options.layer)!==null&&E!==void 0?E:"bottom")===b)&&w(x)})}}o.DecorationService=_;class f extends h.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=u.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=u.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(g){super(),this.options=g,this.onRenderEmitter=this.register(new c.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=g.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.InstantiationService=o.ServiceCollection=void 0;const u=l(2585),c=l(8343);class h{constructor(...p){this._entries=new Map;for(const[m,_]of p)this.set(m,_)}set(p,m){const _=this._entries.get(p);return this._entries.set(p,m),_}forEach(p){for(const[m,_]of this._entries.entries())p(m,_)}has(p){return this._entries.has(p)}get(p){return this._entries.get(p)}}o.ServiceCollection=h,o.InstantiationService=class{constructor(){this._services=new h,this._services.set(u.IInstantiationService,this)}setService(d,p){this._services.set(d,p)}getService(d){return this._services.get(d)}createInstance(d,...p){const m=(0,c.getServiceDependencies)(d).sort((v,g)=>v.index-g.index),_=[];for(const v of m){const g=this._services.get(v.id);if(!g)throw new Error(`[createInstance] ${d.name} depends on UNKNOWN service ${v.id}.`);_.push(g)}const f=m.length>0?m[0].index:p.length;if(p.length!==f)throw new Error(`[createInstance] First service dependency of ${d.name} at position ${f+1} conflicts with ${p.length} static arguments`);return new d(...p,..._)}}},7866:function(a,o,l){var u=this&&this.__decorate||function(f,v,g,y){var b,w=arguments.length,x=w<3?v:y===null?y=Object.getOwnPropertyDescriptor(v,g):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(f,v,g,y);else for(var k=f.length-1;k>=0;k--)(b=f[k])&&(x=(w<3?b(x):w>3?b(v,g,x):b(v,g))||x);return w>3&&x&&Object.defineProperty(v,g,x),x},c=this&&this.__param||function(f,v){return function(g,y){v(g,y,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.traceCall=o.setTraceLogger=o.LogService=void 0;const h=l(844),d=l(2585),p={trace:d.LogLevelEnum.TRACE,debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF};let m,_=o.LogService=class extends h.Disposable{get logLevel(){return this._logLevel}constructor(f){super(),this._optionsService=f,this._logLevel=d.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),m=this}_updateLogLevel(){this._logLevel=p[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(f){for(let v=0;v<f.length;v++)typeof f[v]=="function"&&(f[v]=f[v]())}_log(f,v,g){this._evalLazyOptionalParams(g),f.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+v,...g)}trace(f,...v){var g,y;this._logLevel<=d.LogLevelEnum.TRACE&&this._log((y=(g=this._optionsService.options.logger)===null||g===void 0?void 0:g.trace.bind(this._optionsService.options.logger))!==null&&y!==void 0?y:console.log,f,v)}debug(f,...v){var g,y;this._logLevel<=d.LogLevelEnum.DEBUG&&this._log((y=(g=this._optionsService.options.logger)===null||g===void 0?void 0:g.debug.bind(this._optionsService.options.logger))!==null&&y!==void 0?y:console.log,f,v)}info(f,...v){var g,y;this._logLevel<=d.LogLevelEnum.INFO&&this._log((y=(g=this._optionsService.options.logger)===null||g===void 0?void 0:g.info.bind(this._optionsService.options.logger))!==null&&y!==void 0?y:console.info,f,v)}warn(f,...v){var g,y;this._logLevel<=d.LogLevelEnum.WARN&&this._log((y=(g=this._optionsService.options.logger)===null||g===void 0?void 0:g.warn.bind(this._optionsService.options.logger))!==null&&y!==void 0?y:console.warn,f,v)}error(f,...v){var g,y;this._logLevel<=d.LogLevelEnum.ERROR&&this._log((y=(g=this._optionsService.options.logger)===null||g===void 0?void 0:g.error.bind(this._optionsService.options.logger))!==null&&y!==void 0?y:console.error,f,v)}};o.LogService=_=u([c(0,d.IOptionsService)],_),o.setTraceLogger=function(f){m=f},o.traceCall=function(f,v,g){if(typeof g.value!="function")throw new Error("not supported");const y=g.value;g.value=function(...b){if(m.logLevel!==d.LogLevelEnum.TRACE)return y.apply(this,b);m.trace(`GlyphRenderer#${y.name}(${b.map(x=>JSON.stringify(x)).join(", ")})`);const w=y.apply(this,b);return m.trace(`GlyphRenderer#${y.name} return`,w),w}}},7302:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OptionsService=o.DEFAULT_OPTIONS=void 0;const u=l(8460),c=l(844),h=l(6114);o.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:h.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const d=["normal","bold","100","200","300","400","500","600","700","800","900"];class p extends c.Disposable{constructor(_){super(),this._onOptionChange=this.register(new u.EventEmitter),this.onOptionChange=this._onOptionChange.event;const f=Object.assign({},o.DEFAULT_OPTIONS);for(const v in _)if(v in f)try{const g=_[v];f[v]=this._sanitizeAndValidateOption(v,g)}catch(g){console.error(g)}this.rawOptions=f,this.options=Object.assign({},f),this._setupOptions()}onSpecificOptionChange(_,f){return this.onOptionChange(v=>{v===_&&f(this.rawOptions[_])})}onMultipleOptionChange(_,f){return this.onOptionChange(v=>{_.indexOf(v)!==-1&&f()})}_setupOptions(){const _=v=>{if(!(v in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${v}"`);return this.rawOptions[v]},f=(v,g)=>{if(!(v in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${v}"`);g=this._sanitizeAndValidateOption(v,g),this.rawOptions[v]!==g&&(this.rawOptions[v]=g,this._onOptionChange.fire(v))};for(const v in this.rawOptions){const g={get:_.bind(this,v),set:f.bind(this,v)};Object.defineProperty(this.options,v,g)}}_sanitizeAndValidateOption(_,f){switch(_){case"cursorStyle":if(f||(f=o.DEFAULT_OPTIONS[_]),!function(v){return v==="block"||v==="underline"||v==="bar"}(f))throw new Error(`"${f}" is not a valid value for ${_}`);break;case"wordSeparator":f||(f=o.DEFAULT_OPTIONS[_]);break;case"fontWeight":case"fontWeightBold":if(typeof f=="number"&&1<=f&&f<=1e3)break;f=d.includes(f)?f:o.DEFAULT_OPTIONS[_];break;case"cursorWidth":f=Math.floor(f);case"lineHeight":case"tabStopWidth":if(f<1)throw new Error(`${_} cannot be less than 1, value: ${f}`);break;case"minimumContrastRatio":f=Math.max(1,Math.min(21,Math.round(10*f)/10));break;case"scrollback":if((f=Math.min(f,4294967295))<0)throw new Error(`${_} cannot be less than 0, value: ${f}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(f<=0)throw new Error(`${_} cannot be less than or equal to 0, value: ${f}`);break;case"rows":case"cols":if(!f&&f!==0)throw new Error(`${_} must be numeric, value: ${f}`);break;case"windowsPty":f=f??{}}return f}}o.OptionsService=p},2660:function(a,o,l){var u=this&&this.__decorate||function(p,m,_,f){var v,g=arguments.length,y=g<3?m:f===null?f=Object.getOwnPropertyDescriptor(m,_):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(p,m,_,f);else for(var b=p.length-1;b>=0;b--)(v=p[b])&&(y=(g<3?v(y):g>3?v(m,_,y):v(m,_))||y);return g>3&&y&&Object.defineProperty(m,_,y),y},c=this&&this.__param||function(p,m){return function(_,f){m(_,f,p)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkService=void 0;const h=l(2585);let d=o.OscLinkService=class{constructor(p){this._bufferService=p,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(p){const m=this._bufferService.buffer;if(p.id===void 0){const b=m.addMarker(m.ybase+m.y),w={data:p,id:this._nextId++,lines:[b]};return b.onDispose(()=>this._removeMarkerFromLink(w,b)),this._dataByLinkId.set(w.id,w),w.id}const _=p,f=this._getEntryIdKey(_),v=this._entriesWithId.get(f);if(v)return this.addLineToLink(v.id,m.ybase+m.y),v.id;const g=m.addMarker(m.ybase+m.y),y={id:this._nextId++,key:this._getEntryIdKey(_),data:_,lines:[g]};return g.onDispose(()=>this._removeMarkerFromLink(y,g)),this._entriesWithId.set(y.key,y),this._dataByLinkId.set(y.id,y),y.id}addLineToLink(p,m){const _=this._dataByLinkId.get(p);if(_&&_.lines.every(f=>f.line!==m)){const f=this._bufferService.buffer.addMarker(m);_.lines.push(f),f.onDispose(()=>this._removeMarkerFromLink(_,f))}}getLinkData(p){var m;return(m=this._dataByLinkId.get(p))===null||m===void 0?void 0:m.data}_getEntryIdKey(p){return`${p.id};;${p.uri}`}_removeMarkerFromLink(p,m){const _=p.lines.indexOf(m);_!==-1&&(p.lines.splice(_,1),p.lines.length===0&&(p.data.id!==void 0&&this._entriesWithId.delete(p.key),this._dataByLinkId.delete(p.id)))}};o.OscLinkService=d=u([c(0,h.IBufferService)],d)},8343:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createDecorator=o.getServiceDependencies=o.serviceRegistry=void 0;const l="di$target",u="di$dependencies";o.serviceRegistry=new Map,o.getServiceDependencies=function(c){return c[u]||[]},o.createDecorator=function(c){if(o.serviceRegistry.has(c))return o.serviceRegistry.get(c);const h=function(d,p,m){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(_,f,v){f[l]===f?f[u].push({id:_,index:v}):(f[u]=[{id:_,index:v}],f[l]=f)})(h,d,m)};return h.toString=()=>c,o.serviceRegistry.set(c,h),h}},2585:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.IDecorationService=o.IUnicodeService=o.IOscLinkService=o.IOptionsService=o.ILogService=o.LogLevelEnum=o.IInstantiationService=o.ICharsetService=o.ICoreService=o.ICoreMouseService=o.IBufferService=void 0;const u=l(8343);var c;o.IBufferService=(0,u.createDecorator)("BufferService"),o.ICoreMouseService=(0,u.createDecorator)("CoreMouseService"),o.ICoreService=(0,u.createDecorator)("CoreService"),o.ICharsetService=(0,u.createDecorator)("CharsetService"),o.IInstantiationService=(0,u.createDecorator)("InstantiationService"),function(h){h[h.TRACE=0]="TRACE",h[h.DEBUG=1]="DEBUG",h[h.INFO=2]="INFO",h[h.WARN=3]="WARN",h[h.ERROR=4]="ERROR",h[h.OFF=5]="OFF"}(c||(o.LogLevelEnum=c={})),o.ILogService=(0,u.createDecorator)("LogService"),o.IOptionsService=(0,u.createDecorator)("OptionsService"),o.IOscLinkService=(0,u.createDecorator)("OscLinkService"),o.IUnicodeService=(0,u.createDecorator)("UnicodeService"),o.IDecorationService=(0,u.createDecorator)("DecorationService")},1480:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeService=void 0;const u=l(8460),c=l(225);o.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new u.EventEmitter,this.onChange=this._onChange.event;const h=new c.UnicodeV6;this.register(h),this._active=h.version,this._activeProvider=h}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(h){if(!this._providers[h])throw new Error(`unknown Unicode version "${h}"`);this._active=h,this._activeProvider=this._providers[h],this._onChange.fire(h)}register(h){this._providers[h.version]=h}wcwidth(h){return this._activeProvider.wcwidth(h)}getStringCellWidth(h){let d=0;const p=h.length;for(let m=0;m<p;++m){let _=h.charCodeAt(m);if(55296<=_&&_<=56319){if(++m>=p)return d+this.wcwidth(_);const f=h.charCodeAt(m);56320<=f&&f<=57343?_=1024*(_-55296)+f-56320+65536:d+=this.wcwidth(f)}d+=this.wcwidth(_)}return d}}}},i={};function r(a){var o=i[a];if(o!==void 0)return o.exports;var l=i[a]={exports:{}};return n[a].call(l.exports,l,l.exports,r),l.exports}var s={};return(()=>{var a=s;Object.defineProperty(a,"__esModule",{value:!0}),a.Terminal=void 0;const o=r(9042),l=r(3236),u=r(844),c=r(5741),h=r(8285),d=r(7975),p=r(7090),m=["cols","rows"];class _ extends u.Disposable{constructor(v){super(),this._core=this.register(new l.Terminal(v)),this._addonManager=this.register(new c.AddonManager),this._publicOptions=Object.assign({},this._core.options);const g=b=>this._core.options[b],y=(b,w)=>{this._checkReadonlyOptions(b),this._core.options[b]=w};for(const b in this._core.options){const w={get:g.bind(this,b),set:y.bind(this,b)};Object.defineProperty(this._publicOptions,b,w)}}_checkReadonlyOptions(v){if(m.includes(v))throw new Error(`Option "${v}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new d.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new p.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new h.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const v=this._core.coreService.decPrivateModes;let g="none";switch(this._core.coreMouseService.activeProtocol){case"X10":g="x10";break;case"VT200":g="vt200";break;case"DRAG":g="drag";break;case"ANY":g="any"}return{applicationCursorKeysMode:v.applicationCursorKeys,applicationKeypadMode:v.applicationKeypad,bracketedPasteMode:v.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:g,originMode:v.origin,reverseWraparoundMode:v.reverseWraparound,sendFocusMode:v.sendFocus,wraparoundMode:v.wraparound}}get options(){return this._publicOptions}set options(v){for(const g in v)this._publicOptions[g]=v[g]}blur(){this._core.blur()}focus(){this._core.focus()}resize(v,g){this._verifyIntegers(v,g),this._core.resize(v,g)}open(v){this._core.open(v)}attachCustomKeyEventHandler(v){this._core.attachCustomKeyEventHandler(v)}registerLinkProvider(v){return this._core.registerLinkProvider(v)}registerCharacterJoiner(v){return this._checkProposedApi(),this._core.registerCharacterJoiner(v)}deregisterCharacterJoiner(v){this._checkProposedApi(),this._core.deregisterCharacterJoiner(v)}registerMarker(v=0){return this._verifyIntegers(v),this._core.registerMarker(v)}registerDecoration(v){var g,y,b;return this._checkProposedApi(),this._verifyPositiveIntegers((g=v.x)!==null&&g!==void 0?g:0,(y=v.width)!==null&&y!==void 0?y:0,(b=v.height)!==null&&b!==void 0?b:0),this._core.registerDecoration(v)}hasSelection(){return this._core.hasSelection()}select(v,g,y){this._verifyIntegers(v,g,y),this._core.select(v,g,y)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(v,g){this._verifyIntegers(v,g),this._core.selectLines(v,g)}dispose(){super.dispose()}scrollLines(v){this._verifyIntegers(v),this._core.scrollLines(v)}scrollPages(v){this._verifyIntegers(v),this._core.scrollPages(v)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(v){this._verifyIntegers(v),this._core.scrollToLine(v)}clear(){this._core.clear()}write(v,g){this._core.write(v,g)}writeln(v,g){this._core.write(v),this._core.write(`\r
`,g)}paste(v){this._core.paste(v)}refresh(v,g){this._verifyIntegers(v,g),this._core.refresh(v,g)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(v){this._addonManager.loadAddon(this,v)}static get strings(){return o}_verifyIntegers(...v){for(const g of v)if(g===1/0||isNaN(g)||g%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...v){for(const g of v)if(g&&(g===1/0||isNaN(g)||g%1!=0||g<0))throw new Error("This API only accepts positive integers")}}a.Terminal=_})(),s})())})(rE);var oE=rE.exports,aE={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(self,()=>(()=>{var n={};return(()=>{var i=n;Object.defineProperty(i,"__esModule",{value:!0}),i.FitAddon=void 0,i.FitAddon=class{activate(r){this._terminal=r}dispose(){}fit(){const r=this.proposeDimensions();if(!r||!this._terminal||isNaN(r.cols)||isNaN(r.rows))return;const s=this._terminal._core;this._terminal.rows===r.rows&&this._terminal.cols===r.cols||(s._renderService.clear(),this._terminal.resize(r.cols,r.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const r=this._terminal._core,s=r._renderService.dimensions;if(s.css.cell.width===0||s.css.cell.height===0)return;const a=this._terminal.options.scrollback===0?0:r.viewport.scrollBarWidth,o=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(o.getPropertyValue("height")),u=Math.max(0,parseInt(o.getPropertyValue("width"))),c=window.getComputedStyle(this._terminal.element),h=l-(parseInt(c.getPropertyValue("padding-top"))+parseInt(c.getPropertyValue("padding-bottom"))),d=u-(parseInt(c.getPropertyValue("padding-right"))+parseInt(c.getPropertyValue("padding-left")))-a;return{cols:Math.max(2,Math.floor(d/s.css.cell.width)),rows:Math.max(1,Math.floor(h/s.css.cell.height))}}}})(),n})())})(aE);var lE=aE.exports;const AF=(t,e,n,i,r)=>{let s;s=`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}`;const a=new URLSearchParams;t&&a.set("session_id",t),e&&a.set("resume","1"),i&&a.set("provider",i),r&&a.set("session_name",r);const o=a.toString();return`${s}/ws/pty${o?`?${o}`:""}`};function uE({isActive:t=!0,onFirstPrompt:e,provider:n="claude",sessionId:i,sessionName:r,resume:s,onSessionStarted:a,onResumeMissing:o,bannerMessage:l,onBannerShown:u}){const c=I.useRef(null),h=I.useRef(null),d=I.useRef(null),p=I.useRef(null),m=I.useRef(t),_=I.useRef(""),f=I.useRef(!1),v=I.useRef(!1),g=I.useRef(!1),y=I.useRef(!1),b=I.useRef(!1),w=I.useRef(null),x=I.useRef(null),k=(n||"claude").toLowerCase(),S=k==="codex"?"Codex":k==="claude"?"Claude":`${k.charAt(0).toUpperCase()}${k.slice(1)}`;return I.useEffect(()=>{m.current=t,t&&(d.current&&h.current&&y.current&&b.current&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{var E;try{if(!((E=c.current)!=null&&E.isConnected))return;d.current.fit(),h.current.focus()}catch{}})}),!y.current&&w.current&&w.current())},[t]),I.useEffect(()=>{if(!c.current)return;const E=new oE.Terminal({cursorBlink:!0,convertEol:!1,fontFamily:'"IBM Plex Mono", "SFMono-Regular", Menlo, monospace',fontSize:13,theme:{background:"#f8fafc",foreground:"#111827",cursor:"#111827",selectionBackground:"#bfdbfe",black:"#0f172a",red:"#dc2626",green:"#16a34a",yellow:"#f59e0b",blue:"#2563eb",magenta:"#db2777",cyan:"#0891b2",white:"#e2e8f0"}}),A=new lE.FitAddon;E.loadAddon(A),h.current=E,d.current=A;let M=!0,R=null,P=!1,H=0;const B=10,L=500,j=()=>{if(!m.current||!y.current||!c.current||c.current.clientWidth===0||c.current.clientHeight===0||!b.current)return;try{A.fit()}catch{return}const ee=p.current;!ee||ee.readyState!==WebSocket.OPEN||ee.send(JSON.stringify({type:"resize",cols:E.cols,rows:E.rows}))},D=()=>{if(P)return;P=!0,g.current=!1;const ee=new WebSocket(AF(i,s,!1,k,r));p.current=ee;let K=!1;ee.addEventListener("message",ce=>{let T;try{T=JSON.parse(ce.data)}catch{T={type:"output",data:ce.data}}if(T.type==="session_not_found"){s&&!K&&(K=!0,E.writeln(`\r
[bridge] No saved conversation found. Starting a new session...\r
`),o==null||o());return}if(T.type==="history"&&typeof T.data=="string"){g.current||(g.current=!0,E.reset()),E.write(T.data);return}if(T.type==="output"&&typeof T.data=="string"&&(s&&!K&&T.data.includes("No conversation found with session ID")&&(K=!0,E.writeln(`\r
[bridge] No saved conversation found. Starting a new session...\r
`),o==null||o()),E.write(T.data)),T.type==="error"&&E.writeln(`\r
[bridge] ${T.data}\r
`),T.type==="exit"){const $=T.code??"unknown";E.writeln(`\r
[bridge] ${S} CLI exited (${$}).\r
`)}}),ee.addEventListener("open",()=>{m.current&&j(),a&&!v.current&&(v.current=!0,a())}),ee.addEventListener("error",()=>{H>=3&&E.writeln(`\r
[bridge] Unable to connect. Retrying...\r
`)}),ee.addEventListener("close",()=>{if(M){if(H++,H>B){E.writeln(`\r
[bridge] Max retries reached. Click "New session" to try again.\r
`);return}R=window.setTimeout(()=>{P=!1,D()},L)}})},O=()=>{M=!1;const ee=p.current;ee&&ee.readyState===WebSocket.OPEN&&ee.close()},N=()=>{const ee=p.current;(ee==null?void 0:ee.readyState)===WebSocket.OPEN&&m.current&&j()};window.addEventListener("resize",N),window.addEventListener("beforeunload",O);const z=ee=>{if(!e||f.current)return;const K=ee.replace(/\x1b\[[0-9;]*[A-Za-z]/g,"");let ce=_.current;for(const T of K)if(T==="\r"||T===`
`){const $=ce.trim();$&&(f.current=!0,e($)),ce=""}else T===""?ce=ce.slice(0,-1):ce+=T;_.current=ce};E.onData(ee=>{z(ee);const K=p.current;(K==null?void 0:K.readyState)===WebSocket.OPEN&&K.send(JSON.stringify({type:"input",data:ee}))});const q=()=>{if(!c.current||!c.current.isConnected||!c.current.getClientRects().length||c.current.clientWidth===0||c.current.clientHeight===0)return!1;const K=window.getComputedStyle(c.current);return!(K.visibility==="hidden"||K.display==="none")},te=()=>{if(y.current||!m.current)return;if(!q()){x.current=window.setTimeout(te,60);return}try{E.open(c.current),y.current=!0}catch{x.current=window.setTimeout(te,60);return}const ee=E.onRender(()=>{ee.dispose(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{b.current=!0;try{A.fit(),m.current&&E.focus()}catch{}m.current&&j()})})});l&&(E.writeln(`\r
[bridge] ${l}\r
`),u==null||u()),D()};return w.current=te,m.current&&te(),()=>{window.removeEventListener("resize",N),window.removeEventListener("beforeunload",O),M=!1,R&&window.clearTimeout(R),x.current&&window.clearTimeout(x.current),p.current&&p.current.close(),E.dispose()}},[]),C.jsx("div",{className:"terminal",ref:c})}const Jm="kurt-web-terminal-sessions",Zm="kurt-web-terminal-active",cE=[{id:"claude",label:"Claude"},{id:"codex",label:"Codex"}],Ym="claude",sc=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`session-${Math.random().toString(36).slice(2)}`,TF=()=>{try{const t=localStorage.getItem(Jm);if(!t)return null;const e=JSON.parse(t);return!Array.isArray(e)||e.length===0?null:e}catch{return null}},MF=()=>{try{const t=localStorage.getItem(Zm);if(!t)return null;const e=Number(t);return Number.isNaN(e)?null:e}catch{return null}},RF=(t,e)=>{const{bannerMessage:n,...i}=t,r=Number(i.id)||e,s=typeof i.provider=="string"?i.provider.toLowerCase():Ym;return{...i,id:r,title:i.title||`Session ${r}`,provider:s,sessionId:i.sessionId||sc()}},OF=t=>t.map(({bannerMessage:e,resume:n,...i})=>i),PF=t=>{const e=cE.find(n=>n.id===t);return e?e.label:t?`${t.charAt(0).toUpperCase()}${t.slice(1)}`:"Claude"},NF=t=>{if(!t)return"";const e=t.split("/");return e[e.length-1]};function IF({params:t}){var b;const{collapsed:e,onToggleCollapse:n,approvals:i,onFocusReview:r,onDecision:s,normalizeApprovalPath:a}=t||{},o=I.useRef(1),[l,u]=I.useState(()=>{const w=TF();return w?w.map((x,k)=>({...RF(x,k+1),resume:!0})):[{id:1,title:"Session 1",provider:Ym,sessionId:sc(),resume:!1}]}),[c,h]=I.useState(()=>{const w=MF();return w||(w===0?0:null)}),[d,p]=I.useState(Ym),m=I.useCallback(w=>{const x=w.replace(/\s+/g," ").trim();return x?x.length>28?`${x.slice(0,28)}`:x:"Session"},[]),_=I.useCallback((w,x)=>{u(k=>k.map(S=>S.id!==w||!S.title.startsWith("Session")?S:{...S,title:m(x)}))},[m]),f=()=>{const w=o.current+1;o.current=w;const x={id:w,title:`Session ${w}`,provider:d,sessionId:sc(),resume:!1};u(k=>[...k,x]),h(w)},v=w=>{u(x=>{if(w==null)return x;const k=x.filter(S=>S.id!==w);return k.length===0?(h(null),k):(w===c&&h(k[k.length-1].id),k)})},g=I.useCallback(w=>{u(x=>x.map(k=>k.id===w?{...k,bannerMessage:void 0}:k))},[]),y=I.useCallback(w=>{u(x=>x.map(k=>k.id===w?{...k,sessionId:sc(),resume:!1}:k))},[]);return I.useEffect(()=>{var x;const w=l.reduce((k,S)=>Math.max(k,S.id),1);if(o.current=w,!l.length){h(null);return}l.some(k=>k.id===c)||h(((x=l[0])==null?void 0:x.id)||1)},[l,c]),I.useEffect(()=>{try{l.length===0?localStorage.removeItem(Jm):localStorage.setItem(Jm,JSON.stringify(OF(l))),c==null?localStorage.removeItem(Zm):localStorage.setItem(Zm,String(c))}catch{}},[l,c]),e?C.jsxs("div",{className:"panel-content terminal-panel-content terminal-collapsed",children:[C.jsx("button",{type:"button",className:"sidebar-toggle-btn",onClick:n,title:"Expand agent panel","aria-label":"Expand agent panel",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M10 3.5L5.5 8L10 12.5V3.5Z"})})}),C.jsx("div",{className:"sidebar-collapsed-label",children:"Agent"})]}):C.jsxs("div",{className:"panel-content terminal-panel-content",children:[C.jsxs("div",{className:"terminal-header",children:[C.jsx("button",{type:"button",className:"sidebar-toggle-btn",onClick:n,title:"Collapse agent panel","aria-label":"Collapse agent panel",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M6 3.5L10.5 8L6 12.5V3.5Z"})})}),C.jsxs("div",{className:"terminal-title",children:[C.jsx("span",{className:"status-dot"}),"Agent Sessions"]}),C.jsxs("div",{className:"terminal-actions",children:[C.jsx("select",{id:"terminal-provider-select",className:"terminal-select terminal-provider-select",value:d,onChange:w=>p(w.target.value),"aria-label":"Provider",children:cE.map(w=>C.jsx("option",{value:w.id,children:w.label},w.id))}),C.jsx("button",{type:"button",className:"terminal-new terminal-new-icon",onClick:f,"aria-label":"New session",title:"New session",children:C.jsx("span",{"aria-hidden":"true",children:"+"})})]})]}),l.length===0?C.jsxs("div",{className:"terminal-empty",children:[C.jsx("p",{children:"No active sessions."}),C.jsx("button",{type:"button",className:"terminal-new",onClick:f,children:"Start new session"})]}):C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"terminal-session-bar",children:[C.jsx("label",{htmlFor:"terminal-session-select",children:"Session"}),C.jsx("select",{id:"terminal-session-select",className:"terminal-select",value:c??"",onChange:w=>h(Number(w.target.value)),children:l.map(w=>C.jsx("option",{value:w.id,children:`${w.title} (${PF(w.provider)}) - ${w.sessionId.slice(0,8)}`},w.id))}),C.jsx("button",{type:"button",className:"terminal-copy-id",onClick:()=>{const w=l.find(x=>x.id===c);w!=null&&w.sessionId&&navigator.clipboard.writeText(w.sessionId)},title:((b=l.find(w=>w.id===c))==null?void 0:b.sessionId)||"Copy session ID",children:C.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor",children:[C.jsx("path",{d:"M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"}),C.jsx("path",{d:"M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"})]})}),C.jsx("button",{type:"button",className:"terminal-close-button",onClick:()=>v(c),children:"Close"})]}),C.jsx("div",{className:"terminal-body",children:l.map(w=>C.jsx("div",{className:`terminal-instance ${w.id===c?"active":""}`,children:C.jsx(uE,{isActive:w.id===c,provider:w.provider,sessionId:w.sessionId,sessionName:w.title,resume:!!w.resume,onFirstPrompt:x=>_(w.id,x),onResumeMissing:()=>y(w.id),bannerMessage:w.bannerMessage,onBannerShown:()=>g(w.id)},`${w.id}-${w.sessionId}-${w.provider}-${w.resume}`)},w.id))})]}),Array.isArray(i)&&i.length>0&&C.jsxs("div",{className:"review-list",children:[C.jsxs("div",{className:"review-list-header",children:[C.jsx("span",{className:"review-list-badge",children:i.length}),"Pending Reviews"]}),C.jsx("div",{className:"review-list-items",children:i.map(w=>{const x=(a==null?void 0:a(w))||w.project_path||w.file_path||"",k=NF(x)||w.tool_name||"Review";return C.jsxs("div",{className:"review-list-item",onClick:()=>r==null?void 0:r(w.id),role:"button",tabIndex:0,onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&(r==null||r(w.id))},children:[C.jsxs("div",{className:"review-list-item-info",children:[C.jsx("span",{className:"review-list-item-name",children:k}),x&&C.jsx("span",{className:"review-list-item-path",children:x})]}),C.jsxs("div",{className:"review-list-item-actions",children:[C.jsx("button",{type:"button",className:"review-list-deny",onClick:S=>{S.stopPropagation(),s==null||s(w.id,"deny")},title:"Deny",children:""}),C.jsx("button",{type:"button",className:"review-list-allow",onClick:S=>{S.stopPropagation(),s==null||s(w.id,"allow")},title:"Allow",children:""})]})]},w.id)})})]})]})}const Xm="kurt-web-shell-sessions",Qm="kurt-web-shell-active",oc=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`shell-${Math.random().toString(36).slice(2)}`,LF=()=>{try{const t=localStorage.getItem(Xm);if(!t)return null;const e=JSON.parse(t);return!Array.isArray(e)||e.length===0?null:e}catch{return null}},BF=()=>{try{const t=localStorage.getItem(Qm);if(!t)return null;const e=Number(t);return Number.isNaN(e)?null:e}catch{return null}},zF=(t,e)=>{const{bannerMessage:n,...i}=t,r=Number(i.id)||e;return{...i,id:r,title:i.title||`Shell ${r}`,provider:"shell",sessionId:i.sessionId||oc()}},FF=t=>t.map(({bannerMessage:e,resume:n,...i})=>i);function jF(){var h;const t=I.useRef(1),[e,n]=I.useState(()=>{const d=LF();return d?d.map((p,m)=>({...zF(p,m+1),resume:!0})):[{id:1,title:"Shell 1",provider:"shell",sessionId:oc(),resume:!1}]}),[i,r]=I.useState(()=>{const d=BF();return d||(d===0?0:null)}),s=I.useCallback(d=>{const p=d.replace(/\s+/g," ").trim();return p?p.length>28?`${p.slice(0,28)}`:p:"Shell"},[]),a=I.useCallback((d,p)=>{n(m=>m.map(_=>_.id!==d||!_.title.startsWith("Shell")?_:{..._,title:s(p)}))},[s]),o=()=>{const d=t.current+1;t.current=d;const p={id:d,title:`Shell ${d}`,provider:"shell",sessionId:oc(),resume:!1};n(m=>[...m,p]),r(d)},l=d=>{n(p=>{if(d==null)return p;const m=p.filter(_=>_.id!==d);return m.length===0?(r(null),m):(d===i&&r(m[m.length-1].id),m)})},u=I.useCallback(d=>{n(p=>p.map(m=>m.id===d?{...m,bannerMessage:void 0}:m))},[]),c=I.useCallback(d=>{n(p=>p.map(m=>m.id===d?{...m,sessionId:oc(),resume:!1}:m))},[]);return I.useEffect(()=>{var p;const d=e.reduce((m,_)=>Math.max(m,_.id),1);if(t.current=d,!e.length){r(null);return}e.some(m=>m.id===i)||r(((p=e[0])==null?void 0:p.id)||1)},[e,i]),I.useEffect(()=>{try{e.length===0?localStorage.removeItem(Xm):localStorage.setItem(Xm,JSON.stringify(FF(e))),i==null?localStorage.removeItem(Qm):localStorage.setItem(Qm,String(i))}catch{}},[e,i]),C.jsxs("div",{className:"panel-content shell-panel-content",children:[C.jsx("div",{className:"shell-header",children:C.jsxs("div",{className:"shell-session-bar",children:[C.jsx("select",{id:"shell-session-select",className:"terminal-select",value:i??"",onChange:d=>r(Number(d.target.value)),children:e.map(d=>C.jsx("option",{value:d.id,children:`${d.title} - ${d.sessionId.slice(0,8)}`},d.id))}),C.jsx("button",{type:"button",className:"terminal-copy-id",onClick:()=>{const d=e.find(p=>p.id===i);d!=null&&d.sessionId&&navigator.clipboard.writeText(d.sessionId)},title:((h=e.find(d=>d.id===i))==null?void 0:h.sessionId)||"Copy session ID",children:C.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor",children:[C.jsx("path",{d:"M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"}),C.jsx("path",{d:"M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"})]})}),C.jsx("button",{type:"button",className:"terminal-new terminal-new-icon",onClick:o,"aria-label":"New shell",title:"New shell",children:C.jsx("span",{"aria-hidden":"true",children:"+"})}),C.jsx("button",{type:"button",className:"terminal-close-button",onClick:()=>l(i),children:"Close"})]})}),e.length===0?C.jsxs("div",{className:"terminal-empty",children:[C.jsx("p",{children:"No active shells."}),C.jsx("button",{type:"button",className:"terminal-new",onClick:o,children:"Start new shell"})]}):C.jsx("div",{className:"terminal-body",children:e.map(d=>C.jsx("div",{className:`terminal-instance ${d.id===i?"active":""}`,children:C.jsx(uE,{isActive:d.id===i,provider:"shell",sessionId:d.sessionId,sessionName:d.title,resume:!!d.resume,onFirstPrompt:p=>a(d.id,p),onResumeMissing:()=>c(d.id),bannerMessage:d.bannerMessage,onBannerShown:()=>u(d.id)},`${d.id}-${d.sessionId}-${d.resume}`)},d.id))})]})}function HF(){return C.jsx("div",{className:"panel-content empty-panel",children:C.jsx("div",{className:"empty-panel-content",children:C.jsx("p",{children:"Open a file from the sidebar to start editing"})})})}function $F({request:t,onFeedbackChange:e}){const[n,i]=I.useState("");return I.useEffect(()=>{i("")},[t==null?void 0:t.id]),I.useEffect(()=>{e==null||e(n)},[n,e]),t?C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"approval-feedback",children:[C.jsx("label",{htmlFor:"approval-feedback-input",children:"Feedback (optional)"}),C.jsx("textarea",{id:"approval-feedback-input",value:n,onChange:r=>i(r.target.value),placeholder:"Tell Claude what to adjust before approving.",rows:2})]}),C.jsx("div",{className:"approval-diff",children:C.jsx(fv,{diff:t.diff,showFileHeader:!1})})]}):null}const WF=t=>{if(!t)return"";const e=[];return t.session_provider&&e.push(t.session_provider),t.session_name&&e.push(t.session_name),t.session_id&&e.push(t.session_id.slice(0,8)),e.join(" | ")};function VF({params:t}){const{request:e,filePath:n,onDecision:i,onOpenFile:r}=t||{},[s,a]=I.useState("");if(I.useEffect(()=>{a("")},[e==null?void 0:e.id]),!e)return C.jsx("div",{className:"panel-content review-panel-content",children:C.jsx("div",{className:"approval-panel",children:C.jsx("div",{className:"approval-header",children:C.jsx("div",{className:"approval-title",children:"Review no longer pending"})})})});const o=WF(e),l=e.tool_name?`Review: ${e.tool_name}`:"Review",u=n||e.project_path||e.file_path||"";return C.jsx("div",{className:"panel-content review-panel-content",children:C.jsxs("div",{className:"approval-panel",children:[C.jsxs("div",{className:"approval-header",children:[C.jsxs("div",{children:[C.jsx("div",{className:"approval-title",children:l}),u&&C.jsx("div",{className:"approval-path",children:u})]}),u&&r&&C.jsx("button",{type:"button",className:"approval-secondary",onClick:()=>r(u),children:"Open file"})]}),o&&C.jsx("div",{className:"approval-meta",children:o}),C.jsx($F,{request:e,onFeedbackChange:a}),C.jsxs("div",{className:"approval-actions",children:[C.jsx("button",{type:"button",className:"approval-deny",onClick:()=>i==null?void 0:i(e.id,"deny",s),children:"Deny"}),C.jsx("button",{type:"button",className:"approval-allow",onClick:()=>i==null?void 0:i(e.id,"allow",s),children:"Allow"})]})]})})}const GF="",wl=t=>`${GF}${t}`,gb=3,UF=t=>({discovering:"Discovering URLs",fetching:"Fetching Content",saving:"Saving Files",embedding:"Generating Embeddings",persisting:"Saving to Database"})[t]||t,qF=t=>({map_url:"URL Discovery",map_sources:"Source Mapping",fetch_documents:"Fetch Documents",save_content:"Save Content",generate_embeddings:"Generate Embeddings",persist_documents:"Persist to DB"})[t]||t.replace(/_/g," "),mv=t=>{if(t==null)return null;if(t<1e3)return`${t}ms`;const e=t/1e3;if(e<60)return`${e.toFixed(1)}s`;const n=Math.floor(e/60),i=Math.round(e%60);return`${n}m ${i}s`},KF=t=>t?Array.isArray(t)?t:Array.isArray(t.args)?t.args:null:null,vb=t=>typeof t!="string"?!1:t.startsWith("http://")||t.startsWith("https://"),JF=t=>{const e=KF(t);if(!e||e.length===0)return[];const n=e[0],i=Array.isArray(e[4])?e[4]:null,r=typeof e[4]=="string"?e[4]:null;return typeof n=="string"&&vb(n)?[{docId:r,url:n}]:Array.isArray(n)?n.filter(a=>vb(a)).map((a,o)=>({docId:i&&i[o]?i[o]:null,url:a})):[]},ZF=t=>t?t.length<=12?t:`${t.slice(0,8)}`:"-",YF=(t,e)=>{if(!t)return null;if(e==="map_workflow"||e==="map"){let n="kurt content map";return t.source_url?n+=` "${t.source_url}"`:t.url&&(n+=` "${t.url}"`),t.max_depth!=null&&(n+=` --max-depth ${t.max_depth}`),t.max_pages!=null&&(n+=` --max-pages ${t.max_pages}`),t.include_pattern&&(n+=` --include "${t.include_pattern}"`),t.exclude_pattern&&(n+=` --exclude "${t.exclude_pattern}"`),t.dry_run&&(n+=" --dry-run"),n}if(e==="fetch_workflow"||e==="fetch"){let n="kurt content fetch";return t.fetch_engine&&t.fetch_engine!=="trafilatura"&&(n+=` --engine ${t.fetch_engine}`),t.dry_run&&(n+=" --dry-run"),n}return null},hE=(t,e)=>{if(t!=null&&t.cli_command)return t.cli_command;if(e!=null&&e.cli_command)return e.cli_command;if(t!=null&&t.inputs){if(typeof t.inputs=="string")return t.inputs;const n=YF(t.inputs,(e==null?void 0:e.name)||(e==null?void 0:e.workflow_type));if(n)return n;try{return JSON.stringify(t.inputs,null,2)}catch{return String(t.inputs)}}return null};function dE({command:t}){return t?C.jsxs("div",{className:"workflow-command-section",children:[C.jsx("div",{className:"workflow-command-label",children:"Input"}),C.jsxs("div",{className:"workflow-command-wrapper",children:[C.jsx("code",{className:"workflow-inputs-content workflow-command",children:t}),C.jsx("button",{type:"button",className:"workflow-command-copy",onClick:()=>{navigator.clipboard.writeText(t).catch(()=>{})},title:"Copy command",children:C.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),C.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]})]}):null}function XF({step:t,logs:e,isExpanded:n,onToggle:i,onOpen:r,children:s,showLogs:a=!0}){var p;const o=t.success??0,l=t.error??0,u=mv(t.duration_ms)||"-",c=l>0||t.status==="error"?"error":t.status==="success"||t.status==="completed"||o>0?"success":"running",h=c==="error"?"step-status-error":c==="success"||c==="completed"?"step-status-success":"step-status-running",d=()=>{!n&&r&&a&&r(),i()};return C.jsxs("div",{className:"workflow-step-box",children:[C.jsxs("div",{className:"workflow-step-box-header",onClick:d,role:"button",tabIndex:0,onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),d())},children:[C.jsx("span",{className:"workflow-step-box-toggle",children:n?"":""}),C.jsx("span",{className:`workflow-step-status ${h}`}),C.jsx("span",{className:"workflow-step-box-title",children:qF(t.name)}),C.jsxs("span",{className:"workflow-step-box-meta",children:[C.jsxs("span",{className:"step-meta-success",children:[o," ok"]}),C.jsxs("span",{className:"step-meta-error",children:[l," error",l===1?"":"s"]}),C.jsx("span",{className:"step-meta-duration",children:u})]})]}),n&&C.jsxs("div",{className:"workflow-step-box-body",children:[((p=t.errors)==null?void 0:p.length)>0&&C.jsx("div",{className:"workflow-step-errors",children:t.errors.map((m,_)=>C.jsx("div",{className:"workflow-step-error",children:m},_))}),a&&(e==null?void 0:e.length)>0&&C.jsx("div",{className:"workflow-step-logs",children:e.map((m,_)=>C.jsx("div",{className:`workflow-step-log ${m.level==="error"?"log-error":""}`,children:m.message},_))}),s]})]})}function fE({workflow:t,liveStatus:e,getStatusBadgeClass:n,onAttach:i,onCancel:r,depth:s=0}){var B;const[a,o]=I.useState(!1),[l,u]=I.useState({}),[c,h]=I.useState({}),[d,p]=I.useState([]),[m,_]=I.useState(!1);I.useEffect(()=>{o(s>0),u({}),h({}),p([]),_(!1)},[t==null?void 0:t.workflow_uuid]);const f=(e==null?void 0:e.steps)||[],v=f.reduce((L,j)=>L+(j.success||0),0),g=f.reduce((L,j)=>L+(j.error||0),0),y=v+g,b=f.length>0||d.length>0||(t==null?void 0:t.workflow_type)==="agent",w=I.useCallback(async L=>{if(!(!(t!=null&&t.workflow_uuid)||c[L]))try{const j=await fetch(wl(`/api/workflows/${t.workflow_uuid}/step-logs?step=${encodeURIComponent(L)}`));if(j.ok){const D=await j.json();h(O=>({...O,[L]:D.logs||[]}))}}catch(j){console.error("Failed to fetch step logs:",j)}},[t,c]),x=I.useCallback(async()=>{if(!(!(t!=null&&t.workflow_uuid)||m)){_(!0);try{const L=await fetch(wl(`/api/workflows?parent_id=${t.workflow_uuid}&limit=50`));if(L.ok){const j=await L.json();p(j.workflows||[])}}catch(L){console.error("Failed to fetch child workflows:",L)}}},[t,m]);if(I.useEffect(()=>{a&&x()},[a,x]),I.useEffect(()=>{var j;if(s===0||!a||f.length!==1)return;const L=(j=f[0])==null?void 0:j.name;!L||l[L]||(u(D=>({...D,[L]:!0})),w(L))},[s,a,f,l,w]),I.useEffect(()=>{const L=f.some(O=>(O.error||0)>0||O.errors&&O.errors.length>0);if(!((t==null?void 0:t.status)==="ERROR"||(e==null?void 0:e.status)==="error"||(e==null?void 0:e.status)==="completed_with_errors"||L))return;a||o(!0);const D=f.filter(O=>(O.error||0)>0||O.errors&&O.errors.length>0||O.status==="error");D.length!==0&&(u(O=>{const N={...O};return D.forEach(z=>{N[z.name]=!0}),N}),D.forEach(O=>{w(O.name)}))},[t==null?void 0:t.status,e==null?void 0:e.status,f,a,w]),!b)return null;const k=f.filter(L=>L.step_type==="queue"),S=k.length===1?k[0].name:null,E=(B=f.find(L=>L.name==="fetch_documents"))==null?void 0:B.name,A=new Set,M=f.reduce((L,j)=>(L[j.name]=[],L),{});d.forEach(L=>{var D;const j=L.parent_step_name;if(j&&M[j]){M[j].push(L),A.add(L.workflow_uuid);return}if(!j&&E){const O=L.name||"";if(O.includes("fetch_single_url")||O.includes("fetch_url_batch")){M[E].push(L),A.add(L.workflow_uuid);return}}!j&&S&&((D=L.name)!=null&&D.startsWith("<temp>"))&&(M[S].push(L),A.add(L.workflow_uuid))});const R=d.filter(L=>!A.has(L.workflow_uuid)),P=f.length+R.length,H=y>0?`${v} processed${g>0?`, ${g} failed`:""}`+(d.length>0?` + ${d.length} workflow${d.length!==1?"s":""}`:""):`${P} step${P!==1?"s":""}`+(d.length>0?` + ${d.length} workflow${d.length!==1?"s":""}`:"");return C.jsxs("div",{className:"workflow-collapsible-section",children:[C.jsxs("div",{className:"workflow-section-header",onClick:()=>o(!a),role:"button",tabIndex:0,onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),o(!a))},children:[C.jsx("span",{className:"workflow-section-toggle",children:a?"":""}),C.jsx("span",{className:"workflow-section-label",children:"Steps"}),C.jsx("span",{className:"workflow-section-preview",children:H})]}),a&&C.jsxs("div",{className:"workflow-section-content",children:[f.map(L=>{const j=!!l[L.name],D=M[L.name]||[],O=D.length===0;return C.jsx(XF,{step:L,logs:c[L.name],isExpanded:j,showLogs:O,onToggle:()=>u(N=>({...N,[L.name]:!N[L.name]})),onOpen:()=>w(L.name),children:D.length>0&&s<gb&&C.jsx("div",{className:"workflow-step-children",children:D.map(N=>C.jsx(_b,{workflow:N,getStatusBadgeClass:n,onAttach:i,onCancel:r,depth:s+1},N.workflow_uuid))})},L.name)}),R.length>0&&s<gb&&C.jsx("div",{className:"workflow-unassigned-children",children:R.map(L=>C.jsx(_b,{workflow:L,getStatusBadgeClass:n,onAttach:i,onCancel:r,depth:s+1},L.workflow_uuid))})]})]})}function _b({workflow:t,getStatusBadgeClass:e,onAttach:n,onCancel:i,depth:r=0}){var x,k;const[s,a]=I.useState(!1),[o,l]=I.useState(!1),[u,c]=I.useState(null),[h,d]=I.useState(null);I.useEffect(()=>{a(!1),l(!1),c(null),d(null)},[t==null?void 0:t.workflow_uuid]);const p=I.useCallback(async()=>{if(t!=null&&t.workflow_uuid)try{const S=await fetch(wl(`/api/workflows/${t.workflow_uuid}/status`));if(S.ok){const E=await S.json();c(E)}}catch(S){d(S)}},[t]);I.useEffect(()=>{!u&&!h&&p()},[u,h,p]),I.useEffect(()=>{if(o)return;const S=((u==null?void 0:u.steps)||[]).some(A=>(A.error||0)>0||A.errors&&A.errors.length>0||A.status==="error");((t==null?void 0:t.status)==="ERROR"||(u==null?void 0:u.status)==="error"||(u==null?void 0:u.status)==="completed_with_errors"||S)&&(a(!0),l(!0))},[o,u,t==null?void 0:t.status]);const m=t.definition_name||t.name||"Unknown",_=m.startsWith("<temp>.")?m.replace(/^<temp>\./,""):m,f=((x=t.workflow_uuid)==null?void 0:x.slice(0,8))||"",v=hE(u,t),g=mv(u==null?void 0:u.duration_ms),y=t.status||"UNKNOWN",b=JF(u==null?void 0:u.inputs),w=b.length===1?b[0]:b.length>1?{count:b.length,url:(k=b[0])==null?void 0:k.url}:null;return C.jsxs("div",{className:"workflow-child-box",style:{marginLeft:r*12},children:[C.jsxs("div",{className:"workflow-child-header",onClick:()=>a(S=>!S),role:"button",tabIndex:0,onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&(S.preventDefault(),a(E=>!E))},children:[C.jsx("span",{className:"workflow-child-toggle",children:s?"":""}),C.jsx("span",{className:`workflow-status-badge ${e(y)}`,children:y}),C.jsx("span",{className:"workflow-child-name",title:_,children:_}),C.jsx("span",{className:"workflow-child-id",title:t.workflow_uuid,children:f}),g&&C.jsx("span",{className:"workflow-child-duration",children:g})]}),w&&C.jsxs("div",{className:"workflow-child-doc-summary",children:[w.docId?C.jsxs("span",{className:"workflow-child-doc-field",children:[C.jsx("span",{className:"workflow-child-doc-label",children:"Doc"}),C.jsx("span",{className:"workflow-child-doc-value",title:w.docId,children:ZF(w.docId)})]}):w.count?C.jsxs("span",{className:"workflow-child-doc-field",children:[C.jsx("span",{className:"workflow-child-doc-label",children:"Docs"}),C.jsx("span",{className:"workflow-child-doc-value",children:w.count})]}):null,w.url&&C.jsxs("span",{className:"workflow-child-doc-field workflow-child-doc-url",children:[C.jsx("span",{className:"workflow-child-doc-label",children:"URL"}),C.jsx("span",{className:"workflow-child-doc-value",title:w.url,children:w.url})]})]}),s&&C.jsxs("div",{className:"workflow-child-body",children:[b.length>0&&C.jsxs("div",{className:"workflow-child-input-meta",children:[C.jsx("div",{className:"workflow-child-input-meta-label",children:"Subprocess"}),C.jsx("div",{className:"workflow-child-input-meta-list",children:b.map((S,E)=>C.jsxs("div",{className:"workflow-child-input-meta-row",children:[C.jsx("span",{className:"workflow-child-input-meta-id",children:S.docId||"-"}),C.jsx("span",{className:"workflow-child-input-meta-url",children:S.url})]},`${S.url}-${E}`))})]}),C.jsx(dE,{command:v}),u?C.jsx(fE,{workflow:t,liveStatus:u,getStatusBadgeClass:e,onAttach:n,onCancel:i,depth:r}):h?C.jsx("div",{className:"workflow-child-error",children:"Failed to load workflow status."}):C.jsx("div",{className:"workflow-child-loading",children:"Loading workflow details..."})]})]})}function QF({workflow:t,isExpanded:e,onToggleExpand:n,onAttach:i,onCancel:r,getStatusBadgeClass:s,depth:a=0}){var x,k,S;const[o,l]=I.useState(null),u=t.status==="PENDING"||t.status==="ENQUEUED",h=t.status!=="SUCCESS"?t.status:(o==null?void 0:o.status)==="completed_with_errors"||((o==null?void 0:o.steps)||[]).some(M=>M.error>0)?"WARNING":t.status,d=I.useCallback(async()=>{if(t!=null&&t.workflow_uuid)try{const E=await fetch(wl(`/api/workflows/${t.workflow_uuid}/status`));if(E.ok){const A=await E.json();l(A)}}catch(E){console.error("Failed to fetch status:",E)}},[t]);I.useEffect(()=>{if(!e||!u||!(t!=null&&t.workflow_uuid))return;const E=new EventSource(wl(`/api/workflows/${t.workflow_uuid}/status/stream`));return E.onmessage=A=>{try{const M=JSON.parse(A.data);l(M)}catch(M){console.error("Failed to parse SSE data:",M)}},E.onerror=()=>{E.close()},()=>{E.close()}},[e,u,t==null?void 0:t.workflow_uuid]),I.useEffect(()=>{t.status==="SUCCESS"&&!o&&d()},[t.status,t==null?void 0:t.workflow_uuid,d,o]),I.useEffect(()=>{e&&d()},[e,t==null?void 0:t.workflow_uuid,d]);const p=((x=t.workflow_uuid)==null?void 0:x.slice(0,8))||"",m=t.definition_name||t.name||"Unknown",_=hE(o,t),f=(o==null?void 0:o.progress)||{},v=f.total>0?Math.round(f.current/f.total*100):0,g=E=>{if(!E)return null;try{if(/^\d+$/.test(E)){const M=parseInt(E,10),R=new Date(M);if(!isNaN(R.getTime()))return R}let A=new Date(E);return!isNaN(A.getTime())||typeof E=="string"&&E.includes(" ")&&(A=new Date(E.replace(" ","T")+"Z"),!isNaN(A.getTime()))?A:null}catch{return null}},y=E=>{const A=g(E);return A?A.toLocaleDateString(void 0,{month:"short",day:"numeric"})+" "+A.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):"-"},b=E=>{const A=g(E);return A?A.toLocaleString():"-"},w=E=>{E.stopPropagation(),t.workflow_uuid&&navigator.clipboard.writeText(t.workflow_uuid).catch(()=>{})};return C.jsxs("div",{className:`workflow-row ${e?"expanded":""}`,children:[C.jsxs("div",{className:"workflow-row-header",onClick:n,role:"button",tabIndex:0,onKeyDown:E=>{(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),n())},children:[C.jsx("span",{className:"workflow-expand-icon",children:e?"":""}),C.jsx("span",{className:`workflow-type-badge ${t.workflow_type==="agent"?"workflow-type-agent":"workflow-type-tool"}`,title:t.workflow_type==="agent"?"Agent workflow":"Tool workflow",children:t.workflow_type==="agent"?"agent":"tool"}),C.jsx("span",{className:`workflow-status-badge ${s(h)}`,children:h}),C.jsx("span",{className:"workflow-name",title:t.definition_name||m,children:m.length>20?`${m.slice(0,20)}...`:m}),C.jsx("span",{className:"workflow-id",title:t.workflow_uuid,children:p}),C.jsx("span",{className:"workflow-time",children:y(t.created_at)}),C.jsx("div",{className:"workflow-actions",onClick:E=>E.stopPropagation(),children:u&&C.jsxs(C.Fragment,{children:[C.jsx("button",{type:"button",className:"workflow-action-btn workflow-attach",onClick:i,title:"Attach terminal",children:""}),C.jsx("button",{type:"button",className:"workflow-action-btn workflow-cancel",onClick:r,title:"Cancel workflow",children:""})]})})]}),e&&C.jsxs("div",{className:"workflow-row-details",children:[u&&(o==null?void 0:o.stage)&&C.jsxs("div",{className:"workflow-progress",children:[C.jsxs("div",{className:"workflow-progress-header",children:[C.jsx("span",{className:"workflow-stage-name",children:UF(o.stage)}),C.jsxs("span",{className:"workflow-progress-count",children:[f.current||0,"/",f.total||"?"]})]}),C.jsx("div",{className:"workflow-progress-bar",children:C.jsx("div",{className:"workflow-progress-fill",style:{width:`${v}%`}})})]}),C.jsxs("div",{className:"workflow-meta",children:[C.jsxs("div",{className:"workflow-detail-row",children:[C.jsx("span",{className:"workflow-detail-label",children:"Full ID:"}),C.jsx("code",{className:"workflow-detail-value workflow-id-copyable",onClick:w,title:"Click to copy",children:t.workflow_uuid})]}),C.jsxs("div",{className:"workflow-detail-row workflow-detail-inline",children:[C.jsx("span",{className:"workflow-detail-label",children:"Duration:"}),C.jsx("span",{className:"workflow-detail-value workflow-duration",children:(o==null?void 0:o.duration_ms)!=null?mv(o.duration_ms):"-"}),C.jsx("span",{className:"workflow-detail-separator",children:""}),C.jsx("span",{className:"workflow-detail-label",children:"Updated:"}),C.jsx("span",{className:"workflow-detail-value",children:b(t.updated_at)})]}),(t.tokens_in||t.tokens_out||t.cost_usd)&&C.jsxs("div",{className:"workflow-detail-row workflow-detail-inline workflow-tokens",children:[(t.tokens_in!=null||t.tokens_out!=null)&&C.jsxs(C.Fragment,{children:[C.jsx("span",{className:"workflow-detail-label",children:"Tokens:"}),C.jsxs("span",{className:"workflow-detail-value workflow-token-count",children:[((k=t.tokens_in)==null?void 0:k.toLocaleString())||0," in / ",((S=t.tokens_out)==null?void 0:S.toLocaleString())||0," out"]})]}),t.cost_usd!=null&&C.jsxs(C.Fragment,{children:[C.jsx("span",{className:"workflow-detail-separator",children:""}),C.jsx("span",{className:"workflow-detail-label",children:"Cost:"}),C.jsxs("span",{className:"workflow-detail-value workflow-cost",children:["$",t.cost_usd.toFixed(4)]})]})]})]}),C.jsx(dE,{command:_}),o&&C.jsx(fE,{workflow:t,liveStatus:o,getStatusBadgeClass:s,onAttach:i,onCancel:r,depth:a})]})]})}const e9=[{value:"",label:"All"},{value:"PENDING",label:"Running"},{value:"SUCCESS",label:"Success"},{value:"ERROR",label:"Failed"},{value:"CANCELLED",label:"Cancelled"},{value:"ENQUEUED",label:"Queued"}],t9=[{value:"",label:"All types"},{value:"agent",label:"Agent"},{value:"tool",label:"Tool"}],n9="",yb=t=>`${n9}${t}`;function i9({onAttachWorkflow:t}){const[e,n]=I.useState([]),[i,r]=I.useState(!1),[s,a]=I.useState(""),[o,l]=I.useState(""),[u,c]=I.useState(""),[h,d]=I.useState(null),[p,m]=I.useState(null),_=I.useCallback(async()=>{r(!0),m(null);try{const b=new URLSearchParams;s&&b.set("status",s),o&&b.set("workflow_type",o),u&&b.set("search",u),b.set("limit","50");const w=await fetch(yb(`/api/workflows?${b}`));if(!w.ok)throw new Error(`Failed to fetch: ${w.status}`);const x=await w.json();n(x.workflows||[]),x.error?m(x.error):m(null)}catch(b){console.error("Failed to fetch workflows:",b),m(b.message)}finally{r(!1)}},[s,o,u]);I.useEffect(()=>{_();const b=setInterval(_,3e3);return()=>clearInterval(b)},[_]);const f=async b=>{try{const w=await fetch(yb(`/api/workflows/${b}/cancel`),{method:"POST"});if(!w.ok)throw new Error(`Cancel failed: ${w.status}`);_()}catch(w){console.error("Failed to cancel workflow:",w)}},v=b=>{t==null||t(b)},g=b=>{d(h===b?null:b)},y=b=>{switch(b){case"SUCCESS":return"workflow-status-success";case"WARNING":return"workflow-status-warning";case"ERROR":case"RETRIES_EXCEEDED":return"workflow-status-error";case"PENDING":return"workflow-status-pending";case"ENQUEUED":return"workflow-status-enqueued";case"CANCELLED":return"workflow-status-cancelled";default:return""}};return C.jsxs("div",{className:"workflow-list-container",children:[C.jsxs("div",{className:"workflow-list-filters",children:[C.jsx("select",{className:"workflow-select",value:o,onChange:b=>l(b.target.value),"aria-label":"Filter by type",children:t9.map(b=>C.jsx("option",{value:b.value,children:b.label},b.value))}),C.jsx("select",{className:"workflow-select",value:s,onChange:b=>a(b.target.value),"aria-label":"Filter by status",children:e9.map(b=>C.jsx("option",{value:b.value,children:b.label},b.value))}),C.jsx("input",{type:"text",className:"workflow-search",placeholder:"Search by ID...",value:u,onChange:b=>c(b.target.value),"aria-label":"Search workflows"}),C.jsx("button",{type:"button",className:"workflow-refresh",onClick:_,disabled:i,title:"Refresh",children:i?"...":""})]}),C.jsxs("div",{className:"workflow-list",children:[p&&C.jsx("div",{className:"workflow-list-error",children:p}),e.length===0&&!p?C.jsx("div",{className:"workflow-list-empty",children:i?"Loading...":"No workflows found"}):e.map(b=>C.jsx(QF,{workflow:b,isExpanded:h===b.workflow_uuid,onToggleExpand:()=>g(b.workflow_uuid),onAttach:()=>v(b.workflow_uuid),onCancel:()=>f(b.workflow_uuid),getStatusBadgeClass:y},b.workflow_uuid))]})]})}function r9({params:t}){const{collapsed:e,onToggleCollapse:n,onAttachWorkflow:i}=t||{};return e?C.jsxs("div",{className:"panel-content workflows-panel-content workflows-collapsed",children:[C.jsx("button",{type:"button",className:"sidebar-toggle-btn",onClick:n,title:"Expand workflows panel","aria-label":"Expand workflows panel",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M3.5 6L8 10.5L12.5 6H3.5Z"})})}),C.jsx("span",{className:"workflows-collapsed-label",children:"Workflows"})]}):C.jsxs("div",{className:"panel-content workflows-panel-content",children:[C.jsxs("div",{className:"workflows-header",children:[C.jsx("button",{type:"button",className:"sidebar-toggle-btn",onClick:n,title:"Collapse workflows panel","aria-label":"Collapse workflows panel",children:C.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:C.jsx("path",{d:"M3.5 10L8 5.5L12.5 10H3.5Z"})})}),C.jsxs("div",{className:"workflows-title",children:[C.jsx("span",{className:"status-dot"}),"Workflows"]})]}),C.jsx("div",{className:"workflows-content",children:C.jsx(i9,{onAttachWorkflow:i})})]})}const s9=t=>{let e;e=`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}`;const n=new URLSearchParams;return n.set("provider","kurt"),n.set("kurt_subcommand","workflows"),n.set("kurt_args",JSON.stringify(["follow",t,"--wait"])),n.set("session_id",`workflow-${t}`),n.set("force_new","1"),`${e}/ws/pty?${n}`};function o9({params:t}){const{workflowId:e}=t||{},n=I.useRef(null),i=I.useRef(null),r=I.useRef(null),s=I.useRef(null),a=I.useRef(!1);return I.useEffect(()=>{if(!n.current||!e)return;const o=new oE.Terminal({cursorBlink:!0,convertEol:!0,fontFamily:'"IBM Plex Mono", "SFMono-Regular", Menlo, monospace',fontSize:13,theme:{background:"#0f172a",foreground:"#e2e8f0",cursor:"#e2e8f0",selection:"#334155",black:"#0f172a",red:"#ef4444",green:"#22c55e",yellow:"#f59e0b",blue:"#3b82f6",magenta:"#ec4899",cyan:"#06b6d4",white:"#f1f5f9"}}),l=new lE.FitAddon;o.loadAddon(l),i.current=o,r.current=l;let u=!0;const c=()=>{const p=new WebSocket(s9(e));s.current=p,p.addEventListener("message",m=>{let _;try{_=JSON.parse(m.data)}catch{_={type:"output",data:m.data}}if(_.type==="output"&&typeof _.data=="string")o.write(_.data);else if(_.type==="error")o.writeln(`\r
[workflow] Error: ${_.data}\r
`);else if(_.type==="exit"){const f=_.code??"unknown";o.writeln(`\r
[workflow] Process exited (${f})\r
`)}}),p.addEventListener("open",()=>{if(o.writeln(`[workflow] Attached to workflow ${e.slice(0,8)}...\r
`),r.current)try{l.fit(),p.send(JSON.stringify({type:"resize",cols:o.cols,rows:o.rows}))}catch{}}),p.addEventListener("error",()=>{o.writeln(`\r
[workflow] Connection error\r
`)}),p.addEventListener("close",()=>{u&&o.writeln(`\r
[workflow] Connection closed\r
`)})},h=()=>{var p;if(!a.current){if(!((p=n.current)!=null&&p.isConnected)){setTimeout(h,50);return}try{o.open(n.current),a.current=!0,requestAnimationFrame(()=>{try{l.fit()}catch{}}),c()}catch{setTimeout(h,50)}}};h();const d=()=>{var p;if(r.current&&((p=s.current)==null?void 0:p.readyState)===WebSocket.OPEN)try{l.fit(),s.current.send(JSON.stringify({type:"resize",cols:o.cols,rows:o.rows}))}catch{}};return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d),u=!1,s.current&&s.current.close(),o.dispose()}},[e]),e?C.jsx("div",{className:"panel-content workflow-terminal-panel",children:C.jsx("div",{className:"workflow-terminal",ref:n})}):C.jsx("div",{className:"panel-content workflow-terminal-panel",children:C.jsx("div",{className:"workflow-terminal-empty",children:"No workflow ID provided"})})}const bb=24;function a9(t,e){if(t===e)return e.split(`
`).map((o,l)=>({type:"normal",leftText:o,rightText:o,leftLineNum:l+1,rightLineNum:l+1}));const n=tv(t,e),i=[];let r=1,s=1;return n.forEach(a=>{const o=a.value.split(`
`);o[o.length-1]===""&&o.pop(),a.removed?o.forEach(l=>{i.push({type:"delete",leftText:l,rightText:null,leftLineNum:r++,rightLineNum:null})}):a.added?o.forEach(l=>{i.push({type:"insert",leftText:null,rightText:l,leftLineNum:null,rightLineNum:s++})}):o.forEach(l=>{i.push({type:"normal",leftText:l,rightText:l,leftLineNum:r++,rightLineNum:s++})})}),i}function l9({text:t,lineNum:e,type:n,onChange:i,onKeyDown:r}){const[s,a]=I.useState(t),o=I.useRef(null),l=I.useRef(!1);I.useEffect(()=>{l.current||a(t)},[t]);const u=()=>{l.current=!0},c=m=>{a(m.target.textContent)},h=()=>{l.current=!1,s!==t&&i(e,s)},d=m=>{if(m.key==="Enter"){m.preventDefault();const v=window.getSelection().getRangeAt(0).startOffset;r(e,"split",v,s)}else if(m.key==="Backspace"&&o.current){const f=window.getSelection().getRangeAt(0);f.startOffset===0&&f.endOffset===0&&(m.preventDefault(),r(e,"mergeUp",0,s))}},p=n==="insert"?"diff-cell diff-cell-right diff-cell-added":"diff-cell diff-cell-right";return C.jsxs("div",{className:p,children:[C.jsx("span",{className:"diff-line-num",children:e}),C.jsx("span",{className:"diff-line-marker",children:n==="insert"?"+":""}),C.jsx("span",{ref:o,className:"diff-line-text",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:u,onInput:c,onBlur:h,onKeyDown:d,children:s||""})]})}function u9({line:t,idx:e,onLineChange:n,onLineAction:i}){let r;t.type==="insert"?r=C.jsxs("div",{className:"diff-cell diff-cell-left diff-cell-spacer",children:[C.jsx("span",{className:"diff-line-num"}),C.jsx("span",{className:"diff-line-marker"}),C.jsx("span",{className:"diff-line-text",children:""})]}):t.type==="delete"?r=C.jsxs("div",{className:"diff-cell diff-cell-left diff-cell-deleted",children:[C.jsx("span",{className:"diff-line-num",children:t.leftLineNum}),C.jsx("span",{className:"diff-line-marker",children:"-"}),C.jsx("span",{className:"diff-line-text",children:t.leftText||""})]}):r=C.jsxs("div",{className:"diff-cell diff-cell-left",children:[C.jsx("span",{className:"diff-line-num",children:t.leftLineNum}),C.jsx("span",{className:"diff-line-marker"}),C.jsx("span",{className:"diff-line-text",children:t.leftText||""})]});let s;return t.type==="delete"?s=C.jsxs("div",{className:"diff-cell diff-cell-right diff-cell-spacer",children:[C.jsx("span",{className:"diff-line-num"}),C.jsx("span",{className:"diff-line-marker"}),C.jsx("span",{className:"diff-line-text",children:""})]}):s=C.jsx(l9,{text:t.rightText||"",lineNum:t.rightLineNum,type:t.type,onChange:n,onKeyDown:i}),C.jsxs("div",{className:"diff-row",children:[r,s]},e)}function c9(){const t=`# Hello World

This is the first paragraph.

This is the second paragraph that will be modified.

This is the third paragraph.

This line will be deleted.

The end.`,[e,n]=I.useState(`# Hello World

This is the first paragraph.

This paragraph was MODIFIED with new content!

This is the third paragraph.

This is a completely NEW paragraph that was added!

The end.`),[i,r]=I.useState([]),s=I.useRef(null);I.useEffect(()=>{const l=a9(t,e);r(l)},[t,e]);const a=I.useCallback((l,u)=>{const c=e.split(`
`);c[l-1]=u,n(c.join(`
`))},[e]),o=I.useCallback((l,u,c,h)=>{const d=e.split(`
`);if(u==="split"){const p=h.slice(0,c),m=h.slice(c);d[l-1]=p,d.splice(l,0,m),n(d.join(`
`))}else if(u==="mergeUp"&&l>1){const p=d[l-2];d[l-2]=p+h,d.splice(l-1,1),n(d.join(`
`))}},[e]);return C.jsxs("div",{className:"diff-poc-container",children:[C.jsx("h2",{children:"Editable Diff View POC"}),C.jsx("p",{className:"diff-poc-description",children:"Left: Original (read-only) with deletions in red | Right: Editable with additions in green"}),C.jsx("style",{children:`
        .diff-poc-container {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .diff-poc-description {
          color: #666;
          margin-bottom: 20px;
        }
        .diff-split-view {
          border: 1px solid #d0d0d0;
          border-radius: 6px;
          overflow: auto;
          max-height: 500px;
          background: #1e1e1e;
        }

        .diff-table {
          width: 100%;
          font-family: 'SF Mono', Monaco, 'Courier New', monospace;
          font-size: 13px;
        }

        /* Row contains left and right cells side by side */
        .diff-row {
          display: flex;
          width: 100%;
        }

        /* Each cell is half width */
        .diff-cell {
          flex: 1;
          display: flex;
          min-height: ${bb}px;
          line-height: ${bb}px;
        }
        .diff-cell-left {
          border-right: 1px solid #3c3c3c;
        }

        .diff-line-num {
          width: 40px;
          padding: 0 8px;
          text-align: right;
          color: #6e7681;
          background: #161b22;
          flex-shrink: 0;
          user-select: none;
        }
        .diff-line-marker {
          width: 20px;
          text-align: center;
          flex-shrink: 0;
          color: #8b949e;
          user-select: none;
        }
        .diff-line-text {
          flex: 1;
          padding: 0 8px;
          white-space: pre-wrap;
          word-break: break-word;
          color: #c9d1d9;
          outline: none;
        }

        /* Deleted cells (left side - red) */
        .diff-cell-deleted {
          background-color: rgba(248, 81, 73, 0.15);
        }
        .diff-cell-deleted .diff-line-num {
          background-color: rgba(248, 81, 73, 0.2);
        }
        .diff-cell-deleted .diff-line-marker {
          color: #f85149;
        }
        .diff-cell-deleted .diff-line-text {
          color: #ffa198;
        }

        /* Added cells (right side - green) */
        .diff-cell-added {
          background-color: rgba(46, 160, 67, 0.15);
        }
        .diff-cell-added .diff-line-num {
          background-color: rgba(46, 160, 67, 0.2);
        }
        .diff-cell-added .diff-line-marker {
          color: #3fb950;
        }
        .diff-cell-added .diff-line-text {
          color: #7ee787;
        }

        /* Spacer cells (grey) */
        .diff-cell-spacer {
          background-color: rgba(110, 118, 129, 0.1);
        }
        .diff-cell-spacer .diff-line-num {
          background-color: rgba(110, 118, 129, 0.1);
        }
        .diff-cell-spacer .diff-line-text {
          color: transparent;
        }

        .diff-legend {
          margin-top: 20px;
          font-size: 12px;
          color: #666;
          display: flex;
          gap: 16px;
        }
        .diff-legend-item {
          display: flex;
          align-items: center;
          gap: 6px;
        }
        .diff-legend-color {
          width: 16px;
          height: 16px;
          border-radius: 3px;
        }
      `}),C.jsx("div",{className:"diff-split-view",ref:s,children:C.jsx("div",{className:"diff-table",children:i.map((l,u)=>C.jsx(u9,{line:l,idx:u,onLineChange:a,onLineAction:o},u))})}),C.jsxs("div",{className:"diff-legend",children:[C.jsxs("div",{className:"diff-legend-item",children:[C.jsx("div",{className:"diff-legend-color",style:{background:"rgba(248, 81, 73, 0.3)"}}),C.jsx("span",{children:"Deleted"})]}),C.jsxs("div",{className:"diff-legend-item",children:[C.jsx("div",{className:"diff-legend-color",style:{background:"rgba(46, 160, 67, 0.3)"}}),C.jsx("span",{children:"Added"})]}),C.jsxs("div",{className:"diff-legend-item",children:[C.jsx("div",{className:"diff-legend-color",style:{background:"rgba(110, 118, 129, 0.2)"}}),C.jsx("span",{children:"Spacer"})]})]}),C.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"#f6f8fa",borderRadius:"6px",fontSize:"12px"},children:[C.jsx("strong",{children:"Debug:"})," ",i.length," aligned lines | Original: ",t.split(`
`).length," lines | Current: ",e.split(`
`).length," lines"]})]})}const wb={};function h9(t){let e=wb[t];if(e)return e;e=wb[t]=[];for(let n=0;n<128;n++){const i=String.fromCharCode(n);e.push(i)}for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);e[i]="%"+("0"+i.toString(16).toUpperCase()).slice(-2)}return e}function Io(t,e){typeof e!="string"&&(e=Io.defaultChars);const n=h9(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(i){let r="";for(let s=0,a=i.length;s<a;s+=3){const o=parseInt(i.slice(s+1,s+3),16);if(o<128){r+=n[o];continue}if((o&224)===192&&s+3<a){const l=parseInt(i.slice(s+4,s+6),16);if((l&192)===128){const u=o<<6&1984|l&63;u<128?r+="":r+=String.fromCharCode(u),s+=3;continue}}if((o&240)===224&&s+6<a){const l=parseInt(i.slice(s+4,s+6),16),u=parseInt(i.slice(s+7,s+9),16);if((l&192)===128&&(u&192)===128){const c=o<<12&61440|l<<6&4032|u&63;c<2048||c>=55296&&c<=57343?r+="":r+=String.fromCharCode(c),s+=6;continue}}if((o&248)===240&&s+9<a){const l=parseInt(i.slice(s+4,s+6),16),u=parseInt(i.slice(s+7,s+9),16),c=parseInt(i.slice(s+10,s+12),16);if((l&192)===128&&(u&192)===128&&(c&192)===128){let h=o<<18&1835008|l<<12&258048|u<<6&4032|c&63;h<65536||h>1114111?r+="":(h-=65536,r+=String.fromCharCode(55296+(h>>10),56320+(h&1023))),s+=9;continue}}r+=""}return r})}Io.defaultChars=";/?:@&=+$,#";Io.componentChars="";const Sb={};function d9(t){let e=Sb[t];if(e)return e;e=Sb[t]=[];for(let n=0;n<128;n++){const i=String.fromCharCode(n);/^[0-9a-z]$/i.test(i)?e.push(i):e.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<t.length;n++)e[t.charCodeAt(n)]=t[n];return e}function zl(t,e,n){typeof e!="string"&&(n=e,e=zl.defaultChars),typeof n>"u"&&(n=!0);const i=d9(e);let r="";for(let s=0,a=t.length;s<a;s++){const o=t.charCodeAt(s);if(n&&o===37&&s+2<a&&/^[0-9a-f]{2}$/i.test(t.slice(s+1,s+3))){r+=t.slice(s,s+3),s+=2;continue}if(o<128){r+=i[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&s+1<a){const l=t.charCodeAt(s+1);if(l>=56320&&l<=57343){r+=encodeURIComponent(t[s]+t[s+1]),s++;continue}}r+="%EF%BF%BD";continue}r+=encodeURIComponent(t[s])}return r}zl.defaultChars=";/?:@&=+$,-_.!~*'()#";zl.componentChars="-_.!~*'()";function gv(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&t.hostname.indexOf(":")!==-1?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function Oh(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const f9=/^([a-z0-9.+-]+:)/i,p9=/:[0-9]*$/,m9=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,g9=["<",">",'"',"`"," ","\r",`
`,"	"],v9=["{","}","|","\\","^","`"].concat(g9),_9=["'"].concat(v9),xb=["%","/","?",";","#"].concat(_9),kb=["/","?","#"],y9=255,Cb=/^[+a-z0-9A-Z_-]{0,63}$/,b9=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Eb={javascript:!0,"javascript:":!0},Db={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function vv(t,e){if(t&&t instanceof Oh)return t;const n=new Oh;return n.parse(t,e),n}Oh.prototype.parse=function(t,e){let n,i,r,s=t;if(s=s.trim(),!e&&t.split("#").length===1){const u=m9.exec(s);if(u)return this.pathname=u[1],u[2]&&(this.search=u[2]),this}let a=f9.exec(s);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,s=s.substr(a.length)),(e||a||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(r=s.substr(0,2)==="//",r&&!(a&&Eb[a])&&(s=s.substr(2),this.slashes=!0)),!Eb[a]&&(r||a&&!Db[a])){let u=-1;for(let m=0;m<kb.length;m++)i=s.indexOf(kb[m]),i!==-1&&(u===-1||i<u)&&(u=i);let c,h;u===-1?h=s.lastIndexOf("@"):h=s.lastIndexOf("@",u),h!==-1&&(c=s.slice(0,h),s=s.slice(h+1),this.auth=c),u=-1;for(let m=0;m<xb.length;m++)i=s.indexOf(xb[m]),i!==-1&&(u===-1||i<u)&&(u=i);u===-1&&(u=s.length),s[u-1]===":"&&u--;const d=s.slice(0,u);s=s.slice(u),this.parseHost(d),this.hostname=this.hostname||"";const p=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!p){const m=this.hostname.split(/\./);for(let _=0,f=m.length;_<f;_++){const v=m[_];if(v&&!v.match(Cb)){let g="";for(let y=0,b=v.length;y<b;y++)v.charCodeAt(y)>127?g+="x":g+=v[y];if(!g.match(Cb)){const y=m.slice(0,_),b=m.slice(_+1),w=v.match(b9);w&&(y.push(w[1]),b.unshift(w[2])),b.length&&(s=b.join(".")+s),this.hostname=y.join(".");break}}}}this.hostname.length>y9&&(this.hostname=""),p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=s.indexOf("#");o!==-1&&(this.hash=s.substr(o),s=s.slice(0,o));const l=s.indexOf("?");return l!==-1&&(this.search=s.substr(l),s=s.slice(0,l)),s&&(this.pathname=s),Db[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};Oh.prototype.parseHost=function(t){let e=p9.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const w9=Object.freeze(Object.defineProperty({__proto__:null,decode:Io,encode:zl,format:gv,parse:vv},Symbol.toStringTag,{value:"Module"})),pE=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,mE=/[\0-\x1F\x7F-\x9F]/,S9=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,_v=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,gE=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,vE=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,x9=Object.freeze(Object.defineProperty({__proto__:null,Any:pE,Cc:mE,Cf:S9,P:_v,S:gE,Z:vE},Symbol.toStringTag,{value:"Module"})),k9=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),C9=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var Wf;const E9=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),D9=(Wf=String.fromCodePoint)!==null&&Wf!==void 0?Wf:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function A9(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=E9.get(t))!==null&&e!==void 0?e:t}var At;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(At||(At={}));const T9=32;var br;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(br||(br={}));function e0(t){return t>=At.ZERO&&t<=At.NINE}function M9(t){return t>=At.UPPER_A&&t<=At.UPPER_F||t>=At.LOWER_A&&t<=At.LOWER_F}function R9(t){return t>=At.UPPER_A&&t<=At.UPPER_Z||t>=At.LOWER_A&&t<=At.LOWER_Z||e0(t)}function O9(t){return t===At.EQUALS||R9(t)}var kt;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(kt||(kt={}));var pr;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(pr||(pr={}));class P9{constructor(e,n,i){this.decodeTree=e,this.emitCodePoint=n,this.errors=i,this.state=kt.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=pr.Strict}startEntity(e){this.decodeMode=e,this.state=kt.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case kt.EntityStart:return e.charCodeAt(n)===At.NUM?(this.state=kt.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=kt.NamedEntity,this.stateNamedEntity(e,n));case kt.NumericStart:return this.stateNumericStart(e,n);case kt.NumericDecimal:return this.stateNumericDecimal(e,n);case kt.NumericHex:return this.stateNumericHex(e,n);case kt.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|T9)===At.LOWER_X?(this.state=kt.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=kt.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,i,r){if(n!==i){const s=i-n;this.result=this.result*Math.pow(r,s)+parseInt(e.substr(n,s),r),this.consumed+=s}}stateNumericHex(e,n){const i=n;for(;n<e.length;){const r=e.charCodeAt(n);if(e0(r)||M9(r))n+=1;else return this.addToNumericResult(e,i,n,16),this.emitNumericEntity(r,3)}return this.addToNumericResult(e,i,n,16),-1}stateNumericDecimal(e,n){const i=n;for(;n<e.length;){const r=e.charCodeAt(n);if(e0(r))n+=1;else return this.addToNumericResult(e,i,n,10),this.emitNumericEntity(r,2)}return this.addToNumericResult(e,i,n,10),-1}emitNumericEntity(e,n){var i;if(this.consumed<=n)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===At.SEMI)this.consumed+=1;else if(this.decodeMode===pr.Strict)return 0;return this.emitCodePoint(A9(this.result),this.consumed),this.errors&&(e!==At.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:i}=this;let r=i[this.treeIndex],s=(r&br.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const a=e.charCodeAt(n);if(this.treeIndex=N9(i,r,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===pr.Attribute&&(s===0||O9(a))?0:this.emitNotTerminatedNamedEntity();if(r=i[this.treeIndex],s=(r&br.VALUE_LENGTH)>>14,s!==0){if(a===At.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==pr.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:i}=this,r=(i[n]&br.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,r,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,i){const{decodeTree:r}=this;return this.emitCodePoint(n===1?r[e]&~br.VALUE_LENGTH:r[e+1],i),n===3&&this.emitCodePoint(r[e+2],i),i}end(){var e;switch(this.state){case kt.NamedEntity:return this.result!==0&&(this.decodeMode!==pr.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case kt.NumericDecimal:return this.emitNumericEntity(0,2);case kt.NumericHex:return this.emitNumericEntity(0,3);case kt.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case kt.EntityStart:return 0}}}function _E(t){let e="";const n=new P9(t,i=>e+=D9(i));return function(r,s){let a=0,o=0;for(;(o=r.indexOf("&",o))>=0;){e+=r.slice(a,o),n.startEntity(s);const u=n.write(r,o+1);if(u<0){a=o+n.end();break}a=o+u,o=u===0?a+1:a}const l=e+r.slice(a);return e="",l}}function N9(t,e,n,i){const r=(e&br.BRANCH_LENGTH)>>7,s=e&br.JUMP_TABLE;if(r===0)return s!==0&&i===s?n:-1;if(s){const l=i-s;return l<0||l>=r?-1:t[n+l]-1}let a=n,o=a+r-1;for(;a<=o;){const l=a+o>>>1,u=t[l];if(u<i)a=l+1;else if(u>i)o=l-1;else return t[l+r]}return-1}const I9=_E(k9);_E(C9);function yE(t,e=pr.Legacy){return I9(t,e)}function L9(t){return Object.prototype.toString.call(t)}function yv(t){return L9(t)==="[object String]"}const B9=Object.prototype.hasOwnProperty;function z9(t,e){return B9.call(t,e)}function Rd(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(i){t[i]=n[i]})}}),t}function bE(t,e,n){return[].concat(t.slice(0,e),n,t.slice(e+1))}function bv(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function Ph(t){if(t>65535){t-=65536;const e=55296+(t>>10),n=56320+(t&1023);return String.fromCharCode(e,n)}return String.fromCharCode(t)}const wE=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,F9=/&([a-z#][a-z0-9]{1,31});/gi,j9=new RegExp(wE.source+"|"+F9.source,"gi"),H9=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function $9(t,e){if(e.charCodeAt(0)===35&&H9.test(e)){const i=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return bv(i)?Ph(i):t}const n=yE(t);return n!==t?n:t}function W9(t){return t.indexOf("\\")<0?t:t.replace(wE,"$1")}function Lo(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(j9,function(e,n,i){return n||$9(e,i)})}const V9=/[&<>"]/,G9=/[&<>"]/g,U9={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function q9(t){return U9[t]}function Hr(t){return V9.test(t)?t.replace(G9,q9):t}const K9=/[.?*+^$[\]\\(){}|-]/g;function J9(t){return t.replace(K9,"\\$&")}function Ge(t){switch(t){case 9:case 32:return!0}return!1}function Sl(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function xl(t){return _v.test(t)||gE.test(t)}function kl(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function Od(t){return t=t.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(t=t.replace(//g,"")),t.toLowerCase().toUpperCase()}const Z9={mdurl:w9,ucmicro:x9},Y9=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:bE,assign:Rd,escapeHtml:Hr,escapeRE:J9,fromCodePoint:Ph,has:z9,isMdAsciiPunct:kl,isPunctChar:xl,isSpace:Ge,isString:yv,isValidEntityCode:bv,isWhiteSpace:Sl,lib:Z9,normalizeReference:Od,unescapeAll:Lo,unescapeMd:W9},Symbol.toStringTag,{value:"Module"}));function X9(t,e,n){let i,r,s,a;const o=t.posMax,l=t.pos;for(t.pos=e+1,i=1;t.pos<o;){if(s=t.src.charCodeAt(t.pos),s===93&&(i--,i===0)){r=!0;break}if(a=t.pos,t.md.inline.skipToken(t),s===91){if(a===t.pos-1)i++;else if(n)return t.pos=l,-1}}let u=-1;return r&&(u=t.pos),t.pos=l,u}function Q9(t,e,n){let i,r=e;const s={ok:!1,pos:0,str:""};if(t.charCodeAt(r)===60){for(r++;r<n;){if(i=t.charCodeAt(r),i===10||i===60)return s;if(i===62)return s.pos=r+1,s.str=Lo(t.slice(e+1,r)),s.ok=!0,s;if(i===92&&r+1<n){r+=2;continue}r++}return s}let a=0;for(;r<n&&(i=t.charCodeAt(r),!(i===32||i<32||i===127));){if(i===92&&r+1<n){if(t.charCodeAt(r+1)===32)break;r+=2;continue}if(i===40&&(a++,a>32))return s;if(i===41){if(a===0)break;a--}r++}return e===r||a!==0||(s.str=Lo(t.slice(e,r)),s.pos=r,s.ok=!0),s}function e7(t,e,n,i){let r,s=e;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(i)a.str=i.str,a.marker=i.marker;else{if(s>=n)return a;let o=t.charCodeAt(s);if(o!==34&&o!==39&&o!==40)return a;e++,s++,o===40&&(o=41),a.marker=o}for(;s<n;){if(r=t.charCodeAt(s),r===a.marker)return a.pos=s+1,a.str+=Lo(t.slice(e,s)),a.ok=!0,a;if(r===40&&a.marker===41)return a;r===92&&s+1<n&&s++,s++}return a.can_continue=!0,a.str+=Lo(t.slice(e,s)),a}const t7=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:Q9,parseLinkLabel:X9,parseLinkTitle:e7},Symbol.toStringTag,{value:"Module"})),Ci={};Ci.code_inline=function(t,e,n,i,r){const s=t[e];return"<code"+r.renderAttrs(s)+">"+Hr(s.content)+"</code>"};Ci.code_block=function(t,e,n,i,r){const s=t[e];return"<pre"+r.renderAttrs(s)+"><code>"+Hr(t[e].content)+`</code></pre>
`};Ci.fence=function(t,e,n,i,r){const s=t[e],a=s.info?Lo(s.info).trim():"";let o="",l="";if(a){const c=a.split(/(\s+)/g);o=c[0],l=c.slice(2).join("")}let u;if(n.highlight?u=n.highlight(s.content,o,l)||Hr(s.content):u=Hr(s.content),u.indexOf("<pre")===0)return u+`
`;if(a){const c=s.attrIndex("class"),h=s.attrs?s.attrs.slice():[];c<0?h.push(["class",n.langPrefix+o]):(h[c]=h[c].slice(),h[c][1]+=" "+n.langPrefix+o);const d={attrs:h};return`<pre><code${r.renderAttrs(d)}>${u}</code></pre>
`}return`<pre><code${r.renderAttrs(s)}>${u}</code></pre>
`};Ci.image=function(t,e,n,i,r){const s=t[e];return s.attrs[s.attrIndex("alt")][1]=r.renderInlineAsText(s.children,n,i),r.renderToken(t,e,n)};Ci.hardbreak=function(t,e,n){return n.xhtmlOut?`<br />
`:`<br>
`};Ci.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Ci.text=function(t,e){return Hr(t[e].content)};Ci.html_block=function(t,e){return t[e].content};Ci.html_inline=function(t,e){return t[e].content};function $o(){this.rules=Rd({},Ci)}$o.prototype.renderAttrs=function(e){let n,i,r;if(!e.attrs)return"";for(r="",n=0,i=e.attrs.length;n<i;n++)r+=" "+Hr(e.attrs[n][0])+'="'+Hr(e.attrs[n][1])+'"';return r};$o.prototype.renderToken=function(e,n,i){const r=e[n];let s="";if(r.hidden)return"";r.block&&r.nesting!==-1&&n&&e[n-1].hidden&&(s+=`
`),s+=(r.nesting===-1?"</":"<")+r.tag,s+=this.renderAttrs(r),r.nesting===0&&i.xhtmlOut&&(s+=" /");let a=!1;if(r.block&&(a=!0,r.nesting===1&&n+1<e.length)){const o=e[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===r.tag)&&(a=!1)}return s+=a?`>
`:">",s};$o.prototype.renderInline=function(t,e,n){let i="";const r=this.rules;for(let s=0,a=t.length;s<a;s++){const o=t[s].type;typeof r[o]<"u"?i+=r[o](t,s,e,n,this):i+=this.renderToken(t,s,e)}return i};$o.prototype.renderInlineAsText=function(t,e,n){let i="";for(let r=0,s=t.length;r<s;r++)switch(t[r].type){case"text":i+=t[r].content;break;case"image":i+=this.renderInlineAsText(t[r].children,e,n);break;case"html_inline":case"html_block":i+=t[r].content;break;case"softbreak":case"hardbreak":i+=`
`;break}return i};$o.prototype.render=function(t,e,n){let i="";const r=this.rules;for(let s=0,a=t.length;s<a;s++){const o=t[s].type;o==="inline"?i+=this.renderInline(t[s].children,e,n):typeof r[o]<"u"?i+=r[o](t,s,e,n,this):i+=this.renderToken(t,s,e,n)}return i};function pn(){this.__rules__=[],this.__cache__=null}pn.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1};pn.prototype.__compile__=function(){const t=this,e=[""];t.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(i){e.indexOf(i)<0&&e.push(i)})}),t.__cache__={},e.forEach(function(n){t.__cache__[n]=[],t.__rules__.forEach(function(i){i.enabled&&(n&&i.alt.indexOf(n)<0||t.__cache__[n].push(i.fn))})})};pn.prototype.at=function(t,e,n){const i=this.__find__(t),r=n||{};if(i===-1)throw new Error("Parser rule not found: "+t);this.__rules__[i].fn=e,this.__rules__[i].alt=r.alt||[],this.__cache__=null};pn.prototype.before=function(t,e,n,i){const r=this.__find__(t),s=i||{};if(r===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(r,0,{name:e,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null};pn.prototype.after=function(t,e,n,i){const r=this.__find__(t),s=i||{};if(r===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(r+1,0,{name:e,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null};pn.prototype.push=function(t,e,n){const i=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:i.alt||[]}),this.__cache__=null};pn.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(i){const r=this.__find__(i);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+i)}this.__rules__[r].enabled=!0,n.push(i)},this),this.__cache__=null,n};pn.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(t,e)};pn.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(i){const r=this.__find__(i);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+i)}this.__rules__[r].enabled=!1,n.push(i)},this),this.__cache__=null,n};pn.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};function ri(t,e,n){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}ri.prototype.attrIndex=function(e){if(!this.attrs)return-1;const n=this.attrs;for(let i=0,r=n.length;i<r;i++)if(n[i][0]===e)return i;return-1};ri.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};ri.prototype.attrSet=function(e,n){const i=this.attrIndex(e),r=[e,n];i<0?this.attrPush(r):this.attrs[i]=r};ri.prototype.attrGet=function(e){const n=this.attrIndex(e);let i=null;return n>=0&&(i=this.attrs[n][1]),i};ri.prototype.attrJoin=function(e,n){const i=this.attrIndex(e);i<0?this.attrPush([e,n]):this.attrs[i][1]=this.attrs[i][1]+" "+n};function SE(t,e,n){this.src=t,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=e}SE.prototype.Token=ri;const n7=/\r\n?|\n/g,i7=/\0/g;function r7(t){let e;e=t.src.replace(n7,`
`),e=e.replace(i7,""),t.src=e}function s7(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}function o7(t){const e=t.tokens;for(let n=0,i=e.length;n<i;n++){const r=e[n];r.type==="inline"&&t.md.inline.parse(r.content,t.md,t.env,r.children)}}function a7(t){return/^<a[>\s]/i.test(t)}function l7(t){return/^<\/a\s*>/i.test(t)}function u7(t){const e=t.tokens;if(t.md.options.linkify)for(let n=0,i=e.length;n<i;n++){if(e[n].type!=="inline"||!t.md.linkify.pretest(e[n].content))continue;let r=e[n].children,s=0;for(let a=r.length-1;a>=0;a--){const o=r[a];if(o.type==="link_close"){for(a--;r[a].level!==o.level&&r[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(a7(o.content)&&s>0&&s--,l7(o.content)&&s++),!(s>0)&&o.type==="text"&&t.md.linkify.test(o.content)){const l=o.content;let u=t.md.linkify.match(l);const c=[];let h=o.level,d=0;u.length>0&&u[0].index===0&&a>0&&r[a-1].type==="text_special"&&(u=u.slice(1));for(let p=0;p<u.length;p++){const m=u[p].url,_=t.md.normalizeLink(m);if(!t.md.validateLink(_))continue;let f=u[p].text;u[p].schema?u[p].schema==="mailto:"&&!/^mailto:/i.test(f)?f=t.md.normalizeLinkText("mailto:"+f).replace(/^mailto:/,""):f=t.md.normalizeLinkText(f):f=t.md.normalizeLinkText("http://"+f).replace(/^http:\/\//,"");const v=u[p].index;if(v>d){const w=new t.Token("text","",0);w.content=l.slice(d,v),w.level=h,c.push(w)}const g=new t.Token("link_open","a",1);g.attrs=[["href",_]],g.level=h++,g.markup="linkify",g.info="auto",c.push(g);const y=new t.Token("text","",0);y.content=f,y.level=h,c.push(y);const b=new t.Token("link_close","a",-1);b.level=--h,b.markup="linkify",b.info="auto",c.push(b),d=u[p].lastIndex}if(d<l.length){const p=new t.Token("text","",0);p.content=l.slice(d),p.level=h,c.push(p)}e[n].children=r=bE(r,a,c)}}}}const xE=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,c7=/\((c|tm|r)\)/i,h7=/\((c|tm|r)\)/ig,d7={c:"",r:"",tm:""};function f7(t,e){return d7[e.toLowerCase()]}function p7(t){let e=0;for(let n=t.length-1;n>=0;n--){const i=t[n];i.type==="text"&&!e&&(i.content=i.content.replace(h7,f7)),i.type==="link_open"&&i.info==="auto"&&e--,i.type==="link_close"&&i.info==="auto"&&e++}}function m7(t){let e=0;for(let n=t.length-1;n>=0;n--){const i=t[n];i.type==="text"&&!e&&xE.test(i.content)&&(i.content=i.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),i.type==="link_open"&&i.info==="auto"&&e--,i.type==="link_close"&&i.info==="auto"&&e++}}function g7(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)t.tokens[e].type==="inline"&&(c7.test(t.tokens[e].content)&&p7(t.tokens[e].children),xE.test(t.tokens[e].content)&&m7(t.tokens[e].children))}const v7=/['"]/,Ab=/['"]/g,Tb="";function Nu(t,e,n){return t.slice(0,e)+n+t.slice(e+1)}function _7(t,e){let n;const i=[];for(let r=0;r<t.length;r++){const s=t[r],a=t[r].level;for(n=i.length-1;n>=0&&!(i[n].level<=a);n--);if(i.length=n+1,s.type!=="text")continue;let o=s.content,l=0,u=o.length;e:for(;l<u;){Ab.lastIndex=l;const c=Ab.exec(o);if(!c)break;let h=!0,d=!0;l=c.index+1;const p=c[0]==="'";let m=32;if(c.index-1>=0)m=o.charCodeAt(c.index-1);else for(n=r-1;n>=0&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n--)if(t[n].content){m=t[n].content.charCodeAt(t[n].content.length-1);break}let _=32;if(l<u)_=o.charCodeAt(l);else for(n=r+1;n<t.length&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n++)if(t[n].content){_=t[n].content.charCodeAt(0);break}const f=kl(m)||xl(String.fromCharCode(m)),v=kl(_)||xl(String.fromCharCode(_)),g=Sl(m),y=Sl(_);if(y?h=!1:v&&(g||f||(h=!1)),g?d=!1:f&&(y||v||(d=!1)),_===34&&c[0]==='"'&&m>=48&&m<=57&&(d=h=!1),h&&d&&(h=f,d=v),!h&&!d){p&&(s.content=Nu(s.content,c.index,Tb));continue}if(d)for(n=i.length-1;n>=0;n--){let b=i[n];if(i[n].level<a)break;if(b.single===p&&i[n].level===a){b=i[n];let w,x;p?(w=e.md.options.quotes[2],x=e.md.options.quotes[3]):(w=e.md.options.quotes[0],x=e.md.options.quotes[1]),s.content=Nu(s.content,c.index,x),t[b.token].content=Nu(t[b.token].content,b.pos,w),l+=x.length-1,b.token===r&&(l+=w.length-1),o=s.content,u=o.length,i.length=n;continue e}}h?i.push({token:r,pos:c.index,single:p,level:a}):d&&p&&(s.content=Nu(s.content,c.index,Tb))}}}function y7(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)t.tokens[e].type!=="inline"||!v7.test(t.tokens[e].content)||_7(t.tokens[e].children,t)}function b7(t){let e,n;const i=t.tokens,r=i.length;for(let s=0;s<r;s++){if(i[s].type!=="inline")continue;const a=i[s].children,o=a.length;for(e=0;e<o;e++)a[e].type==="text_special"&&(a[e].type="text");for(e=n=0;e<o;e++)a[e].type==="text"&&e+1<o&&a[e+1].type==="text"?a[e+1].content=a[e].content+a[e+1].content:(e!==n&&(a[n]=a[e]),n++);e!==n&&(a.length=n)}}const Vf=[["normalize",r7],["block",s7],["inline",o7],["linkify",u7],["replacements",g7],["smartquotes",y7],["text_join",b7]];function wv(){this.ruler=new pn;for(let t=0;t<Vf.length;t++)this.ruler.push(Vf[t][0],Vf[t][1])}wv.prototype.process=function(t){const e=this.ruler.getRules("");for(let n=0,i=e.length;n<i;n++)e[n](t)};wv.prototype.State=SE;function Ei(t,e,n,i){this.src=t,this.md=e,this.env=n,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const r=this.src;for(let s=0,a=0,o=0,l=0,u=r.length,c=!1;a<u;a++){const h=r.charCodeAt(a);if(!c)if(Ge(h)){o++,h===9?l+=4-l%4:l++;continue}else c=!0;(h===10||a===u-1)&&(h!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),c=!1,o=0,l=0,s=a+1)}this.bMarks.push(r.length),this.eMarks.push(r.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Ei.prototype.push=function(t,e,n){const i=new ri(t,e,n);return i.block=!0,n<0&&this.level--,i.level=this.level,n>0&&this.level++,this.tokens.push(i),i};Ei.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Ei.prototype.skipEmptyLines=function(e){for(let n=this.lineMax;e<n&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Ei.prototype.skipSpaces=function(e){for(let n=this.src.length;e<n;e++){const i=this.src.charCodeAt(e);if(!Ge(i))break}return e};Ei.prototype.skipSpacesBack=function(e,n){if(e<=n)return e;for(;e>n;)if(!Ge(this.src.charCodeAt(--e)))return e+1;return e};Ei.prototype.skipChars=function(e,n){for(let i=this.src.length;e<i&&this.src.charCodeAt(e)===n;e++);return e};Ei.prototype.skipCharsBack=function(e,n,i){if(e<=i)return e;for(;e>i;)if(n!==this.src.charCodeAt(--e))return e+1;return e};Ei.prototype.getLines=function(e,n,i,r){if(e>=n)return"";const s=new Array(n-e);for(let a=0,o=e;o<n;o++,a++){let l=0;const u=this.bMarks[o];let c=u,h;for(o+1<n||r?h=this.eMarks[o]+1:h=this.eMarks[o];c<h&&l<i;){const d=this.src.charCodeAt(c);if(Ge(d))d===9?l+=4-(l+this.bsCount[o])%4:l++;else if(c-u<this.tShift[o])l++;else break;c++}l>i?s[a]=new Array(l-i+1).join(" ")+this.src.slice(c,h):s[a]=this.src.slice(c,h)}return s.join("")};Ei.prototype.Token=ri;const w7=65536;function Gf(t,e){const n=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];return t.src.slice(n,i)}function Mb(t){const e=[],n=t.length;let i=0,r=t.charCodeAt(i),s=!1,a=0,o="";for(;i<n;)r===124&&(s?(o+=t.substring(a,i-1),a=i):(e.push(o+t.substring(a,i)),o="",a=i+1)),s=r===92,i++,r=t.charCodeAt(i);return e.push(o+t.substring(a)),e}function S7(t,e,n,i){if(e+2>n)return!1;let r=e+1;if(t.sCount[r]<t.blkIndent||t.sCount[r]-t.blkIndent>=4)return!1;let s=t.bMarks[r]+t.tShift[r];if(s>=t.eMarks[r])return!1;const a=t.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58||s>=t.eMarks[r])return!1;const o=t.src.charCodeAt(s++);if(o!==124&&o!==45&&o!==58&&!Ge(o)||a===45&&Ge(o))return!1;for(;s<t.eMarks[r];){const b=t.src.charCodeAt(s);if(b!==124&&b!==45&&b!==58&&!Ge(b))return!1;s++}let l=Gf(t,e+1),u=l.split("|");const c=[];for(let b=0;b<u.length;b++){const w=u[b].trim();if(!w){if(b===0||b===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(w))return!1;w.charCodeAt(w.length-1)===58?c.push(w.charCodeAt(0)===58?"center":"right"):w.charCodeAt(0)===58?c.push("left"):c.push("")}if(l=Gf(t,e).trim(),l.indexOf("|")===-1||t.sCount[e]-t.blkIndent>=4)return!1;u=Mb(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop();const h=u.length;if(h===0||h!==c.length)return!1;if(i)return!0;const d=t.parentType;t.parentType="table";const p=t.md.block.ruler.getRules("blockquote"),m=t.push("table_open","table",1),_=[e,0];m.map=_;const f=t.push("thead_open","thead",1);f.map=[e,e+1];const v=t.push("tr_open","tr",1);v.map=[e,e+1];for(let b=0;b<u.length;b++){const w=t.push("th_open","th",1);c[b]&&(w.attrs=[["style","text-align:"+c[b]]]);const x=t.push("inline","",0);x.content=u[b].trim(),x.children=[],t.push("th_close","th",-1)}t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let g,y=0;for(r=e+2;r<n&&!(t.sCount[r]<t.blkIndent);r++){let b=!1;for(let x=0,k=p.length;x<k;x++)if(p[x](t,r,n,!0)){b=!0;break}if(b||(l=Gf(t,r).trim(),!l)||t.sCount[r]-t.blkIndent>=4||(u=Mb(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop(),y+=h-u.length,y>w7))break;if(r===e+2){const x=t.push("tbody_open","tbody",1);x.map=g=[e+2,0]}const w=t.push("tr_open","tr",1);w.map=[r,r+1];for(let x=0;x<h;x++){const k=t.push("td_open","td",1);c[x]&&(k.attrs=[["style","text-align:"+c[x]]]);const S=t.push("inline","",0);S.content=u[x]?u[x].trim():"",S.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return g&&(t.push("tbody_close","tbody",-1),g[1]=r),t.push("table_close","table",-1),_[1]=r,t.parentType=d,t.line=r,!0}function x7(t,e,n){if(t.sCount[e]-t.blkIndent<4)return!1;let i=e+1,r=i;for(;i<n;){if(t.isEmpty(i)){i++;continue}if(t.sCount[i]-t.blkIndent>=4){i++,r=i;continue}break}t.line=r;const s=t.push("code_block","code",0);return s.content=t.getLines(e,r,4+t.blkIndent,!1)+`
`,s.map=[e,t.line],!0}function k7(t,e,n,i){let r=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||r+3>s)return!1;const a=t.src.charCodeAt(r);if(a!==126&&a!==96)return!1;let o=r;r=t.skipChars(r,a);let l=r-o;if(l<3)return!1;const u=t.src.slice(o,r),c=t.src.slice(r,s);if(a===96&&c.indexOf(String.fromCharCode(a))>=0)return!1;if(i)return!0;let h=e,d=!1;for(;h++,!(h>=n||(r=o=t.bMarks[h]+t.tShift[h],s=t.eMarks[h],r<s&&t.sCount[h]<t.blkIndent));)if(t.src.charCodeAt(r)===a&&!(t.sCount[h]-t.blkIndent>=4)&&(r=t.skipChars(r,a),!(r-o<l)&&(r=t.skipSpaces(r),!(r<s)))){d=!0;break}l=t.sCount[e],t.line=h+(d?1:0);const p=t.push("fence","code",0);return p.info=c,p.content=t.getLines(e+1,h,l,!0),p.markup=u,p.map=[e,t.line],!0}function C7(t,e,n,i){let r=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];const a=t.lineMax;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(r)!==62)return!1;if(i)return!0;const o=[],l=[],u=[],c=[],h=t.md.block.ruler.getRules("blockquote"),d=t.parentType;t.parentType="blockquote";let p=!1,m;for(m=e;m<n;m++){const y=t.sCount[m]<t.blkIndent;if(r=t.bMarks[m]+t.tShift[m],s=t.eMarks[m],r>=s)break;if(t.src.charCodeAt(r++)===62&&!y){let w=t.sCount[m]+1,x,k;t.src.charCodeAt(r)===32?(r++,w++,k=!1,x=!0):t.src.charCodeAt(r)===9?(x=!0,(t.bsCount[m]+w)%4===3?(r++,w++,k=!1):k=!0):x=!1;let S=w;for(o.push(t.bMarks[m]),t.bMarks[m]=r;r<s;){const E=t.src.charCodeAt(r);if(Ge(E))E===9?S+=4-(S+t.bsCount[m]+(k?1:0))%4:S++;else break;r++}p=r>=s,l.push(t.bsCount[m]),t.bsCount[m]=t.sCount[m]+1+(x?1:0),u.push(t.sCount[m]),t.sCount[m]=S-w,c.push(t.tShift[m]),t.tShift[m]=r-t.bMarks[m];continue}if(p)break;let b=!1;for(let w=0,x=h.length;w<x;w++)if(h[w](t,m,n,!0)){b=!0;break}if(b){t.lineMax=m,t.blkIndent!==0&&(o.push(t.bMarks[m]),l.push(t.bsCount[m]),c.push(t.tShift[m]),u.push(t.sCount[m]),t.sCount[m]-=t.blkIndent);break}o.push(t.bMarks[m]),l.push(t.bsCount[m]),c.push(t.tShift[m]),u.push(t.sCount[m]),t.sCount[m]=-1}const _=t.blkIndent;t.blkIndent=0;const f=t.push("blockquote_open","blockquote",1);f.markup=">";const v=[e,0];f.map=v,t.md.block.tokenize(t,e,m);const g=t.push("blockquote_close","blockquote",-1);g.markup=">",t.lineMax=a,t.parentType=d,v[1]=t.line;for(let y=0;y<c.length;y++)t.bMarks[y+e]=o[y],t.tShift[y+e]=c[y],t.sCount[y+e]=u[y],t.bsCount[y+e]=l[y];return t.blkIndent=_,!0}function E7(t,e,n,i){const r=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.bMarks[e]+t.tShift[e];const a=t.src.charCodeAt(s++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;s<r;){const u=t.src.charCodeAt(s++);if(u!==a&&!Ge(u))return!1;u===a&&o++}if(o<3)return!1;if(i)return!0;t.line=e+1;const l=t.push("hr","hr",0);return l.map=[e,t.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function Rb(t,e){const n=t.eMarks[e];let i=t.bMarks[e]+t.tShift[e];const r=t.src.charCodeAt(i++);if(r!==42&&r!==45&&r!==43)return-1;if(i<n){const s=t.src.charCodeAt(i);if(!Ge(s))return-1}return i}function Ob(t,e){const n=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];let r=n;if(r+1>=i)return-1;let s=t.src.charCodeAt(r++);if(s<48||s>57)return-1;for(;;){if(r>=i)return-1;if(s=t.src.charCodeAt(r++),s>=48&&s<=57){if(r-n>=10)return-1;continue}if(s===41||s===46)break;return-1}return r<i&&(s=t.src.charCodeAt(r),!Ge(s))?-1:r}function D7(t,e){const n=t.level+2;for(let i=e+2,r=t.tokens.length-2;i<r;i++)t.tokens[i].level===n&&t.tokens[i].type==="paragraph_open"&&(t.tokens[i+2].hidden=!0,t.tokens[i].hidden=!0,i+=2)}function A7(t,e,n,i){let r,s,a,o,l=e,u=!0;if(t.sCount[l]-t.blkIndent>=4||t.listIndent>=0&&t.sCount[l]-t.listIndent>=4&&t.sCount[l]<t.blkIndent)return!1;let c=!1;i&&t.parentType==="paragraph"&&t.sCount[l]>=t.blkIndent&&(c=!0);let h,d,p;if((p=Ob(t,l))>=0){if(h=!0,a=t.bMarks[l]+t.tShift[l],d=Number(t.src.slice(a,p-1)),c&&d!==1)return!1}else if((p=Rb(t,l))>=0)h=!1;else return!1;if(c&&t.skipSpaces(p)>=t.eMarks[l])return!1;if(i)return!0;const m=t.src.charCodeAt(p-1),_=t.tokens.length;h?(o=t.push("ordered_list_open","ol",1),d!==1&&(o.attrs=[["start",d]])):o=t.push("bullet_list_open","ul",1);const f=[l,0];o.map=f,o.markup=String.fromCharCode(m);let v=!1;const g=t.md.block.ruler.getRules("list"),y=t.parentType;for(t.parentType="list";l<n;){s=p,r=t.eMarks[l];const b=t.sCount[l]+p-(t.bMarks[l]+t.tShift[l]);let w=b;for(;s<r;){const B=t.src.charCodeAt(s);if(B===9)w+=4-(w+t.bsCount[l])%4;else if(B===32)w++;else break;s++}const x=s;let k;x>=r?k=1:k=w-b,k>4&&(k=1);const S=b+k;o=t.push("list_item_open","li",1),o.markup=String.fromCharCode(m);const E=[l,0];o.map=E,h&&(o.info=t.src.slice(a,p-1));const A=t.tight,M=t.tShift[l],R=t.sCount[l],P=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=S,t.tight=!0,t.tShift[l]=x-t.bMarks[l],t.sCount[l]=w,x>=r&&t.isEmpty(l+1)?t.line=Math.min(t.line+2,n):t.md.block.tokenize(t,l,n,!0),(!t.tight||v)&&(u=!1),v=t.line-l>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=P,t.tShift[l]=M,t.sCount[l]=R,t.tight=A,o=t.push("list_item_close","li",-1),o.markup=String.fromCharCode(m),l=t.line,E[1]=l,l>=n||t.sCount[l]<t.blkIndent||t.sCount[l]-t.blkIndent>=4)break;let H=!1;for(let B=0,L=g.length;B<L;B++)if(g[B](t,l,n,!0)){H=!0;break}if(H)break;if(h){if(p=Ob(t,l),p<0)break;a=t.bMarks[l]+t.tShift[l]}else if(p=Rb(t,l),p<0)break;if(m!==t.src.charCodeAt(p-1))break}return h?o=t.push("ordered_list_close","ol",-1):o=t.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(m),f[1]=l,t.line=l,t.parentType=y,u&&D7(t,_),!0}function T7(t,e,n,i){let r=t.bMarks[e]+t.tShift[e],s=t.eMarks[e],a=e+1;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(r)!==91)return!1;function o(g){const y=t.lineMax;if(g>=y||t.isEmpty(g))return null;let b=!1;if(t.sCount[g]-t.blkIndent>3&&(b=!0),t.sCount[g]<0&&(b=!0),!b){const k=t.md.block.ruler.getRules("reference"),S=t.parentType;t.parentType="reference";let E=!1;for(let A=0,M=k.length;A<M;A++)if(k[A](t,g,y,!0)){E=!0;break}if(t.parentType=S,E)return null}const w=t.bMarks[g]+t.tShift[g],x=t.eMarks[g];return t.src.slice(w,x+1)}let l=t.src.slice(r,s+1);s=l.length;let u=-1;for(r=1;r<s;r++){const g=l.charCodeAt(r);if(g===91)return!1;if(g===93){u=r;break}else if(g===10){const y=o(a);y!==null&&(l+=y,s=l.length,a++)}else if(g===92&&(r++,r<s&&l.charCodeAt(r)===10)){const y=o(a);y!==null&&(l+=y,s=l.length,a++)}}if(u<0||l.charCodeAt(u+1)!==58)return!1;for(r=u+2;r<s;r++){const g=l.charCodeAt(r);if(g===10){const y=o(a);y!==null&&(l+=y,s=l.length,a++)}else if(!Ge(g))break}const c=t.md.helpers.parseLinkDestination(l,r,s);if(!c.ok)return!1;const h=t.md.normalizeLink(c.str);if(!t.md.validateLink(h))return!1;r=c.pos;const d=r,p=a,m=r;for(;r<s;r++){const g=l.charCodeAt(r);if(g===10){const y=o(a);y!==null&&(l+=y,s=l.length,a++)}else if(!Ge(g))break}let _=t.md.helpers.parseLinkTitle(l,r,s);for(;_.can_continue;){const g=o(a);if(g===null)break;l+=g,r=s,s=l.length,a++,_=t.md.helpers.parseLinkTitle(l,r,s,_)}let f;for(r<s&&m!==r&&_.ok?(f=_.str,r=_.pos):(f="",r=d,a=p);r<s;){const g=l.charCodeAt(r);if(!Ge(g))break;r++}if(r<s&&l.charCodeAt(r)!==10&&f)for(f="",r=d,a=p;r<s;){const g=l.charCodeAt(r);if(!Ge(g))break;r++}if(r<s&&l.charCodeAt(r)!==10)return!1;const v=Od(l.slice(1,u));return v?(i||(typeof t.env.references>"u"&&(t.env.references={}),typeof t.env.references[v]>"u"&&(t.env.references[v]={title:f,href:h}),t.line=a),!0):!1}const M7=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],R7="[a-zA-Z_:][a-zA-Z0-9:._-]*",O7="[^\"'=<>`\\x00-\\x20]+",P7="'[^']*'",N7='"[^"]*"',I7="(?:"+O7+"|"+P7+"|"+N7+")",L7="(?:\\s+"+R7+"(?:\\s*=\\s*"+I7+")?)",kE="<[A-Za-z][A-Za-z0-9\\-]*"+L7+"*\\s*\\/?>",CE="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",B7="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",z7="<[?][\\s\\S]*?[?]>",F7="<![A-Za-z][^>]*>",j7="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",H7=new RegExp("^(?:"+kE+"|"+CE+"|"+B7+"|"+z7+"|"+F7+"|"+j7+")"),$7=new RegExp("^(?:"+kE+"|"+CE+")"),js=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+M7.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp($7.source+"\\s*$"),/^$/,!1]];function W7(t,e,n,i){let r=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||!t.md.options.html||t.src.charCodeAt(r)!==60)return!1;let a=t.src.slice(r,s),o=0;for(;o<js.length&&!js[o][0].test(a);o++);if(o===js.length)return!1;if(i)return js[o][2];let l=e+1;if(!js[o][1].test(a)){for(;l<n&&!(t.sCount[l]<t.blkIndent);l++)if(r=t.bMarks[l]+t.tShift[l],s=t.eMarks[l],a=t.src.slice(r,s),js[o][1].test(a)){a.length!==0&&l++;break}}t.line=l;const u=t.push("html_block","",0);return u.map=[e,l],u.content=t.getLines(e,l,t.blkIndent,!0),!0}function V7(t,e,n,i){let r=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let a=t.src.charCodeAt(r);if(a!==35||r>=s)return!1;let o=1;for(a=t.src.charCodeAt(++r);a===35&&r<s&&o<=6;)o++,a=t.src.charCodeAt(++r);if(o>6||r<s&&!Ge(a))return!1;if(i)return!0;s=t.skipSpacesBack(s,r);const l=t.skipCharsBack(s,35,r);l>r&&Ge(t.src.charCodeAt(l-1))&&(s=l),t.line=e+1;const u=t.push("heading_open","h"+String(o),1);u.markup="########".slice(0,o),u.map=[e,t.line];const c=t.push("inline","",0);c.content=t.src.slice(r,s).trim(),c.map=[e,t.line],c.children=[];const h=t.push("heading_close","h"+String(o),-1);return h.markup="########".slice(0,o),!0}function G7(t,e,n){const i=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;const r=t.parentType;t.parentType="paragraph";let s=0,a,o=e+1;for(;o<n&&!t.isEmpty(o);o++){if(t.sCount[o]-t.blkIndent>3)continue;if(t.sCount[o]>=t.blkIndent){let p=t.bMarks[o]+t.tShift[o];const m=t.eMarks[o];if(p<m&&(a=t.src.charCodeAt(p),(a===45||a===61)&&(p=t.skipChars(p,a),p=t.skipSpaces(p),p>=m))){s=a===61?1:2;break}}if(t.sCount[o]<0)continue;let d=!1;for(let p=0,m=i.length;p<m;p++)if(i[p](t,o,n,!0)){d=!0;break}if(d)break}if(!s)return!1;const l=t.getLines(e,o,t.blkIndent,!1).trim();t.line=o+1;const u=t.push("heading_open","h"+String(s),1);u.markup=String.fromCharCode(a),u.map=[e,t.line];const c=t.push("inline","",0);c.content=l,c.map=[e,t.line-1],c.children=[];const h=t.push("heading_close","h"+String(s),-1);return h.markup=String.fromCharCode(a),t.parentType=r,!0}function U7(t,e,n){const i=t.md.block.ruler.getRules("paragraph"),r=t.parentType;let s=e+1;for(t.parentType="paragraph";s<n&&!t.isEmpty(s);s++){if(t.sCount[s]-t.blkIndent>3||t.sCount[s]<0)continue;let u=!1;for(let c=0,h=i.length;c<h;c++)if(i[c](t,s,n,!0)){u=!0;break}if(u)break}const a=t.getLines(e,s,t.blkIndent,!1).trim();t.line=s;const o=t.push("paragraph_open","p",1);o.map=[e,t.line];const l=t.push("inline","",0);return l.content=a,l.map=[e,t.line],l.children=[],t.push("paragraph_close","p",-1),t.parentType=r,!0}const Iu=[["table",S7,["paragraph","reference"]],["code",x7],["fence",k7,["paragraph","reference","blockquote","list"]],["blockquote",C7,["paragraph","reference","blockquote","list"]],["hr",E7,["paragraph","reference","blockquote","list"]],["list",A7,["paragraph","reference","blockquote"]],["reference",T7],["html_block",W7,["paragraph","reference","blockquote"]],["heading",V7,["paragraph","reference","blockquote"]],["lheading",G7],["paragraph",U7]];function Pd(){this.ruler=new pn;for(let t=0;t<Iu.length;t++)this.ruler.push(Iu[t][0],Iu[t][1],{alt:(Iu[t][2]||[]).slice()})}Pd.prototype.tokenize=function(t,e,n){const i=this.ruler.getRules(""),r=i.length,s=t.md.options.maxNesting;let a=e,o=!1;for(;a<n&&(t.line=a=t.skipEmptyLines(a),!(a>=n||t.sCount[a]<t.blkIndent));){if(t.level>=s){t.line=n;break}const l=t.line;let u=!1;for(let c=0;c<r;c++)if(u=i[c](t,a,n,!1),u){if(l>=t.line)throw new Error("block rule didn't increment state.line");break}if(!u)throw new Error("none of the block rules matched");t.tight=!o,t.isEmpty(t.line-1)&&(o=!0),a=t.line,a<n&&t.isEmpty(a)&&(o=!0,a++,t.line=a)}};Pd.prototype.parse=function(t,e,n,i){if(!t)return;const r=new this.State(t,e,n,i);this.tokenize(r,r.line,r.lineMax)};Pd.prototype.State=Ei;function Fl(t,e,n,i){this.src=t,this.env=n,this.md=e,this.tokens=i,this.tokens_meta=Array(i.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Fl.prototype.pushPending=function(){const t=new ri("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t};Fl.prototype.push=function(t,e,n){this.pending&&this.pushPending();const i=new ri(t,e,n);let r=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),i.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],r={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(i),this.tokens_meta.push(r),i};Fl.prototype.scanDelims=function(t,e){const n=this.posMax,i=this.src.charCodeAt(t),r=t>0?this.src.charCodeAt(t-1):32;let s=t;for(;s<n&&this.src.charCodeAt(s)===i;)s++;const a=s-t,o=s<n?this.src.charCodeAt(s):32,l=kl(r)||xl(String.fromCharCode(r)),u=kl(o)||xl(String.fromCharCode(o)),c=Sl(r),h=Sl(o),d=!h&&(!u||c||l),p=!c&&(!l||h||u);return{can_open:d&&(e||!p||l),can_close:p&&(e||!d||u),length:a}};Fl.prototype.Token=ri;function q7(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function K7(t,e){let n=t.pos;for(;n<t.posMax&&!q7(t.src.charCodeAt(n));)n++;return n===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}const J7=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function Z7(t,e){if(!t.md.options.linkify||t.linkLevel>0)return!1;const n=t.pos,i=t.posMax;if(n+3>i||t.src.charCodeAt(n)!==58||t.src.charCodeAt(n+1)!==47||t.src.charCodeAt(n+2)!==47)return!1;const r=t.pending.match(J7);if(!r)return!1;const s=r[1],a=t.md.linkify.matchAtStart(t.src.slice(n-s.length));if(!a)return!1;let o=a.url;if(o.length<=s.length)return!1;o=o.replace(/\*+$/,"");const l=t.md.normalizeLink(o);if(!t.md.validateLink(l))return!1;if(!e){t.pending=t.pending.slice(0,-s.length);const u=t.push("link_open","a",1);u.attrs=[["href",l]],u.markup="linkify",u.info="auto";const c=t.push("text","",0);c.content=t.md.normalizeLinkText(o);const h=t.push("link_close","a",-1);h.markup="linkify",h.info="auto"}return t.pos+=o.length-s.length,!0}function Y7(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==10)return!1;const i=t.pending.length-1,r=t.posMax;if(!e)if(i>=0&&t.pending.charCodeAt(i)===32)if(i>=1&&t.pending.charCodeAt(i-1)===32){let s=i-1;for(;s>=1&&t.pending.charCodeAt(s-1)===32;)s--;t.pending=t.pending.slice(0,s),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(n++;n<r&&Ge(t.src.charCodeAt(n));)n++;return t.pos=n,!0}const Sv=[];for(let t=0;t<256;t++)Sv.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){Sv[t.charCodeAt(0)]=1});function X7(t,e){let n=t.pos;const i=t.posMax;if(t.src.charCodeAt(n)!==92||(n++,n>=i))return!1;let r=t.src.charCodeAt(n);if(r===10){for(e||t.push("hardbreak","br",0),n++;n<i&&(r=t.src.charCodeAt(n),!!Ge(r));)n++;return t.pos=n,!0}let s=t.src[n];if(r>=55296&&r<=56319&&n+1<i){const o=t.src.charCodeAt(n+1);o>=56320&&o<=57343&&(s+=t.src[n+1],n++)}const a="\\"+s;if(!e){const o=t.push("text_special","",0);r<256&&Sv[r]!==0?o.content=s:o.content=a,o.markup=a,o.info="escape"}return t.pos=n+1,!0}function Q7(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==96)return!1;const r=n;n++;const s=t.posMax;for(;n<s&&t.src.charCodeAt(n)===96;)n++;const a=t.src.slice(r,n),o=a.length;if(t.backticksScanned&&(t.backticks[o]||0)<=r)return e||(t.pending+=a),t.pos+=o,!0;let l=n,u;for(;(u=t.src.indexOf("`",l))!==-1;){for(l=u+1;l<s&&t.src.charCodeAt(l)===96;)l++;const c=l-u;if(c===o){if(!e){const h=t.push("code_inline","code",0);h.markup=a,h.content=t.src.slice(n,u).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=l,!0}t.backticks[c]=u}return t.backticksScanned=!0,e||(t.pending+=a),t.pos+=o,!0}function ej(t,e){const n=t.pos,i=t.src.charCodeAt(n);if(e||i!==126)return!1;const r=t.scanDelims(t.pos,!0);let s=r.length;const a=String.fromCharCode(i);if(s<2)return!1;let o;s%2&&(o=t.push("text","",0),o.content=a,s--);for(let l=0;l<s;l+=2)o=t.push("text","",0),o.content=a+a,t.delimiters.push({marker:i,length:0,token:t.tokens.length-1,end:-1,open:r.can_open,close:r.can_close});return t.pos+=r.length,!0}function Pb(t,e){let n;const i=[],r=e.length;for(let s=0;s<r;s++){const a=e[s];if(a.marker!==126||a.end===-1)continue;const o=e[a.end];n=t.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=t.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",t.tokens[o.token-1].type==="text"&&t.tokens[o.token-1].content==="~"&&i.push(o.token-1)}for(;i.length;){const s=i.pop();let a=s+1;for(;a<t.tokens.length&&t.tokens[a].type==="s_close";)a++;a--,s!==a&&(n=t.tokens[a],t.tokens[a]=t.tokens[s],t.tokens[s]=n)}}function tj(t){const e=t.tokens_meta,n=t.tokens_meta.length;Pb(t,t.delimiters);for(let i=0;i<n;i++)e[i]&&e[i].delimiters&&Pb(t,e[i].delimiters)}const EE={tokenize:ej,postProcess:tj};function nj(t,e){const n=t.pos,i=t.src.charCodeAt(n);if(e||i!==95&&i!==42)return!1;const r=t.scanDelims(t.pos,i===42);for(let s=0;s<r.length;s++){const a=t.push("text","",0);a.content=String.fromCharCode(i),t.delimiters.push({marker:i,length:r.length,token:t.tokens.length-1,end:-1,open:r.can_open,close:r.can_close})}return t.pos+=r.length,!0}function Nb(t,e){const n=e.length;for(let i=n-1;i>=0;i--){const r=e[i];if(r.marker!==95&&r.marker!==42||r.end===-1)continue;const s=e[r.end],a=i>0&&e[i-1].end===r.end+1&&e[i-1].marker===r.marker&&e[i-1].token===r.token-1&&e[r.end+1].token===s.token+1,o=String.fromCharCode(r.marker),l=t.tokens[r.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const u=t.tokens[s.token];u.type=a?"strong_close":"em_close",u.tag=a?"strong":"em",u.nesting=-1,u.markup=a?o+o:o,u.content="",a&&(t.tokens[e[i-1].token].content="",t.tokens[e[r.end+1].token].content="",i--)}}function ij(t){const e=t.tokens_meta,n=t.tokens_meta.length;Nb(t,t.delimiters);for(let i=0;i<n;i++)e[i]&&e[i].delimiters&&Nb(t,e[i].delimiters)}const DE={tokenize:nj,postProcess:ij};function rj(t,e){let n,i,r,s,a="",o="",l=t.pos,u=!0;if(t.src.charCodeAt(t.pos)!==91)return!1;const c=t.pos,h=t.posMax,d=t.pos+1,p=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(p<0)return!1;let m=p+1;if(m<h&&t.src.charCodeAt(m)===40){for(u=!1,m++;m<h&&(n=t.src.charCodeAt(m),!(!Ge(n)&&n!==10));m++);if(m>=h)return!1;if(l=m,r=t.md.helpers.parseLinkDestination(t.src,m,t.posMax),r.ok){for(a=t.md.normalizeLink(r.str),t.md.validateLink(a)?m=r.pos:a="",l=m;m<h&&(n=t.src.charCodeAt(m),!(!Ge(n)&&n!==10));m++);if(r=t.md.helpers.parseLinkTitle(t.src,m,t.posMax),m<h&&l!==m&&r.ok)for(o=r.str,m=r.pos;m<h&&(n=t.src.charCodeAt(m),!(!Ge(n)&&n!==10));m++);}(m>=h||t.src.charCodeAt(m)!==41)&&(u=!0),m++}if(u){if(typeof t.env.references>"u")return!1;if(m<h&&t.src.charCodeAt(m)===91?(l=m+1,m=t.md.helpers.parseLinkLabel(t,m),m>=0?i=t.src.slice(l,m++):m=p+1):m=p+1,i||(i=t.src.slice(d,p)),s=t.env.references[Od(i)],!s)return t.pos=c,!1;a=s.href,o=s.title}if(!e){t.pos=d,t.posMax=p;const _=t.push("link_open","a",1),f=[["href",a]];_.attrs=f,o&&f.push(["title",o]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=m,t.posMax=h,!0}function sj(t,e){let n,i,r,s,a,o,l,u,c="";const h=t.pos,d=t.posMax;if(t.src.charCodeAt(t.pos)!==33||t.src.charCodeAt(t.pos+1)!==91)return!1;const p=t.pos+2,m=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(m<0)return!1;if(s=m+1,s<d&&t.src.charCodeAt(s)===40){for(s++;s<d&&(n=t.src.charCodeAt(s),!(!Ge(n)&&n!==10));s++);if(s>=d)return!1;for(u=s,o=t.md.helpers.parseLinkDestination(t.src,s,t.posMax),o.ok&&(c=t.md.normalizeLink(o.str),t.md.validateLink(c)?s=o.pos:c=""),u=s;s<d&&(n=t.src.charCodeAt(s),!(!Ge(n)&&n!==10));s++);if(o=t.md.helpers.parseLinkTitle(t.src,s,t.posMax),s<d&&u!==s&&o.ok)for(l=o.str,s=o.pos;s<d&&(n=t.src.charCodeAt(s),!(!Ge(n)&&n!==10));s++);else l="";if(s>=d||t.src.charCodeAt(s)!==41)return t.pos=h,!1;s++}else{if(typeof t.env.references>"u")return!1;if(s<d&&t.src.charCodeAt(s)===91?(u=s+1,s=t.md.helpers.parseLinkLabel(t,s),s>=0?r=t.src.slice(u,s++):s=m+1):s=m+1,r||(r=t.src.slice(p,m)),a=t.env.references[Od(r)],!a)return t.pos=h,!1;c=a.href,l=a.title}if(!e){i=t.src.slice(p,m);const _=[];t.md.inline.parse(i,t.md,t.env,_);const f=t.push("image","img",0),v=[["src",c],["alt",""]];f.attrs=v,f.children=_,f.content=i,l&&v.push(["title",l])}return t.pos=s,t.posMax=d,!0}const oj=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,aj=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function lj(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==60)return!1;const i=t.pos,r=t.posMax;for(;;){if(++n>=r)return!1;const a=t.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const s=t.src.slice(i+1,n);if(aj.test(s)){const a=t.md.normalizeLink(s);if(!t.md.validateLink(a))return!1;if(!e){const o=t.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=t.push("text","",0);l.content=t.md.normalizeLinkText(s);const u=t.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return t.pos+=s.length+2,!0}if(oj.test(s)){const a=t.md.normalizeLink("mailto:"+s);if(!t.md.validateLink(a))return!1;if(!e){const o=t.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=t.push("text","",0);l.content=t.md.normalizeLinkText(s);const u=t.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return t.pos+=s.length+2,!0}return!1}function uj(t){return/^<a[>\s]/i.test(t)}function cj(t){return/^<\/a\s*>/i.test(t)}function hj(t){const e=t|32;return e>=97&&e<=122}function dj(t,e){if(!t.md.options.html)return!1;const n=t.posMax,i=t.pos;if(t.src.charCodeAt(i)!==60||i+2>=n)return!1;const r=t.src.charCodeAt(i+1);if(r!==33&&r!==63&&r!==47&&!hj(r))return!1;const s=t.src.slice(i).match(H7);if(!s)return!1;if(!e){const a=t.push("html_inline","",0);a.content=s[0],uj(a.content)&&t.linkLevel++,cj(a.content)&&t.linkLevel--}return t.pos+=s[0].length,!0}const fj=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,pj=/^&([a-z][a-z0-9]{1,31});/i;function mj(t,e){const n=t.pos,i=t.posMax;if(t.src.charCodeAt(n)!==38||n+1>=i)return!1;if(t.src.charCodeAt(n+1)===35){const s=t.src.slice(n).match(fj);if(s){if(!e){const a=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),o=t.push("text_special","",0);o.content=bv(a)?Ph(a):Ph(65533),o.markup=s[0],o.info="entity"}return t.pos+=s[0].length,!0}}else{const s=t.src.slice(n).match(pj);if(s){const a=yE(s[0]);if(a!==s[0]){if(!e){const o=t.push("text_special","",0);o.content=a,o.markup=s[0],o.info="entity"}return t.pos+=s[0].length,!0}}}return!1}function Ib(t){const e={},n=t.length;if(!n)return;let i=0,r=-2;const s=[];for(let a=0;a<n;a++){const o=t[a];if(s.push(0),(t[i].marker!==o.marker||r!==o.token-1)&&(i=a),r=o.token,o.length=o.length||0,!o.close)continue;e.hasOwnProperty(o.marker)||(e[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=e[o.marker][(o.open?3:0)+o.length%3];let u=i-s[i]-1,c=u;for(;u>l;u-=s[u]+1){const h=t[u];if(h.marker===o.marker&&h.open&&h.end<0){let d=!1;if((h.close||o.open)&&(h.length+o.length)%3===0&&(h.length%3!==0||o.length%3!==0)&&(d=!0),!d){const p=u>0&&!t[u-1].open?s[u-1]+1:0;s[a]=a-u+p,s[u]=p,o.open=!1,h.end=a,h.close=!1,c=-1,r=-2;break}}}c!==-1&&(e[o.marker][(o.open?3:0)+(o.length||0)%3]=c)}}function gj(t){const e=t.tokens_meta,n=t.tokens_meta.length;Ib(t.delimiters);for(let i=0;i<n;i++)e[i]&&e[i].delimiters&&Ib(e[i].delimiters)}function vj(t){let e,n,i=0;const r=t.tokens,s=t.tokens.length;for(e=n=0;e<s;e++)r[e].nesting<0&&i--,r[e].level=i,r[e].nesting>0&&i++,r[e].type==="text"&&e+1<s&&r[e+1].type==="text"?r[e+1].content=r[e].content+r[e+1].content:(e!==n&&(r[n]=r[e]),n++);e!==n&&(r.length=n)}const Uf=[["text",K7],["linkify",Z7],["newline",Y7],["escape",X7],["backticks",Q7],["strikethrough",EE.tokenize],["emphasis",DE.tokenize],["link",rj],["image",sj],["autolink",lj],["html_inline",dj],["entity",mj]],qf=[["balance_pairs",gj],["strikethrough",EE.postProcess],["emphasis",DE.postProcess],["fragments_join",vj]];function jl(){this.ruler=new pn;for(let t=0;t<Uf.length;t++)this.ruler.push(Uf[t][0],Uf[t][1]);this.ruler2=new pn;for(let t=0;t<qf.length;t++)this.ruler2.push(qf[t][0],qf[t][1])}jl.prototype.skipToken=function(t){const e=t.pos,n=this.ruler.getRules(""),i=n.length,r=t.md.options.maxNesting,s=t.cache;if(typeof s[e]<"u"){t.pos=s[e];return}let a=!1;if(t.level<r){for(let o=0;o<i;o++)if(t.level++,a=n[o](t,!0),t.level--,a){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;a||t.pos++,s[e]=t.pos};jl.prototype.tokenize=function(t){const e=this.ruler.getRules(""),n=e.length,i=t.posMax,r=t.md.options.maxNesting;for(;t.pos<i;){const s=t.pos;let a=!1;if(t.level<r){for(let o=0;o<n;o++)if(a=e[o](t,!1),a){if(s>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(t.pos>=i)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};jl.prototype.parse=function(t,e,n,i){const r=new this.State(t,e,n,i);this.tokenize(r);const s=this.ruler2.getRules(""),a=s.length;for(let o=0;o<a;o++)s[o](r)};jl.prototype.State=Fl;function _j(t){const e={};t=t||{},e.src_Any=pE.source,e.src_Cc=mE.source,e.src_Z=vE.source,e.src_P=_v.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const n="[><]";return e.src_pseudo_letter="(?:(?!"+n+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+n+"|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function t0(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(i){t[i]=n[i]})}),t}function Nd(t){return Object.prototype.toString.call(t)}function yj(t){return Nd(t)==="[object String]"}function bj(t){return Nd(t)==="[object Object]"}function wj(t){return Nd(t)==="[object RegExp]"}function Lb(t){return Nd(t)==="[object Function]"}function Sj(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const AE={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function xj(t){return Object.keys(t||{}).reduce(function(e,n){return e||AE.hasOwnProperty(n)},!1)}const kj={"http:":{validate:function(t,e,n){const i=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(i)?i.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){const i=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(i)?e>=3&&t[e-3]===":"||e>=3&&t[e-3]==="/"?0:i.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){const i=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(i)?i.match(n.re.mailto)[0].length:0}}},Cj="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Ej="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function Dj(t){t.__index__=-1,t.__text_cache__=""}function Aj(t){return function(e,n){const i=e.slice(n);return t.test(i)?i.match(t)[0].length:0}}function Bb(){return function(t,e){e.normalize(t)}}function Nh(t){const e=t.re=_j(t.__opts__),n=t.__tlds__.slice();t.onCompile(),t.__tlds_replaced__||n.push(Cj),n.push(e.src_xn),e.src_tlds=n.join("|");function i(o){return o.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(i(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(i(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(i(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(i(e.tpl_host_fuzzy_test),"i");const r=[];t.__compiled__={};function s(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(t.__schemas__).forEach(function(o){const l=t.__schemas__[o];if(l===null)return;const u={validate:null,link:null};if(t.__compiled__[o]=u,bj(l)){wj(l.validate)?u.validate=Aj(l.validate):Lb(l.validate)?u.validate=l.validate:s(o,l),Lb(l.normalize)?u.normalize=l.normalize:l.normalize?s(o,l):u.normalize=Bb();return}if(yj(l)){r.push(o);return}s(o,l)}),r.forEach(function(o){t.__compiled__[t.__schemas__[o]]&&(t.__compiled__[o].validate=t.__compiled__[t.__schemas__[o]].validate,t.__compiled__[o].normalize=t.__compiled__[t.__schemas__[o]].normalize)}),t.__compiled__[""]={validate:null,normalize:Bb()};const a=Object.keys(t.__compiled__).filter(function(o){return o.length>0&&t.__compiled__[o]}).map(Sj).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+a+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+a+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),Dj(t)}function Tj(t,e){const n=t.__index__,i=t.__last_index__,r=t.__text_cache__.slice(n,i);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=i+e,this.raw=r,this.text=r,this.url=r}function n0(t,e){const n=new Tj(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function xn(t,e){if(!(this instanceof xn))return new xn(t,e);e||xj(t)&&(e=t,t={}),this.__opts__=t0({},AE,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=t0({},kj,t),this.__compiled__={},this.__tlds__=Ej,this.__tlds_replaced__=!1,this.re={},Nh(this)}xn.prototype.add=function(e,n){return this.__schemas__[e]=n,Nh(this),this};xn.prototype.set=function(e){return this.__opts__=t0(this.__opts__,e),this};xn.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let n,i,r,s,a,o,l,u,c;if(this.re.schema_test.test(e)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(e))!==null;)if(s=this.testSchemaAt(e,n[2],l.lastIndex),s){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(u=e.search(this.re.host_fuzzy_test),u>=0&&(this.__index__<0||u<this.__index__)&&(i=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=i.index+i[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=i.index+i[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&(r=e.match(this.re.email_fuzzy))!==null&&(a=r.index+r[1].length,o=r.index+r[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};xn.prototype.pretest=function(e){return this.re.pretest.test(e)};xn.prototype.testSchemaAt=function(e,n,i){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(e,i,this):0};xn.prototype.match=function(e){const n=[];let i=0;this.__index__>=0&&this.__text_cache__===e&&(n.push(n0(this,i)),i=this.__last_index__);let r=i?e.slice(i):e;for(;this.test(r);)n.push(n0(this,i)),r=r.slice(this.__last_index__),i+=this.__last_index__;return n.length?n:null};xn.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const n=this.re.schema_at_start.exec(e);if(!n)return null;const i=this.testSchemaAt(e,n[2],n[0].length);return i?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i,n0(this,0)):null};xn.prototype.tlds=function(e,n){return e=Array.isArray(e)?e:[e],n?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(i,r,s){return i!==s[r-1]}).reverse(),Nh(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,Nh(this),this)};xn.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};xn.prototype.onCompile=function(){};const _o=2147483647,mi=36,xv=1,Cl=26,Mj=38,Rj=700,TE=72,ME=128,RE="-",Oj=/^xn--/,Pj=/[^\0-\x7F]/,Nj=/[\x2E\u3002\uFF0E\uFF61]/g,Ij={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Kf=mi-xv,gi=Math.floor,Jf=String.fromCharCode;function ur(t){throw new RangeError(Ij[t])}function Lj(t,e){const n=[];let i=t.length;for(;i--;)n[i]=e(t[i]);return n}function OE(t,e){const n=t.split("@");let i="";n.length>1&&(i=n[0]+"@",t=n[1]),t=t.replace(Nj,".");const r=t.split("."),s=Lj(r,e).join(".");return i+s}function PE(t){const e=[];let n=0;const i=t.length;for(;n<i;){const r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){const s=t.charCodeAt(n++);(s&64512)==56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),n--)}else e.push(r)}return e}const Bj=t=>String.fromCodePoint(...t),zj=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:mi},zb=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},NE=function(t,e,n){let i=0;for(t=n?gi(t/Rj):t>>1,t+=gi(t/e);t>Kf*Cl>>1;i+=mi)t=gi(t/Kf);return gi(i+(Kf+1)*t/(t+Mj))},IE=function(t){const e=[],n=t.length;let i=0,r=ME,s=TE,a=t.lastIndexOf(RE);a<0&&(a=0);for(let o=0;o<a;++o)t.charCodeAt(o)>=128&&ur("not-basic"),e.push(t.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=i;for(let c=1,h=mi;;h+=mi){o>=n&&ur("invalid-input");const d=zj(t.charCodeAt(o++));d>=mi&&ur("invalid-input"),d>gi((_o-i)/c)&&ur("overflow"),i+=d*c;const p=h<=s?xv:h>=s+Cl?Cl:h-s;if(d<p)break;const m=mi-p;c>gi(_o/m)&&ur("overflow"),c*=m}const u=e.length+1;s=NE(i-l,u,l==0),gi(i/u)>_o-r&&ur("overflow"),r+=gi(i/u),i%=u,e.splice(i++,0,r)}return String.fromCodePoint(...e)},LE=function(t){const e=[];t=PE(t);const n=t.length;let i=ME,r=0,s=TE;for(const l of t)l<128&&e.push(Jf(l));const a=e.length;let o=a;for(a&&e.push(RE);o<n;){let l=_o;for(const c of t)c>=i&&c<l&&(l=c);const u=o+1;l-i>gi((_o-r)/u)&&ur("overflow"),r+=(l-i)*u,i=l;for(const c of t)if(c<i&&++r>_o&&ur("overflow"),c===i){let h=r;for(let d=mi;;d+=mi){const p=d<=s?xv:d>=s+Cl?Cl:d-s;if(h<p)break;const m=h-p,_=mi-p;e.push(Jf(zb(p+m%_,0))),h=gi(m/_)}e.push(Jf(zb(h,0))),s=NE(r,u,o===a),r=0,++o}++r,++i}return e.join("")},Fj=function(t){return OE(t,function(e){return Oj.test(e)?IE(e.slice(4).toLowerCase()):e})},jj=function(t){return OE(t,function(e){return Pj.test(e)?"xn--"+LE(e):e})},BE={version:"2.3.1",ucs2:{decode:PE,encode:Bj},decode:IE,encode:LE,toASCII:jj,toUnicode:Fj},Hj={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},$j={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},Wj={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},Vj={default:Hj,zero:$j,commonmark:Wj},Gj=/^(vbscript|javascript|file|data):/,Uj=/^data:image\/(gif|png|jpeg|webp);/;function qj(t){const e=t.trim().toLowerCase();return Gj.test(e)?Uj.test(e):!0}const zE=["http:","https:","mailto:"];function Kj(t){const e=vv(t,!0);if(e.hostname&&(!e.protocol||zE.indexOf(e.protocol)>=0))try{e.hostname=BE.toASCII(e.hostname)}catch{}return zl(gv(e))}function Jj(t){const e=vv(t,!0);if(e.hostname&&(!e.protocol||zE.indexOf(e.protocol)>=0))try{e.hostname=BE.toUnicode(e.hostname)}catch{}return Io(gv(e),Io.defaultChars+"%")}function Wn(t,e){if(!(this instanceof Wn))return new Wn(t,e);e||yv(t)||(e=t||{},t="default"),this.inline=new jl,this.block=new Pd,this.core=new wv,this.renderer=new $o,this.linkify=new xn,this.validateLink=qj,this.normalizeLink=Kj,this.normalizeLinkText=Jj,this.utils=Y9,this.helpers=Rd({},t7),this.options={},this.configure(t),e&&this.set(e)}Wn.prototype.set=function(t){return Rd(this.options,t),this};Wn.prototype.configure=function(t){const e=this;if(yv(t)){const n=t;if(t=Vj[n],!t)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enableOnly(t.components[n].rules),t.components[n].rules2&&e[n].ruler2.enableOnly(t.components[n].rules2)}),this};Wn.prototype.enable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(r){n=n.concat(this[r].ruler.enable(t,!0))},this),n=n.concat(this.inline.ruler2.enable(t,!0));const i=t.filter(function(r){return n.indexOf(r)<0});if(i.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+i);return this};Wn.prototype.disable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(r){n=n.concat(this[r].ruler.disable(t,!0))},this),n=n.concat(this.inline.ruler2.disable(t,!0));const i=t.filter(function(r){return n.indexOf(r)<0});if(i.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+i);return this};Wn.prototype.use=function(t){const e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this};Wn.prototype.parse=function(t,e){if(typeof t!="string")throw new Error("Input data should be a String");const n=new this.core.State(t,this,e);return this.core.process(n),n.tokens};Wn.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};Wn.prototype.parseInline=function(t,e){const n=new this.core.State(t,this,e);return n.inlineMode=!0,this.core.process(n),n.tokens};Wn.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};function Zj(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}function i0(t,e){return Array(e+1).join(t)}function FE(t){return t.replace(/^\n*/,"")}function jE(t){for(var e=t.length;e>0&&t[e-1]===`
`;)e--;return t.substring(0,e)}function HE(t){return jE(FE(t))}var Yj=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function kv(t){return Cv(t,Yj)}var $E=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function WE(t){return Cv(t,$E)}function Xj(t){return GE(t,$E)}var VE=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function Qj(t){return Cv(t,VE)}function eH(t){return GE(t,VE)}function Cv(t,e){return e.indexOf(t.nodeName)>=0}function GE(t,e){return t.getElementsByTagName&&e.some(function(n){return t.getElementsByTagName(n).length})}var Zt={};Zt.paragraph={filter:"p",replacement:function(t){return`

`+t+`

`}};Zt.lineBreak={filter:"br",replacement:function(t,e,n){return n.br+`
`}};Zt.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(t,e,n){var i=Number(e.nodeName.charAt(1));if(n.headingStyle==="setext"&&i<3){var r=i0(i===1?"=":"-",t.length);return`

`+t+`
`+r+`

`}else return`

`+i0("#",i)+" "+t+`

`}};Zt.blockquote={filter:"blockquote",replacement:function(t){return t=HE(t).replace(/^/gm,"> "),`

`+t+`

`}};Zt.list={filter:["ul","ol"],replacement:function(t,e){var n=e.parentNode;return n.nodeName==="LI"&&n.lastElementChild===e?`
`+t:`

`+t+`

`}};Zt.listItem={filter:"li",replacement:function(t,e,n){var i=n.bulletListMarker+"   ",r=e.parentNode;if(r.nodeName==="OL"){var s=r.getAttribute("start"),a=Array.prototype.indexOf.call(r.children,e);i=(s?Number(s)+a:a+1)+".  "}var o=/\n$/.test(t);return t=HE(t)+(o?`
`:""),t=t.replace(/\n/gm,`
`+" ".repeat(i.length)),i+t+(e.nextSibling?`
`:"")}};Zt.indentedCodeBlock={filter:function(t,e){return e.codeBlockStyle==="indented"&&t.nodeName==="PRE"&&t.firstChild&&t.firstChild.nodeName==="CODE"},replacement:function(t,e,n){return`

    `+e.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Zt.fencedCodeBlock={filter:function(t,e){return e.codeBlockStyle==="fenced"&&t.nodeName==="PRE"&&t.firstChild&&t.firstChild.nodeName==="CODE"},replacement:function(t,e,n){for(var i=e.firstChild.getAttribute("class")||"",r=(i.match(/language-(\S+)/)||[null,""])[1],s=e.firstChild.textContent,a=n.fence.charAt(0),o=3,l=new RegExp("^"+a+"{3,}","gm"),u;u=l.exec(s);)u[0].length>=o&&(o=u[0].length+1);var c=i0(a,o);return`

`+c+r+`
`+s.replace(/\n$/,"")+`
`+c+`

`}};Zt.horizontalRule={filter:"hr",replacement:function(t,e,n){return`

`+n.hr+`

`}};Zt.inlineLink={filter:function(t,e){return e.linkStyle==="inlined"&&t.nodeName==="A"&&t.getAttribute("href")},replacement:function(t,e){var n=e.getAttribute("href");n&&(n=n.replace(/([()])/g,"\\$1"));var i=Ih(e.getAttribute("title"));return i&&(i=' "'+i.replace(/"/g,'\\"')+'"'),"["+t+"]("+n+i+")"}};Zt.referenceLink={filter:function(t,e){return e.linkStyle==="referenced"&&t.nodeName==="A"&&t.getAttribute("href")},replacement:function(t,e,n){var i=e.getAttribute("href"),r=Ih(e.getAttribute("title"));r&&(r=' "'+r+'"');var s,a;switch(n.linkReferenceStyle){case"collapsed":s="["+t+"][]",a="["+t+"]: "+i+r;break;case"shortcut":s="["+t+"]",a="["+t+"]: "+i+r;break;default:var o=this.references.length+1;s="["+t+"]["+o+"]",a="["+o+"]: "+i+r}return this.references.push(a),s},references:[],append:function(t){var e="";return this.references.length&&(e=`

`+this.references.join(`
`)+`

`,this.references=[]),e}};Zt.emphasis={filter:["em","i"],replacement:function(t,e,n){return t.trim()?n.emDelimiter+t+n.emDelimiter:""}};Zt.strong={filter:["strong","b"],replacement:function(t,e,n){return t.trim()?n.strongDelimiter+t+n.strongDelimiter:""}};Zt.code={filter:function(t){var e=t.previousSibling||t.nextSibling,n=t.parentNode.nodeName==="PRE"&&!e;return t.nodeName==="CODE"&&!n},replacement:function(t){if(!t)return"";t=t.replace(/\r?\n|\r/g," ");for(var e=/^`|^ .*?[^ ].* $|`$/.test(t)?" ":"",n="`",i=t.match(/`+/gm)||[];i.indexOf(n)!==-1;)n=n+"`";return n+e+t+e+n}};Zt.image={filter:"img",replacement:function(t,e){var n=Ih(e.getAttribute("alt")),i=e.getAttribute("src")||"",r=Ih(e.getAttribute("title")),s=r?' "'+r+'"':"";return i?"!["+n+"]("+i+s+")":""}};function Ih(t){return t?t.replace(/(\n+\s*)+/g,`
`):""}function UE(t){this.options=t,this._keep=[],this._remove=[],this.blankRule={replacement:t.blankReplacement},this.keepReplacement=t.keepReplacement,this.defaultRule={replacement:t.defaultReplacement},this.array=[];for(var e in t.rules)this.array.push(t.rules[e])}UE.prototype={add:function(t,e){this.array.unshift(e)},keep:function(t){this._keep.unshift({filter:t,replacement:this.keepReplacement})},remove:function(t){this._remove.unshift({filter:t,replacement:function(){return""}})},forNode:function(t){if(t.isBlank)return this.blankRule;var e;return(e=Zf(this.array,t,this.options))||(e=Zf(this._keep,t,this.options))||(e=Zf(this._remove,t,this.options))?e:this.defaultRule},forEach:function(t){for(var e=0;e<this.array.length;e++)t(this.array[e],e)}};function Zf(t,e,n){for(var i=0;i<t.length;i++){var r=t[i];if(tH(r,e,n))return r}}function tH(t,e,n){var i=t.filter;if(typeof i=="string"){if(i===e.nodeName.toLowerCase())return!0}else if(Array.isArray(i)){if(i.indexOf(e.nodeName.toLowerCase())>-1)return!0}else if(typeof i=="function"){if(i.call(t,e,n))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function nH(t){var e=t.element,n=t.isBlock,i=t.isVoid,r=t.isPre||function(h){return h.nodeName==="PRE"};if(!(!e.firstChild||r(e))){for(var s=null,a=!1,o=null,l=Fb(o,e,r);l!==e;){if(l.nodeType===3||l.nodeType===4){var u=l.data.replace(/[ \r\n\t]+/g," ");if((!s||/ $/.test(s.data))&&!a&&u[0]===" "&&(u=u.substr(1)),!u){l=Yf(l);continue}l.data=u,s=l}else if(l.nodeType===1)n(l)||l.nodeName==="BR"?(s&&(s.data=s.data.replace(/ $/,"")),s=null,a=!1):i(l)||r(l)?(s=null,a=!0):s&&(a=!1);else{l=Yf(l);continue}var c=Fb(o,l,r);o=l,l=c}s&&(s.data=s.data.replace(/ $/,""),s.data||Yf(s))}}function Yf(t){var e=t.nextSibling||t.parentNode;return t.parentNode.removeChild(t),e}function Fb(t,e,n){return t&&t.parentNode===e||n(e)?e.nextSibling||e.parentNode:e.firstChild||e.nextSibling||e.parentNode}var Ev=typeof window<"u"?window:{};function iH(){var t=Ev.DOMParser,e=!1;try{new t().parseFromString("","text/html")&&(e=!0)}catch{}return e}function rH(){var t=function(){};return sH()?t.prototype.parseFromString=function(e){var n=new window.ActiveXObject("htmlfile");return n.designMode="on",n.open(),n.write(e),n.close(),n}:t.prototype.parseFromString=function(e){var n=document.implementation.createHTMLDocument("");return n.open(),n.write(e),n.close(),n},t}function sH(){var t=!1;try{document.implementation.createHTMLDocument("").open()}catch{Ev.ActiveXObject&&(t=!0)}return t}var oH=iH()?Ev.DOMParser:rH();function aH(t,e){var n;if(typeof t=="string"){var i=lH().parseFromString('<x-turndown id="turndown-root">'+t+"</x-turndown>","text/html");n=i.getElementById("turndown-root")}else n=t.cloneNode(!0);return nH({element:n,isBlock:kv,isVoid:WE,isPre:e.preformattedCode?uH:null}),n}var Xf;function lH(){return Xf=Xf||new oH,Xf}function uH(t){return t.nodeName==="PRE"||t.nodeName==="CODE"}function cH(t,e){return t.isBlock=kv(t),t.isCode=t.nodeName==="CODE"||t.parentNode.isCode,t.isBlank=hH(t),t.flankingWhitespace=dH(t,e),t}function hH(t){return!WE(t)&&!Qj(t)&&/^\s*$/i.test(t.textContent)&&!Xj(t)&&!eH(t)}function dH(t,e){if(t.isBlock||e.preformattedCode&&t.isCode)return{leading:"",trailing:""};var n=fH(t.textContent);return n.leadingAscii&&jb("left",t,e)&&(n.leading=n.leadingNonAscii),n.trailingAscii&&jb("right",t,e)&&(n.trailing=n.trailingNonAscii),{leading:n.leading,trailing:n.trailing}}function fH(t){var e=t.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:e[1],leadingAscii:e[2],leadingNonAscii:e[3],trailing:e[4],trailingNonAscii:e[5],trailingAscii:e[6]}}function jb(t,e,n){var i,r,s;return t==="left"?(i=e.previousSibling,r=/ $/):(i=e.nextSibling,r=/^ /),i&&(i.nodeType===3?s=r.test(i.nodeValue):n.preformattedCode&&i.nodeName==="CODE"?s=!1:i.nodeType===1&&!kv(i)&&(s=r.test(i.textContent))),s}var pH=Array.prototype.reduce,mH=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function Lh(t){if(!(this instanceof Lh))return new Lh(t);var e={rules:Zt,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(n,i){return i.isBlock?`

`:""},keepReplacement:function(n,i){return i.isBlock?`

`+i.outerHTML+`

`:i.outerHTML},defaultReplacement:function(n,i){return i.isBlock?`

`+n+`

`:n}};this.options=Zj({},e,t),this.rules=new UE(this.options)}Lh.prototype={turndown:function(t){if(!_H(t))throw new TypeError(t+" is not a string, or an element/document/fragment node.");if(t==="")return"";var e=qE.call(this,new aH(t,this.options));return gH.call(this,e)},use:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.use(t[e]);else if(typeof t=="function")t(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(t,e){return this.rules.add(t,e),this},keep:function(t){return this.rules.keep(t),this},remove:function(t){return this.rules.remove(t),this},escape:function(t){return mH.reduce(function(e,n){return e.replace(n[0],n[1])},t)}};function qE(t){var e=this;return pH.call(t.childNodes,function(n,i){i=new cH(i,e.options);var r="";return i.nodeType===3?r=i.isCode?i.nodeValue:e.escape(i.nodeValue):i.nodeType===1&&(r=vH.call(e,i)),KE(n,r)},"")}function gH(t){var e=this;return this.rules.forEach(function(n){typeof n.append=="function"&&(t=KE(t,n.append(e.options)))}),t.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function vH(t){var e=this.rules.forNode(t),n=qE.call(this,t),i=t.flankingWhitespace;return(i.leading||i.trailing)&&(n=n.trim()),i.leading+e.replacement(n,t,this.options)+i.trailing}function KE(t,e){var n=jE(t),i=FE(e),r=Math.max(t.length-n.length,e.length-i.length),s=`

`.substring(0,r);return n+s+i}function _H(t){return t!=null&&(typeof t=="string"||t.nodeType&&(t.nodeType===1||t.nodeType===9||t.nodeType===11))}function JE(t,e){if(t===e)return{deletedLines:[],addedLineNumbers:new Set,wordDiffs:new Map};const n=tv(t,e),i=[],r=new Set,s=new Map;let a=0,o=[],l=[];return n.forEach(u=>{const c=u.value.split(`
`);c[c.length-1]===""&&c.pop(),u.removed?c.forEach(h=>{o.push(h),l.push(h)}):u.added?c.forEach((h,d)=>{if(a++,r.add(a),d<l.length){const p=l[d],m=Ah(p,h);s.set(a,m)}if(d===0&&o.length>0){const p=o.map((m,_)=>_<c.length?{text:m,wordChanges:Ah(m,c[_])}:{text:m,wordChanges:null});i.push({beforeLine:a,texts:o,wordDiffs:p}),o=[],l=[]}}):(o.length>0&&(i.push({beforeLine:a+1,texts:[...o],wordDiffs:o.map(h=>({text:h,wordChanges:null}))}),o=[],l=[]),c.forEach(()=>{a++}))}),o.length>0&&i.push({beforeLine:a+1,texts:[...o],wordDiffs:o.map(u=>({text:u,wordChanges:null}))}),{deletedLines:i,addedLineNumbers:r,wordDiffs:s}}function yH(t,e){return Xe.create({name:"diffDecorations",addProseMirrorPlugins(){return[new Ye({key:new dt("diffDecorations"),props:{decorations(n){const i=n.doc;let r=[];i.descendants(p=>(p.isBlock&&p.isTextblock&&r.push(p.textContent),!1));const s=r.join(`
`),a=JE(t,s),{deletedLines:o,addedLineNumbers:l,wordDiffs:u}=a,c=[];let h=0;i.descendants((p,m)=>{if(p.isBlock){if(h++,l.has(h)){c.push(nt.node(m,m+p.nodeSize,{class:"diff-line-added"}));const f=u.get(h);if(f&&p.isTextblock){let v=0;const g=m+1;f.forEach(y=>{if(y.added){const b=g+v,w=b+y.value.length;w<=m+p.nodeSize-1&&c.push(nt.inline(b,w,{class:"diff-word-added"})),v+=y.value.length}else y.removed||(v+=y.value.length)})}}const _=o.find(f=>f.beforeLine===h);if(_){const f=document.createElement("div");f.className="diff-deleted-block",f.contentEditable="false";const v=[];_.wordDiffs?_.wordDiffs.forEach(({text:y,wordChanges:b})=>{const w=document.createElement("div");w.className="diff-deleted-line",v.push(y),b?b.forEach(x=>{const k=document.createElement("span");x.removed?(k.className="diff-word-removed",k.textContent=x.value,w.appendChild(k)):x.added||(k.textContent=x.value,w.appendChild(k))}):w.textContent=y||"",f.appendChild(w)}):_.texts.forEach(y=>{const b=document.createElement("div");b.className="diff-deleted-line",b.textContent=y||"",v.push(y),f.appendChild(b)});const g=document.createElement("button");g.className="diff-copy-btn",g.textContent="",g.title="Copy deleted text",g.onclick=y=>{y.preventDefault(),y.stopPropagation(),navigator.clipboard.writeText(v.join(`
`)),g.textContent="",setTimeout(()=>{g.textContent=""},1500)},f.addEventListener("mouseenter",()=>{g.style.opacity="1"}),f.addEventListener("mouseleave",()=>{g.style.opacity="0.3"}),f.appendChild(g),c.push(nt.widget(m,f,{side:-1}))}}return!1});const d=o.find(p=>p.beforeLine===h+1);if(d){const p=document.createElement("div");p.className="diff-deleted-block",d.texts.forEach(m=>{const _=document.createElement("div");_.className="diff-deleted-line",_.textContent=m||"",p.appendChild(_)}),c.push(nt.widget(i.content.size,p,{side:1}))}return We.create(i,c)}}})]}})}function bH(){const t=`# Hello World

This is the first paragraph.

This is the second paragraph that will be modified.

This is the third paragraph.

This line will be deleted.

The end.`,[e,n]=I.useState(`# Hello World

This is the first paragraph.

This paragraph was MODIFIED with new content!

This is the third paragraph.

This is a completely NEW paragraph that was added!

The end.`),i=I.useMemo(()=>new Wn({html:!1,linkify:!0,breaks:!0}),[]),r=I.useMemo(()=>new Lh({codeBlockStyle:"fenced",headingStyle:"atx",bulletListMarker:"-"}),[]),s=I.useMemo(()=>t.split(`
`).map(u=>u.replace(/^#+\s*/,"").trim()).filter(u=>u.length>0).join(`
`),[t]),a=I.useMemo(()=>yH(s),[s,r]),o=I.useMemo(()=>JE(t,e),[t,e]),l=jC({extensions:[m2,a],content:i.render(e),onUpdate:({editor:u})=>{const c=u.getHTML(),h=r.turndown(c);n(h)}},[a]);return I.useEffect(()=>{if(l&&!l.isFocused){const u=l.getHTML();r.turndown(u)!==e&&l.commands.setContent(i.render(e))}},[l,e,i,r]),C.jsxs("div",{className:"tiptap-diff-poc",children:[C.jsx("h2",{children:"Tiptap Diff POC"}),C.jsx("p",{className:"poc-description",children:"Deleted lines shown in red above modified content. Green background for additions."}),C.jsx("style",{children:`
        .tiptap-diff-poc {
          padding: 20px;
          max-width: 900px;
          margin: 0 auto;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .poc-description {
          color: #666;
          margin-bottom: 20px;
        }
        .tiptap-editor-container {
          border: 1px solid #d0d0d0;
          border-radius: 6px;
          background: #1e1e1e;
          padding: 16px;
          min-height: 400px;
        }
        .tiptap-editor-container .ProseMirror {
          outline: none;
          font-family: 'SF Mono', Monaco, 'Courier New', monospace;
          font-size: 14px;
          line-height: 1.6;
          color: #c9d1d9;
        }
        .tiptap-editor-container .ProseMirror p {
          margin: 0;
          padding: 4px 8px;
        }
        .tiptap-editor-container .ProseMirror h1,
        .tiptap-editor-container .ProseMirror h2,
        .tiptap-editor-container .ProseMirror h3 {
          margin: 0;
          padding: 4px 8px;
          color: #c9d1d9;
        }

        /* Added line - green background */
        .diff-line-added {
          background-color: rgba(46, 160, 67, 0.15) !important;
          border-left: 3px solid #3fb950;
        }
        .diff-line-added p,
        .diff-line-added h1,
        .diff-line-added h2 {
          color: #7ee787 !important;
        }

        /* Deleted lines block - red */
        .diff-deleted-block {
          background-color: rgba(248, 81, 73, 0.15);
          border-left: 3px solid #f85149;
          margin: 0;
          padding: 0;
          position: relative;
        }
        .diff-copy-btn {
          position: absolute;
          right: 8px;
          top: 4px;
          padding: 4px 8px;
          font-size: 14px;
          background: rgba(248, 81, 73, 0.3);
          border: 1px solid #f85149;
          border-radius: 4px;
          color: #ffa198;
          cursor: pointer;
          opacity: 0.3;
          transition: opacity 0.15s, background 0.15s;
          z-index: 10;
        }
        .diff-copy-btn:hover {
          background: rgba(248, 81, 73, 0.6);
          opacity: 1 !important;
        }
        .diff-deleted-line {
          padding: 4px 8px;
          font-family: 'SF Mono', Monaco, 'Courier New', monospace;
          font-size: 14px;
          line-height: 1.6;
          color: #ffa198;
          opacity: 0.9;
        }
        /* Word-level highlight for removed text */
        .diff-word-removed {
          background-color: rgba(248, 81, 73, 0.4);
          text-decoration: line-through;
          border-radius: 2px;
          padding: 1px 2px;
        }
        /* Word-level highlight for added text */
        .diff-word-added {
          background-color: rgba(46, 160, 67, 0.4);
          border-radius: 2px;
          padding: 1px 2px;
        }

        .debug-info {
          margin-top: 16px;
          padding: 12px;
          background: #f6f8fa;
          border-radius: 6px;
          font-size: 12px;
        }
      `}),C.jsx("div",{className:"tiptap-editor-container",children:C.jsx(zC,{editor:l})}),C.jsxs("div",{className:"debug-info",children:[C.jsx("strong",{children:"Debug:"})," ",o.deletedLines.length," deleted blocks |",o.addedLineNumbers.size," added lines | Original: ",t.split(`
`).length," lines | Current: ",e.split(`
`).length," lines"]})]})}const Hb=new URLSearchParams(window.location.search).get("poc"),wH="",ua=t=>`${wH}${t}`,ZE={filetree:S6,editor:DF,terminal:IF,shell:jF,empty:HF,review:VF,workflows:r9,workflowTerminal:o9},YE=new Set(Object.keys(ZE)),Lu=["filetree","terminal","workflows","shell"],XE=t=>{if(!(t!=null&&t.grid)||!(t!=null&&t.panels))return!1;const e=t.panels,n=Object.keys(e);for(const c of Lu)if(!n.includes(c))return console.warn(`[Layout drift] Missing essential panel: ${c}`),!1;const i=[],r=c=>{var h;if(c){if(c.type==="leaf"&&((h=c.data)!=null&&h.views)){const d=c.data.views.map(p=>p.id).filter(Boolean);i.push(d)}c.data&&Array.isArray(c.data)&&c.data.forEach(r)}};r(t.grid.root);const s={};i.forEach((c,h)=>{c.forEach(d=>{s[d]=h})});const a=i[s.filetree];if(a){const c=a.filter(d=>d!=="filetree");if(c.some(d=>Lu.includes(d)))return console.warn("[Layout drift] filetree group has invalid panels:",c),!1}const o=i[s.terminal];if(o){const c=o.filter(d=>d!=="terminal");if(c.some(d=>Lu.includes(d)))return console.warn("[Layout drift] terminal group has invalid panels:",c),!1}const l=s.workflows,u=s.shell;if(l===u&&l!==void 0){const h=i[l].filter(d=>d!=="workflows"&&d!=="shell"&&!d.startsWith("editor-")&&!d.startsWith("review-")&&Lu.includes(d));if(h.length>0)return console.warn("[Layout drift] workflows/shell group has invalid panels:",h),!1}if(u!==void 0){const c=i[u];if(c.includes("filetree")||c.includes("terminal"))return console.warn("[Layout drift] shell is in wrong group with filetree/terminal"),!1}if(l!==void 0){const c=i[l];if(c.includes("filetree")||c.includes("terminal"))return console.warn("[Layout drift] workflows is in wrong group with filetree/terminal"),!1}return!0},SH=t=>C.jsx(a6,{...t,hideClose:!0}),xH={noClose:SH},Qf=t=>{const e=t.split("/");return e[e.length-1]},Dv=21,kH=t=>{if(!t)return"default";let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);e=(e<<5)-e+i,e=e&e}return Math.abs(e).toString(36)},ls=(t,e)=>`kurt-web-${kH(t)}-${e}`,CH=t=>{try{const e=localStorage.getItem(ls(t,"tabs"));if(e)return JSON.parse(e)}catch{}return[]},EH=(t,e)=>{try{localStorage.setItem(ls(t,"tabs"),JSON.stringify(e))}catch{}},DH=t=>{try{const e=localStorage.getItem(ls(t,"layout"));if(!e)return null;const n=JSON.parse(e);return!(n!=null&&n.version)||n.version<Dv?(console.info("[Layout] Version outdated, resetting layout"),localStorage.removeItem(ls(t,"layout")),null):n!=null&&n.panels&&typeof n.panels=="object"&&Object.values(n.panels).some(s=>(s==null?void 0:s.contentComponent)&&!YE.has(s.contentComponent))?(console.info("[Layout] Unknown components found, resetting layout"),localStorage.removeItem(ls(t,"layout")),null):XE(n)?n:(console.info("[Layout] Structure drift detected, resetting layout"),localStorage.removeItem(ls(t,"layout")),null)}catch{return null}},AH=t=>{if(!t||!Array.isArray(t.groups))return!1;const e=[...t.groups];let n=!1;return e.forEach(i=>{const r=Array.isArray(i==null?void 0:i.panels)?i.panels:[];if(r.length===0){t.removeGroup(i),n=!0;return}r.some(a=>{var o;return YE.has((o=a==null?void 0:a.api)==null?void 0:o.component)})||(t.removeGroup(i),n=!0)}),n},$b=(t,e)=>{try{const n={...e,version:Dv};localStorage.setItem(ls(t,"layout"),JSON.stringify(n))}catch{}},QE="kurt-web-sidebar-collapsed",eD="kurt-web-panel-sizes",TH=()=>{try{const t=localStorage.getItem(QE);if(t)return JSON.parse(t)}catch{}return{filetree:!1,terminal:!1,workflows:!1}},ep=t=>{try{localStorage.setItem(QE,JSON.stringify(t))}catch{}},MH=()=>{try{const t=localStorage.getItem(eD);if(t)return JSON.parse(t)}catch{}return{filetree:280,terminal:400,workflows:250}},Bu=t=>{try{localStorage.setItem(eD,JSON.stringify(t))}catch{}};function RH(){const[t,e]=I.useState(null),[n,i]=I.useState({}),[r,s]=I.useState([]),[a,o]=I.useState(!1),[l,u]=I.useState({}),[c,h]=I.useState(null),[d,p]=I.useState(null),[m,_]=I.useState(TH),f=I.useRef(MH()),v=I.useRef(!1),g=I.useRef(new Set),y=I.useRef(null),b=I.useRef(!1),w=I.useRef(!1),[x,k]=I.useState(null),S=I.useRef(null),E=I.useCallback(()=>{if(!m.filetree&&t){const F=t.getPanel("filetree"),V=F==null?void 0:F.group;if(V){const G=V.api.width;G>48&&(f.current={...f.current,filetree:G},Bu(f.current))}}_(F=>{const V={...F,filetree:!F.filetree};return ep(V),V})},[m.filetree,t]),A=I.useCallback(()=>{if(!m.terminal&&t){const F=t.getPanel("terminal"),V=F==null?void 0:F.group;if(V){const G=V.api.width;G>48&&(f.current={...f.current,terminal:G},Bu(f.current))}}_(F=>{const V={...F,terminal:!F.terminal};return ep(V),V})},[m.terminal,t]),M=I.useCallback(()=>{if(!m.workflows&&t){const F=t.getPanel("workflows"),V=F==null?void 0:F.group;if(V){const G=V.api.height;G>36&&(f.current={...f.current,workflows:G},Bu(f.current))}}_(F=>{const V={...F,workflows:!F.workflows};return ep(V),V})},[m.workflows,t]),R=I.useCallback(F=>{var oe;const V=((oe=F.group)==null?void 0:oe.panels)||[],G=V.some(ae=>ae.id==="workflows"),W=V.some(ae=>ae.id==="shell");return G&&W||W&&!G?C.jsx("button",{type:"button",className:"tab-collapse-btn",onClick:M,title:m.workflows?"Expand panel":"Collapse panel","aria-label":m.workflows?"Expand panel":"Collapse panel",children:C.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor",children:m.workflows?C.jsx("path",{d:"M3.5 6L8 10.5L12.5 6H3.5Z"}):C.jsx("path",{d:"M3.5 10L8 5.5L12.5 10H3.5Z"})})}):null},[m.workflows,M]);I.useEffect(()=>{if(!t)return;const F=!v.current;F&&(v.current=!0);const V=t.getPanel("filetree"),G=t.getPanel("terminal"),W=V==null?void 0:V.group;W&&(m.filetree?(W.api.setConstraints({minimumWidth:48,maximumWidth:48}),W.api.setSize({width:48})):(W.api.setConstraints({minimumWidth:180,maximumWidth:1/0}),F||W.api.setSize({width:f.current.filetree})));const ne=G==null?void 0:G.group;ne&&(m.terminal?(ne.api.setConstraints({minimumWidth:48,maximumWidth:48}),ne.api.setSize({width:48})):(ne.api.setConstraints({minimumWidth:250,maximumWidth:1/0}),F||ne.api.setSize({width:f.current.terminal})));const oe=t.getPanel("workflows"),ae=t.getPanel("shell"),Y=oe==null?void 0:oe.group,le=ae==null?void 0:ae.group;Y&&(m.workflows?(Y.api.setConstraints({minimumHeight:36,maximumHeight:36}),Y.api.setSize({height:36})):(Y.api.setConstraints({minimumHeight:100,maximumHeight:1/0}),F||Y.api.setSize({height:f.current.workflows}))),le&&le!==Y&&(m.workflows?(le.api.setConstraints({minimumHeight:36,maximumHeight:36}),le.api.setSize({height:36})):(le.api.setConstraints({minimumHeight:100,maximumHeight:1/0}),F||le.api.setSize({height:f.current.workflows})))},[t,m]);const P=I.useCallback(()=>{fetch(ua("/api/git/status")).then(F=>F.json()).then(F=>{F.available&&F.files&&u(F.files)}).catch(()=>{})},[]);I.useEffect(()=>{P();const F=setInterval(P,5e3);return()=>clearInterval(F)},[P]),I.useEffect(()=>{let F=!0;const V=()=>{fetch(ua("/api/approval/pending")).then(W=>W.json()).then(W=>{if(!F)return;const oe=(Array.isArray(W.requests)?W.requests:[]).filter(ae=>!g.current.has(ae.id));s(oe),o(!0)}).catch(()=>{})};V();const G=setInterval(V,1e3);return()=>{F=!1,clearInterval(G)}},[]);const H=I.useCallback(async(F,V,G)=>{if(F){if(g.current.add(F),s(W=>W.filter(ne=>ne.id!==F)),t){const W=t.getPanel(`review-${F}`);W&&W.api.close()}}else s([]);try{await fetch(ua("/api/approval/decision"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request_id:F,decision:V,reason:G})})}catch{}},[t]),B=I.useCallback(F=>{if(!F)return"";if(F.project_path)return F.project_path;const V=F.file_path||"";if(!V)return"";if(x){const G=x.endsWith("/")?x:`${x}/`;if(V.startsWith(G))return V.slice(G.length)}return V},[x]),L=I.useCallback(F=>{const V=B(F);return V?`Review: ${Qf(V)}`:F!=null&&F.tool_name?`Review: ${F.tool_name}`:"Review"},[B]),j=I.useCallback((F,V,G={})=>{if(!t)return;const W=`editor-${F}`,ne=t.getPanel(W);if(ne){G.initialMode&&ne.api.updateParameters({initialMode:G.initialMode}),ne.api.setActive();return}const oe=t.getPanel("empty-center"),ae=y.current;ae&&(ae.header.hidden=!1);const Y=le=>{i(fe=>({...fe,[F]:{content:le,isDirty:!1}}));const _e=t.addPanel({id:W,component:"editor",title:Qf(F),position:V,params:{path:F,initialContent:le,contentVersion:1,...G,onContentChange:(fe,xe)=>{i(De=>({...De,[fe]:{...De[fe],content:xe}}))},onDirtyChange:(fe,xe)=>{i(ge=>({...ge,[fe]:{...ge[fe],isDirty:xe}}));const De=t.getPanel(`editor-${fe}`);De&&De.api.setTitle(Qf(fe)+(xe?" *":""))}}});oe&&oe.api.close(),_e!=null&&_e.group&&(_e.group.header.hidden=!1,y.current=_e.group,_e.group.api.setConstraints({minimumHeight:200,maximumHeight:1/0}))};fetch(ua(`/api/file?path=${encodeURIComponent(F)}`)).then(le=>le.json()).then(le=>{Y(le.content||"")}).catch(()=>{Y("")})},[t]),D=I.useCallback(F=>{if(!t)return!1;const V=`editor-${F}`,G=t.getPanel(V);if(G)return G.api.setActive(),!0;const W=t.getPanel("empty-center"),ne=t.getPanel("workflows"),oe=y.current,Y=(Array.isArray(t.panels)?t.panels:[]).find(_e=>_e.id.startsWith("editor-")||_e.id.startsWith("review-"));let le;return Y!=null&&Y.group?le={referenceGroup:Y.group}:oe?le={referenceGroup:oe}:W!=null&&W.group?le={referenceGroup:W.group}:ne!=null&&ne.group?le={direction:"above",referenceGroup:ne.group}:le={direction:"right",referencePanel:"filetree"},j(F,le),!0},[t,j]),O=I.useCallback(F=>{if(!t)return;const V=`editor-${F}`,G=t.getPanel(V);if(G){G.api.setActive();return}const W=t.activePanel;let ne;W&&W.id.startsWith("editor-")?ne={direction:"right",referencePanel:W.id}:y.current?ne={direction:"right",referenceGroup:y.current}:ne={direction:"right",referencePanel:"filetree"},j(F,ne)},[t,j]),N=I.useCallback((F,V)=>{if(!t)return;const G=`editor-${F}`,W=t.getPanel(G);if(W){W.api.updateParameters({initialMode:"git-diff"}),W.api.setActive(),p(F);return}const ne=t.getPanel("empty-center"),oe=t.getPanel("workflows"),ae=y.current;let Y;ne!=null&&ne.group?Y={referenceGroup:ne.group}:ae?Y={referenceGroup:ae}:oe!=null&&oe.group?Y={direction:"above",referenceGroup:oe.group}:Y={direction:"right",referencePanel:"filetree"},j(F,Y,{initialMode:"git-diff"}),p(F)},[t,j]);I.useEffect(()=>{if(!t||!a)return;const F=new Set(r.map(G=>G.id));(Array.isArray(t.panels)?t.panels:typeof t.getPanels=="function"?t.getPanels():[]).forEach(G=>{var ne;if(!((ne=G==null?void 0:G.id)!=null&&ne.startsWith("review-")))return;const W=G.id.replace("review-","");F.has(W)||G.api.close()}),r.forEach(G=>{const W=`review-${G.id}`,ne=B(G),oe=t.getPanel(W),ae={request:G,filePath:ne,onDecision:H,onOpenFile:D};if(oe){oe.api.updateParameters(ae),oe.api.setTitle(L(G));return}const Y=t.getPanel("empty-center"),le=t.getPanel("workflows"),fe=(Array.isArray(t.panels)?t.panels:[]).find(ge=>ge.id.startsWith("editor-")||ge.id.startsWith("review-"));let xe;fe!=null&&fe.group?xe={referenceGroup:fe.group}:y.current?xe={referenceGroup:y.current}:Y!=null&&Y.group?xe={referenceGroup:Y.group}:le!=null&&le.group?xe={direction:"above",referenceGroup:le.group}:xe={direction:"right",referencePanel:"filetree"};const De=t.addPanel({id:W,component:"review",title:L(G),position:xe,params:ae});Y&&Y.api.close(),De!=null&&De.group&&(De.group.header.hidden=!1,y.current=De.group,De.group.api.setConstraints({minimumHeight:200,maximumHeight:1/0}))})},[r,a,t,L,H,B,D]);const z=F=>{const V=F.api;e(V);const G=()=>{const Y=V.getPanel("filetree"),le=V.getPanel("terminal"),_e=Y==null?void 0:Y.group;_e&&(_e.locked=!0,_e.header.hidden=!0,_e.api.setConstraints({minimumWidth:180,maximumWidth:1/0}));const fe=le==null?void 0:le.group;fe&&(fe.locked=!0,fe.header.hidden=!0,fe.api.setConstraints({minimumWidth:250,maximumWidth:1/0}));const xe=V.getPanel("workflows"),De=xe==null?void 0:xe.group;De&&De.api.setConstraints({minimumHeight:100,maximumHeight:1/0})},W=()=>{let Y=V.getPanel("filetree");Y||(Y=V.addPanel({id:"filetree",component:"filetree",title:"Files",params:{onOpenFile:()=>{}}}));let le=V.getPanel("terminal");le||(le=V.addPanel({id:"terminal",component:"terminal",title:"Code Sessions",position:{direction:"right",referencePanel:"filetree"}}));let _e=V.getPanel("empty-center");_e||(_e=V.addPanel({id:"empty-center",component:"empty",title:"",position:{direction:"left",referencePanel:"terminal"}})),_e!=null&&_e.group&&(_e.group.header.hidden=!0,y.current=_e.group,_e.group.api.setConstraints({minimumHeight:200,maximumHeight:1/0}));let fe=V.getPanel("workflows");!fe&&(_e!=null&&_e.group)&&(fe=V.addPanel({id:"workflows",component:"workflows",tabComponent:"noClose",title:"Workflows",position:{direction:"below",referenceGroup:_e.group},params:{collapsed:!1,onToggleCollapse:()=>{},onAttachWorkflow:()=>{}}}));let xe=V.getPanel("shell");!xe&&(fe!=null&&fe.group)&&(xe=V.addPanel({id:"shell",component:"shell",tabComponent:"noClose",title:"Shell",position:{referenceGroup:fe.group},params:{collapsed:!1,onToggleCollapse:()=>{}}})),fe!=null&&fe.group&&(fe.group.header.hidden=!1,fe.group.locked=!0);const ge=(Array.isArray(V.panels)?V.panels:typeof V.getPanels=="function"?V.getPanels():[]).filter(ke=>ke.id.startsWith("editor-"));ge.length>0&&(y.current=ge[0].group),G()};let ne=!1;try{for(let Y=0;Y<localStorage.length;Y++){const le=localStorage.key(Y);if(le&&le.startsWith("kurt-web-")&&le.endsWith("-layout")){const _e=localStorage.getItem(le);if(_e){const fe=JSON.parse(_e);if((fe==null?void 0:fe.version)>=Dv&&(fe!=null&&fe.panels)&&XE(fe)){ne=!0;break}}}}}catch{}ne||W(),requestAnimationFrame(()=>{var fe,xe,De,ge,ke,Pe;const Y=(fe=V.getPanel("filetree"))==null?void 0:fe.group,le=(xe=V.getPanel("terminal"))==null?void 0:xe.group,_e=(De=V.getPanel("workflows"))==null?void 0:De.group;Y&&((ge=V.getGroup(Y.id))==null||ge.api.setSize({width:f.current.filetree})),le&&((ke=V.getGroup(le.id))==null||ke.api.setSize({width:f.current.terminal})),_e&&((Pe=V.getGroup(_e.id))==null||Pe.api.setSize({height:f.current.workflows}))}),V.onDidRemovePanel(Y=>{if(Y.id.startsWith("editor-")){const le=Y.id.replace("editor-","");i(_e=>{const fe={..._e};return delete fe[le],fe})}}),V.onDidRemovePanel(()=>{var Pe,Fe;if(V.getPanel("empty-center"))return;const le=Array.isArray(V.panels)?V.panels:[],_e=le.some(vt=>vt.id.startsWith("editor-")),fe=le.some(vt=>vt.id.startsWith("review-"));if(_e||fe)return;let xe=y.current;const De=xe&&((Pe=V.groups)==null?void 0:Pe.includes(xe)),ge=V.getPanel("workflows");let ke;De&&((Fe=xe.panels)==null?void 0:Fe.length)>0?ke=V.addPanel({id:"empty-center",component:"empty",title:"",position:{referenceGroup:xe}}):ge!=null&&ge.group?ke=V.addPanel({id:"empty-center",component:"empty",title:"",position:{direction:"above",referenceGroup:ge.group}}):ke=V.addPanel({id:"empty-center",component:"empty",title:"",position:{direction:"right",referencePanel:"filetree"}}),ke!=null&&ke.group&&(y.current=ke.group,ke.group.header.hidden=!0,ke.group.api.setConstraints({minimumHeight:200,maximumHeight:1/0}))});const oe=()=>{typeof V.toJSON=="function"&&$b(S.current,V.toJSON())},ae=()=>{const Y=V.getPanel("filetree"),le=V.getPanel("terminal"),_e=V.getPanel("workflows"),fe=Y==null?void 0:Y.group,xe=le==null?void 0:le.group,De=_e==null?void 0:_e.group,ge={...f.current};let ke=!1;fe&&fe.api.width>48&&ge.filetree!==fe.api.width&&(ge.filetree=fe.api.width,ke=!0),xe&&xe.api.width>48&&ge.terminal!==xe.api.width&&(ge.terminal=xe.api.width,ke=!0),De&&De.api.height>36&&ge.workflows!==De.api.height&&(ge.workflows=De.api.height,ke=!0),ke&&(f.current=ge,Bu(ge))};typeof V.onDidLayoutChange=="function"&&V.onDidLayoutChange(()=>{oe(),ae()}),window.addEventListener("beforeunload",oe),b.current=!0};I.useEffect(()=>{const F=()=>{fetch(ua("/api/project")).then(V=>V.json()).then(V=>{const G=V.root||"";S.current=G,k(G)}).catch(()=>{setTimeout(F,500)})};F()},[]);const q=I.useRef(!1);I.useEffect(()=>{if(!t||x===null||q.current)return;q.current=!0;const F=DH(x);if(F&&typeof t.fromJSON=="function")try{t.fromJSON(F),w.current=!0;const V=t.getPanel("filetree"),G=t.getPanel("terminal"),W=t.getPanel("workflows"),ne=V==null?void 0:V.group;ne&&(ne.locked=!0,ne.header.hidden=!0);const oe=G==null?void 0:G.group;oe&&(oe.locked=!0,oe.header.hidden=!0);const ae=W==null?void 0:W.group;ae&&(ae.locked=!0,ae.header.hidden=!1,ae.api.setConstraints({minimumHeight:100,maximumHeight:1/0}));let Y=t.getPanel("shell");!Y&&(W!=null&&W.group)&&(Y=t.addPanel({id:"shell",component:"shell",tabComponent:"noClose",title:"Shell",position:{referenceGroup:W.group},params:{collapsed:!1,onToggleCollapse:()=>{}}}));const le=Array.isArray(t.panels)?t.panels:typeof t.getPanels=="function"?t.getPanels():[],_e=le.some(ge=>ge.id.startsWith("editor-")),fe=le.some(ge=>ge.id.startsWith("review-"));if(_e||fe){const ge=t.getPanel("empty-center");if(ge){const ke=le.find(Pe=>Pe.id.startsWith("editor-")||Pe.id.startsWith("review-"));ke!=null&&ke.group&&(y.current=ke.group),ge.api.close()}}const xe=t.getPanel("empty-center");xe!=null&&xe.group&&(y.current=xe.group,xe.group.api.setConstraints({minimumHeight:200,maximumHeight:1/0})),AH(t)&&typeof t.toJSON=="function"&&$b(x,t.toJSON()),requestAnimationFrame(()=>{var Yt,Dn,_t,St,Ee,Pt,U;const ge=(Yt=t.getPanel("filetree"))==null?void 0:Yt.group,ke=(Dn=t.getPanel("terminal"))==null?void 0:Dn.group,Pe=(_t=t.getPanel("workflows"))==null?void 0:_t.group;if(ge){const Q=(St=t.getGroup(ge.id))==null?void 0:St.api;Q&&(m.filetree?(Q.setConstraints({minimumWidth:48,maximumWidth:48}),Q.setSize({width:48})):(Q.setConstraints({minimumWidth:180,maximumWidth:1/0}),Q.setSize({width:f.current.filetree})))}if(ke){const Q=(Ee=t.getGroup(ke.id))==null?void 0:Ee.api;Q&&(m.terminal?(Q.setConstraints({minimumWidth:48,maximumWidth:48}),Q.setSize({width:48})):(Q.setConstraints({minimumWidth:250,maximumWidth:1/0}),Q.setSize({width:f.current.terminal})))}if(Pe){const Q=(Pt=t.getGroup(Pe.id))==null?void 0:Pt.api;Q&&(m.workflows?(Q.setConstraints({minimumHeight:36,maximumHeight:36}),Q.setSize({height:36})):(Q.setConstraints({minimumHeight:100,maximumHeight:1/0}),Q.setSize({height:f.current.workflows})))}const Fe=t.getPanel("shell"),vt=Fe==null?void 0:Fe.group;if(vt&&vt!==Pe){const Q=(U=t.getGroup(vt.id))==null?void 0:U.api;Q&&(m.workflows?(Q.setConstraints({minimumHeight:36,maximumHeight:36}),Q.setSize({height:36})):(Q.setConstraints({minimumHeight:100,maximumHeight:1/0}),Q.setSize({height:f.current.workflows})))}v.current=!0})}catch{w.current=!1}},[t,x]),I.useEffect(()=>{if(!t)return;const F=t.onDidActivePanelChange(V=>{if(V&&V.id&&V.id.startsWith("editor-")){const G=V.id.replace("editor-","");h(G),p(G);const W=new URL(window.location.href);W.searchParams.set("doc",G),window.history.replaceState({},"",W)}else{h(null),p(null);const G=new URL(window.location.href);G.searchParams.delete("doc"),window.history.replaceState({},"",G)}});return()=>F.dispose()},[t]),I.useEffect(()=>{if(!t)return;const F=t.getPanel("filetree");F&&F.api.updateParameters({onOpenFile:D,onOpenFileToSide:O,onOpenDiff:N,projectRoot:x,activeFile:c,activeDiffFile:d,collapsed:m.filetree,onToggleCollapse:E})},[t,D,O,N,x,c,d,m.filetree,E]);const te=I.useCallback(F=>{if(!t)return;const V=t.getPanel(`review-${F}`);V&&V.api.setActive()},[t]);I.useEffect(()=>{if(!t)return;const F=t.getPanel("terminal");F&&F.api.updateParameters({collapsed:m.terminal,onToggleCollapse:A,approvals:r,onFocusReview:te,onDecision:H,normalizeApprovalPath:B})},[t,m.terminal,A,r,te,H,B]);const ee=I.useCallback(F=>{if(!t)return;const V=`workflow-terminal-${F}`,G=t.getPanel(V);if(G){G.api.setActive();return}const W=y.current?{referenceGroup:y.current}:{direction:"right",referencePanel:"filetree"},ne=t.addPanel({id:V,component:"workflowTerminal",title:`Workflow: ${F.slice(0,8)}`,position:W,params:{workflowId:F}});ne!=null&&ne.group&&(ne.group.header.hidden=!1,y.current=ne.group)},[t]);I.useEffect(()=>{if(!t)return;const F=t.getPanel("workflows");F&&F.api.updateParameters({collapsed:m.workflows,onToggleCollapse:M,onAttachWorkflow:ee});const V=t.getPanel("shell");V&&V.api.updateParameters({collapsed:m.workflows,onToggleCollapse:M})},[t,m.workflows,M,ee,x]);const K=I.useRef(!1);I.useEffect(()=>{if(!t||x===null||K.current||(K.current=!0,w.current))return;const F=CH(x);F.length>0&&setTimeout(()=>{F.forEach(V=>{D(V)})},50)},[t,x,D]),I.useEffect(()=>{if(!b.current||x===null)return;const F=Object.keys(n);EH(x,F)},[n,x]);const ce=I.useRef(!1);I.useEffect(()=>{if(!t||x===null||ce.current||!t.getPanel("filetree"))return;ce.current=!0;const V=new URLSearchParams(window.location.search).get("doc");V&&setTimeout(()=>{D(V)},150)},[t,x,D]);const T=F=>F.dataTransfer.types.includes("application/x-kurt-file"),$=F=>{const{dataTransfer:V,position:G,group:W}=F,ne=V.getData("application/x-kurt-file");if(ne)try{const ae=JSON.parse(ne).path;let Y;if(W)Y={referenceGroup:W};else if(G)Y=G;else{const le=y.current;Y=le?{referenceGroup:le}:{direction:"right",referencePanel:"filetree"}}j(ae,Y)}catch{}};if(Hb==="diff")return C.jsx(c9,{});if(Hb==="tiptap-diff")return C.jsx(bH,{});const Z=["dockview-theme-abyss",m.filetree&&"filetree-is-collapsed",m.terminal&&"terminal-is-collapsed",m.workflows&&"workflows-is-collapsed"].filter(Boolean).join(" ");return C.jsx(Ex,{className:Z,components:ZE,tabComponents:xH,rightHeaderActionsComponent:R,onReady:z,showDndOverlay:T,onDidDrop:$})}const OH=console.error;console.error=(...t)=>{const e=t[0];typeof e=="string"&&e.includes("_renderer.value is undefined")||OH.apply(console,t)};window.addEventListener("error",t=>{var e;if((e=t.message)!=null&&e.includes("_renderer.value is undefined"))return t.preventDefault(),!1});rx(document.getElementById("root")).render(C.jsx(RH,{}));
